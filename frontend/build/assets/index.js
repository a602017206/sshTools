var bi=Object.defineProperty;var Si=(l,i,a)=>i in l?bi(l,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[i]=a;var Gt=(l,i,a)=>Si(l,typeof i!="symbol"?i+"":i,a);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const C of document.querySelectorAll('link[rel="modulepreload"]'))b(C);new MutationObserver(C=>{for(const R of C)if(R.type==="childList")for(const y of R.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&b(y)}).observe(document,{childList:!0,subtree:!0});function a(C){const R={};return C.integrity&&(R.integrity=C.integrity),C.referrerPolicy&&(R.referrerPolicy=C.referrerPolicy),C.crossOrigin==="use-credentials"?R.credentials="include":C.crossOrigin==="anonymous"?R.credentials="omit":R.credentials="same-origin",R}function b(C){if(C.ep)return;C.ep=!0;const R=a(C);fetch(C.href,R)}})();const wi="modulepreload",yi=function(l){return"/"+l},ur={},ei=function(i,a,b){let C=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),t=(y==null?void 0:y.nonce)||(y==null?void 0:y.getAttribute("nonce"));C=Promise.allSettled(a.map(n=>{if(n=yi(n),n in ur)return;ur[n]=!0;const h=n.endsWith(".css"),_=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${_}`))return;const c=document.createElement("link");if(c.rel=h?"stylesheet":wi,h||(c.as="script"),c.crossOrigin="",c.href=n,t&&c.setAttribute("nonce",t),document.head.appendChild(c),h)return new Promise((u,g)=>{c.addEventListener("load",u),c.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${n}`)))})}))}function R(y){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=y,window.dispatchEvent(t),!t.defaultPrevented)throw y}return C.then(y=>{for(const t of y||[])t.status==="rejected"&&R(t.reason);return i().catch(R)})};function Se(){}function Ci(l,i){for(const a in i)l[a]=i[a];return l}function ti(l){return l()}function fr(){return Object.create(null)}function ye(l){l.forEach(ti)}function dt(l){return typeof l=="function"}function Ze(l,i){return l!=l?i==i:l!==i||l&&typeof l=="object"||typeof l=="function"}function ki(l){return Object.keys(l).length===0}function er(l,...i){if(l==null){for(const b of i)b(void 0);return Se}const a=l.subscribe(...i);return a.unsubscribe?()=>a.unsubscribe():a}function xi(l){let i;return er(l,a=>i=a)(),i}function it(l,i,a){l.$$.on_destroy.push(er(i,a))}function Ei(l,i,a,b){if(l){const C=ri(l,i,a,b);return l[0](C)}}function ri(l,i,a,b){return l[1]&&b?Ci(a.ctx.slice(),l[1](b(i))):a.ctx}function Li(l,i,a,b){return l[2],i.dirty}function Di(l,i,a,b,C,R){if(C){const y=ri(i,a,b,R);l.p(y,C)}}function Ri(l){if(l.ctx.length>32){const i=[],a=l.ctx.length/32;for(let b=0;b<a;b++)i[b]=-1;return i}return-1}function _r(l){return l??""}function ii(l){return l&&dt(l.destroy)?l.destroy:Se}const Ai=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function E(l,i){l.appendChild(i)}function ee(l,i,a){l.insertBefore(i,a||null)}function $(l){l.parentNode&&l.parentNode.removeChild(l)}function Bi(l,i){for(let a=0;a<l.length;a+=1)l[a]&&l[a].d(i)}function T(l){return document.createElement(l)}function _e(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function ie(l){return document.createTextNode(l)}function K(){return ie(" ")}function kt(){return ie("")}function se(l,i,a,b){return l.addEventListener(i,a,b),()=>l.removeEventListener(i,a,b)}function Mi(l){return function(i){return i.preventDefault(),l.call(this,i)}}function pr(l){return function(i){return i.stopPropagation(),l.call(this,i)}}function w(l,i,a){a==null?l.removeAttribute(i):l.getAttribute(i)!==a&&l.setAttribute(i,a)}function Ti(l){let i;return{p(...a){i=a,i.forEach(b=>l.push(b))},r(){i.forEach(a=>l.splice(l.indexOf(a),1))}}}function Oi(l){return Array.from(l.childNodes)}function de(l,i){i=""+i,l.data!==i&&(l.data=i)}function pe(l,i){l.value=i??""}function fe(l,i,a,b){a==null?l.style.removeProperty(i):l.style.setProperty(i,a,"")}function gr(l,i,a){for(let b=0;b<l.options.length;b+=1){const C=l.options[b];if(C.__value===i){C.selected=!0;return}}(!a||i!==void 0)&&(l.selectedIndex=-1)}function Pi(l){const i=l.querySelector(":checked");return i&&i.__value}function vr(l,i,a){l.classList.toggle(i,!!a)}let Dt;function Lt(l){Dt=l}function si(){if(!Dt)throw new Error("Function called outside component initialization");return Dt}function Rt(l){si().$$.on_mount.push(l)}function Nt(l){si().$$.on_destroy.push(l)}const St=[],Xe=[];let wt=[];const Zt=[],ni=Promise.resolve();let Yt=!1;function oi(){Yt||(Yt=!0,ni.then(ai))}function Jt(){return oi(),ni}function zt(l){wt.push(l)}function yt(l){Zt.push(l)}const Xt=new Set;let mt=0;function ai(){if(mt!==0)return;const l=Dt;do{try{for(;mt<St.length;){const i=St[mt];mt++,Lt(i),Ii(i.$$)}}catch(i){throw St.length=0,mt=0,i}for(Lt(null),St.length=0,mt=0;Xe.length;)Xe.pop()();for(let i=0;i<wt.length;i+=1){const a=wt[i];Xt.has(a)||(Xt.add(a),a())}wt.length=0}while(St.length);for(;Zt.length;)Zt.pop()();Yt=!1,Xt.clear(),Lt(l)}function Ii(l){if(l.fragment!==null){l.update(),ye(l.before_update);const i=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,i),l.after_update.forEach(zt)}}function Hi(l){const i=[],a=[];wt.forEach(b=>l.indexOf(b)===-1?i.push(b):a.push(b)),a.forEach(b=>b()),wt=i}const Wt=new Set;let _t;function tr(){_t={r:0,c:[],p:_t}}function rr(){_t.r||ye(_t.c),_t=_t.p}function Te(l,i){l&&l.i&&(Wt.delete(l),l.i(i))}function Fe(l,i,a,b){if(l&&l.o){if(Wt.has(l))return;Wt.add(l),_t.c.push(()=>{Wt.delete(l),b&&(a&&l.d(1),b())}),l.o(i)}else b&&b()}function Ve(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function jt(l,i){l.d(1),i.delete(l.key)}function Fi(l,i){Fe(l,1,1,()=>{i.delete(l.key)})}function At(l,i,a,b,C,R,y,t,n,h,_,c){let u=l.length,g=R.length,m=u;const f={};for(;m--;)f[l[m].key]=m;const e=[],o=new Map,r=new Map,s=[];for(m=g;m--;){const x=c(C,R,m),p=a(x);let k=y.get(p);k?s.push(()=>k.p(x,i)):(k=h(p,x),k.c()),o.set(p,e[m]=k),p in f&&r.set(p,Math.abs(m-f[p]))}const d=new Set,v=new Set;function S(x){Te(x,1),x.m(t,_),y.set(x.key,x),_=x.first,g--}for(;u&&g;){const x=e[g-1],p=l[u-1],k=x.key,A=p.key;x===p?(_=x.first,u--,g--):o.has(A)?!y.has(k)||d.has(k)?S(x):v.has(A)?u--:r.get(k)>r.get(A)?(v.add(k),S(x)):(d.add(A),u--):(n(p,y),u--)}for(;u--;){const x=l[u];o.has(x.key)||n(x,y)}for(;g;)S(e[g-1]);return ye(s),e}function Ct(l,i,a){const b=l.$$.props[i];b!==void 0&&(l.$$.bound[b]=a,a(l.$$.ctx[b]))}function rt(l){l&&l.c()}function Ge(l,i,a){const{fragment:b,after_update:C}=l.$$;b&&b.m(i,a),zt(()=>{const R=l.$$.on_mount.map(ti).filter(dt);l.$$.on_destroy?l.$$.on_destroy.push(...R):ye(R),l.$$.on_mount=[]}),C.forEach(zt)}function Je(l,i){const a=l.$$;a.fragment!==null&&(Hi(a.after_update),ye(a.on_destroy),a.fragment&&a.fragment.d(i),a.on_destroy=a.fragment=null,a.ctx=[])}function Wi(l,i){l.$$.dirty[0]===-1&&(St.push(l),oi(),l.$$.dirty.fill(0)),l.$$.dirty[i/31|0]|=1<<i%31}function st(l,i,a,b,C,R,y=null,t=[-1]){const n=Dt;Lt(l);const h=l.$$={fragment:null,ctx:[],props:R,update:Se,not_equal:C,bound:fr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(n?n.$$.context:[])),callbacks:fr(),dirty:t,skip_bound:!1,root:i.target||n.$$.root};y&&y(h.root);let _=!1;if(h.ctx=a?a(l,i.props||{},(c,u,...g)=>{const m=g.length?g[0]:u;return h.ctx&&C(h.ctx[c],h.ctx[c]=m)&&(!h.skip_bound&&h.bound[c]&&h.bound[c](m),_&&Wi(l,c)),u}):[],h.update(),_=!0,ye(h.before_update),h.fragment=b?b(h.ctx):!1,i.target){if(i.hydrate){const c=Oi(i.target);h.fragment&&h.fragment.l(c),c.forEach($)}else h.fragment&&h.fragment.c();i.intro&&Te(l.$$.fragment),Ge(l,i.target,i.anchor),ai()}Lt(n)}class nt{constructor(){Gt(this,"$$");Gt(this,"$$set")}$destroy(){Je(this,1),this.$destroy=Se}$on(i,a){if(!dt(a))return Se;const b=this.$$.callbacks[i]||(this.$$.callbacks[i]=[]);return b.push(a),()=>{const C=b.indexOf(a);C!==-1&&b.splice(C,1)}}$set(i){this.$$set&&!ki(i)&&(this.$$.skip_bound=!0,this.$$set(i),this.$$.skip_bound=!1)}}const zi="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(zi);const bt=[];function Ui(l,i){return{subscribe:xt(l,i).subscribe}}function xt(l,i=Se){let a;const b=new Set;function C(t){if(Ze(l,t)&&(l=t,a)){const n=!bt.length;for(const h of b)h[1](),bt.push(h,l);if(n){for(let h=0;h<bt.length;h+=2)bt[h][0](bt[h+1]);bt.length=0}}}function R(t){C(t(l))}function y(t,n=Se){const h=[t,n];return b.add(h),b.size===1&&(a=i(C,R)||Se),t(l),()=>{b.delete(h),b.size===0&&a&&(a(),a=null)}}return{set:C,update:R,subscribe:y}}function pt(l,i,a){const b=!Array.isArray(l),C=b?[l]:l;if(!C.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const R=i.length<2;return Ui(a,(y,t)=>{let n=!1;const h=[];let _=0,c=Se;const u=()=>{if(_)return;c();const m=i(b?h[0]:h,y,t);R?y(m):c=dt(m)?m:Se},g=C.map((m,f)=>er(m,e=>{h[f]=e,_&=~(1<<f),n&&u()},()=>{_|=1<<f}));return n=!0,u(),function(){ye(g),c(),n=!1}})}const ot=xt([]);pt(ot,l=>l.reduce((i,a)=>(i[a.group]||(i[a.group]=[]),i[a.group].push(a),i),{}));const tt=xt(new Map),ht=xt(null),Ut=xt("light");function Ni(){if(typeof window>"u")return null;try{const l=localStorage.getItem("ssh-tools-ui-config");if(!l)return null;const i=JSON.parse(l);return i.sidebarWidth&&(i.sidebarWidth=Number(i.sidebarWidth)),i.rightPanelWidth&&(i.rightPanelWidth=Number(i.rightPanelWidth)),i.fileManagerHeight&&(i.fileManagerHeight=Number(i.fileManagerHeight)),i}catch{return null}}const ji={isDevToolsOpen:!1,isFileManagerOpen:!1,isMonitorOpen:!1,sidebarWidth:288,rightPanelWidth:320,fileManagerHeight:50},Ki=Ni(),Ye=xt({...ji,...Ki});Ye.subscribe(l=>{if(typeof window<"u")try{localStorage.setItem("ssh-tools-ui-config",JSON.stringify(l))}catch{}});pt(Ye,l=>l.isDevToolsOpen);pt(Ye,l=>l.isFileManagerOpen);pt(Ye,l=>l.isMonitorOpen);pt(Ye,l=>l.sidebarWidth);pt(Ye,l=>l.rightPanelWidth);pt(Ye,l=>l.fileManagerHeight);function qi(l){Ye.update(i=>({...i,sidebarWidth:l}))}function Vi(l){Ye.update(i=>({...i,rightPanelWidth:l}))}function Gi(l){Ye.update(i=>({...i,fileManagerHeight:l}))}function mr(l,i,a){const b=l.slice();return b[17]=i[a][0],b[18]=i[a][1],b}function br(l,i,a){const b=l.slice();return b[21]=i[a],b}function Ji(l){let i,a;return{c(){i=_e("svg"),a=_e("path"),w(a,"stroke-linecap","round"),w(a,"stroke-linejoin","round"),w(a,"stroke-width","2"),w(a,"d","M9 5l7 7-7 7"),w(i,"class","w-4 h-4 text-gray-500 dark:text-gray-400"),w(i,"fill","none"),w(i,"stroke","currentColor"),w(i,"viewBox","0 0 24 24")},m(b,C){ee(b,i,C),E(i,a)},d(b){b&&$(i)}}}function Xi(l){let i,a;return{c(){i=_e("svg"),a=_e("path"),w(a,"stroke-linecap","round"),w(a,"stroke-linejoin","round"),w(a,"stroke-width","2"),w(a,"d","M19 9l-7 7-7-7"),w(i,"class","w-4 h-4 text-gray-500 dark:text-gray-400"),w(i,"fill","none"),w(i,"stroke","currentColor"),w(i,"viewBox","0 0 24 24")},m(b,C){ee(b,i,C),E(i,a)},d(b){b&&$(i)}}}function Sr(l){let i,a=[],b=new Map,C=Ve(l[18]);const R=y=>y[21].id;for(let y=0;y<C.length;y+=1){let t=br(l,C,y),n=R(t);b.set(n,a[y]=yr(n,t))}return{c(){i=T("div");for(let y=0;y<a.length;y+=1)a[y].c();w(i,"class","ml-4")},m(y,t){ee(y,i,t);for(let n=0;n<a.length;n+=1)a[n]&&a[n].m(i,null)},p(y,t){t&165&&(C=Ve(y[18]),a=At(a,t,R,1,y,C,b,i,jt,yr,null,br))},d(y){y&&$(i);for(let t=0;t<a.length;t+=1)a[t].d()}}}function wr(l){let i,a=l[21].dbType.toUpperCase()+"",b;return{c(){i=ie("• "),b=ie(a)},m(C,R){ee(C,i,R),ee(C,b,R)},p(C,R){R&32&&a!==(a=C[21].dbType.toUpperCase()+"")&&de(b,a)},d(C){C&&($(i),$(b))}}}function yr(l,i){let a,b,C=kr(i[21].type)+"",R,y,t,n,h=i[21].name+"",_,c,u,g,m,f,e=i[21].username+"",o,r,s=i[21].host+"",d,v,S=i[21].port+"",x,p,k,A,P,I,M,z,q,Y,Z,Q,L=i[21].type==="database"&&i[21].dbType&&wr(i);function O(){return i[13](i[21])}function H(){return i[14](i[21])}function F(...G){return i[15](i[21],...G)}function N(){return i[16](i[21])}return{key:l,first:null,c(){a=T("div"),b=T("div"),R=K(),y=T("div"),t=T("div"),n=T("span"),_=ie(h),c=K(),u=T("div"),m=K(),f=T("div"),o=ie(e),r=ie("@"),d=ie(s),v=ie(":"),x=ie(S),p=K(),L&&L.c(),k=K(),A=T("div"),P=T("button"),P.innerHTML='<svg class="w-3 h-3 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>',I=K(),M=T("button"),M.innerHTML='<svg class="w-3 h-3 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>',z=K(),q=T("button"),q.innerHTML='<svg class="w-3 h-3 text-red-600 dark:text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>',Y=K(),w(b,"class","flex-shrink-0"),w(n,"class","text-sm font-medium text-gray-900 dark:text-white truncate"),w(u,"class",g=`w-2 h-2 rounded-full flex-shrink-0 ${i[21].status==="online"?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}`),w(t,"class","flex items-center gap-2"),w(f,"class","text-xs text-gray-500 dark:text-gray-400 truncate"),w(y,"class","flex-1 min-w-0"),w(P,"class","p-1 hover:bg-green-100 dark:hover:bg-green-800 rounded"),w(P,"title","连接"),w(M,"class","p-1 hover:bg-purple-100 dark:hover:bg-purple-800 rounded"),w(q,"class","p-1 hover:bg-red-100 dark:hover:bg-red-800 rounded"),w(A,"class","opacity-0 group-hover:opacity-100 flex gap-1 transition-opacity"),w(a,"class","group flex items-center gap-2 px-3 py-2.5 hover:bg-purple-50 dark:hover:bg-purple-900/20 rounded-lg mx-2 cursor-pointer transition-all"),this.first=a},m(G,V){ee(G,a,V),E(a,b),b.innerHTML=C,E(a,R),E(a,y),E(y,t),E(t,n),E(n,_),E(t,c),E(t,u),E(y,m),E(y,f),E(f,o),E(f,r),E(f,d),E(f,v),E(f,x),E(f,p),L&&L.m(f,null),E(a,k),E(a,A),E(A,P),E(A,I),E(A,M),E(A,z),E(A,q),E(a,Y),Z||(Q=[se(P,"click",pr(O)),se(M,"click",pr(H)),se(q,"click",F),se(a,"click",N)],Z=!0)},p(G,V){i=G,V&32&&C!==(C=kr(i[21].type)+"")&&(b.innerHTML=C),V&32&&h!==(h=i[21].name+"")&&de(_,h),V&32&&g!==(g=`w-2 h-2 rounded-full flex-shrink-0 ${i[21].status==="online"?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}`)&&w(u,"class",g),V&32&&e!==(e=i[21].username+"")&&de(o,e),V&32&&s!==(s=i[21].host+"")&&de(d,s),V&32&&S!==(S=i[21].port+"")&&de(x,S),i[21].type==="database"&&i[21].dbType?L?L.p(i,V):(L=wr(i),L.c(),L.m(f,null)):L&&(L.d(1),L=null)},d(G){G&&$(a),L&&L.d(),Z=!1,ye(Q)}}}function Cr(l){let i,a,b,C,R,y,t,n,h=l[17]+"",_,c,u,g,m=l[18].length+"",f,e,o,r=l[4].has(l[17]),s,d,v;function S(P,I){return I&48&&(b=null),b==null&&(b=!!P[4].has(P[17])),b?Xi:Ji}let x=S(l,-1),p=x(l);function k(){return l[12](l[17])}let A=r&&Sr(l);return{c(){i=T("div"),a=T("div"),p.c(),C=K(),R=_e("svg"),y=_e("path"),t=K(),n=T("span"),_=ie(h),c=K(),u=T("span"),g=ie("("),f=ie(m),e=ie(")"),o=K(),A&&A.c(),s=K(),w(y,"d","M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"),w(R,"class","w-4 h-4 text-amber-500"),w(R,"fill","currentColor"),w(R,"viewBox","0 0 24 24"),w(n,"class","text-sm font-medium text-gray-700 dark:text-gray-300"),w(u,"class","ml-auto text-xs text-gray-400 dark:text-gray-500"),w(a,"class","flex items-center gap-2 px-3 py-2 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors"),w(i,"class","mb-1")},m(P,I){ee(P,i,I),E(i,a),p.m(a,null),E(a,C),E(a,R),E(R,y),E(a,t),E(a,n),E(n,_),E(a,c),E(a,u),E(u,g),E(u,f),E(u,e),E(i,o),A&&A.m(i,null),E(i,s),d||(v=se(a,"click",k),d=!0)},p(P,I){l=P,x!==(x=S(l,I))&&(p.d(1),p=x(l),p&&(p.c(),p.m(a,C))),I&32&&h!==(h=l[17]+"")&&de(_,h),I&32&&m!==(m=l[18].length+"")&&de(f,m),I&48&&(r=l[4].has(l[17])),r?A?A.p(l,I):(A=Sr(l),A.c(),A.m(i,s)):A&&(A.d(1),A=null)},d(P){P&&$(i),p.d(),A&&A.d(),d=!1,v()}}}function Zi(l){let i,a,b,C,R,y,t,n,h,_,c,u,g,m,f,e,o=Ve(Object.entries(l[5])),r=[];for(let s=0;s<o.length;s+=1)r[s]=Cr(mr(l,o,s));return{c(){i=T("div"),a=T("div"),b=T("div"),C=T("h2"),C.textContent="服务器资产",R=K(),y=T("button"),y.innerHTML='<svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>',t=K(),n=T("div"),h=_e("svg"),_=_e("path"),c=K(),u=T("input"),g=K(),m=T("div");for(let s=0;s<r.length;s+=1)r[s].c();w(C,"class","text-sm font-semibold text-gray-900 dark:text-white"),w(y,"class","p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"),w(b,"class","flex items-center justify-between mb-3"),w(_,"stroke-linecap","round"),w(_,"stroke-linejoin","round"),w(_,"stroke-width","2"),w(_,"d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"),w(h,"class","absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"),w(h,"fill","none"),w(h,"stroke","currentColor"),w(h,"viewBox","0 0 24 24"),w(u,"type","text"),w(u,"placeholder","搜索服务器..."),w(u,"class","w-full pl-9 pr-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"),w(n,"class","relative"),w(a,"class","p-4 border-b border-gray-200 dark:border-gray-700"),w(m,"class","flex-1 overflow-y-auto scrollbar-thin"),w(i,"class","h-full flex flex-col bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700")},m(s,d){ee(s,i,d),E(i,a),E(a,b),E(b,C),E(b,R),E(b,y),E(a,t),E(a,n),E(n,h),E(h,_),E(n,c),E(n,u),pe(u,l[3]),E(i,g),E(i,m);for(let v=0;v<r.length;v+=1)r[v]&&r[v].m(m,null);f||(e=[se(y,"click",function(){dt(l[1])&&l[1].apply(this,arguments)}),se(u,"input",l[11])],f=!0)},p(s,[d]){if(l=s,d&8&&u.value!==l[3]&&pe(u,l[3]),d&245){o=Ve(Object.entries(l[5]));let v;for(v=0;v<o.length;v+=1){const S=mr(l,o,v);r[v]?r[v].p(S,d):(r[v]=Cr(S),r[v].c(),r[v].m(m,null))}for(;v<r.length;v+=1)r[v].d(1);r.length=o.length}},i:Se,o:Se,d(s){s&&$(i),Bi(r,s),f=!1,ye(e)}}}function kr(l){switch(l){case"database":return`<svg class="w-4 h-4 text-blue-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4" />
        </svg>`;case"docker":return`<svg class="w-4 h-4 text-cyan-600 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24">
          <path d="M13.983 11.078h2.119a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186h-2.119a.185.185 0 00-.185.185v1.888c0 .102.083.185.185.185m-2.954-3.333h2.118a.186.186 0 00.186-.186V5.671a.186.186 0 00-.186-.185h-2.118a.185.185 0 00-.185.185v1.888c0 .102.082.185.185.185m-2.954 3.333h2.118a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186H8.075a.186.186 0 00-.186.186v1.888c0 .102.083.185.186.185m-2.954-3.333h2.119a.186.186 0 00.185-.186V5.671a.185.185 0 00-.185-.185H5.12a.186.186 0 00-.186.185v1.888c0 .102.084.185.186.185m-2.93 3.333h2.12a.185.185 0 00.185-.185V9.006a.185.185 0 00-.186-.186h-2.12a.185.185 0 00-.184.186v1.888c0 .102.083.185.185.185M20.69 6.662c.057.16.09.331.09.51v7.9c0 3.058-2.724 4.928-8.78 4.928-6.055 0-8.779-1.87-8.779-4.928v-7.9c0-.179.033-.35.09-.51C1.536 7.396 0 9.522 0 12.072v3.639c0 4.072 3.608 6.789 12 6.789 8.391 0 12-2.717 12-6.79v-3.638c0-2.55-1.536-4.677-4.31-6.41" />
        </svg>`;default:return`<svg class="w-4 h-4 text-purple-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01" />
        </svg>`}}function Yi(l,i,a){let b,C,R;it(l,ot,d=>a(10,R=d));let{onConnect:y}=i,{onAddClick:t}=i,{onDelete:n}=i,{onEdit:h}=i,_="",c=new Set(["生产环境","开发环境"]);function u(d){const v=new Set(c);v.has(d)?v.delete(d):v.add(d),a(4,c=v)}async function g(d,v){if(v.stopPropagation(),!window.wailsBindings){console.error("Wails bindings not loaded"),ot.update(S=>S.filter(x=>x.id!==d.id));return}if(confirm(`确定要删除连接 "${d.name}" 吗？`))try{await window.wailsBindings.RemoveConnection(d.id),ot.update(S=>S.filter(x=>x.id!==d.id))}catch(S){console.error("Failed to delete asset:",S)}}function m(){_=this.value,a(3,_)}const f=d=>u(d),e=d=>y(d),o=d=>h(d),r=(d,v)=>g(d,v),s=d=>y(d);return l.$$set=d=>{"onConnect"in d&&a(0,y=d.onConnect),"onAddClick"in d&&a(1,t=d.onAddClick),"onDelete"in d&&a(8,n=d.onDelete),"onEdit"in d&&a(2,h=d.onEdit)},l.$$.update=()=>{l.$$.dirty&1032&&a(9,b=R.filter(d=>{const v=_.toLowerCase();return d.name.toLowerCase().includes(v)||d.host.toLowerCase().includes(v)||d.group.toLowerCase().includes(v)||d.username.toLowerCase().includes(v)})),l.$$.dirty&512&&a(5,C=b.reduce((d,v)=>(d[v.group]||(d[v.group]=[]),d[v.group].push(v),d),{}))},[y,t,h,_,c,C,u,g,n,b,R,m,f,e,o,r,s]}class Qi extends nt{constructor(i){super(),st(this,i,Yi,Zi,Ze,{onConnect:0,onAddClick:1,onDelete:8,onEdit:2})}}var li={exports:{}};(function(l,i){(function(a,b){l.exports=b()})(globalThis,()=>(()=>{var a={4567:function(y,t,n){var h=this&&this.__decorate||function(r,s,d,v){var S,x=arguments.length,p=x<3?s:v===null?v=Object.getOwnPropertyDescriptor(s,d):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(r,s,d,v);else for(var k=r.length-1;k>=0;k--)(S=r[k])&&(p=(x<3?S(p):x>3?S(s,d,p):S(s,d))||p);return x>3&&p&&Object.defineProperty(s,d,p),p},_=this&&this.__param||function(r,s){return function(d,v){s(d,v,r)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;const c=n(9042),u=n(9924),g=n(844),m=n(4725),f=n(2585),e=n(3656);let o=t.AccessibilityManager=class extends g.Disposable{constructor(r,s,d,v){super(),this._terminal=r,this._coreBrowserService=d,this._renderService=v,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let S=0;S<this._terminal.rows;S++)this._rowElements[S]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[S]);if(this._topBoundaryFocusListener=S=>this._handleBoundaryFocus(S,0),this._bottomBoundaryFocusListener=S=>this._handleBoundaryFocus(S,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new u.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(S=>this._handleResize(S.rows))),this.register(this._terminal.onRender(S=>this._refreshRows(S.start,S.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(S=>this._handleChar(S))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(S=>this._handleTab(S))),this.register(this._terminal.onKey(S=>this._handleKey(S.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,e.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,g.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(r){for(let s=0;s<r;s++)this._handleChar(" ")}_handleChar(r){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==r&&(this._charsToAnnounce+=r):this._charsToAnnounce+=r,r===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=c.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(r){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(r)||this._charsToConsume.push(r)}_refreshRows(r,s){this._liveRegionDebouncer.refresh(r,s,this._terminal.rows)}_renderRows(r,s){const d=this._terminal.buffer,v=d.lines.length.toString();for(let S=r;S<=s;S++){const x=d.lines.get(d.ydisp+S),p=[],k=(x==null?void 0:x.translateToString(!0,void 0,void 0,p))||"",A=(d.ydisp+S+1).toString(),P=this._rowElements[S];P&&(k.length===0?(P.innerText=" ",this._rowColumns.set(P,[0,1])):(P.textContent=k,this._rowColumns.set(P,p)),P.setAttribute("aria-posinset",A),P.setAttribute("aria-setsize",v))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(r,s){const d=r.target,v=this._rowElements[s===0?1:this._rowElements.length-2];if(d.getAttribute("aria-posinset")===(s===0?"1":`${this._terminal.buffer.lines.length}`)||r.relatedTarget!==v)return;let S,x;if(s===0?(S=d,x=this._rowElements.pop(),this._rowContainer.removeChild(x)):(S=this._rowElements.shift(),x=d,this._rowContainer.removeChild(S)),S.removeEventListener("focus",this._topBoundaryFocusListener),x.removeEventListener("focus",this._bottomBoundaryFocusListener),s===0){const p=this._createAccessibilityTreeNode();this._rowElements.unshift(p),this._rowContainer.insertAdjacentElement("afterbegin",p)}else{const p=this._createAccessibilityTreeNode();this._rowElements.push(p),this._rowContainer.appendChild(p)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(s===0?-1:1),this._rowElements[s===0?1:this._rowElements.length-2].focus(),r.preventDefault(),r.stopImmediatePropagation()}_handleSelectionChange(){var k;if(this._rowElements.length===0)return;const r=document.getSelection();if(!r)return;if(r.isCollapsed)return void(this._rowContainer.contains(r.anchorNode)&&this._terminal.clearSelection());if(!r.anchorNode||!r.focusNode)return void console.error("anchorNode and/or focusNode are null");let s={node:r.anchorNode,offset:r.anchorOffset},d={node:r.focusNode,offset:r.focusOffset};if((s.node.compareDocumentPosition(d.node)&Node.DOCUMENT_POSITION_PRECEDING||s.node===d.node&&s.offset>d.offset)&&([s,d]=[d,s]),s.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(s={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(s.node))return;const v=this._rowElements.slice(-1)[0];if(d.node.compareDocumentPosition(v)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(d={node:v,offset:((k=v.textContent)==null?void 0:k.length)??0}),!this._rowContainer.contains(d.node))return;const S=({node:A,offset:P})=>{const I=A instanceof Text?A.parentNode:A;let M=parseInt(I==null?void 0:I.getAttribute("aria-posinset"),10)-1;if(isNaN(M))return console.warn("row is invalid. Race condition?"),null;const z=this._rowColumns.get(I);if(!z)return console.warn("columns is null. Race condition?"),null;let q=P<z.length?z[P]:z.slice(-1)[0]+1;return q>=this._terminal.cols&&(++M,q=0),{row:M,column:q}},x=S(s),p=S(d);if(x&&p){if(x.row>p.row||x.row===p.row&&x.column>=p.column)throw new Error("invalid range");this._terminal.select(x.column,x.row,(p.row-x.row)*this._terminal.cols-x.column+p.column)}}_handleResize(r){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let s=this._rowContainer.children.length;s<this._terminal.rows;s++)this._rowElements[s]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[s]);for(;this._rowElements.length>r;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const r=this._coreBrowserService.mainDocument.createElement("div");return r.setAttribute("role","listitem"),r.tabIndex=-1,this._refreshRowDimensions(r),r}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let r=0;r<this._terminal.rows;r++)this._refreshRowDimensions(this._rowElements[r])}}_refreshRowDimensions(r){r.style.height=`${this._renderService.dimensions.css.cell.height}px`}};t.AccessibilityManager=o=h([_(1,f.IInstantiationService),_(2,m.ICoreBrowserService),_(3,m.IRenderService)],o)},3614:(y,t)=>{function n(u){return u.replace(/\r?\n/g,"\r")}function h(u,g){return g?"\x1B[200~"+u+"\x1B[201~":u}function _(u,g,m,f){u=h(u=n(u),m.decPrivateModes.bracketedPasteMode&&f.rawOptions.ignoreBracketedPasteMode!==!0),m.triggerDataEvent(u,!0),g.value=""}function c(u,g,m){const f=m.getBoundingClientRect(),e=u.clientX-f.left-10,o=u.clientY-f.top-10;g.style.width="20px",g.style.height="20px",g.style.left=`${e}px`,g.style.top=`${o}px`,g.style.zIndex="1000",g.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=n,t.bracketTextForPaste=h,t.copyHandler=function(u,g){u.clipboardData&&u.clipboardData.setData("text/plain",g.selectionText),u.preventDefault()},t.handlePasteEvent=function(u,g,m,f){u.stopPropagation(),u.clipboardData&&_(u.clipboardData.getData("text/plain"),g,m,f)},t.paste=_,t.moveTextAreaUnderMouseCursor=c,t.rightClickHandler=function(u,g,m,f,e){c(u,g,m),e&&f.rightClickSelect(u),g.value=f.selectionText,g.select()}},7239:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;const h=n(1505);t.ColorContrastCache=class{constructor(){this._color=new h.TwoKeyMap,this._css=new h.TwoKeyMap}setCss(_,c,u){this._css.set(_,c,u)}getCss(_,c){return this._css.get(_,c)}setColor(_,c,u){this._color.set(_,c,u)}getColor(_,c){return this._color.get(_,c)}clear(){this._color.clear(),this._css.clear()}}},3656:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(n,h,_,c){n.addEventListener(h,_,c);let u=!1;return{dispose:()=>{u||(u=!0,n.removeEventListener(h,_,c))}}}},3551:function(y,t,n){var h=this&&this.__decorate||function(o,r,s,d){var v,S=arguments.length,x=S<3?r:d===null?d=Object.getOwnPropertyDescriptor(r,s):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(o,r,s,d);else for(var p=o.length-1;p>=0;p--)(v=o[p])&&(x=(S<3?v(x):S>3?v(r,s,x):v(r,s))||x);return S>3&&x&&Object.defineProperty(r,s,x),x},_=this&&this.__param||function(o,r){return function(s,d){r(s,d,o)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier=void 0;const c=n(3656),u=n(8460),g=n(844),m=n(2585),f=n(4725);let e=t.Linkifier=class extends g.Disposable{get currentLink(){return this._currentLink}constructor(o,r,s,d,v){super(),this._element=o,this._mouseService=r,this._renderService=s,this._bufferService=d,this._linkProviderService=v,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new u.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new u.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,g.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,g.toDisposable)(()=>{var S;this._lastMouseEvent=void 0,(S=this._activeProviderReplies)==null||S.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,c.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,c.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(o){this._lastMouseEvent=o;const r=this._positionFromMouseEvent(o,this._element,this._mouseService);if(!r)return;this._isMouseOut=!1;const s=o.composedPath();for(let d=0;d<s.length;d++){const v=s[d];if(v.classList.contains("xterm"))break;if(v.classList.contains("xterm-hover"))return}this._lastBufferCell&&r.x===this._lastBufferCell.x&&r.y===this._lastBufferCell.y||(this._handleHover(r),this._lastBufferCell=r)}_handleHover(o){if(this._activeLine!==o.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(o,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,o)||(this._clearCurrentLink(),this._askForLink(o,!0))}_askForLink(o,r){var d,v;this._activeProviderReplies&&r||((d=this._activeProviderReplies)==null||d.forEach(S=>{S==null||S.forEach(x=>{x.link.dispose&&x.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=o.y);let s=!1;for(const[S,x]of this._linkProviderService.linkProviders.entries())r?(v=this._activeProviderReplies)!=null&&v.get(S)&&(s=this._checkLinkProviderResult(S,o,s)):x.provideLinks(o.y,p=>{var A,P;if(this._isMouseOut)return;const k=p==null?void 0:p.map(I=>({link:I}));(A=this._activeProviderReplies)==null||A.set(S,k),s=this._checkLinkProviderResult(S,o,s),((P=this._activeProviderReplies)==null?void 0:P.size)===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(o.y,this._activeProviderReplies)})}_removeIntersectingLinks(o,r){const s=new Set;for(let d=0;d<r.size;d++){const v=r.get(d);if(v)for(let S=0;S<v.length;S++){const x=v[S],p=x.link.range.start.y<o?0:x.link.range.start.x,k=x.link.range.end.y>o?this._bufferService.cols:x.link.range.end.x;for(let A=p;A<=k;A++){if(s.has(A)){v.splice(S--,1);break}s.add(A)}}}}_checkLinkProviderResult(o,r,s){var S;if(!this._activeProviderReplies)return s;const d=this._activeProviderReplies.get(o);let v=!1;for(let x=0;x<o;x++)this._activeProviderReplies.has(x)&&!this._activeProviderReplies.get(x)||(v=!0);if(!v&&d){const x=d.find(p=>this._linkAtPosition(p.link,r));x&&(s=!0,this._handleNewLink(x))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!s)for(let x=0;x<this._activeProviderReplies.size;x++){const p=(S=this._activeProviderReplies.get(x))==null?void 0:S.find(k=>this._linkAtPosition(k.link,r));if(p){s=!0,this._handleNewLink(p);break}}return s}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(o){if(!this._currentLink)return;const r=this._positionFromMouseEvent(o,this._element,this._mouseService);r&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,r)&&this._currentLink.link.activate(o,this._currentLink.link.text)}_clearCurrentLink(o,r){this._currentLink&&this._lastMouseEvent&&(!o||!r||this._currentLink.link.range.start.y>=o&&this._currentLink.link.range.end.y<=r)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,g.disposeArray)(this._linkCacheDisposables))}_handleNewLink(o){if(!this._lastMouseEvent)return;const r=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);r&&this._linkAtPosition(o.link,r)&&(this._currentLink=o,this._currentLink.state={decorations:{underline:o.link.decorations===void 0||o.link.decorations.underline,pointerCursor:o.link.decorations===void 0||o.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,o.link,this._lastMouseEvent),o.link.decorations={},Object.defineProperties(o.link.decorations,{pointerCursor:{get:()=>{var s,d;return(d=(s=this._currentLink)==null?void 0:s.state)==null?void 0:d.decorations.pointerCursor},set:s=>{var d;(d=this._currentLink)!=null&&d.state&&this._currentLink.state.decorations.pointerCursor!==s&&(this._currentLink.state.decorations.pointerCursor=s,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",s))}},underline:{get:()=>{var s,d;return(d=(s=this._currentLink)==null?void 0:s.state)==null?void 0:d.decorations.underline},set:s=>{var d,v,S;(d=this._currentLink)!=null&&d.state&&((S=(v=this._currentLink)==null?void 0:v.state)==null?void 0:S.decorations.underline)!==s&&(this._currentLink.state.decorations.underline=s,this._currentLink.state.isHovered&&this._fireUnderlineEvent(o.link,s))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(s=>{if(!this._currentLink)return;const d=s.start===0?0:s.start+1+this._bufferService.buffer.ydisp,v=this._bufferService.buffer.ydisp+1+s.end;if(this._currentLink.link.range.start.y>=d&&this._currentLink.link.range.end.y<=v&&(this._clearCurrentLink(d,v),this._lastMouseEvent)){const S=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);S&&this._askForLink(S,!1)}})))}_linkHover(o,r,s){var d;(d=this._currentLink)!=null&&d.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(r,!0),this._currentLink.state.decorations.pointerCursor&&o.classList.add("xterm-cursor-pointer")),r.hover&&r.hover(s,r.text)}_fireUnderlineEvent(o,r){const s=o.range,d=this._bufferService.buffer.ydisp,v=this._createLinkUnderlineEvent(s.start.x-1,s.start.y-d-1,s.end.x,s.end.y-d-1,void 0);(r?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(v)}_linkLeave(o,r,s){var d;(d=this._currentLink)!=null&&d.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(r,!1),this._currentLink.state.decorations.pointerCursor&&o.classList.remove("xterm-cursor-pointer")),r.leave&&r.leave(s,r.text)}_linkAtPosition(o,r){const s=o.range.start.y*this._bufferService.cols+o.range.start.x,d=o.range.end.y*this._bufferService.cols+o.range.end.x,v=r.y*this._bufferService.cols+r.x;return s<=v&&v<=d}_positionFromMouseEvent(o,r,s){const d=s.getCoords(o,r,this._bufferService.cols,this._bufferService.rows);if(d)return{x:d[0],y:d[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(o,r,s,d,v){return{x1:o,y1:r,x2:s,y2:d,cols:this._bufferService.cols,fg:v}}};t.Linkifier=e=h([_(1,f.IMouseService),_(2,f.IRenderService),_(3,m.IBufferService),_(4,f.ILinkProviderService)],e)},9042:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(y,t,n){var h=this&&this.__decorate||function(f,e,o,r){var s,d=arguments.length,v=d<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,e,o,r);else for(var S=f.length-1;S>=0;S--)(s=f[S])&&(v=(d<3?s(v):d>3?s(e,o,v):s(e,o))||v);return d>3&&v&&Object.defineProperty(e,o,v),v},_=this&&this.__param||function(f,e){return function(o,r){e(o,r,f)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkProvider=void 0;const c=n(511),u=n(2585);let g=t.OscLinkProvider=class{constructor(f,e,o){this._bufferService=f,this._optionsService=e,this._oscLinkService=o}provideLinks(f,e){var k;const o=this._bufferService.buffer.lines.get(f-1);if(!o)return void e(void 0);const r=[],s=this._optionsService.rawOptions.linkHandler,d=new c.CellData,v=o.getTrimmedLength();let S=-1,x=-1,p=!1;for(let A=0;A<v;A++)if(x!==-1||o.hasContent(A)){if(o.loadCell(A,d),d.hasExtendedAttrs()&&d.extended.urlId){if(x===-1){x=A,S=d.extended.urlId;continue}p=d.extended.urlId!==S}else x!==-1&&(p=!0);if(p||x!==-1&&A===v-1){const P=(k=this._oscLinkService.getLinkData(S))==null?void 0:k.uri;if(P){const I={start:{x:x+1,y:f},end:{x:A+(p||A!==v-1?0:1),y:f}};let M=!1;if(!(s!=null&&s.allowNonHttpProtocols))try{const z=new URL(P);["http:","https:"].includes(z.protocol)||(M=!0)}catch{M=!0}M||r.push({text:P,range:I,activate:(z,q)=>s?s.activate(z,q,I):m(0,q),hover:(z,q)=>{var Y;return(Y=s==null?void 0:s.hover)==null?void 0:Y.call(s,z,q,I)},leave:(z,q)=>{var Y;return(Y=s==null?void 0:s.leave)==null?void 0:Y.call(s,z,q,I)}})}p=!1,d.hasExtendedAttrs()&&d.extended.urlId?(x=A,S=d.extended.urlId):(x=-1,S=-1)}}e(r)}};function m(f,e){if(confirm(`Do you want to navigate to ${e}?

WARNING: This link could potentially be dangerous`)){const o=window.open();if(o){try{o.opener=null}catch{}o.location.href=e}else console.warn("Opening link blocked as opener could not be cleared")}}t.OscLinkProvider=g=h([_(0,u.IBufferService),_(1,u.IOptionsService),_(2,u.IOscLinkService)],g)},6193:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0,t.RenderDebouncer=class{constructor(n,h){this._renderCallback=n,this._coreBrowserService=h,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(n){return this._refreshCallbacks.push(n),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(n,h,_){this._rowCount=_,n=n!==void 0?n:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const n=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,h),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const n of this._refreshCallbacks)n(0);this._refreshCallbacks=[]}}},3236:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;const h=n(3614),_=n(3656),c=n(3551),u=n(9042),g=n(3730),m=n(1680),f=n(3107),e=n(5744),o=n(2950),r=n(1296),s=n(428),d=n(4269),v=n(5114),S=n(8934),x=n(3230),p=n(9312),k=n(4725),A=n(6731),P=n(8055),I=n(8969),M=n(8460),z=n(844),q=n(6114),Y=n(8437),Z=n(2584),Q=n(7399),L=n(5941),O=n(9074),H=n(2585),F=n(5435),N=n(4567),G=n(779);class V extends I.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(B={}){super(B),this.browser=q,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new z.MutableDisposable),this._onCursorMove=this.register(new M.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new M.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new M.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new M.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new M.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new M.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new M.EventEmitter),this._onBlur=this.register(new M.EventEmitter),this._onA11yCharEmitter=this.register(new M.EventEmitter),this._onA11yTabEmitter=this.register(new M.EventEmitter),this._onWillOpen=this.register(new M.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(O.DecorationService),this._instantiationService.setService(H.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(G.LinkProviderService),this._instantiationService.setService(k.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(g.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((D,U)=>this.refresh(D,U))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(D=>this._reportWindowsOptions(D))),this.register(this._inputHandler.onColor(D=>this._handleColorEvent(D))),this.register((0,M.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,M.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,M.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,M.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(D=>this._afterResize(D.cols,D.rows))),this.register((0,z.toDisposable)(()=>{var D,U;this._customKeyEventHandler=void 0,(U=(D=this.element)==null?void 0:D.parentNode)==null||U.removeChild(this.element)}))}_handleColorEvent(B){if(this._themeService)for(const D of B){let U,W="";switch(D.index){case 256:U="foreground",W="10";break;case 257:U="background",W="11";break;case 258:U="cursor",W="12";break;default:U="ansi",W="4;"+D.index}switch(D.type){case 0:const J=P.color.toColorRGB(U==="ansi"?this._themeService.colors.ansi[D.index]:this._themeService.colors[U]);this.coreService.triggerDataEvent(`${Z.C0.ESC}]${W};${(0,L.toRgbString)(J)}${Z.C1_ESCAPED.ST}`);break;case 1:if(U==="ansi")this._themeService.modifyColors(X=>X.ansi[D.index]=P.channels.toColor(...D.color));else{const X=U;this._themeService.modifyColors(te=>te[X]=P.channels.toColor(...D.color))}break;case 2:this._themeService.restoreColor(D.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(B){B?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(N.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(B){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(Z.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var B;return(B=this.textarea)==null?void 0:B.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(Z.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const B=this.buffer.ybase+this.buffer.y,D=this.buffer.lines.get(B);if(!D)return;const U=Math.min(this.buffer.x,this.cols-1),W=this._renderService.dimensions.css.cell.height,J=D.getWidth(U),X=this._renderService.dimensions.css.cell.width*J,te=this.buffer.y*this._renderService.dimensions.css.cell.height,re=U*this._renderService.dimensions.css.cell.width;this.textarea.style.left=re+"px",this.textarea.style.top=te+"px",this.textarea.style.width=X+"px",this.textarea.style.height=W+"px",this.textarea.style.lineHeight=W+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,_.addDisposableDomListener)(this.element,"copy",D=>{this.hasSelection()&&(0,h.copyHandler)(D,this._selectionService)}));const B=D=>(0,h.handlePasteEvent)(D,this.textarea,this.coreService,this.optionsService);this.register((0,_.addDisposableDomListener)(this.textarea,"paste",B)),this.register((0,_.addDisposableDomListener)(this.element,"paste",B)),q.isFirefox?this.register((0,_.addDisposableDomListener)(this.element,"mousedown",D=>{D.button===2&&(0,h.rightClickHandler)(D,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,_.addDisposableDomListener)(this.element,"contextmenu",D=>{(0,h.rightClickHandler)(D,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),q.isLinux&&this.register((0,_.addDisposableDomListener)(this.element,"auxclick",D=>{D.button===1&&(0,h.moveTextAreaUnderMouseCursor)(D,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,_.addDisposableDomListener)(this.textarea,"keyup",B=>this._keyUp(B),!0)),this.register((0,_.addDisposableDomListener)(this.textarea,"keydown",B=>this._keyDown(B),!0)),this.register((0,_.addDisposableDomListener)(this.textarea,"keypress",B=>this._keyPress(B),!0)),this.register((0,_.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,_.addDisposableDomListener)(this.textarea,"compositionupdate",B=>this._compositionHelper.compositionupdate(B))),this.register((0,_.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,_.addDisposableDomListener)(this.textarea,"input",B=>this._inputEvent(B),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(B){var U;if(!B)throw new Error("Terminal requires a parent element.");if(B.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),((U=this.element)==null?void 0:U.ownerDocument.defaultView)&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=B.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),B.appendChild(this.element);const D=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),D.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,_.addDisposableDomListener)(this.screenElement,"mousemove",W=>this.updateCursorStyle(W))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),D.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",u.promptLabel),q.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(v.CoreBrowserService,this.textarea,B.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(k.ICoreBrowserService,this._coreBrowserService),this.register((0,_.addDisposableDomListener)(this.textarea,"focus",W=>this._handleTextAreaFocus(W))),this.register((0,_.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(s.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(k.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(A.ThemeService),this._instantiationService.setService(k.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(d.CharacterJoinerService),this._instantiationService.setService(k.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(x.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(k.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(W=>this._onRender.fire(W))),this.onResize(W=>this._renderService.resize(W.cols,W.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(o.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(S.MouseService),this._instantiationService.setService(k.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(c.Linkifier,this.screenElement)),this.element.appendChild(D);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(m.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(W=>this.scrollLines(W.amount,W.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(p.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(k.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(W=>this.scrollLines(W.amount,W.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(W=>this._renderService.handleSelectionChanged(W.start,W.end,W.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(W=>{this.textarea.value=W,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(W=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,_.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(f.BufferDecorationRenderer,this.screenElement)),this.register((0,_.addDisposableDomListener)(this.element,"mousedown",W=>this._selectionService.handleMouseDown(W))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(N.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",W=>this._handleScreenReaderModeOptionChange(W))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(e.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",W=>{!this._overviewRulerRenderer&&W&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(e.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(r.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const B=this,D=this.element;function U(X){const te=B._mouseService.getMouseReportCoords(X,B.screenElement);if(!te)return!1;let re,ae;switch(X.overrideType||X.type){case"mousemove":ae=32,X.buttons===void 0?(re=3,X.button!==void 0&&(re=X.button<3?X.button:3)):re=1&X.buttons?0:4&X.buttons?1:2&X.buttons?2:3;break;case"mouseup":ae=0,re=X.button<3?X.button:3;break;case"mousedown":ae=1,re=X.button<3?X.button:3;break;case"wheel":if(B._customWheelEventHandler&&B._customWheelEventHandler(X)===!1||B.viewport.getLinesScrolled(X)===0)return!1;ae=X.deltaY<0?0:1,re=4;break;default:return!1}return!(ae===void 0||re===void 0||re>4)&&B.coreMouseService.triggerMouseEvent({col:te.col,row:te.row,x:te.x,y:te.y,button:re,action:ae,ctrl:X.ctrlKey,alt:X.altKey,shift:X.shiftKey})}const W={mouseup:null,wheel:null,mousedrag:null,mousemove:null},J={mouseup:X=>(U(X),X.buttons||(this._document.removeEventListener("mouseup",W.mouseup),W.mousedrag&&this._document.removeEventListener("mousemove",W.mousedrag)),this.cancel(X)),wheel:X=>(U(X),this.cancel(X,!0)),mousedrag:X=>{X.buttons&&U(X)},mousemove:X=>{X.buttons||U(X)}};this.register(this.coreMouseService.onProtocolChange(X=>{X?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(X)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&X?W.mousemove||(D.addEventListener("mousemove",J.mousemove),W.mousemove=J.mousemove):(D.removeEventListener("mousemove",W.mousemove),W.mousemove=null),16&X?W.wheel||(D.addEventListener("wheel",J.wheel,{passive:!1}),W.wheel=J.wheel):(D.removeEventListener("wheel",W.wheel),W.wheel=null),2&X?W.mouseup||(W.mouseup=J.mouseup):(this._document.removeEventListener("mouseup",W.mouseup),W.mouseup=null),4&X?W.mousedrag||(W.mousedrag=J.mousedrag):(this._document.removeEventListener("mousemove",W.mousedrag),W.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,_.addDisposableDomListener)(D,"mousedown",X=>{if(X.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(X))return U(X),W.mouseup&&this._document.addEventListener("mouseup",W.mouseup),W.mousedrag&&this._document.addEventListener("mousemove",W.mousedrag),this.cancel(X)})),this.register((0,_.addDisposableDomListener)(D,"wheel",X=>{if(!W.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(X)===!1)return!1;if(!this.buffer.hasScrollback){const te=this.viewport.getLinesScrolled(X);if(te===0)return;const re=Z.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(X.deltaY<0?"A":"B");let ae="";for(let ue=0;ue<Math.abs(te);ue++)ae+=re;return this.coreService.triggerDataEvent(ae,!0),this.cancel(X,!0)}return this.viewport.handleWheel(X)?this.cancel(X):void 0}},{passive:!1})),this.register((0,_.addDisposableDomListener)(D,"touchstart",X=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(X),this.cancel(X)},{passive:!0})),this.register((0,_.addDisposableDomListener)(D,"touchmove",X=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(X)?void 0:this.cancel(X)},{passive:!1}))}refresh(B,D){var U;(U=this._renderService)==null||U.refreshRows(B,D)}updateCursorStyle(B){var D;(D=this._selectionService)!=null&&D.shouldColumnSelect(B)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(B,D,U=0){var W;U===1?(super.scrollLines(B,D,U),this.refresh(0,this.rows-1)):(W=this.viewport)==null||W.scrollLines(B)}paste(B){(0,h.paste)(B,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(B){this._customKeyEventHandler=B}attachCustomWheelEventHandler(B){this._customWheelEventHandler=B}registerLinkProvider(B){return this._linkProviderService.registerLinkProvider(B)}registerCharacterJoiner(B){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const D=this._characterJoinerService.register(B);return this.refresh(0,this.rows-1),D}deregisterCharacterJoiner(B){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(B)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(B){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+B)}registerDecoration(B){return this._decorationService.registerDecoration(B)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(B,D,U){this._selectionService.setSelection(B,D,U)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var B;(B=this._selectionService)==null||B.clearSelection()}selectAll(){var B;(B=this._selectionService)==null||B.selectAll()}selectLines(B,D){var U;(U=this._selectionService)==null||U.selectLines(B,D)}_keyDown(B){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(B)===!1)return!1;const D=this.browser.isMac&&this.options.macOptionIsMeta&&B.altKey;if(!D&&!this._compositionHelper.keydown(B))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;D||B.key!=="Dead"&&B.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const U=(0,Q.evaluateKeyboardEvent)(B,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(B),U.type===3||U.type===2){const W=this.rows-1;return this.scrollLines(U.type===2?-W:W),this.cancel(B,!0)}return U.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,B)||(U.cancel&&this.cancel(B,!0),!U.key||!!(B.key&&!B.ctrlKey&&!B.altKey&&!B.metaKey&&B.key.length===1&&B.key.charCodeAt(0)>=65&&B.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(U.key!==Z.C0.ETX&&U.key!==Z.C0.CR||(this.textarea.value=""),this._onKey.fire({key:U.key,domEvent:B}),this._showCursor(),this.coreService.triggerDataEvent(U.key,!0),!this.optionsService.rawOptions.screenReaderMode||B.altKey||B.ctrlKey?this.cancel(B,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(B,D){const U=B.isMac&&!this.options.macOptionIsMeta&&D.altKey&&!D.ctrlKey&&!D.metaKey||B.isWindows&&D.altKey&&D.ctrlKey&&!D.metaKey||B.isWindows&&D.getModifierState("AltGraph");return D.type==="keypress"?U:U&&(!D.keyCode||D.keyCode>47)}_keyUp(B){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(B)===!1||(function(D){return D.keyCode===16||D.keyCode===17||D.keyCode===18}(B)||this.focus(),this.updateCursorStyle(B),this._keyPressHandled=!1)}_keyPress(B){let D;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(B)===!1)return!1;if(this.cancel(B),B.charCode)D=B.charCode;else if(B.which===null||B.which===void 0)D=B.keyCode;else{if(B.which===0||B.charCode===0)return!1;D=B.which}return!(!D||(B.altKey||B.ctrlKey||B.metaKey)&&!this._isThirdLevelShift(this.browser,B)||(D=String.fromCharCode(D),this._onKey.fire({key:D,domEvent:B}),this._showCursor(),this.coreService.triggerDataEvent(D,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(B){if(B.data&&B.inputType==="insertText"&&(!B.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const D=B.data;return this.coreService.triggerDataEvent(D,!0),this.cancel(B),!0}return!1}resize(B,D){B!==this.cols||D!==this.rows?super.resize(B,D):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(B,D){var U,W;(U=this._charSizeService)==null||U.measure(),(W=this.viewport)==null||W.syncScrollArea(!0)}clear(){var B;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let D=1;D<this.rows;D++)this.buffer.lines.push(this.buffer.getBlankLine(Y.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(B=this.viewport)==null||B.reset(),this.refresh(0,this.rows-1)}}reset(){var D,U;this.options.rows=this.rows,this.options.cols=this.cols;const B=this._customKeyEventHandler;this._setup(),super.reset(),(D=this._selectionService)==null||D.reset(),this._decorationService.reset(),(U=this.viewport)==null||U.reset(),this._customKeyEventHandler=B,this.refresh(0,this.rows-1)}clearTextureAtlas(){var B;(B=this._renderService)==null||B.clearTextureAtlas()}_reportFocus(){var B;(B=this.element)!=null&&B.classList.contains("focus")?this.coreService.triggerDataEvent(Z.C0.ESC+"[I"):this.coreService.triggerDataEvent(Z.C0.ESC+"[O")}_reportWindowsOptions(B){if(this._renderService)switch(B){case F.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const D=this._renderService.dimensions.css.canvas.width.toFixed(0),U=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${Z.C0.ESC}[4;${U};${D}t`);break;case F.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const W=this._renderService.dimensions.css.cell.width.toFixed(0),J=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${Z.C0.ESC}[6;${J};${W}t`)}}cancel(B,D){if(this.options.cancelEvents||D)return B.preventDefault(),B.stopPropagation(),!1}}t.Terminal=V},9924:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0,t.TimeBasedDebouncer=class{constructor(n,h=1e3){this._renderCallback=n,this._debounceThresholdMS=h,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(n,h,_){this._rowCount=_,n=n!==void 0?n:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h;const c=Date.now();if(c-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=c,this._innerRefresh();else if(!this._additionalRefreshRequested){const u=c-this._lastRefreshMs,g=this._debounceThresholdMS-u;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},g)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const n=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,h)}}},1680:function(y,t,n){var h=this&&this.__decorate||function(o,r,s,d){var v,S=arguments.length,x=S<3?r:d===null?d=Object.getOwnPropertyDescriptor(r,s):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(o,r,s,d);else for(var p=o.length-1;p>=0;p--)(v=o[p])&&(x=(S<3?v(x):S>3?v(r,s,x):v(r,s))||x);return S>3&&x&&Object.defineProperty(r,s,x),x},_=this&&this.__param||function(o,r){return function(s,d){r(s,d,o)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;const c=n(3656),u=n(4725),g=n(8460),m=n(844),f=n(2585);let e=t.Viewport=class extends m.Disposable{constructor(o,r,s,d,v,S,x,p){super(),this._viewportElement=o,this._scrollArea=r,this._bufferService=s,this._optionsService=d,this._charSizeService=v,this._renderService=S,this._coreBrowserService=x,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new g.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,c.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(k=>this._activeBuffer=k.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(k=>this._renderDimensions=k)),this._handleThemeChange(p.colors),this.register(p.onChangeColors(k=>this._handleThemeChange(k))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(o){this._viewportElement.style.backgroundColor=o.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(o){if(o)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const r=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==r&&(this._lastRecordedBufferHeight=r,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const o=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==o&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=o),this._refreshAnimationFrame=null}syncScrollArea(o=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(o);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(o)}_handleScroll(o){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const r=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:r,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const o=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(o*(this._smoothScrollState.target-this._smoothScrollState.origin)),o<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(o,r){const s=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(r<0&&this._viewportElement.scrollTop!==0||r>0&&s<this._lastRecordedBufferHeight)||(o.cancelable&&o.preventDefault(),!1)}handleWheel(o){const r=this._getPixelsScrolled(o);return r!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+r:this._smoothScrollState.target+=r,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=r,this._bubbleScroll(o,r))}scrollLines(o){if(o!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const r=o*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+r,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:o,suppressScrollEvent:!1})}_getPixelsScrolled(o){if(o.deltaY===0||o.shiftKey)return 0;let r=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_LINE?r*=this._currentRowHeight:o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._currentRowHeight*this._bufferService.rows),r}getBufferElements(o,r){var p;let s,d="";const v=[],S=r??this._bufferService.buffer.lines.length,x=this._bufferService.buffer.lines;for(let k=o;k<S;k++){const A=x.get(k);if(!A)continue;const P=(p=x.get(k+1))==null?void 0:p.isWrapped;if(d+=A.translateToString(!P),!P||k===x.length-1){const I=document.createElement("div");I.textContent=d,v.push(I),d.length>0&&(s=I),d=""}}return{bufferElements:v,cursorElement:s}}getLinesScrolled(o){if(o.deltaY===0||o.shiftKey)return 0;let r=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(r/=this._currentRowHeight+0,this._wheelPartialScroll+=r,r=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._bufferService.rows),r}_applyScrollModifier(o,r){const s=this._optionsService.rawOptions.fastScrollModifier;return s==="alt"&&r.altKey||s==="ctrl"&&r.ctrlKey||s==="shift"&&r.shiftKey?o*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:o*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(o){this._lastTouchY=o.touches[0].pageY}handleTouchMove(o){const r=this._lastTouchY-o.touches[0].pageY;return this._lastTouchY=o.touches[0].pageY,r!==0&&(this._viewportElement.scrollTop+=r,this._bubbleScroll(o,r))}};t.Viewport=e=h([_(2,f.IBufferService),_(3,f.IOptionsService),_(4,u.ICharSizeService),_(5,u.IRenderService),_(6,u.ICoreBrowserService),_(7,u.IThemeService)],e)},3107:function(y,t,n){var h=this&&this.__decorate||function(f,e,o,r){var s,d=arguments.length,v=d<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,e,o,r);else for(var S=f.length-1;S>=0;S--)(s=f[S])&&(v=(d<3?s(v):d>3?s(e,o,v):s(e,o))||v);return d>3&&v&&Object.defineProperty(e,o,v),v},_=this&&this.__param||function(f,e){return function(o,r){e(o,r,f)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferDecorationRenderer=void 0;const c=n(4725),u=n(844),g=n(2585);let m=t.BufferDecorationRenderer=class extends u.Disposable{constructor(f,e,o,r,s){super(),this._screenElement=f,this._bufferService=e,this._coreBrowserService=o,this._decorationService=r,this._renderService=s,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(d=>this._removeDecoration(d))),this.register((0,u.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const f of this._decorationService.decorations)this._renderDecoration(f);this._dimensionsChanged=!1}_renderDecoration(f){this._refreshStyle(f),this._dimensionsChanged&&this._refreshXPosition(f)}_createElement(f){var r;const e=this._coreBrowserService.mainDocument.createElement("div");e.classList.add("xterm-decoration"),e.classList.toggle("xterm-decoration-top-layer",((r=f==null?void 0:f.options)==null?void 0:r.layer)==="top"),e.style.width=`${Math.round((f.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,e.style.height=(f.options.height||1)*this._renderService.dimensions.css.cell.height+"px",e.style.top=(f.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",e.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const o=f.options.x??0;return o&&o>this._bufferService.cols&&(e.style.display="none"),this._refreshXPosition(f,e),e}_refreshStyle(f){const e=f.marker.line-this._bufferService.buffers.active.ydisp;if(e<0||e>=this._bufferService.rows)f.element&&(f.element.style.display="none",f.onRenderEmitter.fire(f.element));else{let o=this._decorationElements.get(f);o||(o=this._createElement(f),f.element=o,this._decorationElements.set(f,o),this._container.appendChild(o),f.onDispose(()=>{this._decorationElements.delete(f),o.remove()})),o.style.top=e*this._renderService.dimensions.css.cell.height+"px",o.style.display=this._altBufferIsActive?"none":"block",f.onRenderEmitter.fire(o)}}_refreshXPosition(f,e=f.element){if(!e)return;const o=f.options.x??0;(f.options.anchor||"left")==="right"?e.style.right=o?o*this._renderService.dimensions.css.cell.width+"px":"":e.style.left=o?o*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(f){var e;(e=this._decorationElements.get(f))==null||e.remove(),this._decorationElements.delete(f),f.dispose()}};t.BufferDecorationRenderer=m=h([_(1,g.IBufferService),_(2,c.ICoreBrowserService),_(3,g.IDecorationService),_(4,c.IRenderService)],m)},5871:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorZoneStore=void 0,t.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(n){if(n.options.overviewRulerOptions){for(const h of this._zones)if(h.color===n.options.overviewRulerOptions.color&&h.position===n.options.overviewRulerOptions.position){if(this._lineIntersectsZone(h,n.marker.line))return;if(this._lineAdjacentToZone(h,n.marker.line,n.options.overviewRulerOptions.position))return void this._addLineToZone(h,n.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=n.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=n.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=n.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=n.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:n.options.overviewRulerOptions.color,position:n.options.overviewRulerOptions.position,startBufferLine:n.marker.line,endBufferLine:n.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(n){this._linePadding=n}_lineIntersectsZone(n,h){return h>=n.startBufferLine&&h<=n.endBufferLine}_lineAdjacentToZone(n,h,_){return h>=n.startBufferLine-this._linePadding[_||"full"]&&h<=n.endBufferLine+this._linePadding[_||"full"]}_addLineToZone(n,h){n.startBufferLine=Math.min(n.startBufferLine,h),n.endBufferLine=Math.max(n.endBufferLine,h)}}},5744:function(y,t,n){var h=this&&this.__decorate||function(s,d,v,S){var x,p=arguments.length,k=p<3?d:S===null?S=Object.getOwnPropertyDescriptor(d,v):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(s,d,v,S);else for(var A=s.length-1;A>=0;A--)(x=s[A])&&(k=(p<3?x(k):p>3?x(d,v,k):x(d,v))||k);return p>3&&k&&Object.defineProperty(d,v,k),k},_=this&&this.__param||function(s,d){return function(v,S){d(v,S,s)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OverviewRulerRenderer=void 0;const c=n(5871),u=n(4725),g=n(844),m=n(2585),f={full:0,left:0,center:0,right:0},e={full:0,left:0,center:0,right:0},o={full:0,left:0,center:0,right:0};let r=t.OverviewRulerRenderer=class extends g.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(s,d,v,S,x,p,k){var P;super(),this._viewportElement=s,this._screenElement=d,this._bufferService=v,this._decorationService=S,this._renderService=x,this._optionsService=p,this._coreBrowserService=k,this._colorZoneStore=new c.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(P=this._viewportElement.parentElement)==null||P.insertBefore(this._canvas,this._viewportElement);const A=this._canvas.getContext("2d");if(!A)throw new Error("Ctx cannot be null");this._ctx=A,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,g.toDisposable)(()=>{var I;(I=this._canvas)==null||I.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const s=Math.floor(this._canvas.width/3),d=Math.ceil(this._canvas.width/3);e.full=this._canvas.width,e.left=s,e.center=d,e.right=s,this._refreshDrawHeightConstants(),o.full=0,o.left=0,o.center=e.left,o.right=e.left+e.center}_refreshDrawHeightConstants(){f.full=Math.round(2*this._coreBrowserService.dpr);const s=this._canvas.height/this._bufferService.buffer.lines.length,d=Math.round(Math.max(Math.min(s,12),6)*this._coreBrowserService.dpr);f.left=d,f.center=d,f.right=d}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const d of this._decorationService.decorations)this._colorZoneStore.addDecoration(d);this._ctx.lineWidth=1;const s=this._colorZoneStore.zones;for(const d of s)d.position!=="full"&&this._renderColorZone(d);for(const d of s)d.position==="full"&&this._renderColorZone(d);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(s){this._ctx.fillStyle=s.color,this._ctx.fillRect(o[s.position||"full"],Math.round((this._canvas.height-1)*(s.startBufferLine/this._bufferService.buffers.active.lines.length)-f[s.position||"full"]/2),e[s.position||"full"],Math.round((this._canvas.height-1)*((s.endBufferLine-s.startBufferLine)/this._bufferService.buffers.active.lines.length)+f[s.position||"full"]))}_queueRefresh(s,d){this._shouldUpdateDimensions=s||this._shouldUpdateDimensions,this._shouldUpdateAnchor=d||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};t.OverviewRulerRenderer=r=h([_(2,m.IBufferService),_(3,m.IDecorationService),_(4,u.IRenderService),_(5,m.IOptionsService),_(6,u.ICoreBrowserService)],r)},2950:function(y,t,n){var h=this&&this.__decorate||function(f,e,o,r){var s,d=arguments.length,v=d<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,e,o,r);else for(var S=f.length-1;S>=0;S--)(s=f[S])&&(v=(d<3?s(v):d>3?s(e,o,v):s(e,o))||v);return d>3&&v&&Object.defineProperty(e,o,v),v},_=this&&this.__param||function(f,e){return function(o,r){e(o,r,f)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;const c=n(4725),u=n(2585),g=n(2584);let m=t.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(f,e,o,r,s,d){this._textarea=f,this._compositionView=e,this._bufferService=o,this._optionsService=r,this._coreService=s,this._renderService=d,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(f){this._compositionView.textContent=f.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(f){if(this._isComposing||this._isSendingComposition){if(f.keyCode===229||f.keyCode===16||f.keyCode===17||f.keyCode===18)return!1;this._finalizeComposition(!1)}return f.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(f){if(this._compositionView.classList.remove("active"),this._isComposing=!1,f){const e={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let o;this._isSendingComposition=!1,e.start+=this._dataAlreadySent.length,o=this._isComposing?this._textarea.value.substring(e.start,e.end):this._textarea.value.substring(e.start),o.length>0&&this._coreService.triggerDataEvent(o,!0)}},0)}else{this._isSendingComposition=!1;const e=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(e,!0)}}_handleAnyTextareaChanges(){const f=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const e=this._textarea.value,o=e.replace(f,"");this._dataAlreadySent=o,e.length>f.length?this._coreService.triggerDataEvent(o,!0):e.length<f.length?this._coreService.triggerDataEvent(`${g.C0.DEL}`,!0):e.length===f.length&&e!==f&&this._coreService.triggerDataEvent(e,!0)}},0)}updateCompositionElements(f){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const e=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),o=this._renderService.dimensions.css.cell.height,r=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,s=e*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=s+"px",this._compositionView.style.top=r+"px",this._compositionView.style.height=o+"px",this._compositionView.style.lineHeight=o+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const d=this._compositionView.getBoundingClientRect();this._textarea.style.left=s+"px",this._textarea.style.top=r+"px",this._textarea.style.width=Math.max(d.width,1)+"px",this._textarea.style.height=Math.max(d.height,1)+"px",this._textarea.style.lineHeight=d.height+"px"}f||setTimeout(()=>this.updateCompositionElements(!0),0)}}};t.CompositionHelper=m=h([_(2,u.IBufferService),_(3,u.IOptionsService),_(4,u.ICoreService),_(5,c.IRenderService)],m)},9806:(y,t)=>{function n(h,_,c){const u=c.getBoundingClientRect(),g=h.getComputedStyle(c),m=parseInt(g.getPropertyValue("padding-left")),f=parseInt(g.getPropertyValue("padding-top"));return[_.clientX-u.left-m,_.clientY-u.top-f]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=n,t.getCoords=function(h,_,c,u,g,m,f,e,o){if(!m)return;const r=n(h,_,c);return r?(r[0]=Math.ceil((r[0]+(o?f/2:0))/f),r[1]=Math.ceil(r[1]/e),r[0]=Math.min(Math.max(r[0],1),u+(o?1:0)),r[1]=Math.min(Math.max(r[1],1),g),r):void 0}},9504:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;const h=n(2584);function _(e,o,r,s){const d=e-c(e,r),v=o-c(o,r),S=Math.abs(d-v)-function(x,p,k){let A=0;const P=x-c(x,k),I=p-c(p,k);for(let M=0;M<Math.abs(P-I);M++){const z=u(x,p)==="A"?-1:1,q=k.buffer.lines.get(P+z*M);q!=null&&q.isWrapped&&A++}return A}(e,o,r);return f(S,m(u(e,o),s))}function c(e,o){let r=0,s=o.buffer.lines.get(e),d=s==null?void 0:s.isWrapped;for(;d&&e>=0&&e<o.rows;)r++,s=o.buffer.lines.get(--e),d=s==null?void 0:s.isWrapped;return r}function u(e,o){return e>o?"A":"B"}function g(e,o,r,s,d,v){let S=e,x=o,p="";for(;S!==r||x!==s;)S+=d?1:-1,d&&S>v.cols-1?(p+=v.buffer.translateBufferLineToString(x,!1,e,S),S=0,e=0,x++):!d&&S<0&&(p+=v.buffer.translateBufferLineToString(x,!1,0,e+1),S=v.cols-1,e=S,x--);return p+v.buffer.translateBufferLineToString(x,!1,e,S)}function m(e,o){const r=o?"O":"[";return h.C0.ESC+r+e}function f(e,o){e=Math.floor(e);let r="";for(let s=0;s<e;s++)r+=o;return r}t.moveToCellSequence=function(e,o,r,s){const d=r.buffer.x,v=r.buffer.y;if(!r.buffer.hasScrollback)return function(p,k,A,P,I,M){return _(k,P,I,M).length===0?"":f(g(p,k,p,k-c(k,I),!1,I).length,m("D",M))}(d,v,0,o,r,s)+_(v,o,r,s)+function(p,k,A,P,I,M){let z;z=_(k,P,I,M).length>0?P-c(P,I):k;const q=P,Y=function(Z,Q,L,O,H,F){let N;return N=_(L,O,H,F).length>0?O-c(O,H):Q,Z<L&&N<=O||Z>=L&&N<O?"C":"D"}(p,k,A,P,I,M);return f(g(p,z,A,q,Y==="C",I).length,m(Y,M))}(d,v,e,o,r,s);let S;if(v===o)return S=d>e?"D":"C",f(Math.abs(d-e),m(S,s));S=v>o?"D":"C";const x=Math.abs(v-o);return f(function(p,k){return k.cols-p}(v>o?e:d,r)+(x-1)*r.cols+1+((v>o?d:e)-1),m(S,s))}},1296:function(y,t,n){var h=this&&this.__decorate||function(M,z,q,Y){var Z,Q=arguments.length,L=Q<3?z:Y===null?Y=Object.getOwnPropertyDescriptor(z,q):Y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(M,z,q,Y);else for(var O=M.length-1;O>=0;O--)(Z=M[O])&&(L=(Q<3?Z(L):Q>3?Z(z,q,L):Z(z,q))||L);return Q>3&&L&&Object.defineProperty(z,q,L),L},_=this&&this.__param||function(M,z){return function(q,Y){z(q,Y,M)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;const c=n(3787),u=n(2550),g=n(2223),m=n(6171),f=n(6052),e=n(4725),o=n(8055),r=n(8460),s=n(844),d=n(2585),v="xterm-dom-renderer-owner-",S="xterm-rows",x="xterm-fg-",p="xterm-bg-",k="xterm-focus",A="xterm-selection";let P=1,I=t.DomRenderer=class extends s.Disposable{constructor(M,z,q,Y,Z,Q,L,O,H,F,N,G,V){super(),this._terminal=M,this._document=z,this._element=q,this._screenElement=Y,this._viewportElement=Z,this._helperContainer=Q,this._linkifier2=L,this._charSizeService=H,this._optionsService=F,this._bufferService=N,this._coreBrowserService=G,this._themeService=V,this._terminalClass=P++,this._rowElements=[],this._selectionRenderModel=(0,f.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new r.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(S),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(A),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,m.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(j=>this._injectCss(j))),this._injectCss(this._themeService.colors),this._rowFactory=O.createInstance(c.DomRendererRowFactory,document),this._element.classList.add(v+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(j=>this._handleLinkHover(j))),this.register(this._linkifier2.onHideLinkUnderline(j=>this._handleLinkLeave(j))),this.register((0,s.toDisposable)(()=>{this._element.classList.remove(v+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new u.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const M=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*M,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*M),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/M),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/M),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const q of this._rowElements)q.style.width=`${this.dimensions.css.canvas.width}px`,q.style.height=`${this.dimensions.css.cell.height}px`,q.style.lineHeight=`${this.dimensions.css.cell.height}px`,q.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const z=`${this._terminalSelector} .${S} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=z,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(M){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let z=`${this._terminalSelector} .${S} { color: ${M.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;z+=`${this._terminalSelector} .${S} .xterm-dim { color: ${o.color.multiplyOpacity(M.foreground,.5).css};}`,z+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const q=`blink_underline_${this._terminalClass}`,Y=`blink_bar_${this._terminalClass}`,Z=`blink_block_${this._terminalClass}`;z+=`@keyframes ${q} { 50% {  border-bottom-style: hidden; }}`,z+=`@keyframes ${Y} { 50% {  box-shadow: none; }}`,z+=`@keyframes ${Z} { 0% {  background-color: ${M.cursor.css};  color: ${M.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${M.cursor.css}; }}`,z+=`${this._terminalSelector} .${S}.${k} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${q} 1s step-end infinite;}${this._terminalSelector} .${S}.${k} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${Y} 1s step-end infinite;}${this._terminalSelector} .${S}.${k} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${Z} 1s step-end infinite;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-block { background-color: ${M.cursor.css}; color: ${M.cursorAccent.css};}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${M.cursor.css} !important; color: ${M.cursorAccent.css} !important;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${M.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${M.cursor.css} inset;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${M.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,z+=`${this._terminalSelector} .${A} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${A} div { position: absolute; background-color: ${M.selectionBackgroundOpaque.css};}${this._terminalSelector} .${A} div { position: absolute; background-color: ${M.selectionInactiveBackgroundOpaque.css};}`;for(const[Q,L]of M.ansi.entries())z+=`${this._terminalSelector} .${x}${Q} { color: ${L.css}; }${this._terminalSelector} .${x}${Q}.xterm-dim { color: ${o.color.multiplyOpacity(L,.5).css}; }${this._terminalSelector} .${p}${Q} { background-color: ${L.css}; }`;z+=`${this._terminalSelector} .${x}${g.INVERTED_DEFAULT_COLOR} { color: ${o.color.opaque(M.background).css}; }${this._terminalSelector} .${x}${g.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${o.color.multiplyOpacity(o.color.opaque(M.background),.5).css}; }${this._terminalSelector} .${p}${g.INVERTED_DEFAULT_COLOR} { background-color: ${M.foreground.css}; }`,this._themeStyleElement.textContent=z}_setDefaultSpacing(){const M=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${M}px`,this._rowFactory.defaultSpacing=M}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(M,z){for(let q=this._rowElements.length;q<=z;q++){const Y=this._document.createElement("div");this._rowContainer.appendChild(Y),this._rowElements.push(Y)}for(;this._rowElements.length>z;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(M,z){this._refreshRowElements(M,z),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(k),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(k),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(M,z,q){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(M,z,q),this.renderRows(0,this._bufferService.rows-1),!M||!z)return;this._selectionRenderModel.update(this._terminal,M,z,q);const Y=this._selectionRenderModel.viewportStartRow,Z=this._selectionRenderModel.viewportEndRow,Q=this._selectionRenderModel.viewportCappedStartRow,L=this._selectionRenderModel.viewportCappedEndRow;if(Q>=this._bufferService.rows||L<0)return;const O=this._document.createDocumentFragment();if(q){const H=M[0]>z[0];O.appendChild(this._createSelectionElement(Q,H?z[0]:M[0],H?M[0]:z[0],L-Q+1))}else{const H=Y===Q?M[0]:0,F=Q===Z?z[0]:this._bufferService.cols;O.appendChild(this._createSelectionElement(Q,H,F));const N=L-Q-1;if(O.appendChild(this._createSelectionElement(Q+1,0,this._bufferService.cols,N)),Q!==L){const G=Z===L?z[0]:this._bufferService.cols;O.appendChild(this._createSelectionElement(L,0,G))}}this._selectionContainer.appendChild(O)}_createSelectionElement(M,z,q,Y=1){const Z=this._document.createElement("div"),Q=z*this.dimensions.css.cell.width;let L=this.dimensions.css.cell.width*(q-z);return Q+L>this.dimensions.css.canvas.width&&(L=this.dimensions.css.canvas.width-Q),Z.style.height=Y*this.dimensions.css.cell.height+"px",Z.style.top=M*this.dimensions.css.cell.height+"px",Z.style.left=`${Q}px`,Z.style.width=`${L}px`,Z}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const M of this._rowElements)M.replaceChildren()}renderRows(M,z){const q=this._bufferService.buffer,Y=q.ybase+q.y,Z=Math.min(q.x,this._bufferService.cols-1),Q=this._optionsService.rawOptions.cursorBlink,L=this._optionsService.rawOptions.cursorStyle,O=this._optionsService.rawOptions.cursorInactiveStyle;for(let H=M;H<=z;H++){const F=H+q.ydisp,N=this._rowElements[H],G=q.lines.get(F);if(!N||!G)break;N.replaceChildren(...this._rowFactory.createRow(G,F,F===Y,L,O,Z,Q,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${v}${this._terminalClass}`}_handleLinkHover(M){this._setCellUnderline(M.x1,M.x2,M.y1,M.y2,M.cols,!0)}_handleLinkLeave(M){this._setCellUnderline(M.x1,M.x2,M.y1,M.y2,M.cols,!1)}_setCellUnderline(M,z,q,Y,Z,Q){q<0&&(M=0),Y<0&&(z=0);const L=this._bufferService.rows-1;q=Math.max(Math.min(q,L),0),Y=Math.max(Math.min(Y,L),0),Z=Math.min(Z,this._bufferService.cols);const O=this._bufferService.buffer,H=O.ybase+O.y,F=Math.min(O.x,Z-1),N=this._optionsService.rawOptions.cursorBlink,G=this._optionsService.rawOptions.cursorStyle,V=this._optionsService.rawOptions.cursorInactiveStyle;for(let j=q;j<=Y;++j){const B=j+O.ydisp,D=this._rowElements[j],U=O.lines.get(B);if(!D||!U)break;D.replaceChildren(...this._rowFactory.createRow(U,B,B===H,G,V,F,N,this.dimensions.css.cell.width,this._widthCache,Q?j===q?M:0:-1,Q?(j===Y?z:Z)-1:-1))}}};t.DomRenderer=I=h([_(7,d.IInstantiationService),_(8,e.ICharSizeService),_(9,d.IOptionsService),_(10,d.IBufferService),_(11,e.ICoreBrowserService),_(12,e.IThemeService)],I)},3787:function(y,t,n){var h=this&&this.__decorate||function(S,x,p,k){var A,P=arguments.length,I=P<3?x:k===null?k=Object.getOwnPropertyDescriptor(x,p):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(S,x,p,k);else for(var M=S.length-1;M>=0;M--)(A=S[M])&&(I=(P<3?A(I):P>3?A(x,p,I):A(x,p))||I);return P>3&&I&&Object.defineProperty(x,p,I),I},_=this&&this.__param||function(S,x){return function(p,k){x(p,k,S)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=void 0;const c=n(2223),u=n(643),g=n(511),m=n(2585),f=n(8055),e=n(4725),o=n(4269),r=n(6171),s=n(3734);let d=t.DomRendererRowFactory=class{constructor(S,x,p,k,A,P,I){this._document=S,this._characterJoinerService=x,this._optionsService=p,this._coreBrowserService=k,this._coreService=A,this._decorationService=P,this._themeService=I,this._workCell=new g.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(S,x,p){this._selectionStart=S,this._selectionEnd=x,this._columnSelectMode=p}createRow(S,x,p,k,A,P,I,M,z,q,Y){const Z=[],Q=this._characterJoinerService.getJoinedCharacters(x),L=this._themeService.colors;let O,H=S.getNoBgTrimmedLength();p&&H<P+1&&(H=P+1);let F=0,N="",G=0,V=0,j=0,B=!1,D=0,U=!1,W=0;const J=[],X=q!==-1&&Y!==-1;for(let te=0;te<H;te++){S.loadCell(te,this._workCell);let re=this._workCell.getWidth();if(re===0)continue;let ae=!1,ue=te,oe=this._workCell;if(Q.length>0&&te===Q[0][0]){ae=!0;const ge=Q.shift();oe=new o.JoinedCellData(this._workCell,S.translateToString(!0,ge[0],ge[1]),ge[1]-ge[0]),ue=ge[1]-1,re=oe.getWidth()}const he=this._isCellInSelection(te,x),Ee=p&&te===P,be=X&&te>=q&&te<=Y;let ve=!1;this._decorationService.forEachDecorationAtCell(te,x,void 0,ge=>{ve=!0});let We=oe.getChars()||u.WHITESPACE_CELL_CHAR;if(We===" "&&(oe.isUnderline()||oe.isOverline())&&(We=" "),W=re*M-z.get(We,oe.isBold(),oe.isItalic()),O){if(F&&(he&&U||!he&&!U&&oe.bg===G)&&(he&&U&&L.selectionForeground||oe.fg===V)&&oe.extended.ext===j&&be===B&&W===D&&!Ee&&!ae&&!ve){oe.isInvisible()?N+=u.WHITESPACE_CELL_CHAR:N+=We,F++;continue}F&&(O.textContent=N),O=this._document.createElement("span"),F=0,N=""}else O=this._document.createElement("span");if(G=oe.bg,V=oe.fg,j=oe.extended.ext,B=be,D=W,U=he,ae&&P>=te&&P<=ue&&(P=te),!this._coreService.isCursorHidden&&Ee&&this._coreService.isCursorInitialized){if(J.push("xterm-cursor"),this._coreBrowserService.isFocused)I&&J.push("xterm-cursor-blink"),J.push(k==="bar"?"xterm-cursor-bar":k==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(A)switch(A){case"outline":J.push("xterm-cursor-outline");break;case"block":J.push("xterm-cursor-block");break;case"bar":J.push("xterm-cursor-bar");break;case"underline":J.push("xterm-cursor-underline")}}if(oe.isBold()&&J.push("xterm-bold"),oe.isItalic()&&J.push("xterm-italic"),oe.isDim()&&J.push("xterm-dim"),N=oe.isInvisible()?u.WHITESPACE_CELL_CHAR:oe.getChars()||u.WHITESPACE_CELL_CHAR,oe.isUnderline()&&(J.push(`xterm-underline-${oe.extended.underlineStyle}`),N===" "&&(N=" "),!oe.isUnderlineColorDefault()))if(oe.isUnderlineColorRGB())O.style.textDecorationColor=`rgb(${s.AttributeData.toColorRGB(oe.getUnderlineColor()).join(",")})`;else{let ge=oe.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&oe.isBold()&&ge<8&&(ge+=8),O.style.textDecorationColor=L.ansi[ge].css}oe.isOverline()&&(J.push("xterm-overline"),N===" "&&(N=" ")),oe.isStrikethrough()&&J.push("xterm-strikethrough"),be&&(O.style.textDecoration="underline");let Ce=oe.getFgColor(),Ne=oe.getFgColorMode(),ke=oe.getBgColor(),Oe=oe.getBgColorMode();const ze=!!oe.isInverse();if(ze){const ge=Ce;Ce=ke,ke=ge;const Ke=Ne;Ne=Oe,Oe=Ke}let ne,ce,Le,De=!1;switch(this._decorationService.forEachDecorationAtCell(te,x,void 0,ge=>{ge.options.layer!=="top"&&De||(ge.backgroundColorRGB&&(Oe=50331648,ke=ge.backgroundColorRGB.rgba>>8&16777215,ne=ge.backgroundColorRGB),ge.foregroundColorRGB&&(Ne=50331648,Ce=ge.foregroundColorRGB.rgba>>8&16777215,ce=ge.foregroundColorRGB),De=ge.options.layer==="top")}),!De&&he&&(ne=this._coreBrowserService.isFocused?L.selectionBackgroundOpaque:L.selectionInactiveBackgroundOpaque,ke=ne.rgba>>8&16777215,Oe=50331648,De=!0,L.selectionForeground&&(Ne=50331648,Ce=L.selectionForeground.rgba>>8&16777215,ce=L.selectionForeground)),De&&J.push("xterm-decoration-top"),Oe){case 16777216:case 33554432:Le=L.ansi[ke],J.push(`xterm-bg-${ke}`);break;case 50331648:Le=f.channels.toColor(ke>>16,ke>>8&255,255&ke),this._addStyle(O,`background-color:#${v((ke>>>0).toString(16),"0",6)}`);break;default:ze?(Le=L.foreground,J.push(`xterm-bg-${c.INVERTED_DEFAULT_COLOR}`)):Le=L.background}switch(ne||oe.isDim()&&(ne=f.color.multiplyOpacity(Le,.5)),Ne){case 16777216:case 33554432:oe.isBold()&&Ce<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(Ce+=8),this._applyMinimumContrast(O,Le,L.ansi[Ce],oe,ne,void 0)||J.push(`xterm-fg-${Ce}`);break;case 50331648:const ge=f.channels.toColor(Ce>>16&255,Ce>>8&255,255&Ce);this._applyMinimumContrast(O,Le,ge,oe,ne,ce)||this._addStyle(O,`color:#${v(Ce.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(O,Le,L.foreground,oe,ne,ce)||ze&&J.push(`xterm-fg-${c.INVERTED_DEFAULT_COLOR}`)}J.length&&(O.className=J.join(" "),J.length=0),Ee||ae||ve?O.textContent=N:F++,W!==this.defaultSpacing&&(O.style.letterSpacing=`${W}px`),Z.push(O),te=ue}return O&&F&&(O.textContent=N),Z}_applyMinimumContrast(S,x,p,k,A,P){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,r.treatGlyphAsBackgroundColor)(k.getCode()))return!1;const I=this._getContrastCache(k);let M;if(A||P||(M=I.getColor(x.rgba,p.rgba)),M===void 0){const z=this._optionsService.rawOptions.minimumContrastRatio/(k.isDim()?2:1);M=f.color.ensureContrastRatio(A||x,P||p,z),I.setColor((A||x).rgba,(P||p).rgba,M??null)}return!!M&&(this._addStyle(S,`color:${M.css}`),!0)}_getContrastCache(S){return S.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(S,x){S.setAttribute("style",`${S.getAttribute("style")||""}${x};`)}_isCellInSelection(S,x){const p=this._selectionStart,k=this._selectionEnd;return!(!p||!k)&&(this._columnSelectMode?p[0]<=k[0]?S>=p[0]&&x>=p[1]&&S<k[0]&&x<=k[1]:S<p[0]&&x>=p[1]&&S>=k[0]&&x<=k[1]:x>p[1]&&x<k[1]||p[1]===k[1]&&x===p[1]&&S>=p[0]&&S<k[0]||p[1]<k[1]&&x===k[1]&&S<k[0]||p[1]<k[1]&&x===p[1]&&S>=p[0])}};function v(S,x,p){for(;S.length<p;)S=x+S;return S}t.DomRendererRowFactory=d=h([_(1,e.ICharacterJoinerService),_(2,m.IOptionsService),_(3,e.ICoreBrowserService),_(4,m.ICoreService),_(5,m.IDecorationService),_(6,e.IThemeService)],d)},2550:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WidthCache=void 0,t.WidthCache=class{constructor(n,h){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=n.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const _=n.createElement("span");_.classList.add("xterm-char-measure-element");const c=n.createElement("span");c.classList.add("xterm-char-measure-element"),c.style.fontWeight="bold";const u=n.createElement("span");u.classList.add("xterm-char-measure-element"),u.style.fontStyle="italic";const g=n.createElement("span");g.classList.add("xterm-char-measure-element"),g.style.fontWeight="bold",g.style.fontStyle="italic",this._measureElements=[_,c,u,g],this._container.appendChild(_),this._container.appendChild(c),this._container.appendChild(u),this._container.appendChild(g),h.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(n,h,_,c){n===this._font&&h===this._fontSize&&_===this._weight&&c===this._weightBold||(this._font=n,this._fontSize=h,this._weight=_,this._weightBold=c,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${_}`,this._measureElements[1].style.fontWeight=`${c}`,this._measureElements[2].style.fontWeight=`${_}`,this._measureElements[3].style.fontWeight=`${c}`,this.clear())}get(n,h,_){let c=0;if(!h&&!_&&n.length===1&&(c=n.charCodeAt(0))<256){if(this._flat[c]!==-9999)return this._flat[c];const m=this._measure(n,0);return m>0&&(this._flat[c]=m),m}let u=n;h&&(u+="B"),_&&(u+="I");let g=this._holey.get(u);if(g===void 0){let m=0;h&&(m|=1),_&&(m|=2),g=this._measure(n,m),g>0&&this._holey.set(u,g)}return g}_measure(n,h){const _=this._measureElements[h];return _.textContent=n.repeat(32),_.offsetWidth/32}}},2223:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;const h=n(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=h.isFirefox||h.isLegacyEdge?"bottom":"ideographic"},6171:(y,t)=>{function n(_){return 57508<=_&&_<=57558}function h(_){return _>=128512&&_<=128591||_>=127744&&_<=128511||_>=128640&&_<=128767||_>=9728&&_<=9983||_>=9984&&_<=10175||_>=65024&&_<=65039||_>=129280&&_<=129535||_>=127462&&_<=127487}Object.defineProperty(t,"__esModule",{value:!0}),t.computeNextVariantOffset=t.createRenderDimensions=t.treatGlyphAsBackgroundColor=t.allowRescaling=t.isEmoji=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(_){if(!_)throw new Error("value must not be falsy");return _},t.isPowerlineGlyph=n,t.isRestrictedPowerlineGlyph=function(_){return 57520<=_&&_<=57527},t.isEmoji=h,t.allowRescaling=function(_,c,u,g){return c===1&&u>Math.ceil(1.5*g)&&_!==void 0&&_>255&&!h(_)&&!n(_)&&!function(m){return 57344<=m&&m<=63743}(_)},t.treatGlyphAsBackgroundColor=function(_){return n(_)||function(c){return 9472<=c&&c<=9631}(_)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},t.computeNextVariantOffset=function(_,c,u=0){return(_-(2*Math.round(c)-u))%(2*Math.round(c))}},6052:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionRenderModel=void 0;class n{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(_,c,u,g=!1){if(this.selectionStart=c,this.selectionEnd=u,!c||!u||c[0]===u[0]&&c[1]===u[1])return void this.clear();const m=_.buffers.active.ydisp,f=c[1]-m,e=u[1]-m,o=Math.max(f,0),r=Math.min(e,_.rows-1);o>=_.rows||r<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=g,this.viewportStartRow=f,this.viewportEndRow=e,this.viewportCappedStartRow=o,this.viewportCappedEndRow=r,this.startCol=c[0],this.endCol=u[0])}isCellSelected(_,c,u){return!!this.hasSelection&&(u-=_.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?c>=this.startCol&&u>=this.viewportCappedStartRow&&c<this.endCol&&u<=this.viewportCappedEndRow:c<this.startCol&&u>=this.viewportCappedStartRow&&c>=this.endCol&&u<=this.viewportCappedEndRow:u>this.viewportStartRow&&u<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&u===this.viewportStartRow&&c>=this.startCol&&c<this.endCol||this.viewportStartRow<this.viewportEndRow&&u===this.viewportEndRow&&c<this.endCol||this.viewportStartRow<this.viewportEndRow&&u===this.viewportStartRow&&c>=this.startCol)}}t.createSelectionRenderModel=function(){return new n}},456:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0,t.SelectionModel=class{constructor(n){this._bufferService=n,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?n%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)-1]:[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[n,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[Math.max(n,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const n=this.selectionStart,h=this.selectionEnd;return!(!n||!h)&&(n[1]>h[1]||n[1]===h[1]&&n[0]>h[0])}handleTrim(n){return this.selectionStart&&(this.selectionStart[1]-=n),this.selectionEnd&&(this.selectionEnd[1]-=n),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(y,t,n){var h=this&&this.__decorate||function(r,s,d,v){var S,x=arguments.length,p=x<3?s:v===null?v=Object.getOwnPropertyDescriptor(s,d):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(r,s,d,v);else for(var k=r.length-1;k>=0;k--)(S=r[k])&&(p=(x<3?S(p):x>3?S(s,d,p):S(s,d))||p);return x>3&&p&&Object.defineProperty(s,d,p),p},_=this&&this.__param||function(r,s){return function(d,v){s(d,v,r)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;const c=n(2585),u=n(8460),g=n(844);let m=t.CharSizeService=class extends g.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(r,s,d){super(),this._optionsService=d,this.width=0,this.height=0,this._onCharSizeChange=this.register(new u.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new o(this._optionsService))}catch{this._measureStrategy=this.register(new e(r,s,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const r=this._measureStrategy.measure();r.width===this.width&&r.height===this.height||(this.width=r.width,this.height=r.height,this._onCharSizeChange.fire())}};t.CharSizeService=m=h([_(2,c.IOptionsService)],m);class f extends g.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(s,d){s!==void 0&&s>0&&d!==void 0&&d>0&&(this._result.width=s,this._result.height=d)}}class e extends f{constructor(s,d,v){super(),this._document=s,this._parentElement=d,this._optionsService=v,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class o extends f{constructor(s){super(),this._optionsService=s,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const d=this._ctx.measureText("W");if(!("width"in d&&"fontBoundingBoxAscent"in d&&"fontBoundingBoxDescent"in d))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const s=this._ctx.measureText("W");return this._validateAndSet(s.width,s.fontBoundingBoxAscent+s.fontBoundingBoxDescent),this._result}}},4269:function(y,t,n){var h=this&&this.__decorate||function(o,r,s,d){var v,S=arguments.length,x=S<3?r:d===null?d=Object.getOwnPropertyDescriptor(r,s):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(o,r,s,d);else for(var p=o.length-1;p>=0;p--)(v=o[p])&&(x=(S<3?v(x):S>3?v(r,s,x):v(r,s))||x);return S>3&&x&&Object.defineProperty(r,s,x),x},_=this&&this.__param||function(o,r){return function(s,d){r(s,d,o)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;const c=n(3734),u=n(643),g=n(511),m=n(2585);class f extends c.AttributeData{constructor(r,s,d){super(),this.content=0,this.combinedData="",this.fg=r.fg,this.bg=r.bg,this.combinedData=s,this._width=d}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(r){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.JoinedCellData=f;let e=t.CharacterJoinerService=class ci{constructor(r){this._bufferService=r,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new g.CellData}register(r){const s={id:this._nextCharacterJoinerId++,handler:r};return this._characterJoiners.push(s),s.id}deregister(r){for(let s=0;s<this._characterJoiners.length;s++)if(this._characterJoiners[s].id===r)return this._characterJoiners.splice(s,1),!0;return!1}getJoinedCharacters(r){if(this._characterJoiners.length===0)return[];const s=this._bufferService.buffer.lines.get(r);if(!s||s.length===0)return[];const d=[],v=s.translateToString(!0);let S=0,x=0,p=0,k=s.getFg(0),A=s.getBg(0);for(let P=0;P<s.getTrimmedLength();P++)if(s.loadCell(P,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==k||this._workCell.bg!==A){if(P-S>1){const I=this._getJoinedRanges(v,p,x,s,S);for(let M=0;M<I.length;M++)d.push(I[M])}S=P,p=x,k=this._workCell.fg,A=this._workCell.bg}x+=this._workCell.getChars().length||u.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-S>1){const P=this._getJoinedRanges(v,p,x,s,S);for(let I=0;I<P.length;I++)d.push(P[I])}return d}_getJoinedRanges(r,s,d,v,S){const x=r.substring(s,d);let p=[];try{p=this._characterJoiners[0].handler(x)}catch(k){console.error(k)}for(let k=1;k<this._characterJoiners.length;k++)try{const A=this._characterJoiners[k].handler(x);for(let P=0;P<A.length;P++)ci._mergeRanges(p,A[P])}catch(A){console.error(A)}return this._stringRangesToCellRanges(p,v,S),p}_stringRangesToCellRanges(r,s,d){let v=0,S=!1,x=0,p=r[v];if(p){for(let k=d;k<this._bufferService.cols;k++){const A=s.getWidth(k),P=s.getString(k).length||u.WHITESPACE_CELL_CHAR.length;if(A!==0){if(!S&&p[0]<=x&&(p[0]=k,S=!0),p[1]<=x){if(p[1]=k,p=r[++v],!p)break;p[0]<=x?(p[0]=k,S=!0):S=!1}x+=P}}p&&(p[1]=this._bufferService.cols)}}static _mergeRanges(r,s){let d=!1;for(let v=0;v<r.length;v++){const S=r[v];if(d){if(s[1]<=S[0])return r[v-1][1]=s[1],r;if(s[1]<=S[1])return r[v-1][1]=Math.max(s[1],S[1]),r.splice(v,1),r;r.splice(v,1),v--}else{if(s[1]<=S[0])return r.splice(v,0,s),r;if(s[1]<=S[1])return S[0]=Math.min(s[0],S[0]),r;s[0]<S[1]&&(S[0]=Math.min(s[0],S[0]),d=!0)}}return d?r[r.length-1][1]=s[1]:r.push(s),r}};t.CharacterJoinerService=e=h([_(0,m.IBufferService)],e)},5114:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0;const h=n(844),_=n(8460),c=n(3656);class u extends h.Disposable{constructor(f,e,o){super(),this._textarea=f,this._window=e,this.mainDocument=o,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new g(this._window),this._onDprChange=this.register(new _.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new _.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(r=>this._screenDprMonitor.setWindow(r))),this.register((0,_.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(f){this._window!==f&&(this._window=f,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}t.CoreBrowserService=u;class g extends h.Disposable{constructor(f){super(),this._parentWindow=f,this._windowResizeListener=this.register(new h.MutableDisposable),this._onDprChange=this.register(new _.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,h.toDisposable)(()=>this.clearListener()))}setWindow(f){this._parentWindow=f,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,c.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){var f;this._outerListener&&((f=this._resolutionMediaMatchList)==null||f.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkProviderService=void 0;const h=n(844);class _ extends h.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,h.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(u){return this.linkProviders.push(u),{dispose:()=>{const g=this.linkProviders.indexOf(u);g!==-1&&this.linkProviders.splice(g,1)}}}}t.LinkProviderService=_},8934:function(y,t,n){var h=this&&this.__decorate||function(m,f,e,o){var r,s=arguments.length,d=s<3?f:o===null?o=Object.getOwnPropertyDescriptor(f,e):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(m,f,e,o);else for(var v=m.length-1;v>=0;v--)(r=m[v])&&(d=(s<3?r(d):s>3?r(f,e,d):r(f,e))||d);return s>3&&d&&Object.defineProperty(f,e,d),d},_=this&&this.__param||function(m,f){return function(e,o){f(e,o,m)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;const c=n(4725),u=n(9806);let g=t.MouseService=class{constructor(m,f){this._renderService=m,this._charSizeService=f}getCoords(m,f,e,o,r){return(0,u.getCoords)(window,m,f,e,o,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,r)}getMouseReportCoords(m,f){const e=(0,u.getCoordsRelativeToElement)(window,m,f);if(this._charSizeService.hasValidSize)return e[0]=Math.min(Math.max(e[0],0),this._renderService.dimensions.css.canvas.width-1),e[1]=Math.min(Math.max(e[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(e[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(e[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(e[0]),y:Math.floor(e[1])}}};t.MouseService=g=h([_(0,c.IRenderService),_(1,c.ICharSizeService)],g)},3230:function(y,t,n){var h=this&&this.__decorate||function(r,s,d,v){var S,x=arguments.length,p=x<3?s:v===null?v=Object.getOwnPropertyDescriptor(s,d):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(r,s,d,v);else for(var k=r.length-1;k>=0;k--)(S=r[k])&&(p=(x<3?S(p):x>3?S(s,d,p):S(s,d))||p);return x>3&&p&&Object.defineProperty(s,d,p),p},_=this&&this.__param||function(r,s){return function(d,v){s(d,v,r)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;const c=n(6193),u=n(4725),g=n(8460),m=n(844),f=n(7226),e=n(2585);let o=t.RenderService=class extends m.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(r,s,d,v,S,x,p,k){super(),this._rowCount=r,this._charSizeService=v,this._renderer=this.register(new m.MutableDisposable),this._pausedResizeTask=new f.DebouncedIdleTask,this._observerDisposable=this.register(new m.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new g.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new g.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new g.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new g.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new c.RenderDebouncer((A,P)=>this._renderRows(A,P),p),this.register(this._renderDebouncer),this.register(p.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(x.onResize(()=>this._fullRefresh())),this.register(x.buffers.onBufferActivate(()=>{var A;return(A=this._renderer.value)==null?void 0:A.clear()})),this.register(d.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(S.onDecorationRegistered(()=>this._fullRefresh())),this.register(S.onDecorationRemoved(()=>this._fullRefresh())),this.register(d.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(x.cols,x.rows),this._fullRefresh()})),this.register(d.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(x.buffer.y,x.buffer.y,!0))),this.register(k.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(p.window,s),this.register(p.onWindowChange(A=>this._registerIntersectionObserver(A,s)))}_registerIntersectionObserver(r,s){if("IntersectionObserver"in r){const d=new r.IntersectionObserver(v=>this._handleIntersectionChange(v[v.length-1]),{threshold:0});d.observe(s),this._observerDisposable.value=(0,m.toDisposable)(()=>d.disconnect())}}_handleIntersectionChange(r){this._isPaused=r.isIntersecting===void 0?r.intersectionRatio===0:!r.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(r,s,d=!1){this._isPaused?this._needsFullRefresh=!0:(d||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(r,s,this._rowCount))}_renderRows(r,s){this._renderer.value&&(r=Math.min(r,this._rowCount-1),s=Math.min(s,this._rowCount-1),this._renderer.value.renderRows(r,s),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:r,end:s}),this._onRender.fire({start:r,end:s}),this._isNextRenderRedrawOnly=!0)}resize(r,s){this._rowCount=s,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(r){this._renderer.value=r,this._renderer.value&&(this._renderer.value.onRequestRedraw(s=>this.refreshRows(s.start,s.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(r){return this._renderDebouncer.addRefreshCallback(r)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var r,s;this._renderer.value&&((s=(r=this._renderer.value).clearTextureAtlas)==null||s.call(r),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(r,s){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>{var d;return(d=this._renderer.value)==null?void 0:d.handleResize(r,s)}):this._renderer.value.handleResize(r,s),this._fullRefresh())}handleCharSizeChanged(){var r;(r=this._renderer.value)==null||r.handleCharSizeChanged()}handleBlur(){var r;(r=this._renderer.value)==null||r.handleBlur()}handleFocus(){var r;(r=this._renderer.value)==null||r.handleFocus()}handleSelectionChanged(r,s,d){var v;this._selectionState.start=r,this._selectionState.end=s,this._selectionState.columnSelectMode=d,(v=this._renderer.value)==null||v.handleSelectionChanged(r,s,d)}handleCursorMove(){var r;(r=this._renderer.value)==null||r.handleCursorMove()}clear(){var r;(r=this._renderer.value)==null||r.clear()}};t.RenderService=o=h([_(2,e.IOptionsService),_(3,u.ICharSizeService),_(4,e.IDecorationService),_(5,e.IBufferService),_(6,u.ICoreBrowserService),_(7,u.IThemeService)],o)},9312:function(y,t,n){var h=this&&this.__decorate||function(p,k,A,P){var I,M=arguments.length,z=M<3?k:P===null?P=Object.getOwnPropertyDescriptor(k,A):P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")z=Reflect.decorate(p,k,A,P);else for(var q=p.length-1;q>=0;q--)(I=p[q])&&(z=(M<3?I(z):M>3?I(k,A,z):I(k,A))||z);return M>3&&z&&Object.defineProperty(k,A,z),z},_=this&&this.__param||function(p,k){return function(A,P){k(A,P,p)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;const c=n(9806),u=n(9504),g=n(456),m=n(4725),f=n(8460),e=n(844),o=n(6114),r=n(4841),s=n(511),d=n(2585),v=" ",S=new RegExp(v,"g");let x=t.SelectionService=class extends e.Disposable{constructor(p,k,A,P,I,M,z,q,Y){super(),this._element=p,this._screenElement=k,this._linkifier=A,this._bufferService=P,this._coreService=I,this._mouseService=M,this._optionsService=z,this._renderService=q,this._coreBrowserService=Y,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new s.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new f.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new f.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new f.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new f.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=Z=>this._handleMouseMove(Z),this._mouseUpListener=Z=>this._handleMouseUp(Z),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(Z=>this._handleTrim(Z)),this.register(this._bufferService.buffers.onBufferActivate(Z=>this._handleBufferActivate(Z))),this.enable(),this._model=new g.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,e.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const p=this._model.finalSelectionStart,k=this._model.finalSelectionEnd;return!(!p||!k||p[0]===k[0]&&p[1]===k[1])}get selectionText(){const p=this._model.finalSelectionStart,k=this._model.finalSelectionEnd;if(!p||!k)return"";const A=this._bufferService.buffer,P=[];if(this._activeSelectionMode===3){if(p[0]===k[0])return"";const I=p[0]<k[0]?p[0]:k[0],M=p[0]<k[0]?k[0]:p[0];for(let z=p[1];z<=k[1];z++){const q=A.translateBufferLineToString(z,!0,I,M);P.push(q)}}else{const I=p[1]===k[1]?k[0]:void 0;P.push(A.translateBufferLineToString(p[1],!0,p[0],I));for(let M=p[1]+1;M<=k[1]-1;M++){const z=A.lines.get(M),q=A.translateBufferLineToString(M,!0);z!=null&&z.isWrapped?P[P.length-1]+=q:P.push(q)}if(p[1]!==k[1]){const M=A.lines.get(k[1]),z=A.translateBufferLineToString(k[1],!0,0,k[0]);M&&M.isWrapped?P[P.length-1]+=z:P.push(z)}}return P.map(I=>I.replace(S," ")).join(o.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(p){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),o.isLinux&&p&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(p){const k=this._getMouseBufferCoords(p),A=this._model.finalSelectionStart,P=this._model.finalSelectionEnd;return!!(A&&P&&k)&&this._areCoordsInSelection(k,A,P)}isCellInSelection(p,k){const A=this._model.finalSelectionStart,P=this._model.finalSelectionEnd;return!(!A||!P)&&this._areCoordsInSelection([p,k],A,P)}_areCoordsInSelection(p,k,A){return p[1]>k[1]&&p[1]<A[1]||k[1]===A[1]&&p[1]===k[1]&&p[0]>=k[0]&&p[0]<A[0]||k[1]<A[1]&&p[1]===A[1]&&p[0]<A[0]||k[1]<A[1]&&p[1]===k[1]&&p[0]>=k[0]}_selectWordAtCursor(p,k){var I,M;const A=(M=(I=this._linkifier.currentLink)==null?void 0:I.link)==null?void 0:M.range;if(A)return this._model.selectionStart=[A.start.x-1,A.start.y-1],this._model.selectionStartLength=(0,r.getRangeLength)(A,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const P=this._getMouseBufferCoords(p);return!!P&&(this._selectWordAt(P,k),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(p,k){this._model.clearSelection(),p=Math.max(p,0),k=Math.min(k,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,p],this._model.selectionEnd=[this._bufferService.cols,k],this.refresh(),this._onSelectionChange.fire()}_handleTrim(p){this._model.handleTrim(p)&&this.refresh()}_getMouseBufferCoords(p){const k=this._mouseService.getCoords(p,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(k)return k[0]--,k[1]--,k[1]+=this._bufferService.buffer.ydisp,k}_getMouseEventScrollAmount(p){let k=(0,c.getCoordsRelativeToElement)(this._coreBrowserService.window,p,this._screenElement)[1];const A=this._renderService.dimensions.css.canvas.height;return k>=0&&k<=A?0:(k>A&&(k-=A),k=Math.min(Math.max(k,-50),50),k/=50,k/Math.abs(k)+Math.round(14*k))}shouldForceSelection(p){return o.isMac?p.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:p.shiftKey}handleMouseDown(p){if(this._mouseDownTimeStamp=p.timeStamp,(p.button!==2||!this.hasSelection)&&p.button===0){if(!this._enabled){if(!this.shouldForceSelection(p))return;p.stopPropagation()}p.preventDefault(),this._dragScrollAmount=0,this._enabled&&p.shiftKey?this._handleIncrementalClick(p):p.detail===1?this._handleSingleClick(p):p.detail===2?this._handleDoubleClick(p):p.detail===3&&this._handleTripleClick(p),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(p){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(p))}_handleSingleClick(p){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(p)?3:0,this._model.selectionStart=this._getMouseBufferCoords(p),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const k=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);k&&k.length!==this._model.selectionStart[0]&&k.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(p){this._selectWordAtCursor(p,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(p){const k=this._getMouseBufferCoords(p);k&&(this._activeSelectionMode=2,this._selectLineAt(k[1]))}shouldColumnSelect(p){return p.altKey&&!(o.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(p){if(p.stopImmediatePropagation(),!this._model.selectionStart)return;const k=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(p),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(p),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const A=this._bufferService.buffer;if(this._model.selectionEnd[1]<A.lines.length){const P=A.lines.get(this._model.selectionEnd[1]);P&&P.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}k&&k[0]===this._model.selectionEnd[0]&&k[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const p=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(p.ydisp+this._bufferService.rows,p.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=p.ydisp),this.refresh()}}_handleMouseUp(p){const k=p.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&k<500&&p.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const A=this._mouseService.getCoords(p,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(A&&A[0]!==void 0&&A[1]!==void 0){const P=(0,u.moveToCellSequence)(A[0]-1,A[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(P,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const p=this._model.finalSelectionStart,k=this._model.finalSelectionEnd,A=!(!p||!k||p[0]===k[0]&&p[1]===k[1]);A?p&&k&&(this._oldSelectionStart&&this._oldSelectionEnd&&p[0]===this._oldSelectionStart[0]&&p[1]===this._oldSelectionStart[1]&&k[0]===this._oldSelectionEnd[0]&&k[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(p,k,A)):this._oldHasSelection&&this._fireOnSelectionChange(p,k,A)}_fireOnSelectionChange(p,k,A){this._oldSelectionStart=p,this._oldSelectionEnd=k,this._oldHasSelection=A,this._onSelectionChange.fire()}_handleBufferActivate(p){this.clearSelection(),this._trimListener.dispose(),this._trimListener=p.activeBuffer.lines.onTrim(k=>this._handleTrim(k))}_convertViewportColToCharacterIndex(p,k){let A=k;for(let P=0;k>=P;P++){const I=p.loadCell(P,this._workCell).getChars().length;this._workCell.getWidth()===0?A--:I>1&&k!==P&&(A+=I-1)}return A}setSelection(p,k,A){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[p,k],this._model.selectionStartLength=A,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(p){this._isClickInSelection(p)||(this._selectWordAtCursor(p,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(p,k,A=!0,P=!0){if(p[0]>=this._bufferService.cols)return;const I=this._bufferService.buffer,M=I.lines.get(p[1]);if(!M)return;const z=I.translateBufferLineToString(p[1],!1);let q=this._convertViewportColToCharacterIndex(M,p[0]),Y=q;const Z=p[0]-q;let Q=0,L=0,O=0,H=0;if(z.charAt(q)===" "){for(;q>0&&z.charAt(q-1)===" ";)q--;for(;Y<z.length&&z.charAt(Y+1)===" ";)Y++}else{let G=p[0],V=p[0];M.getWidth(G)===0&&(Q++,G--),M.getWidth(V)===2&&(L++,V++);const j=M.getString(V).length;for(j>1&&(H+=j-1,Y+=j-1);G>0&&q>0&&!this._isCharWordSeparator(M.loadCell(G-1,this._workCell));){M.loadCell(G-1,this._workCell);const B=this._workCell.getChars().length;this._workCell.getWidth()===0?(Q++,G--):B>1&&(O+=B-1,q-=B-1),q--,G--}for(;V<M.length&&Y+1<z.length&&!this._isCharWordSeparator(M.loadCell(V+1,this._workCell));){M.loadCell(V+1,this._workCell);const B=this._workCell.getChars().length;this._workCell.getWidth()===2?(L++,V++):B>1&&(H+=B-1,Y+=B-1),Y++,V++}}Y++;let F=q+Z-Q+O,N=Math.min(this._bufferService.cols,Y-q+Q+L-O-H);if(k||z.slice(q,Y).trim()!==""){if(A&&F===0&&M.getCodePoint(0)!==32){const G=I.lines.get(p[1]-1);if(G&&M.isWrapped&&G.getCodePoint(this._bufferService.cols-1)!==32){const V=this._getWordAt([this._bufferService.cols-1,p[1]-1],!1,!0,!1);if(V){const j=this._bufferService.cols-V.start;F-=j,N+=j}}}if(P&&F+N===this._bufferService.cols&&M.getCodePoint(this._bufferService.cols-1)!==32){const G=I.lines.get(p[1]+1);if(G!=null&&G.isWrapped&&G.getCodePoint(0)!==32){const V=this._getWordAt([0,p[1]+1],!1,!1,!0);V&&(N+=V.length)}}return{start:F,length:N}}}_selectWordAt(p,k){const A=this._getWordAt(p,k);if(A){for(;A.start<0;)A.start+=this._bufferService.cols,p[1]--;this._model.selectionStart=[A.start,p[1]],this._model.selectionStartLength=A.length}}_selectToWordAt(p){const k=this._getWordAt(p,!0);if(k){let A=p[1];for(;k.start<0;)k.start+=this._bufferService.cols,A--;if(!this._model.areSelectionValuesReversed())for(;k.start+k.length>this._bufferService.cols;)k.length-=this._bufferService.cols,A++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?k.start:k.start+k.length,A]}}_isCharWordSeparator(p){return p.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(p.getChars())>=0}_selectLineAt(p){const k=this._bufferService.buffer.getWrappedRangeForLine(p),A={start:{x:0,y:k.first},end:{x:this._bufferService.cols-1,y:k.last}};this._model.selectionStart=[0,k.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,r.getRangeLength)(A,this._bufferService.cols)}};t.SelectionService=x=h([_(3,d.IBufferService),_(4,d.ICoreService),_(5,m.IMouseService),_(6,d.IOptionsService),_(7,m.IRenderService),_(8,m.ICoreBrowserService)],x)},4725:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ILinkProviderService=t.IThemeService=t.ICharacterJoinerService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;const h=n(8343);t.ICharSizeService=(0,h.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,h.createDecorator)("CoreBrowserService"),t.IMouseService=(0,h.createDecorator)("MouseService"),t.IRenderService=(0,h.createDecorator)("RenderService"),t.ISelectionService=(0,h.createDecorator)("SelectionService"),t.ICharacterJoinerService=(0,h.createDecorator)("CharacterJoinerService"),t.IThemeService=(0,h.createDecorator)("ThemeService"),t.ILinkProviderService=(0,h.createDecorator)("LinkProviderService")},6731:function(y,t,n){var h=this&&this.__decorate||function(x,p,k,A){var P,I=arguments.length,M=I<3?p:A===null?A=Object.getOwnPropertyDescriptor(p,k):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(x,p,k,A);else for(var z=x.length-1;z>=0;z--)(P=x[z])&&(M=(I<3?P(M):I>3?P(p,k,M):P(p,k))||M);return I>3&&M&&Object.defineProperty(p,k,M),M},_=this&&this.__param||function(x,p){return function(k,A){p(k,A,x)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeService=t.DEFAULT_ANSI_COLORS=void 0;const c=n(7239),u=n(8055),g=n(8460),m=n(844),f=n(2585),e=u.css.toColor("#ffffff"),o=u.css.toColor("#000000"),r=u.css.toColor("#ffffff"),s=u.css.toColor("#000000"),d={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const x=[u.css.toColor("#2e3436"),u.css.toColor("#cc0000"),u.css.toColor("#4e9a06"),u.css.toColor("#c4a000"),u.css.toColor("#3465a4"),u.css.toColor("#75507b"),u.css.toColor("#06989a"),u.css.toColor("#d3d7cf"),u.css.toColor("#555753"),u.css.toColor("#ef2929"),u.css.toColor("#8ae234"),u.css.toColor("#fce94f"),u.css.toColor("#729fcf"),u.css.toColor("#ad7fa8"),u.css.toColor("#34e2e2"),u.css.toColor("#eeeeec")],p=[0,95,135,175,215,255];for(let k=0;k<216;k++){const A=p[k/36%6|0],P=p[k/6%6|0],I=p[k%6];x.push({css:u.channels.toCss(A,P,I),rgba:u.channels.toRgba(A,P,I)})}for(let k=0;k<24;k++){const A=8+10*k;x.push({css:u.channels.toCss(A,A,A),rgba:u.channels.toRgba(A,A,A)})}return x})());let v=t.ThemeService=class extends m.Disposable{get colors(){return this._colors}constructor(x){super(),this._optionsService=x,this._contrastCache=new c.ColorContrastCache,this._halfContrastCache=new c.ColorContrastCache,this._onChangeColors=this.register(new g.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:e,background:o,cursor:r,cursorAccent:s,selectionForeground:void 0,selectionBackgroundTransparent:d,selectionBackgroundOpaque:u.color.blend(o,d),selectionInactiveBackgroundTransparent:d,selectionInactiveBackgroundOpaque:u.color.blend(o,d),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(x={}){const p=this._colors;if(p.foreground=S(x.foreground,e),p.background=S(x.background,o),p.cursor=S(x.cursor,r),p.cursorAccent=S(x.cursorAccent,s),p.selectionBackgroundTransparent=S(x.selectionBackground,d),p.selectionBackgroundOpaque=u.color.blend(p.background,p.selectionBackgroundTransparent),p.selectionInactiveBackgroundTransparent=S(x.selectionInactiveBackground,p.selectionBackgroundTransparent),p.selectionInactiveBackgroundOpaque=u.color.blend(p.background,p.selectionInactiveBackgroundTransparent),p.selectionForeground=x.selectionForeground?S(x.selectionForeground,u.NULL_COLOR):void 0,p.selectionForeground===u.NULL_COLOR&&(p.selectionForeground=void 0),u.color.isOpaque(p.selectionBackgroundTransparent)&&(p.selectionBackgroundTransparent=u.color.opacity(p.selectionBackgroundTransparent,.3)),u.color.isOpaque(p.selectionInactiveBackgroundTransparent)&&(p.selectionInactiveBackgroundTransparent=u.color.opacity(p.selectionInactiveBackgroundTransparent,.3)),p.ansi=t.DEFAULT_ANSI_COLORS.slice(),p.ansi[0]=S(x.black,t.DEFAULT_ANSI_COLORS[0]),p.ansi[1]=S(x.red,t.DEFAULT_ANSI_COLORS[1]),p.ansi[2]=S(x.green,t.DEFAULT_ANSI_COLORS[2]),p.ansi[3]=S(x.yellow,t.DEFAULT_ANSI_COLORS[3]),p.ansi[4]=S(x.blue,t.DEFAULT_ANSI_COLORS[4]),p.ansi[5]=S(x.magenta,t.DEFAULT_ANSI_COLORS[5]),p.ansi[6]=S(x.cyan,t.DEFAULT_ANSI_COLORS[6]),p.ansi[7]=S(x.white,t.DEFAULT_ANSI_COLORS[7]),p.ansi[8]=S(x.brightBlack,t.DEFAULT_ANSI_COLORS[8]),p.ansi[9]=S(x.brightRed,t.DEFAULT_ANSI_COLORS[9]),p.ansi[10]=S(x.brightGreen,t.DEFAULT_ANSI_COLORS[10]),p.ansi[11]=S(x.brightYellow,t.DEFAULT_ANSI_COLORS[11]),p.ansi[12]=S(x.brightBlue,t.DEFAULT_ANSI_COLORS[12]),p.ansi[13]=S(x.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),p.ansi[14]=S(x.brightCyan,t.DEFAULT_ANSI_COLORS[14]),p.ansi[15]=S(x.brightWhite,t.DEFAULT_ANSI_COLORS[15]),x.extendedAnsi){const k=Math.min(p.ansi.length-16,x.extendedAnsi.length);for(let A=0;A<k;A++)p.ansi[A+16]=S(x.extendedAnsi[A],t.DEFAULT_ANSI_COLORS[A+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(x){this._restoreColor(x),this._onChangeColors.fire(this.colors)}_restoreColor(x){if(x!==void 0)switch(x){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[x]=this._restoreColors.ansi[x]}else for(let p=0;p<this._restoreColors.ansi.length;++p)this._colors.ansi[p]=this._restoreColors.ansi[p]}modifyColors(x){x(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function S(x,p){if(x!==void 0)try{return u.css.toColor(x)}catch{}return p}t.ThemeService=v=h([_(0,f.IOptionsService)],v)},6349:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;const h=n(8460),_=n(844);class c extends _.Disposable{constructor(g){super(),this._maxLength=g,this.onDeleteEmitter=this.register(new h.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new h.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new h.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(g){if(this._maxLength===g)return;const m=new Array(g);for(let f=0;f<Math.min(g,this.length);f++)m[f]=this._array[this._getCyclicIndex(f)];this._array=m,this._maxLength=g,this._startIndex=0}get length(){return this._length}set length(g){if(g>this._length)for(let m=this._length;m<g;m++)this._array[m]=void 0;this._length=g}get(g){return this._array[this._getCyclicIndex(g)]}set(g,m){this._array[this._getCyclicIndex(g)]=m}push(g){this._array[this._getCyclicIndex(this._length)]=g,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(g,m,...f){if(m){for(let e=g;e<this._length-m;e++)this._array[this._getCyclicIndex(e)]=this._array[this._getCyclicIndex(e+m)];this._length-=m,this.onDeleteEmitter.fire({index:g,amount:m})}for(let e=this._length-1;e>=g;e--)this._array[this._getCyclicIndex(e+f.length)]=this._array[this._getCyclicIndex(e)];for(let e=0;e<f.length;e++)this._array[this._getCyclicIndex(g+e)]=f[e];if(f.length&&this.onInsertEmitter.fire({index:g,amount:f.length}),this._length+f.length>this._maxLength){const e=this._length+f.length-this._maxLength;this._startIndex+=e,this._length=this._maxLength,this.onTrimEmitter.fire(e)}else this._length+=f.length}trimStart(g){g>this._length&&(g=this._length),this._startIndex+=g,this._length-=g,this.onTrimEmitter.fire(g)}shiftElements(g,m,f){if(!(m<=0)){if(g<0||g>=this._length)throw new Error("start argument out of range");if(g+f<0)throw new Error("Cannot shift elements in list beyond index 0");if(f>0){for(let o=m-1;o>=0;o--)this.set(g+o+f,this.get(g+o));const e=g+m+f-this._length;if(e>0)for(this._length+=e;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let e=0;e<m;e++)this.set(g+e+f,this.get(g+e))}}_getCyclicIndex(g){return(this._startIndex+g)%this._maxLength}}t.CircularList=c},1439:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function n(h,_=5){if(typeof h!="object")return h;const c=Array.isArray(h)?[]:{};for(const u in h)c[u]=_<=1?h[u]:h[u]&&n(h[u],_-1);return c}},8055:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;let n=0,h=0,_=0,c=0;var u,g,m,f,e;function o(s){const d=s.toString(16);return d.length<2?"0"+d:d}function r(s,d){return s<d?(d+.05)/(s+.05):(s+.05)/(d+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(s){s.toCss=function(d,v,S,x){return x!==void 0?`#${o(d)}${o(v)}${o(S)}${o(x)}`:`#${o(d)}${o(v)}${o(S)}`},s.toRgba=function(d,v,S,x=255){return(d<<24|v<<16|S<<8|x)>>>0},s.toColor=function(d,v,S,x){return{css:s.toCss(d,v,S,x),rgba:s.toRgba(d,v,S,x)}}}(u||(t.channels=u={})),function(s){function d(v,S){return c=Math.round(255*S),[n,h,_]=e.toChannels(v.rgba),{css:u.toCss(n,h,_,c),rgba:u.toRgba(n,h,_,c)}}s.blend=function(v,S){if(c=(255&S.rgba)/255,c===1)return{css:S.css,rgba:S.rgba};const x=S.rgba>>24&255,p=S.rgba>>16&255,k=S.rgba>>8&255,A=v.rgba>>24&255,P=v.rgba>>16&255,I=v.rgba>>8&255;return n=A+Math.round((x-A)*c),h=P+Math.round((p-P)*c),_=I+Math.round((k-I)*c),{css:u.toCss(n,h,_),rgba:u.toRgba(n,h,_)}},s.isOpaque=function(v){return(255&v.rgba)==255},s.ensureContrastRatio=function(v,S,x){const p=e.ensureContrastRatio(v.rgba,S.rgba,x);if(p)return u.toColor(p>>24&255,p>>16&255,p>>8&255)},s.opaque=function(v){const S=(255|v.rgba)>>>0;return[n,h,_]=e.toChannels(S),{css:u.toCss(n,h,_),rgba:S}},s.opacity=d,s.multiplyOpacity=function(v,S){return c=255&v.rgba,d(v,c*S/255)},s.toColorRGB=function(v){return[v.rgba>>24&255,v.rgba>>16&255,v.rgba>>8&255]}}(g||(t.color=g={})),function(s){let d,v;try{const S=document.createElement("canvas");S.width=1,S.height=1;const x=S.getContext("2d",{willReadFrequently:!0});x&&(d=x,d.globalCompositeOperation="copy",v=d.createLinearGradient(0,0,1,1))}catch{}s.toColor=function(S){if(S.match(/#[\da-f]{3,8}/i))switch(S.length){case 4:return n=parseInt(S.slice(1,2).repeat(2),16),h=parseInt(S.slice(2,3).repeat(2),16),_=parseInt(S.slice(3,4).repeat(2),16),u.toColor(n,h,_);case 5:return n=parseInt(S.slice(1,2).repeat(2),16),h=parseInt(S.slice(2,3).repeat(2),16),_=parseInt(S.slice(3,4).repeat(2),16),c=parseInt(S.slice(4,5).repeat(2),16),u.toColor(n,h,_,c);case 7:return{css:S,rgba:(parseInt(S.slice(1),16)<<8|255)>>>0};case 9:return{css:S,rgba:parseInt(S.slice(1),16)>>>0}}const x=S.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(x)return n=parseInt(x[1]),h=parseInt(x[2]),_=parseInt(x[3]),c=Math.round(255*(x[5]===void 0?1:parseFloat(x[5]))),u.toColor(n,h,_,c);if(!d||!v)throw new Error("css.toColor: Unsupported css format");if(d.fillStyle=v,d.fillStyle=S,typeof d.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(d.fillRect(0,0,1,1),[n,h,_,c]=d.getImageData(0,0,1,1).data,c!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:u.toRgba(n,h,_,c),css:S}}}(m||(t.css=m={})),function(s){function d(v,S,x){const p=v/255,k=S/255,A=x/255;return .2126*(p<=.03928?p/12.92:Math.pow((p+.055)/1.055,2.4))+.7152*(k<=.03928?k/12.92:Math.pow((k+.055)/1.055,2.4))+.0722*(A<=.03928?A/12.92:Math.pow((A+.055)/1.055,2.4))}s.relativeLuminance=function(v){return d(v>>16&255,v>>8&255,255&v)},s.relativeLuminance2=d}(f||(t.rgb=f={})),function(s){function d(S,x,p){const k=S>>24&255,A=S>>16&255,P=S>>8&255;let I=x>>24&255,M=x>>16&255,z=x>>8&255,q=r(f.relativeLuminance2(I,M,z),f.relativeLuminance2(k,A,P));for(;q<p&&(I>0||M>0||z>0);)I-=Math.max(0,Math.ceil(.1*I)),M-=Math.max(0,Math.ceil(.1*M)),z-=Math.max(0,Math.ceil(.1*z)),q=r(f.relativeLuminance2(I,M,z),f.relativeLuminance2(k,A,P));return(I<<24|M<<16|z<<8|255)>>>0}function v(S,x,p){const k=S>>24&255,A=S>>16&255,P=S>>8&255;let I=x>>24&255,M=x>>16&255,z=x>>8&255,q=r(f.relativeLuminance2(I,M,z),f.relativeLuminance2(k,A,P));for(;q<p&&(I<255||M<255||z<255);)I=Math.min(255,I+Math.ceil(.1*(255-I))),M=Math.min(255,M+Math.ceil(.1*(255-M))),z=Math.min(255,z+Math.ceil(.1*(255-z))),q=r(f.relativeLuminance2(I,M,z),f.relativeLuminance2(k,A,P));return(I<<24|M<<16|z<<8|255)>>>0}s.blend=function(S,x){if(c=(255&x)/255,c===1)return x;const p=x>>24&255,k=x>>16&255,A=x>>8&255,P=S>>24&255,I=S>>16&255,M=S>>8&255;return n=P+Math.round((p-P)*c),h=I+Math.round((k-I)*c),_=M+Math.round((A-M)*c),u.toRgba(n,h,_)},s.ensureContrastRatio=function(S,x,p){const k=f.relativeLuminance(S>>8),A=f.relativeLuminance(x>>8);if(r(k,A)<p){if(A<k){const M=d(S,x,p),z=r(k,f.relativeLuminance(M>>8));if(z<p){const q=v(S,x,p);return z>r(k,f.relativeLuminance(q>>8))?M:q}return M}const P=v(S,x,p),I=r(k,f.relativeLuminance(P>>8));if(I<p){const M=d(S,x,p);return I>r(k,f.relativeLuminance(M>>8))?P:M}return P}},s.reduceLuminance=d,s.increaseLuminance=v,s.toChannels=function(S){return[S>>24&255,S>>16&255,S>>8&255,255&S]}}(e||(t.rgba=e={})),t.toPaddedHex=o,t.contrastRatio=r},8969:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;const h=n(844),_=n(2585),c=n(4348),u=n(7866),g=n(744),m=n(7302),f=n(6975),e=n(8460),o=n(1753),r=n(1480),s=n(7994),d=n(9282),v=n(5435),S=n(5981),x=n(2660);let p=!1;class k extends h.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new e.EventEmitter),this._onScroll.event(P=>{var I;(I=this._onScrollApi)==null||I.fire(P.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(P){for(const I in P)this.optionsService.options[I]=P[I]}constructor(P){super(),this._windowsWrappingHeuristics=this.register(new h.MutableDisposable),this._onBinary=this.register(new e.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new e.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new e.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new e.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new e.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new e.EventEmitter),this._instantiationService=new c.InstantiationService,this.optionsService=this.register(new m.OptionsService(P)),this._instantiationService.setService(_.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(g.BufferService)),this._instantiationService.setService(_.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(u.LogService)),this._instantiationService.setService(_.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(f.CoreService)),this._instantiationService.setService(_.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(o.CoreMouseService)),this._instantiationService.setService(_.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(r.UnicodeService)),this._instantiationService.setService(_.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(s.CharsetService),this._instantiationService.setService(_.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(x.OscLinkService),this._instantiationService.setService(_.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new v.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,e.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,e.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,e.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,e.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(I=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(I=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new S.WriteBuffer((I,M)=>this._inputHandler.parse(I,M))),this.register((0,e.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(P,I){this._writeBuffer.write(P,I)}writeSync(P,I){this._logService.logLevel<=_.LogLevelEnum.WARN&&!p&&(this._logService.warn("writeSync is unreliable and will be removed soon."),p=!0),this._writeBuffer.writeSync(P,I)}input(P,I=!0){this.coreService.triggerDataEvent(P,I)}resize(P,I){isNaN(P)||isNaN(I)||(P=Math.max(P,g.MINIMUM_COLS),I=Math.max(I,g.MINIMUM_ROWS),this._bufferService.resize(P,I))}scroll(P,I=!1){this._bufferService.scroll(P,I)}scrollLines(P,I,M){this._bufferService.scrollLines(P,I,M)}scrollPages(P){this.scrollLines(P*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(P){const I=P-this._bufferService.buffer.ydisp;I!==0&&this.scrollLines(I)}registerEscHandler(P,I){return this._inputHandler.registerEscHandler(P,I)}registerDcsHandler(P,I){return this._inputHandler.registerDcsHandler(P,I)}registerCsiHandler(P,I){return this._inputHandler.registerCsiHandler(P,I)}registerOscHandler(P,I){return this._inputHandler.registerOscHandler(P,I)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let P=!1;const I=this.optionsService.rawOptions.windowsPty;I&&I.buildNumber!==void 0&&I.buildNumber!==void 0?P=I.backend==="conpty"&&I.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(P=!0),P?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const P=[];P.push(this.onLineFeed(d.updateWindowsModeWrappedState.bind(null,this._bufferService))),P.push(this.registerCsiHandler({final:"H"},()=>((0,d.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,h.toDisposable)(()=>{for(const I of P)I.dispose()})}}}t.CoreTerminal=k},8460:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runAndSubscribe=t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=n=>(this._listeners.push(n),{dispose:()=>{if(!this._disposed){for(let h=0;h<this._listeners.length;h++)if(this._listeners[h]===n)return void this._listeners.splice(h,1)}}})),this._event}fire(n,h){const _=[];for(let c=0;c<this._listeners.length;c++)_.push(this._listeners[c]);for(let c=0;c<_.length;c++)_[c].call(void 0,n,h)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},t.forwardEvent=function(n,h){return n(_=>h.fire(_))},t.runAndSubscribe=function(n,h){return h(void 0),n(_=>h(_))}},5435:function(y,t,n){var h=this&&this.__decorate||function(Q,L,O,H){var F,N=arguments.length,G=N<3?L:H===null?H=Object.getOwnPropertyDescriptor(L,O):H;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")G=Reflect.decorate(Q,L,O,H);else for(var V=Q.length-1;V>=0;V--)(F=Q[V])&&(G=(N<3?F(G):N>3?F(L,O,G):F(L,O))||G);return N>3&&G&&Object.defineProperty(L,O,G),G},_=this&&this.__param||function(Q,L){return function(O,H){L(O,H,Q)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;const c=n(2584),u=n(7116),g=n(2015),m=n(844),f=n(482),e=n(8437),o=n(8460),r=n(643),s=n(511),d=n(3734),v=n(2585),S=n(1480),x=n(6242),p=n(6351),k=n(5941),A={"(":0,")":1,"*":2,"+":3,"-":1,".":2},P=131072;function I(Q,L){if(Q>24)return L.setWinLines||!1;switch(Q){case 1:return!!L.restoreWin;case 2:return!!L.minimizeWin;case 3:return!!L.setWinPosition;case 4:return!!L.setWinSizePixels;case 5:return!!L.raiseWin;case 6:return!!L.lowerWin;case 7:return!!L.refreshWin;case 8:return!!L.setWinSizeChars;case 9:return!!L.maximizeWin;case 10:return!!L.fullscreenWin;case 11:return!!L.getWinState;case 13:return!!L.getWinPosition;case 14:return!!L.getWinSizePixels;case 15:return!!L.getScreenSizePixels;case 16:return!!L.getCellSizePixels;case 18:return!!L.getWinSizeChars;case 19:return!!L.getScreenSizeChars;case 20:return!!L.getIconTitle;case 21:return!!L.getWinTitle;case 22:return!!L.pushTitle;case 23:return!!L.popTitle;case 24:return!!L.setWinLines}return!1}var M;(function(Q){Q[Q.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",Q[Q.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(M||(t.WindowsOptionsReportType=M={}));let z=0;class q extends m.Disposable{getAttrData(){return this._curAttrData}constructor(L,O,H,F,N,G,V,j,B=new g.EscapeSequenceParser){super(),this._bufferService=L,this._charsetService=O,this._coreService=H,this._logService=F,this._optionsService=N,this._oscLinkService=G,this._coreMouseService=V,this._unicodeService=j,this._parser=B,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new f.StringToUtf32,this._utf8Decoder=new f.Utf8ToUtf32,this._workCell=new s.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=e.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new o.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new o.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new o.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new o.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new o.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new o.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new o.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new o.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new o.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new o.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new o.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new o.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new o.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new Y(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(D=>this._activeBuffer=D.activeBuffer)),this._parser.setCsiHandlerFallback((D,U)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(D),params:U.toArray()})}),this._parser.setEscHandlerFallback(D=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(D)})}),this._parser.setExecuteHandlerFallback(D=>{this._logService.debug("Unknown EXECUTE code: ",{code:D})}),this._parser.setOscHandlerFallback((D,U,W)=>{this._logService.debug("Unknown OSC code: ",{identifier:D,action:U,data:W})}),this._parser.setDcsHandlerFallback((D,U,W)=>{U==="HOOK"&&(W=W.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(D),action:U,payload:W})}),this._parser.setPrintHandler((D,U,W)=>this.print(D,U,W)),this._parser.registerCsiHandler({final:"@"},D=>this.insertChars(D)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},D=>this.scrollLeft(D)),this._parser.registerCsiHandler({final:"A"},D=>this.cursorUp(D)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},D=>this.scrollRight(D)),this._parser.registerCsiHandler({final:"B"},D=>this.cursorDown(D)),this._parser.registerCsiHandler({final:"C"},D=>this.cursorForward(D)),this._parser.registerCsiHandler({final:"D"},D=>this.cursorBackward(D)),this._parser.registerCsiHandler({final:"E"},D=>this.cursorNextLine(D)),this._parser.registerCsiHandler({final:"F"},D=>this.cursorPrecedingLine(D)),this._parser.registerCsiHandler({final:"G"},D=>this.cursorCharAbsolute(D)),this._parser.registerCsiHandler({final:"H"},D=>this.cursorPosition(D)),this._parser.registerCsiHandler({final:"I"},D=>this.cursorForwardTab(D)),this._parser.registerCsiHandler({final:"J"},D=>this.eraseInDisplay(D,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},D=>this.eraseInDisplay(D,!0)),this._parser.registerCsiHandler({final:"K"},D=>this.eraseInLine(D,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},D=>this.eraseInLine(D,!0)),this._parser.registerCsiHandler({final:"L"},D=>this.insertLines(D)),this._parser.registerCsiHandler({final:"M"},D=>this.deleteLines(D)),this._parser.registerCsiHandler({final:"P"},D=>this.deleteChars(D)),this._parser.registerCsiHandler({final:"S"},D=>this.scrollUp(D)),this._parser.registerCsiHandler({final:"T"},D=>this.scrollDown(D)),this._parser.registerCsiHandler({final:"X"},D=>this.eraseChars(D)),this._parser.registerCsiHandler({final:"Z"},D=>this.cursorBackwardTab(D)),this._parser.registerCsiHandler({final:"`"},D=>this.charPosAbsolute(D)),this._parser.registerCsiHandler({final:"a"},D=>this.hPositionRelative(D)),this._parser.registerCsiHandler({final:"b"},D=>this.repeatPrecedingCharacter(D)),this._parser.registerCsiHandler({final:"c"},D=>this.sendDeviceAttributesPrimary(D)),this._parser.registerCsiHandler({prefix:">",final:"c"},D=>this.sendDeviceAttributesSecondary(D)),this._parser.registerCsiHandler({final:"d"},D=>this.linePosAbsolute(D)),this._parser.registerCsiHandler({final:"e"},D=>this.vPositionRelative(D)),this._parser.registerCsiHandler({final:"f"},D=>this.hVPosition(D)),this._parser.registerCsiHandler({final:"g"},D=>this.tabClear(D)),this._parser.registerCsiHandler({final:"h"},D=>this.setMode(D)),this._parser.registerCsiHandler({prefix:"?",final:"h"},D=>this.setModePrivate(D)),this._parser.registerCsiHandler({final:"l"},D=>this.resetMode(D)),this._parser.registerCsiHandler({prefix:"?",final:"l"},D=>this.resetModePrivate(D)),this._parser.registerCsiHandler({final:"m"},D=>this.charAttributes(D)),this._parser.registerCsiHandler({final:"n"},D=>this.deviceStatus(D)),this._parser.registerCsiHandler({prefix:"?",final:"n"},D=>this.deviceStatusPrivate(D)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},D=>this.softReset(D)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},D=>this.setCursorStyle(D)),this._parser.registerCsiHandler({final:"r"},D=>this.setScrollRegion(D)),this._parser.registerCsiHandler({final:"s"},D=>this.saveCursor(D)),this._parser.registerCsiHandler({final:"t"},D=>this.windowOptions(D)),this._parser.registerCsiHandler({final:"u"},D=>this.restoreCursor(D)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},D=>this.insertColumns(D)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},D=>this.deleteColumns(D)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},D=>this.selectProtected(D)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},D=>this.requestMode(D,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},D=>this.requestMode(D,!1)),this._parser.setExecuteHandler(c.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(c.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(c.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(c.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(c.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(c.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(c.C1.IND,()=>this.index()),this._parser.setExecuteHandler(c.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(c.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new x.OscHandler(D=>(this.setTitle(D),this.setIconName(D),!0))),this._parser.registerOscHandler(1,new x.OscHandler(D=>this.setIconName(D))),this._parser.registerOscHandler(2,new x.OscHandler(D=>this.setTitle(D))),this._parser.registerOscHandler(4,new x.OscHandler(D=>this.setOrReportIndexedColor(D))),this._parser.registerOscHandler(8,new x.OscHandler(D=>this.setHyperlink(D))),this._parser.registerOscHandler(10,new x.OscHandler(D=>this.setOrReportFgColor(D))),this._parser.registerOscHandler(11,new x.OscHandler(D=>this.setOrReportBgColor(D))),this._parser.registerOscHandler(12,new x.OscHandler(D=>this.setOrReportCursorColor(D))),this._parser.registerOscHandler(104,new x.OscHandler(D=>this.restoreIndexedColor(D))),this._parser.registerOscHandler(110,new x.OscHandler(D=>this.restoreFgColor(D))),this._parser.registerOscHandler(111,new x.OscHandler(D=>this.restoreBgColor(D))),this._parser.registerOscHandler(112,new x.OscHandler(D=>this.restoreCursorColor(D))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const D in u.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:D},()=>this.selectCharset("("+D)),this._parser.registerEscHandler({intermediates:")",final:D},()=>this.selectCharset(")"+D)),this._parser.registerEscHandler({intermediates:"*",final:D},()=>this.selectCharset("*"+D)),this._parser.registerEscHandler({intermediates:"+",final:D},()=>this.selectCharset("+"+D)),this._parser.registerEscHandler({intermediates:"-",final:D},()=>this.selectCharset("-"+D)),this._parser.registerEscHandler({intermediates:".",final:D},()=>this.selectCharset("."+D)),this._parser.registerEscHandler({intermediates:"/",final:D},()=>this.selectCharset("/"+D));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(D=>(this._logService.error("Parsing error: ",D),D)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new p.DcsHandler((D,U)=>this.requestStatusString(D,U)))}_preserveStack(L,O,H,F){this._parseStack.paused=!0,this._parseStack.cursorStartX=L,this._parseStack.cursorStartY=O,this._parseStack.decodedLength=H,this._parseStack.position=F}_logSlowResolvingAsync(L){this._logService.logLevel<=v.LogLevelEnum.WARN&&Promise.race([L,new Promise((O,H)=>setTimeout(()=>H("#SLOW_TIMEOUT"),5e3))]).catch(O=>{if(O!=="#SLOW_TIMEOUT")throw O;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(L,O){let H,F=this._activeBuffer.x,N=this._activeBuffer.y,G=0;const V=this._parseStack.paused;if(V){if(H=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,O))return this._logSlowResolvingAsync(H),H;F=this._parseStack.cursorStartX,N=this._parseStack.cursorStartY,this._parseStack.paused=!1,L.length>P&&(G=this._parseStack.position+P)}if(this._logService.logLevel<=v.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof L=="string"?` "${L}"`:` "${Array.prototype.map.call(L,D=>String.fromCharCode(D)).join("")}"`),typeof L=="string"?L.split("").map(D=>D.charCodeAt(0)):L),this._parseBuffer.length<L.length&&this._parseBuffer.length<P&&(this._parseBuffer=new Uint32Array(Math.min(L.length,P))),V||this._dirtyRowTracker.clearRange(),L.length>P)for(let D=G;D<L.length;D+=P){const U=D+P<L.length?D+P:L.length,W=typeof L=="string"?this._stringDecoder.decode(L.substring(D,U),this._parseBuffer):this._utf8Decoder.decode(L.subarray(D,U),this._parseBuffer);if(H=this._parser.parse(this._parseBuffer,W))return this._preserveStack(F,N,W,D),this._logSlowResolvingAsync(H),H}else if(!V){const D=typeof L=="string"?this._stringDecoder.decode(L,this._parseBuffer):this._utf8Decoder.decode(L,this._parseBuffer);if(H=this._parser.parse(this._parseBuffer,D))return this._preserveStack(F,N,D,0),this._logSlowResolvingAsync(H),H}this._activeBuffer.x===F&&this._activeBuffer.y===N||this._onCursorMove.fire();const j=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),B=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);B<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(B,this._bufferService.rows-1),Math.min(j,this._bufferService.rows-1))}print(L,O,H){let F,N;const G=this._charsetService.charset,V=this._optionsService.rawOptions.screenReaderMode,j=this._bufferService.cols,B=this._coreService.decPrivateModes.wraparound,D=this._coreService.modes.insertMode,U=this._curAttrData;let W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&H-O>0&&W.getWidth(this._activeBuffer.x-1)===2&&W.setCellFromCodepoint(this._activeBuffer.x-1,0,1,U);let J=this._parser.precedingJoinState;for(let X=O;X<H;++X){if(F=L[X],F<127&&G){const ue=G[String.fromCharCode(F)];ue&&(F=ue.charCodeAt(0))}const te=this._unicodeService.charProperties(F,J);N=S.UnicodeService.extractWidth(te);const re=S.UnicodeService.extractShouldJoin(te),ae=re?S.UnicodeService.extractWidth(J):0;if(J=te,V&&this._onA11yChar.fire((0,f.stringFromCodePoint)(F)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+N-ae>j){if(B){const ue=W;let oe=this._activeBuffer.x-ae;for(this._activeBuffer.x=ae,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),ae>0&&W instanceof e.BufferLine&&W.copyCellsFrom(ue,oe,0,ae,!1);oe<j;)ue.setCellFromCodepoint(oe++,0,1,U)}else if(this._activeBuffer.x=j-1,N===2)continue}if(re&&this._activeBuffer.x){const ue=W.getWidth(this._activeBuffer.x-1)?1:2;W.addCodepointToCell(this._activeBuffer.x-ue,F,N);for(let oe=N-ae;--oe>=0;)W.setCellFromCodepoint(this._activeBuffer.x++,0,0,U)}else if(D&&(W.insertCells(this._activeBuffer.x,N-ae,this._activeBuffer.getNullCell(U)),W.getWidth(j-1)===2&&W.setCellFromCodepoint(j-1,r.NULL_CELL_CODE,r.NULL_CELL_WIDTH,U)),W.setCellFromCodepoint(this._activeBuffer.x++,F,N,U),N>0)for(;--N;)W.setCellFromCodepoint(this._activeBuffer.x++,0,0,U)}this._parser.precedingJoinState=J,this._activeBuffer.x<j&&H-O>0&&W.getWidth(this._activeBuffer.x)===0&&!W.hasContent(this._activeBuffer.x)&&W.setCellFromCodepoint(this._activeBuffer.x,0,1,U),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(L,O){return L.final!=="t"||L.prefix||L.intermediates?this._parser.registerCsiHandler(L,O):this._parser.registerCsiHandler(L,H=>!I(H.params[0],this._optionsService.rawOptions.windowOptions)||O(H))}registerDcsHandler(L,O){return this._parser.registerDcsHandler(L,new p.DcsHandler(O))}registerEscHandler(L,O){return this._parser.registerEscHandler(L,O)}registerOscHandler(L,O){return this._parser.registerOscHandler(L,new x.OscHandler(O))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var L;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&((L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))!=null&&L.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);O.hasWidth(this._activeBuffer.x)&&!O.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const L=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-L),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(L=this._bufferService.cols-1){this._activeBuffer.x=Math.min(L,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(L,O){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=L,this._activeBuffer.y=this._activeBuffer.scrollTop+O):(this._activeBuffer.x=L,this._activeBuffer.y=O),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(L,O){this._restrictCursor(),this._setCursor(this._activeBuffer.x+L,this._activeBuffer.y+O)}cursorUp(L){const O=this._activeBuffer.y-this._activeBuffer.scrollTop;return O>=0?this._moveCursor(0,-Math.min(O,L.params[0]||1)):this._moveCursor(0,-(L.params[0]||1)),!0}cursorDown(L){const O=this._activeBuffer.scrollBottom-this._activeBuffer.y;return O>=0?this._moveCursor(0,Math.min(O,L.params[0]||1)):this._moveCursor(0,L.params[0]||1),!0}cursorForward(L){return this._moveCursor(L.params[0]||1,0),!0}cursorBackward(L){return this._moveCursor(-(L.params[0]||1),0),!0}cursorNextLine(L){return this.cursorDown(L),this._activeBuffer.x=0,!0}cursorPrecedingLine(L){return this.cursorUp(L),this._activeBuffer.x=0,!0}cursorCharAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(L){return this._setCursor(L.length>=2?(L.params[1]||1)-1:0,(L.params[0]||1)-1),!0}charPosAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(L){return this._moveCursor(L.params[0]||1,0),!0}linePosAbsolute(L){return this._setCursor(this._activeBuffer.x,(L.params[0]||1)-1),!0}vPositionRelative(L){return this._moveCursor(0,L.params[0]||1),!0}hVPosition(L){return this.cursorPosition(L),!0}tabClear(L){const O=L.params[0];return O===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:O===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let O=L.params[0]||1;for(;O--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let O=L.params[0]||1;for(;O--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(L){const O=L.params[0];return O===1&&(this._curAttrData.bg|=536870912),O!==2&&O!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(L,O,H,F=!1,N=!1){const G=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);G.replaceCells(O,H,this._activeBuffer.getNullCell(this._eraseAttrData()),N),F&&(G.isWrapped=!1)}_resetBufferLine(L,O=!1){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);H&&(H.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),O),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+L),H.isWrapped=!1)}eraseInDisplay(L,O=!1){let H;switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:for(H=this._activeBuffer.y,this._dirtyRowTracker.markDirty(H),this._eraseInBufferLine(H++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,O);H<this._bufferService.rows;H++)this._resetBufferLine(H,O);this._dirtyRowTracker.markDirty(H);break;case 1:for(H=this._activeBuffer.y,this._dirtyRowTracker.markDirty(H),this._eraseInBufferLine(H,0,this._activeBuffer.x+1,!0,O),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(H+1).isWrapped=!1);H--;)this._resetBufferLine(H,O);this._dirtyRowTracker.markDirty(0);break;case 2:for(H=this._bufferService.rows,this._dirtyRowTracker.markDirty(H-1);H--;)this._resetBufferLine(H,O);this._dirtyRowTracker.markDirty(0);break;case 3:const F=this._activeBuffer.lines.length-this._bufferService.rows;F>0&&(this._activeBuffer.lines.trimStart(F),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-F,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-F,0),this._onScroll.fire(0))}return!0}eraseInLine(L,O=!1){switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,O);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,O);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,O)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(L){this._restrictCursor();let O=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const H=this._activeBuffer.ybase+this._activeBuffer.y,F=this._bufferService.rows-1-this._activeBuffer.scrollBottom,N=this._bufferService.rows-1+this._activeBuffer.ybase-F+1;for(;O--;)this._activeBuffer.lines.splice(N-1,1),this._activeBuffer.lines.splice(H,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(L){this._restrictCursor();let O=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const H=this._activeBuffer.ybase+this._activeBuffer.y;let F;for(F=this._bufferService.rows-1-this._activeBuffer.scrollBottom,F=this._bufferService.rows-1+this._activeBuffer.ybase-F;O--;)this._activeBuffer.lines.splice(H,1),this._activeBuffer.lines.splice(F,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(L){this._restrictCursor();const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return O&&(O.insertCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(L){this._restrictCursor();const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return O&&(O.deleteCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(L){let O=L.params[0]||1;for(;O--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(L){let O=L.params[0]||1;for(;O--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(e.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=L.params[0]||1;for(let H=this._activeBuffer.scrollTop;H<=this._activeBuffer.scrollBottom;++H){const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+H);F.deleteCells(0,O,this._activeBuffer.getNullCell(this._eraseAttrData())),F.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=L.params[0]||1;for(let H=this._activeBuffer.scrollTop;H<=this._activeBuffer.scrollBottom;++H){const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+H);F.insertCells(0,O,this._activeBuffer.getNullCell(this._eraseAttrData())),F.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=L.params[0]||1;for(let H=this._activeBuffer.scrollTop;H<=this._activeBuffer.scrollBottom;++H){const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+H);F.insertCells(this._activeBuffer.x,O,this._activeBuffer.getNullCell(this._eraseAttrData())),F.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=L.params[0]||1;for(let H=this._activeBuffer.scrollTop;H<=this._activeBuffer.scrollBottom;++H){const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+H);F.deleteCells(this._activeBuffer.x,O,this._activeBuffer.getNullCell(this._eraseAttrData())),F.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(L){this._restrictCursor();const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return O&&(O.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(L.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(L){const O=this._parser.precedingJoinState;if(!O)return!0;const H=L.params[0]||1,F=S.UnicodeService.extractWidth(O),N=this._activeBuffer.x-F,G=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(N),V=new Uint32Array(G.length*H);let j=0;for(let D=0;D<G.length;){const U=G.codePointAt(D)||0;V[j++]=U,D+=U>65535?2:1}let B=j;for(let D=1;D<H;++D)V.copyWithin(B,0,j),B+=j;return this.print(V,0,B),!0}sendDeviceAttributesPrimary(L){return L.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(c.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(c.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(L){return L.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(c.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(c.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(L.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(c.C0.ESC+"[>83;40003;0c")),!0}_is(L){return(this._optionsService.rawOptions.termName+"").indexOf(L)===0}setMode(L){for(let O=0;O<L.length;O++)switch(L.params[O]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(L){for(let O=0;O<L.length;O++)switch(L.params[O]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,u.DEFAULT_CHARSET),this._charsetService.setgCharset(1,u.DEFAULT_CHARSET),this._charsetService.setgCharset(2,u.DEFAULT_CHARSET),this._charsetService.setgCharset(3,u.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(L){for(let O=0;O<L.length;O++)switch(L.params[O]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(L){for(let O=0;O<L.length;O++)switch(L.params[O]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),L.params[O]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(L,O){const H=this._coreService.decPrivateModes,{activeProtocol:F,activeEncoding:N}=this._coreMouseService,G=this._coreService,{buffers:V,cols:j}=this._bufferService,{active:B,alt:D}=V,U=this._optionsService.rawOptions,W=re=>re?1:2,J=L.params[0];return X=J,te=O?J===2?4:J===4?W(G.modes.insertMode):J===12?3:J===20?W(U.convertEol):0:J===1?W(H.applicationCursorKeys):J===3?U.windowOptions.setWinLines?j===80?2:j===132?1:0:0:J===6?W(H.origin):J===7?W(H.wraparound):J===8?3:J===9?W(F==="X10"):J===12?W(U.cursorBlink):J===25?W(!G.isCursorHidden):J===45?W(H.reverseWraparound):J===66?W(H.applicationKeypad):J===67?4:J===1e3?W(F==="VT200"):J===1002?W(F==="DRAG"):J===1003?W(F==="ANY"):J===1004?W(H.sendFocus):J===1005?4:J===1006?W(N==="SGR"):J===1015?4:J===1016?W(N==="SGR_PIXELS"):J===1048?1:J===47||J===1047||J===1049?W(B===D):J===2004?W(H.bracketedPasteMode):0,G.triggerDataEvent(`${c.C0.ESC}[${O?"":"?"}${X};${te}$y`),!0;var X,te}_updateAttrColor(L,O,H,F,N){return O===2?(L|=50331648,L&=-16777216,L|=d.AttributeData.fromColorRGB([H,F,N])):O===5&&(L&=-50331904,L|=33554432|255&H),L}_extractColor(L,O,H){const F=[0,0,-1,0,0,0];let N=0,G=0;do{if(F[G+N]=L.params[O+G],L.hasSubParams(O+G)){const V=L.getSubParams(O+G);let j=0;do F[1]===5&&(N=1),F[G+j+1+N]=V[j];while(++j<V.length&&j+G+1+N<F.length);break}if(F[1]===5&&G+N>=2||F[1]===2&&G+N>=5)break;F[1]&&(N=1)}while(++G+O<L.length&&G+N<F.length);for(let V=2;V<F.length;++V)F[V]===-1&&(F[V]=0);switch(F[0]){case 38:H.fg=this._updateAttrColor(H.fg,F[1],F[3],F[4],F[5]);break;case 48:H.bg=this._updateAttrColor(H.bg,F[1],F[3],F[4],F[5]);break;case 58:H.extended=H.extended.clone(),H.extended.underlineColor=this._updateAttrColor(H.extended.underlineColor,F[1],F[3],F[4],F[5])}return G}_processUnderline(L,O){O.extended=O.extended.clone(),(!~L||L>5)&&(L=1),O.extended.underlineStyle=L,O.fg|=268435456,L===0&&(O.fg&=-268435457),O.updateExtended()}_processSGR0(L){L.fg=e.DEFAULT_ATTR_DATA.fg,L.bg=e.DEFAULT_ATTR_DATA.bg,L.extended=L.extended.clone(),L.extended.underlineStyle=0,L.extended.underlineColor&=-67108864,L.updateExtended()}charAttributes(L){if(L.length===1&&L.params[0]===0)return this._processSGR0(this._curAttrData),!0;const O=L.length;let H;const F=this._curAttrData;for(let N=0;N<O;N++)H=L.params[N],H>=30&&H<=37?(F.fg&=-50331904,F.fg|=16777216|H-30):H>=40&&H<=47?(F.bg&=-50331904,F.bg|=16777216|H-40):H>=90&&H<=97?(F.fg&=-50331904,F.fg|=16777224|H-90):H>=100&&H<=107?(F.bg&=-50331904,F.bg|=16777224|H-100):H===0?this._processSGR0(F):H===1?F.fg|=134217728:H===3?F.bg|=67108864:H===4?(F.fg|=268435456,this._processUnderline(L.hasSubParams(N)?L.getSubParams(N)[0]:1,F)):H===5?F.fg|=536870912:H===7?F.fg|=67108864:H===8?F.fg|=1073741824:H===9?F.fg|=2147483648:H===2?F.bg|=134217728:H===21?this._processUnderline(2,F):H===22?(F.fg&=-134217729,F.bg&=-134217729):H===23?F.bg&=-67108865:H===24?(F.fg&=-268435457,this._processUnderline(0,F)):H===25?F.fg&=-536870913:H===27?F.fg&=-67108865:H===28?F.fg&=-1073741825:H===29?F.fg&=2147483647:H===39?(F.fg&=-67108864,F.fg|=16777215&e.DEFAULT_ATTR_DATA.fg):H===49?(F.bg&=-67108864,F.bg|=16777215&e.DEFAULT_ATTR_DATA.bg):H===38||H===48||H===58?N+=this._extractColor(L,N,F):H===53?F.bg|=1073741824:H===55?F.bg&=-1073741825:H===59?(F.extended=F.extended.clone(),F.extended.underlineColor=-1,F.updateExtended()):H===100?(F.fg&=-67108864,F.fg|=16777215&e.DEFAULT_ATTR_DATA.fg,F.bg&=-67108864,F.bg|=16777215&e.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",H);return!0}deviceStatus(L){switch(L.params[0]){case 5:this._coreService.triggerDataEvent(`${c.C0.ESC}[0n`);break;case 6:const O=this._activeBuffer.y+1,H=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${c.C0.ESC}[${O};${H}R`)}return!0}deviceStatusPrivate(L){if(L.params[0]===6){const O=this._activeBuffer.y+1,H=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${c.C0.ESC}[?${O};${H}R`)}return!0}softReset(L){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(L){const O=L.params[0]||1;switch(O){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const H=O%2==1;return this._optionsService.options.cursorBlink=H,!0}setScrollRegion(L){const O=L.params[0]||1;let H;return(L.length<2||(H=L.params[1])>this._bufferService.rows||H===0)&&(H=this._bufferService.rows),H>O&&(this._activeBuffer.scrollTop=O-1,this._activeBuffer.scrollBottom=H-1,this._setCursor(0,0)),!0}windowOptions(L){if(!I(L.params[0],this._optionsService.rawOptions.windowOptions))return!0;const O=L.length>1?L.params[1]:0;switch(L.params[0]){case 14:O!==2&&this._onRequestWindowsOptionsReport.fire(M.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(M.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${c.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:O!==0&&O!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),O!==0&&O!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:O!==0&&O!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),O!==0&&O!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(L){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(L){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(L){return this._windowTitle=L,this._onTitleChange.fire(L),!0}setIconName(L){return this._iconName=L,!0}setOrReportIndexedColor(L){const O=[],H=L.split(";");for(;H.length>1;){const F=H.shift(),N=H.shift();if(/^\d+$/.exec(F)){const G=parseInt(F);if(Z(G))if(N==="?")O.push({type:0,index:G});else{const V=(0,k.parseColor)(N);V&&O.push({type:1,index:G,color:V})}}}return O.length&&this._onColor.fire(O),!0}setHyperlink(L){const O=L.split(";");return!(O.length<2)&&(O[1]?this._createHyperlink(O[0],O[1]):!O[0]&&this._finishHyperlink())}_createHyperlink(L,O){this._getCurrentLinkId()&&this._finishHyperlink();const H=L.split(":");let F;const N=H.findIndex(G=>G.startsWith("id="));return N!==-1&&(F=H[N].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:F,uri:O}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(L,O){const H=L.split(";");for(let F=0;F<H.length&&!(O>=this._specialColors.length);++F,++O)if(H[F]==="?")this._onColor.fire([{type:0,index:this._specialColors[O]}]);else{const N=(0,k.parseColor)(H[F]);N&&this._onColor.fire([{type:1,index:this._specialColors[O],color:N}])}return!0}setOrReportFgColor(L){return this._setOrReportSpecialColor(L,0)}setOrReportBgColor(L){return this._setOrReportSpecialColor(L,1)}setOrReportCursorColor(L){return this._setOrReportSpecialColor(L,2)}restoreIndexedColor(L){if(!L)return this._onColor.fire([{type:2}]),!0;const O=[],H=L.split(";");for(let F=0;F<H.length;++F)if(/^\d+$/.exec(H[F])){const N=parseInt(H[F]);Z(N)&&O.push({type:2,index:N})}return O.length&&this._onColor.fire(O),!0}restoreFgColor(L){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(L){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(L){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,u.DEFAULT_CHARSET),!0}selectCharset(L){return L.length!==2?(this.selectDefaultCharset(),!0):(L[0]==="/"||this._charsetService.setgCharset(A[L[0]],u.CHARSETS[L[1]]||u.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const L=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,L,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=e.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(L){return this._charsetService.setgLevel(L),!0}screenAlignmentPattern(){const L=new s.CellData;L.content=4194373,L.fg=this._curAttrData.fg,L.bg=this._curAttrData.bg,this._setCursor(0,0);for(let O=0;O<this._bufferService.rows;++O){const H=this._activeBuffer.ybase+this._activeBuffer.y+O,F=this._activeBuffer.lines.get(H);F&&(F.fill(L),F.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(L,O){const H=this._bufferService.buffer,F=this._optionsService.rawOptions;return(N=>(this._coreService.triggerDataEvent(`${c.C0.ESC}${N}${c.C0.ESC}\\`),!0))(L==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:L==='"p'?'P1$r61;1"p':L==="r"?`P1$r${H.scrollTop+1};${H.scrollBottom+1}r`:L==="m"?"P1$r0m":L===" q"?`P1$r${{block:2,underline:4,bar:6}[F.cursorStyle]-(F.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(L,O){this._dirtyRowTracker.markRangeDirty(L,O)}}t.InputHandler=q;let Y=class{constructor(Q){this._bufferService=Q,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(Q){Q<this.start?this.start=Q:Q>this.end&&(this.end=Q)}markRangeDirty(Q,L){Q>L&&(z=Q,Q=L,L=z),Q<this.start&&(this.start=Q),L>this.end&&(this.end=L)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function Z(Q){return 0<=Q&&Q<256}Y=h([_(0,v.IBufferService)],Y)},844:(y,t)=>{function n(h){for(const _ of h)_.dispose();h.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const h of this._disposables)h.dispose();this._disposables.length=0}register(h){return this._disposables.push(h),h}unregister(h){const _=this._disposables.indexOf(h);_!==-1&&this._disposables.splice(_,1)}},t.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(h){var _;this._isDisposed||h===this._value||((_=this._value)==null||_.dispose(),this._value=h)}clear(){this.value=void 0}dispose(){var h;this._isDisposed=!0,(h=this._value)==null||h.dispose(),this._value=void 0}},t.toDisposable=function(h){return{dispose:h}},t.disposeArray=n,t.getDisposeArrayDisposable=function(h){return{dispose:()=>n(h)}}},1505:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;class n{constructor(){this._data={}}set(_,c,u){this._data[_]||(this._data[_]={}),this._data[_][c]=u}get(_,c){return this._data[_]?this._data[_][c]:void 0}clear(){this._data={}}}t.TwoKeyMap=n,t.FourKeyMap=class{constructor(){this._data=new n}set(h,_,c,u,g){this._data.get(h,_)||this._data.set(h,_,new n),this._data.get(h,_).set(c,u,g)}get(h,_,c,u){var g;return(g=this._data.get(h,_))==null?void 0:g.get(c,u)}clear(){this._data.clear()}}},6114:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode=typeof process<"u"&&"title"in process;const n=t.isNode?"node":navigator.userAgent,h=t.isNode?"node":navigator.platform;t.isFirefox=n.includes("Firefox"),t.isLegacyEdge=n.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(n),t.getSafariVersion=function(){if(!t.isSafari)return 0;const _=n.match(/Version\/(\d+)/);return _===null||_.length<2?0:parseInt(_[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(h),t.isIpad=h==="iPad",t.isIphone=h==="iPhone",t.isWindows=["Windows","Win16","Win32","WinCE"].includes(h),t.isLinux=h.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(n)},6106:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SortedList=void 0;let n=0;t.SortedList=class{constructor(h){this._getKey=h,this._array=[]}clear(){this._array.length=0}insert(h){this._array.length!==0?(n=this._search(this._getKey(h)),this._array.splice(n,0,h)):this._array.push(h)}delete(h){if(this._array.length===0)return!1;const _=this._getKey(h);if(_===void 0||(n=this._search(_),n===-1)||this._getKey(this._array[n])!==_)return!1;do if(this._array[n]===h)return this._array.splice(n,1),!0;while(++n<this._array.length&&this._getKey(this._array[n])===_);return!1}*getKeyIterator(h){if(this._array.length!==0&&(n=this._search(h),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===h))do yield this._array[n];while(++n<this._array.length&&this._getKey(this._array[n])===h)}forEachByKey(h,_){if(this._array.length!==0&&(n=this._search(h),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===h))do _(this._array[n]);while(++n<this._array.length&&this._getKey(this._array[n])===h)}values(){return[...this._array].values()}_search(h){let _=0,c=this._array.length-1;for(;c>=_;){let u=_+c>>1;const g=this._getKey(this._array[u]);if(g>h)c=u-1;else{if(!(g<h)){for(;u>0&&this._getKey(this._array[u-1])===h;)u--;return u}_=u+1}}return _}}},7226:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;const h=n(6114);class _{constructor(){this._tasks=[],this._i=0}enqueue(g){this._tasks.push(g),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(g){this._idleCallback=void 0;let m=0,f=0,e=g.timeRemaining(),o=0;for(;this._i<this._tasks.length;){if(m=Date.now(),this._tasks[this._i]()||this._i++,m=Math.max(1,Date.now()-m),f=Math.max(m,f),o=g.timeRemaining(),1.5*f>o)return e-m<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(e-m))}ms`),void this._start();e=o}this.clear()}}class c extends _{_requestCallback(g){return setTimeout(()=>g(this._createDeadline(16)))}_cancelCallback(g){clearTimeout(g)}_createDeadline(g){const m=Date.now()+g;return{timeRemaining:()=>Math.max(0,m-Date.now())}}}t.PriorityTaskQueue=c,t.IdleTaskQueue=!h.isNode&&"requestIdleCallback"in window?class extends _{_requestCallback(u){return requestIdleCallback(u)}_cancelCallback(u){cancelIdleCallback(u)}}:c,t.DebouncedIdleTask=class{constructor(){this._queue=new t.IdleTaskQueue}set(u){this._queue.clear(),this._queue.enqueue(u)}flush(){this._queue.flush()}}},9282:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;const h=n(643);t.updateWindowsModeWrappedState=function(_){const c=_.buffer.lines.get(_.buffer.ybase+_.buffer.y-1),u=c==null?void 0:c.get(_.cols-1),g=_.buffer.lines.get(_.buffer.ybase+_.buffer.y);g&&u&&(g.isWrapped=u[h.CHAR_DATA_CODE_INDEX]!==h.NULL_CELL_CODE&&u[h.CHAR_DATA_CODE_INDEX]!==h.WHITESPACE_CELL_CODE)}},3734:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;class n{constructor(){this.fg=0,this.bg=0,this.extended=new h}static toColorRGB(c){return[c>>>16&255,c>>>8&255,255&c]}static fromColorRGB(c){return(255&c[0])<<16|(255&c[1])<<8|255&c[2]}clone(){const c=new n;return c.fg=this.fg,c.bg=this.bg,c.extended=this.extended.clone(),c}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}t.AttributeData=n;class h{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(c){this._ext=c}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(c){this._ext&=-469762049,this._ext|=c<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(c){this._ext&=-67108864,this._ext|=67108863&c}get urlId(){return this._urlId}set urlId(c){this._urlId=c}get underlineVariantOffset(){const c=(3758096384&this._ext)>>29;return c<0?4294967288^c:c}set underlineVariantOffset(c){this._ext&=536870911,this._ext|=c<<29&3758096384}constructor(c=0,u=0){this._ext=0,this._urlId=0,this._ext=c,this._urlId=u}clone(){return new h(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}t.ExtendedAttrs=h},9092:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=t.MAX_BUFFER_SIZE=void 0;const h=n(6349),_=n(7226),c=n(3734),u=n(8437),g=n(4634),m=n(511),f=n(643),e=n(4863),o=n(7116);t.MAX_BUFFER_SIZE=4294967295,t.Buffer=class{constructor(r,s,d){this._hasScrollback=r,this._optionsService=s,this._bufferService=d,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=u.DEFAULT_ATTR_DATA.clone(),this.savedCharset=o.DEFAULT_CHARSET,this.markers=[],this._nullCell=m.CellData.fromCharData([0,f.NULL_CELL_CHAR,f.NULL_CELL_WIDTH,f.NULL_CELL_CODE]),this._whitespaceCell=m.CellData.fromCharData([0,f.WHITESPACE_CELL_CHAR,f.WHITESPACE_CELL_WIDTH,f.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new _.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(r){return r?(this._nullCell.fg=r.fg,this._nullCell.bg=r.bg,this._nullCell.extended=r.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new c.ExtendedAttrs),this._nullCell}getWhitespaceCell(r){return r?(this._whitespaceCell.fg=r.fg,this._whitespaceCell.bg=r.bg,this._whitespaceCell.extended=r.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new c.ExtendedAttrs),this._whitespaceCell}getBlankLine(r,s){return new u.BufferLine(this._bufferService.cols,this.getNullCell(r),s)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const r=this.ybase+this.y-this.ydisp;return r>=0&&r<this._rows}_getCorrectBufferLength(r){if(!this._hasScrollback)return r;const s=r+this._optionsService.rawOptions.scrollback;return s>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:s}fillViewportRows(r){if(this.lines.length===0){r===void 0&&(r=u.DEFAULT_ATTR_DATA);let s=this._rows;for(;s--;)this.lines.push(this.getBlankLine(r))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(r,s){const d=this.getNullCell(u.DEFAULT_ATTR_DATA);let v=0;const S=this._getCorrectBufferLength(s);if(S>this.lines.maxLength&&(this.lines.maxLength=S),this.lines.length>0){if(this._cols<r)for(let p=0;p<this.lines.length;p++)v+=+this.lines.get(p).resize(r,d);let x=0;if(this._rows<s)for(let p=this._rows;p<s;p++)this.lines.length<s+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new u.BufferLine(r,d)):this.ybase>0&&this.lines.length<=this.ybase+this.y+x+1?(this.ybase--,x++,this.ydisp>0&&this.ydisp--):this.lines.push(new u.BufferLine(r,d)));else for(let p=this._rows;p>s;p--)this.lines.length>s+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(S<this.lines.maxLength){const p=this.lines.length-S;p>0&&(this.lines.trimStart(p),this.ybase=Math.max(this.ybase-p,0),this.ydisp=Math.max(this.ydisp-p,0),this.savedY=Math.max(this.savedY-p,0)),this.lines.maxLength=S}this.x=Math.min(this.x,r-1),this.y=Math.min(this.y,s-1),x&&(this.y+=x),this.savedX=Math.min(this.savedX,r-1),this.scrollTop=0}if(this.scrollBottom=s-1,this._isReflowEnabled&&(this._reflow(r,s),this._cols>r))for(let x=0;x<this.lines.length;x++)v+=+this.lines.get(x).resize(r,d);this._cols=r,this._rows=s,this._memoryCleanupQueue.clear(),v>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let r=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,r=!1);let s=0;for(;this._memoryCleanupPosition<this.lines.length;)if(s+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),s>100)return!0;return r}get _isReflowEnabled(){const r=this._optionsService.rawOptions.windowsPty;return r&&r.buildNumber?this._hasScrollback&&r.backend==="conpty"&&r.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(r,s){this._cols!==r&&(r>this._cols?this._reflowLarger(r,s):this._reflowSmaller(r,s))}_reflowLarger(r,s){const d=(0,g.reflowLargerGetLinesToRemove)(this.lines,this._cols,r,this.ybase+this.y,this.getNullCell(u.DEFAULT_ATTR_DATA));if(d.length>0){const v=(0,g.reflowLargerCreateNewLayout)(this.lines,d);(0,g.reflowLargerApplyNewLayout)(this.lines,v.layout),this._reflowLargerAdjustViewport(r,s,v.countRemoved)}}_reflowLargerAdjustViewport(r,s,d){const v=this.getNullCell(u.DEFAULT_ATTR_DATA);let S=d;for(;S-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<s&&this.lines.push(new u.BufferLine(r,v))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-d,0)}_reflowSmaller(r,s){const d=this.getNullCell(u.DEFAULT_ATTR_DATA),v=[];let S=0;for(let x=this.lines.length-1;x>=0;x--){let p=this.lines.get(x);if(!p||!p.isWrapped&&p.getTrimmedLength()<=r)continue;const k=[p];for(;p.isWrapped&&x>0;)p=this.lines.get(--x),k.unshift(p);const A=this.ybase+this.y;if(A>=x&&A<x+k.length)continue;const P=k[k.length-1].getTrimmedLength(),I=(0,g.reflowSmallerGetNewLineLengths)(k,this._cols,r),M=I.length-k.length;let z;z=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+M):Math.max(0,this.lines.length-this.lines.maxLength+M);const q=[];for(let H=0;H<M;H++){const F=this.getBlankLine(u.DEFAULT_ATTR_DATA,!0);q.push(F)}q.length>0&&(v.push({start:x+k.length+S,newLines:q}),S+=q.length),k.push(...q);let Y=I.length-1,Z=I[Y];Z===0&&(Y--,Z=I[Y]);let Q=k.length-M-1,L=P;for(;Q>=0;){const H=Math.min(L,Z);if(k[Y]===void 0)break;if(k[Y].copyCellsFrom(k[Q],L-H,Z-H,H,!0),Z-=H,Z===0&&(Y--,Z=I[Y]),L-=H,L===0){Q--;const F=Math.max(Q,0);L=(0,g.getWrappedLineTrimmedLength)(k,F,this._cols)}}for(let H=0;H<k.length;H++)I[H]<r&&k[H].setCell(I[H],d);let O=M-z;for(;O-- >0;)this.ybase===0?this.y<s-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+S)-s&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+M,this.ybase+s-1)}if(v.length>0){const x=[],p=[];for(let Y=0;Y<this.lines.length;Y++)p.push(this.lines.get(Y));const k=this.lines.length;let A=k-1,P=0,I=v[P];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+S);let M=0;for(let Y=Math.min(this.lines.maxLength-1,k+S-1);Y>=0;Y--)if(I&&I.start>A+M){for(let Z=I.newLines.length-1;Z>=0;Z--)this.lines.set(Y--,I.newLines[Z]);Y++,x.push({index:A+1,amount:I.newLines.length}),M+=I.newLines.length,I=v[++P]}else this.lines.set(Y,p[A--]);let z=0;for(let Y=x.length-1;Y>=0;Y--)x[Y].index+=z,this.lines.onInsertEmitter.fire(x[Y]),z+=x[Y].amount;const q=Math.max(0,k+S-this.lines.maxLength);q>0&&this.lines.onTrimEmitter.fire(q)}}translateBufferLineToString(r,s,d=0,v){const S=this.lines.get(r);return S?S.translateToString(s,d,v):""}getWrappedRangeForLine(r){let s=r,d=r;for(;s>0&&this.lines.get(s).isWrapped;)s--;for(;d+1<this.lines.length&&this.lines.get(d+1).isWrapped;)d++;return{first:s,last:d}}setupTabStops(r){for(r!=null?this.tabs[r]||(r=this.prevStop(r)):(this.tabs={},r=0);r<this._cols;r+=this._optionsService.rawOptions.tabStopWidth)this.tabs[r]=!0}prevStop(r){for(r==null&&(r=this.x);!this.tabs[--r]&&r>0;);return r>=this._cols?this._cols-1:r<0?0:r}nextStop(r){for(r==null&&(r=this.x);!this.tabs[++r]&&r<this._cols;);return r>=this._cols?this._cols-1:r<0?0:r}clearMarkers(r){this._isClearing=!0;for(let s=0;s<this.markers.length;s++)this.markers[s].line===r&&(this.markers[s].dispose(),this.markers.splice(s--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let r=0;r<this.markers.length;r++)this.markers[r].dispose(),this.markers.splice(r--,1);this._isClearing=!1}addMarker(r){const s=new e.Marker(r);return this.markers.push(s),s.register(this.lines.onTrim(d=>{s.line-=d,s.line<0&&s.dispose()})),s.register(this.lines.onInsert(d=>{s.line>=d.index&&(s.line+=d.amount)})),s.register(this.lines.onDelete(d=>{s.line>=d.index&&s.line<d.index+d.amount&&s.dispose(),s.line>d.index&&(s.line-=d.amount)})),s.register(s.onDispose(()=>this._removeMarker(s))),s}_removeMarker(r){this._isClearing||this.markers.splice(this.markers.indexOf(r),1)}}},8437:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;const h=n(3734),_=n(511),c=n(643),u=n(482);t.DEFAULT_ATTR_DATA=Object.freeze(new h.AttributeData);let g=0;class m{constructor(e,o,r=!1){this.isWrapped=r,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*e);const s=o||_.CellData.fromCharData([0,c.NULL_CELL_CHAR,c.NULL_CELL_WIDTH,c.NULL_CELL_CODE]);for(let d=0;d<e;++d)this.setCell(d,s);this.length=e}get(e){const o=this._data[3*e+0],r=2097151&o;return[this._data[3*e+1],2097152&o?this._combined[e]:r?(0,u.stringFromCodePoint)(r):"",o>>22,2097152&o?this._combined[e].charCodeAt(this._combined[e].length-1):r]}set(e,o){this._data[3*e+1]=o[c.CHAR_DATA_ATTR_INDEX],o[c.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=o[1],this._data[3*e+0]=2097152|e|o[c.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=o[c.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|o[c.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(e){return this._data[3*e+0]>>22}hasWidth(e){return 12582912&this._data[3*e+0]}getFg(e){return this._data[3*e+1]}getBg(e){return this._data[3*e+2]}hasContent(e){return 4194303&this._data[3*e+0]}getCodePoint(e){const o=this._data[3*e+0];return 2097152&o?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&o}isCombined(e){return 2097152&this._data[3*e+0]}getString(e){const o=this._data[3*e+0];return 2097152&o?this._combined[e]:2097151&o?(0,u.stringFromCodePoint)(2097151&o):""}isProtected(e){return 536870912&this._data[3*e+2]}loadCell(e,o){return g=3*e,o.content=this._data[g+0],o.fg=this._data[g+1],o.bg=this._data[g+2],2097152&o.content&&(o.combinedData=this._combined[e]),268435456&o.bg&&(o.extended=this._extendedAttrs[e]),o}setCell(e,o){2097152&o.content&&(this._combined[e]=o.combinedData),268435456&o.bg&&(this._extendedAttrs[e]=o.extended),this._data[3*e+0]=o.content,this._data[3*e+1]=o.fg,this._data[3*e+2]=o.bg}setCellFromCodepoint(e,o,r,s){268435456&s.bg&&(this._extendedAttrs[e]=s.extended),this._data[3*e+0]=o|r<<22,this._data[3*e+1]=s.fg,this._data[3*e+2]=s.bg}addCodepointToCell(e,o,r){let s=this._data[3*e+0];2097152&s?this._combined[e]+=(0,u.stringFromCodePoint)(o):2097151&s?(this._combined[e]=(0,u.stringFromCodePoint)(2097151&s)+(0,u.stringFromCodePoint)(o),s&=-2097152,s|=2097152):s=o|4194304,r&&(s&=-12582913,s|=r<<22),this._data[3*e+0]=s}insertCells(e,o,r){if((e%=this.length)&&this.getWidth(e-1)===2&&this.setCellFromCodepoint(e-1,0,1,r),o<this.length-e){const s=new _.CellData;for(let d=this.length-e-o-1;d>=0;--d)this.setCell(e+o+d,this.loadCell(e+d,s));for(let d=0;d<o;++d)this.setCell(e+d,r)}else for(let s=e;s<this.length;++s)this.setCell(s,r);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,r)}deleteCells(e,o,r){if(e%=this.length,o<this.length-e){const s=new _.CellData;for(let d=0;d<this.length-e-o;++d)this.setCell(e+d,this.loadCell(e+o+d,s));for(let d=this.length-o;d<this.length;++d)this.setCell(d,r)}else for(let s=e;s<this.length;++s)this.setCell(s,r);e&&this.getWidth(e-1)===2&&this.setCellFromCodepoint(e-1,0,1,r),this.getWidth(e)!==0||this.hasContent(e)||this.setCellFromCodepoint(e,0,1,r)}replaceCells(e,o,r,s=!1){if(s)for(e&&this.getWidth(e-1)===2&&!this.isProtected(e-1)&&this.setCellFromCodepoint(e-1,0,1,r),o<this.length&&this.getWidth(o-1)===2&&!this.isProtected(o)&&this.setCellFromCodepoint(o,0,1,r);e<o&&e<this.length;)this.isProtected(e)||this.setCell(e,r),e++;else for(e&&this.getWidth(e-1)===2&&this.setCellFromCodepoint(e-1,0,1,r),o<this.length&&this.getWidth(o-1)===2&&this.setCellFromCodepoint(o,0,1,r);e<o&&e<this.length;)this.setCell(e++,r)}resize(e,o){if(e===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const r=3*e;if(e>this.length){if(this._data.buffer.byteLength>=4*r)this._data=new Uint32Array(this._data.buffer,0,r);else{const s=new Uint32Array(r);s.set(this._data),this._data=s}for(let s=this.length;s<e;++s)this.setCell(s,o)}else{this._data=this._data.subarray(0,r);const s=Object.keys(this._combined);for(let v=0;v<s.length;v++){const S=parseInt(s[v],10);S>=e&&delete this._combined[S]}const d=Object.keys(this._extendedAttrs);for(let v=0;v<d.length;v++){const S=parseInt(d[v],10);S>=e&&delete this._extendedAttrs[S]}}return this.length=e,4*r*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const e=new Uint32Array(this._data.length);return e.set(this._data),this._data=e,1}return 0}fill(e,o=!1){if(o)for(let r=0;r<this.length;++r)this.isProtected(r)||this.setCell(r,e);else{this._combined={},this._extendedAttrs={};for(let r=0;r<this.length;++r)this.setCell(r,e)}}copyFrom(e){this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={};for(const o in e._combined)this._combined[o]=e._combined[o];this._extendedAttrs={};for(const o in e._extendedAttrs)this._extendedAttrs[o]=e._extendedAttrs[o];this.isWrapped=e.isWrapped}clone(){const e=new m(0);e._data=new Uint32Array(this._data),e.length=this.length;for(const o in this._combined)e._combined[o]=this._combined[o];for(const o in this._extendedAttrs)e._extendedAttrs[o]=this._extendedAttrs[o];return e.isWrapped=this.isWrapped,e}getTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0}getNoBgTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0]||50331648&this._data[3*e+2])return e+(this._data[3*e+0]>>22);return 0}copyCellsFrom(e,o,r,s,d){const v=e._data;if(d)for(let x=s-1;x>=0;x--){for(let p=0;p<3;p++)this._data[3*(r+x)+p]=v[3*(o+x)+p];268435456&v[3*(o+x)+2]&&(this._extendedAttrs[r+x]=e._extendedAttrs[o+x])}else for(let x=0;x<s;x++){for(let p=0;p<3;p++)this._data[3*(r+x)+p]=v[3*(o+x)+p];268435456&v[3*(o+x)+2]&&(this._extendedAttrs[r+x]=e._extendedAttrs[o+x])}const S=Object.keys(e._combined);for(let x=0;x<S.length;x++){const p=parseInt(S[x],10);p>=o&&(this._combined[p-o+r]=e._combined[p])}}translateToString(e,o,r,s){o=o??0,r=r??this.length,e&&(r=Math.min(r,this.getTrimmedLength())),s&&(s.length=0);let d="";for(;o<r;){const v=this._data[3*o+0],S=2097151&v,x=2097152&v?this._combined[o]:S?(0,u.stringFromCodePoint)(S):c.WHITESPACE_CELL_CHAR;if(d+=x,s)for(let p=0;p<x.length;++p)s.push(o);o+=v>>22||1}return s&&s.push(o),d}}t.BufferLine=m},4841:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(n,h){if(n.start.y>n.end.y)throw new Error(`Buffer range end (${n.end.x}, ${n.end.y}) cannot be before start (${n.start.x}, ${n.start.y})`);return h*(n.end.y-n.start.y)+(n.end.x-n.start.x+1)}},4634:(y,t)=>{function n(h,_,c){if(_===h.length-1)return h[_].getTrimmedLength();const u=!h[_].hasContent(c-1)&&h[_].getWidth(c-1)===1,g=h[_+1].getWidth(0)===2;return u&&g?c-1:c}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(h,_,c,u,g){const m=[];for(let f=0;f<h.length-1;f++){let e=f,o=h.get(++e);if(!o.isWrapped)continue;const r=[h.get(f)];for(;e<h.length&&o.isWrapped;)r.push(o),o=h.get(++e);if(u>=f&&u<e){f+=r.length-1;continue}let s=0,d=n(r,s,_),v=1,S=0;for(;v<r.length;){const p=n(r,v,_),k=p-S,A=c-d,P=Math.min(k,A);r[s].copyCellsFrom(r[v],S,d,P,!1),d+=P,d===c&&(s++,d=0),S+=P,S===p&&(v++,S=0),d===0&&s!==0&&r[s-1].getWidth(c-1)===2&&(r[s].copyCellsFrom(r[s-1],c-1,d++,1,!1),r[s-1].setCell(c-1,g))}r[s].replaceCells(d,c,g);let x=0;for(let p=r.length-1;p>0&&(p>s||r[p].getTrimmedLength()===0);p--)x++;x>0&&(m.push(f+r.length-x),m.push(x)),f+=r.length-1}return m},t.reflowLargerCreateNewLayout=function(h,_){const c=[];let u=0,g=_[u],m=0;for(let f=0;f<h.length;f++)if(g===f){const e=_[++u];h.onDeleteEmitter.fire({index:f-m,amount:e}),f+=e-1,m+=e,g=_[++u]}else c.push(f);return{layout:c,countRemoved:m}},t.reflowLargerApplyNewLayout=function(h,_){const c=[];for(let u=0;u<_.length;u++)c.push(h.get(_[u]));for(let u=0;u<c.length;u++)h.set(u,c[u]);h.length=_.length},t.reflowSmallerGetNewLineLengths=function(h,_,c){const u=[],g=h.map((o,r)=>n(h,r,_)).reduce((o,r)=>o+r);let m=0,f=0,e=0;for(;e<g;){if(g-e<c){u.push(g-e);break}m+=c;const o=n(h,f,_);m>o&&(m-=o,f++);const r=h[f].getWidth(m-1)===2;r&&m--;const s=r?c-1:c;u.push(s),e+=s}return u},t.getWrappedLineTrimmedLength=n},5295:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;const h=n(8460),_=n(844),c=n(9092);class u extends _.Disposable{constructor(m,f){super(),this._optionsService=m,this._bufferService=f,this._onBufferActivate=this.register(new h.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new c.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new c.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(m){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(m),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(m,f){this._normal.resize(m,f),this._alt.resize(m,f),this.setupTabStops(m)}setupTabStops(m){this._normal.setupTabStops(m),this._alt.setupTabStops(m)}}t.BufferSet=u},511:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;const h=n(482),_=n(643),c=n(3734);class u extends c.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new c.ExtendedAttrs,this.combinedData=""}static fromCharData(m){const f=new u;return f.setFromCharData(m),f}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,h.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(m){this.fg=m[_.CHAR_DATA_ATTR_INDEX],this.bg=0;let f=!1;if(m[_.CHAR_DATA_CHAR_INDEX].length>2)f=!0;else if(m[_.CHAR_DATA_CHAR_INDEX].length===2){const e=m[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=e&&e<=56319){const o=m[_.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=o&&o<=57343?this.content=1024*(e-55296)+o-56320+65536|m[_.CHAR_DATA_WIDTH_INDEX]<<22:f=!0}else f=!0}else this.content=m[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|m[_.CHAR_DATA_WIDTH_INDEX]<<22;f&&(this.combinedData=m[_.CHAR_DATA_CHAR_INDEX],this.content=2097152|m[_.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.CellData=u},643:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;const h=n(8460),_=n(844);class c{get id(){return this._id}constructor(g){this.line=g,this.isDisposed=!1,this._disposables=[],this._id=c._nextId++,this._onDispose=this.register(new h.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,_.disposeArray)(this._disposables),this._disposables.length=0)}register(g){return this._disposables.push(g),g}}t.Marker=c,c._nextId=1},7116:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},t.CHARSETS.A={"#":"£"},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},t.CHARSETS.C=t.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},t.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},t.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},t.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},t.CHARSETS.E=t.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},t.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},t.CHARSETS.H=t.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(y,t)=>{var n,h,_;Object.defineProperty(t,"__esModule",{value:!0}),t.C1_ESCAPED=t.C1=t.C0=void 0,function(c){c.NUL="\0",c.SOH="",c.STX="",c.ETX="",c.EOT="",c.ENQ="",c.ACK="",c.BEL="\x07",c.BS="\b",c.HT="	",c.LF=`
`,c.VT="\v",c.FF="\f",c.CR="\r",c.SO="",c.SI="",c.DLE="",c.DC1="",c.DC2="",c.DC3="",c.DC4="",c.NAK="",c.SYN="",c.ETB="",c.CAN="",c.EM="",c.SUB="",c.ESC="\x1B",c.FS="",c.GS="",c.RS="",c.US="",c.SP=" ",c.DEL=""}(n||(t.C0=n={})),function(c){c.PAD="",c.HOP="",c.BPH="",c.NBH="",c.IND="",c.NEL="",c.SSA="",c.ESA="",c.HTS="",c.HTJ="",c.VTS="",c.PLD="",c.PLU="",c.RI="",c.SS2="",c.SS3="",c.DCS="",c.PU1="",c.PU2="",c.STS="",c.CCH="",c.MW="",c.SPA="",c.EPA="",c.SOS="",c.SGCI="",c.SCI="",c.CSI="",c.ST="",c.OSC="",c.PM="",c.APC=""}(h||(t.C1=h={})),function(c){c.ST=`${n.ESC}\\`}(_||(t.C1_ESCAPED=_={}))},7399:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;const h=n(2584),_={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(c,u,g,m){const f={type:0,cancel:!1,key:void 0},e=(c.shiftKey?1:0)|(c.altKey?2:0)|(c.ctrlKey?4:0)|(c.metaKey?8:0);switch(c.keyCode){case 0:c.key==="UIKeyInputUpArrow"?f.key=u?h.C0.ESC+"OA":h.C0.ESC+"[A":c.key==="UIKeyInputLeftArrow"?f.key=u?h.C0.ESC+"OD":h.C0.ESC+"[D":c.key==="UIKeyInputRightArrow"?f.key=u?h.C0.ESC+"OC":h.C0.ESC+"[C":c.key==="UIKeyInputDownArrow"&&(f.key=u?h.C0.ESC+"OB":h.C0.ESC+"[B");break;case 8:f.key=c.ctrlKey?"\b":h.C0.DEL,c.altKey&&(f.key=h.C0.ESC+f.key);break;case 9:if(c.shiftKey){f.key=h.C0.ESC+"[Z";break}f.key=h.C0.HT,f.cancel=!0;break;case 13:f.key=c.altKey?h.C0.ESC+h.C0.CR:h.C0.CR,f.cancel=!0;break;case 27:f.key=h.C0.ESC,c.altKey&&(f.key=h.C0.ESC+h.C0.ESC),f.cancel=!0;break;case 37:if(c.metaKey)break;e?(f.key=h.C0.ESC+"[1;"+(e+1)+"D",f.key===h.C0.ESC+"[1;3D"&&(f.key=h.C0.ESC+(g?"b":"[1;5D"))):f.key=u?h.C0.ESC+"OD":h.C0.ESC+"[D";break;case 39:if(c.metaKey)break;e?(f.key=h.C0.ESC+"[1;"+(e+1)+"C",f.key===h.C0.ESC+"[1;3C"&&(f.key=h.C0.ESC+(g?"f":"[1;5C"))):f.key=u?h.C0.ESC+"OC":h.C0.ESC+"[C";break;case 38:if(c.metaKey)break;e?(f.key=h.C0.ESC+"[1;"+(e+1)+"A",g||f.key!==h.C0.ESC+"[1;3A"||(f.key=h.C0.ESC+"[1;5A")):f.key=u?h.C0.ESC+"OA":h.C0.ESC+"[A";break;case 40:if(c.metaKey)break;e?(f.key=h.C0.ESC+"[1;"+(e+1)+"B",g||f.key!==h.C0.ESC+"[1;3B"||(f.key=h.C0.ESC+"[1;5B")):f.key=u?h.C0.ESC+"OB":h.C0.ESC+"[B";break;case 45:c.shiftKey||c.ctrlKey||(f.key=h.C0.ESC+"[2~");break;case 46:f.key=e?h.C0.ESC+"[3;"+(e+1)+"~":h.C0.ESC+"[3~";break;case 36:f.key=e?h.C0.ESC+"[1;"+(e+1)+"H":u?h.C0.ESC+"OH":h.C0.ESC+"[H";break;case 35:f.key=e?h.C0.ESC+"[1;"+(e+1)+"F":u?h.C0.ESC+"OF":h.C0.ESC+"[F";break;case 33:c.shiftKey?f.type=2:c.ctrlKey?f.key=h.C0.ESC+"[5;"+(e+1)+"~":f.key=h.C0.ESC+"[5~";break;case 34:c.shiftKey?f.type=3:c.ctrlKey?f.key=h.C0.ESC+"[6;"+(e+1)+"~":f.key=h.C0.ESC+"[6~";break;case 112:f.key=e?h.C0.ESC+"[1;"+(e+1)+"P":h.C0.ESC+"OP";break;case 113:f.key=e?h.C0.ESC+"[1;"+(e+1)+"Q":h.C0.ESC+"OQ";break;case 114:f.key=e?h.C0.ESC+"[1;"+(e+1)+"R":h.C0.ESC+"OR";break;case 115:f.key=e?h.C0.ESC+"[1;"+(e+1)+"S":h.C0.ESC+"OS";break;case 116:f.key=e?h.C0.ESC+"[15;"+(e+1)+"~":h.C0.ESC+"[15~";break;case 117:f.key=e?h.C0.ESC+"[17;"+(e+1)+"~":h.C0.ESC+"[17~";break;case 118:f.key=e?h.C0.ESC+"[18;"+(e+1)+"~":h.C0.ESC+"[18~";break;case 119:f.key=e?h.C0.ESC+"[19;"+(e+1)+"~":h.C0.ESC+"[19~";break;case 120:f.key=e?h.C0.ESC+"[20;"+(e+1)+"~":h.C0.ESC+"[20~";break;case 121:f.key=e?h.C0.ESC+"[21;"+(e+1)+"~":h.C0.ESC+"[21~";break;case 122:f.key=e?h.C0.ESC+"[23;"+(e+1)+"~":h.C0.ESC+"[23~";break;case 123:f.key=e?h.C0.ESC+"[24;"+(e+1)+"~":h.C0.ESC+"[24~";break;default:if(!c.ctrlKey||c.shiftKey||c.altKey||c.metaKey)if(g&&!m||!c.altKey||c.metaKey)!g||c.altKey||c.ctrlKey||c.shiftKey||!c.metaKey?c.key&&!c.ctrlKey&&!c.altKey&&!c.metaKey&&c.keyCode>=48&&c.key.length===1?f.key=c.key:c.key&&c.ctrlKey&&(c.key==="_"&&(f.key=h.C0.US),c.key==="@"&&(f.key=h.C0.NUL)):c.keyCode===65&&(f.type=1);else{const o=_[c.keyCode],r=o==null?void 0:o[c.shiftKey?1:0];if(r)f.key=h.C0.ESC+r;else if(c.keyCode>=65&&c.keyCode<=90){const s=c.ctrlKey?c.keyCode-64:c.keyCode+32;let d=String.fromCharCode(s);c.shiftKey&&(d=d.toUpperCase()),f.key=h.C0.ESC+d}else if(c.keyCode===32)f.key=h.C0.ESC+(c.ctrlKey?h.C0.NUL:" ");else if(c.key==="Dead"&&c.code.startsWith("Key")){let s=c.code.slice(3,4);c.shiftKey||(s=s.toLowerCase()),f.key=h.C0.ESC+s,f.cancel=!0}}else c.keyCode>=65&&c.keyCode<=90?f.key=String.fromCharCode(c.keyCode-64):c.keyCode===32?f.key=h.C0.NUL:c.keyCode>=51&&c.keyCode<=55?f.key=String.fromCharCode(c.keyCode-51+27):c.keyCode===56?f.key=h.C0.DEL:c.keyCode===219?f.key=h.C0.ESC:c.keyCode===220?f.key=h.C0.FS:c.keyCode===221&&(f.key=h.C0.GS)}return f}},482:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(n){return n>65535?(n-=65536,String.fromCharCode(55296+(n>>10))+String.fromCharCode(n%1024+56320)):String.fromCharCode(n)},t.utf32ToString=function(n,h=0,_=n.length){let c="";for(let u=h;u<_;++u){let g=n[u];g>65535?(g-=65536,c+=String.fromCharCode(55296+(g>>10))+String.fromCharCode(g%1024+56320)):c+=String.fromCharCode(g)}return c},t.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(n,h){const _=n.length;if(!_)return 0;let c=0,u=0;if(this._interim){const g=n.charCodeAt(u++);56320<=g&&g<=57343?h[c++]=1024*(this._interim-55296)+g-56320+65536:(h[c++]=this._interim,h[c++]=g),this._interim=0}for(let g=u;g<_;++g){const m=n.charCodeAt(g);if(55296<=m&&m<=56319){if(++g>=_)return this._interim=m,c;const f=n.charCodeAt(g);56320<=f&&f<=57343?h[c++]=1024*(m-55296)+f-56320+65536:(h[c++]=m,h[c++]=f)}else m!==65279&&(h[c++]=m)}return c}},t.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(n,h){const _=n.length;if(!_)return 0;let c,u,g,m,f=0,e=0,o=0;if(this.interim[0]){let d=!1,v=this.interim[0];v&=(224&v)==192?31:(240&v)==224?15:7;let S,x=0;for(;(S=63&this.interim[++x])&&x<4;)v<<=6,v|=S;const p=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,k=p-x;for(;o<k;){if(o>=_)return 0;if(S=n[o++],(192&S)!=128){o--,d=!0;break}this.interim[x++]=S,v<<=6,v|=63&S}d||(p===2?v<128?o--:h[f++]=v:p===3?v<2048||v>=55296&&v<=57343||v===65279||(h[f++]=v):v<65536||v>1114111||(h[f++]=v)),this.interim.fill(0)}const r=_-4;let s=o;for(;s<_;){for(;!(!(s<r)||128&(c=n[s])||128&(u=n[s+1])||128&(g=n[s+2])||128&(m=n[s+3]));)h[f++]=c,h[f++]=u,h[f++]=g,h[f++]=m,s+=4;if(c=n[s++],c<128)h[f++]=c;else if((224&c)==192){if(s>=_)return this.interim[0]=c,f;if(u=n[s++],(192&u)!=128){s--;continue}if(e=(31&c)<<6|63&u,e<128){s--;continue}h[f++]=e}else if((240&c)==224){if(s>=_)return this.interim[0]=c,f;if(u=n[s++],(192&u)!=128){s--;continue}if(s>=_)return this.interim[0]=c,this.interim[1]=u,f;if(g=n[s++],(192&g)!=128){s--;continue}if(e=(15&c)<<12|(63&u)<<6|63&g,e<2048||e>=55296&&e<=57343||e===65279)continue;h[f++]=e}else if((248&c)==240){if(s>=_)return this.interim[0]=c,f;if(u=n[s++],(192&u)!=128){s--;continue}if(s>=_)return this.interim[0]=c,this.interim[1]=u,f;if(g=n[s++],(192&g)!=128){s--;continue}if(s>=_)return this.interim[0]=c,this.interim[1]=u,this.interim[2]=g,f;if(m=n[s++],(192&m)!=128){s--;continue}if(e=(7&c)<<18|(63&u)<<12|(63&g)<<6|63&m,e<65536||e>1114111)continue;h[f++]=e}}return f}}},225:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;const h=n(1480),_=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],c=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let u;t.UnicodeV6=class{constructor(){if(this.version="6",!u){u=new Uint8Array(65536),u.fill(1),u[0]=0,u.fill(0,1,32),u.fill(0,127,160),u.fill(2,4352,4448),u[9001]=2,u[9002]=2,u.fill(2,11904,42192),u[12351]=1,u.fill(2,44032,55204),u.fill(2,63744,64256),u.fill(2,65040,65050),u.fill(2,65072,65136),u.fill(2,65280,65377),u.fill(2,65504,65511);for(let g=0;g<_.length;++g)u.fill(0,_[g][0],_[g][1]+1)}}wcwidth(g){return g<32?0:g<127?1:g<65536?u[g]:function(m,f){let e,o=0,r=f.length-1;if(m<f[0][0]||m>f[r][1])return!1;for(;r>=o;)if(e=o+r>>1,m>f[e][1])o=e+1;else{if(!(m<f[e][0]))return!0;r=e-1}return!1}(g,c)?0:g>=131072&&g<=196605||g>=196608&&g<=262141?2:1}charProperties(g,m){let f=this.wcwidth(g),e=f===0&&m!==0;if(e){const o=h.UnicodeService.extractWidth(m);o===0?e=!1:o>f&&(f=o)}return h.UnicodeService.createPropertyValue(0,f,e)}}},5981:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;const h=n(8460),_=n(844);class c extends _.Disposable{constructor(g){super(),this._action=g,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new h.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(g,m){if(m!==void 0&&this._syncCalls>m)return void(this._syncCalls=0);if(this._pendingData+=g.length,this._writeBuffer.push(g),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let f;for(this._isSyncWriting=!0;f=this._writeBuffer.shift();){this._action(f);const e=this._callbacks.shift();e&&e()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(g,m){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=g.length,this._writeBuffer.push(g),this._callbacks.push(m),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=g.length,this._writeBuffer.push(g),this._callbacks.push(m)}_innerWrite(g=0,m=!0){const f=g||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const e=this._writeBuffer[this._bufferOffset],o=this._action(e,m);if(o){const s=d=>Date.now()-f>=12?setTimeout(()=>this._innerWrite(0,d)):this._innerWrite(f,d);return void o.catch(d=>(queueMicrotask(()=>{throw d}),Promise.resolve(!1))).then(s)}const r=this._callbacks[this._bufferOffset];if(r&&r(),this._bufferOffset++,this._pendingData-=e.length,Date.now()-f>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}t.WriteBuffer=c},5941:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;const n=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,h=/^[\da-f]+$/;function _(c,u){const g=c.toString(16),m=g.length<2?"0"+g:g;switch(u){case 4:return g[0];case 8:return m;case 12:return(m+m).slice(0,3);default:return m+m}}t.parseColor=function(c){if(!c)return;let u=c.toLowerCase();if(u.indexOf("rgb:")===0){u=u.slice(4);const g=n.exec(u);if(g){const m=g[1]?15:g[4]?255:g[7]?4095:65535;return[Math.round(parseInt(g[1]||g[4]||g[7]||g[10],16)/m*255),Math.round(parseInt(g[2]||g[5]||g[8]||g[11],16)/m*255),Math.round(parseInt(g[3]||g[6]||g[9]||g[12],16)/m*255)]}}else if(u.indexOf("#")===0&&(u=u.slice(1),h.exec(u)&&[3,6,9,12].includes(u.length))){const g=u.length/3,m=[0,0,0];for(let f=0;f<3;++f){const e=parseInt(u.slice(g*f,g*f+g),16);m[f]=g===1?e<<4:g===2?e:g===3?e>>4:e>>8}return m}},t.toRgbString=function(c,u=16){const[g,m,f]=c;return`rgb:${_(g,u)}/${_(m,u)}/${_(f,u)}`}},5770:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;const h=n(482),_=n(8742),c=n(5770),u=[];t.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=u,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=u}registerHandler(m,f){this._handlers[m]===void 0&&(this._handlers[m]=[]);const e=this._handlers[m];return e.push(f),{dispose:()=>{const o=e.indexOf(f);o!==-1&&e.splice(o,1)}}}clearHandler(m){this._handlers[m]&&delete this._handlers[m]}setHandlerFallback(m){this._handlerFb=m}reset(){if(this._active.length)for(let m=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;m>=0;--m)this._active[m].unhook(!1);this._stack.paused=!1,this._active=u,this._ident=0}hook(m,f){if(this.reset(),this._ident=m,this._active=this._handlers[m]||u,this._active.length)for(let e=this._active.length-1;e>=0;e--)this._active[e].hook(f);else this._handlerFb(this._ident,"HOOK",f)}put(m,f,e){if(this._active.length)for(let o=this._active.length-1;o>=0;o--)this._active[o].put(m,f,e);else this._handlerFb(this._ident,"PUT",(0,h.utf32ToString)(m,f,e))}unhook(m,f=!0){if(this._active.length){let e=!1,o=this._active.length-1,r=!1;if(this._stack.paused&&(o=this._stack.loopPosition-1,e=f,r=this._stack.fallThrough,this._stack.paused=!1),!r&&e===!1){for(;o>=0&&(e=this._active[o].unhook(m),e!==!0);o--)if(e instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!1,e;o--}for(;o>=0;o--)if(e=this._active[o].unhook(!1),e instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!0,e}else this._handlerFb(this._ident,"UNHOOK",m);this._active=u,this._ident=0}};const g=new _.Params;g.addParam(0),t.DcsHandler=class{constructor(m){this._handler=m,this._data="",this._params=g,this._hitLimit=!1}hook(m){this._params=m.length>1||m.params[0]?m.clone():g,this._data="",this._hitLimit=!1}put(m,f,e){this._hitLimit||(this._data+=(0,h.utf32ToString)(m,f,e),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(m){let f=!1;if(this._hitLimit)f=!1;else if(m&&(f=this._handler(this._data,this._params),f instanceof Promise))return f.then(e=>(this._params=g,this._data="",this._hitLimit=!1,e));return this._params=g,this._data="",this._hitLimit=!1,f}}},2015:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;const h=n(844),_=n(8742),c=n(6242),u=n(6351);class g{constructor(o){this.table=new Uint8Array(o)}setDefault(o,r){this.table.fill(o<<4|r)}add(o,r,s,d){this.table[r<<8|o]=s<<4|d}addMany(o,r,s,d){for(let v=0;v<o.length;v++)this.table[r<<8|o[v]]=s<<4|d}}t.TransitionTable=g;const m=160;t.VT500_TRANSITION_TABLE=function(){const e=new g(4095),o=Array.apply(null,Array(256)).map((x,p)=>p),r=(x,p)=>o.slice(x,p),s=r(32,127),d=r(0,24);d.push(25),d.push.apply(d,r(28,32));const v=r(0,14);let S;for(S in e.setDefault(1,0),e.addMany(s,0,2,0),v)e.addMany([24,26,153,154],S,3,0),e.addMany(r(128,144),S,3,0),e.addMany(r(144,152),S,3,0),e.add(156,S,0,0),e.add(27,S,11,1),e.add(157,S,4,8),e.addMany([152,158,159],S,0,7),e.add(155,S,11,3),e.add(144,S,11,9);return e.addMany(d,0,3,0),e.addMany(d,1,3,1),e.add(127,1,0,1),e.addMany(d,8,0,8),e.addMany(d,3,3,3),e.add(127,3,0,3),e.addMany(d,4,3,4),e.add(127,4,0,4),e.addMany(d,6,3,6),e.addMany(d,5,3,5),e.add(127,5,0,5),e.addMany(d,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(s,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(r(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(s,7,0,7),e.addMany(d,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(r(64,127),3,7,0),e.addMany(r(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(r(48,60),4,8,4),e.addMany(r(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(r(32,64),6,0,6),e.add(127,6,0,6),e.addMany(r(64,127),6,0,0),e.addMany(r(32,48),3,9,5),e.addMany(r(32,48),5,9,5),e.addMany(r(48,64),5,0,6),e.addMany(r(64,127),5,7,0),e.addMany(r(32,48),4,9,5),e.addMany(r(32,48),1,9,2),e.addMany(r(32,48),2,9,2),e.addMany(r(48,127),2,10,0),e.addMany(r(48,80),1,10,0),e.addMany(r(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(r(96,127),1,10,0),e.add(80,1,11,9),e.addMany(d,9,0,9),e.add(127,9,0,9),e.addMany(r(28,32),9,0,9),e.addMany(r(32,48),9,9,12),e.addMany(r(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(d,11,0,11),e.addMany(r(32,128),11,0,11),e.addMany(r(28,32),11,0,11),e.addMany(d,10,0,10),e.add(127,10,0,10),e.addMany(r(28,32),10,0,10),e.addMany(r(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(r(32,48),10,9,12),e.addMany(d,12,0,12),e.add(127,12,0,12),e.addMany(r(28,32),12,0,12),e.addMany(r(32,48),12,9,12),e.addMany(r(48,64),12,0,11),e.addMany(r(64,127),12,12,13),e.addMany(r(64,127),10,12,13),e.addMany(r(64,127),9,12,13),e.addMany(d,13,13,13),e.addMany(s,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(m,0,2,0),e.add(m,8,5,8),e.add(m,6,0,6),e.add(m,11,0,11),e.add(m,13,13,13),e}();class f extends h.Disposable{constructor(o=t.VT500_TRANSITION_TABLE){super(),this._transitions=o,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new _.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(r,s,d)=>{},this._executeHandlerFb=r=>{},this._csiHandlerFb=(r,s)=>{},this._escHandlerFb=r=>{},this._errorHandlerFb=r=>r,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,h.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new c.OscParser),this._dcsParser=this.register(new u.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(o,r=[64,126]){let s=0;if(o.prefix){if(o.prefix.length>1)throw new Error("only one byte as prefix supported");if(s=o.prefix.charCodeAt(0),s&&60>s||s>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(o.intermediates){if(o.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let v=0;v<o.intermediates.length;++v){const S=o.intermediates.charCodeAt(v);if(32>S||S>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");s<<=8,s|=S}}if(o.final.length!==1)throw new Error("final must be a single byte");const d=o.final.charCodeAt(0);if(r[0]>d||d>r[1])throw new Error(`final must be in range ${r[0]} .. ${r[1]}`);return s<<=8,s|=d,s}identToString(o){const r=[];for(;o;)r.push(String.fromCharCode(255&o)),o>>=8;return r.reverse().join("")}setPrintHandler(o){this._printHandler=o}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(o,r){const s=this._identifier(o,[48,126]);this._escHandlers[s]===void 0&&(this._escHandlers[s]=[]);const d=this._escHandlers[s];return d.push(r),{dispose:()=>{const v=d.indexOf(r);v!==-1&&d.splice(v,1)}}}clearEscHandler(o){this._escHandlers[this._identifier(o,[48,126])]&&delete this._escHandlers[this._identifier(o,[48,126])]}setEscHandlerFallback(o){this._escHandlerFb=o}setExecuteHandler(o,r){this._executeHandlers[o.charCodeAt(0)]=r}clearExecuteHandler(o){this._executeHandlers[o.charCodeAt(0)]&&delete this._executeHandlers[o.charCodeAt(0)]}setExecuteHandlerFallback(o){this._executeHandlerFb=o}registerCsiHandler(o,r){const s=this._identifier(o);this._csiHandlers[s]===void 0&&(this._csiHandlers[s]=[]);const d=this._csiHandlers[s];return d.push(r),{dispose:()=>{const v=d.indexOf(r);v!==-1&&d.splice(v,1)}}}clearCsiHandler(o){this._csiHandlers[this._identifier(o)]&&delete this._csiHandlers[this._identifier(o)]}setCsiHandlerFallback(o){this._csiHandlerFb=o}registerDcsHandler(o,r){return this._dcsParser.registerHandler(this._identifier(o),r)}clearDcsHandler(o){this._dcsParser.clearHandler(this._identifier(o))}setDcsHandlerFallback(o){this._dcsParser.setHandlerFallback(o)}registerOscHandler(o,r){return this._oscParser.registerHandler(o,r)}clearOscHandler(o){this._oscParser.clearHandler(o)}setOscHandlerFallback(o){this._oscParser.setHandlerFallback(o)}setErrorHandler(o){this._errorHandler=o}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(o,r,s,d,v){this._parseStack.state=o,this._parseStack.handlers=r,this._parseStack.handlerPos=s,this._parseStack.transition=d,this._parseStack.chunkPos=v}parse(o,r,s){let d,v=0,S=0,x=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,x=this._parseStack.chunkPos+1;else{if(s===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const p=this._parseStack.handlers;let k=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(s===!1&&k>-1){for(;k>=0&&(d=p[k](this._params),d!==!0);k--)if(d instanceof Promise)return this._parseStack.handlerPos=k,d}this._parseStack.handlers=[];break;case 4:if(s===!1&&k>-1){for(;k>=0&&(d=p[k](),d!==!0);k--)if(d instanceof Promise)return this._parseStack.handlerPos=k,d}this._parseStack.handlers=[];break;case 6:if(v=o[this._parseStack.chunkPos],d=this._dcsParser.unhook(v!==24&&v!==26,s),d)return d;v===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(v=o[this._parseStack.chunkPos],d=this._oscParser.end(v!==24&&v!==26,s),d)return d;v===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,x=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let p=x;p<r;++p){switch(v=o[p],S=this._transitions.table[this.currentState<<8|(v<160?v:m)],S>>4){case 2:for(let M=p+1;;++M){if(M>=r||(v=o[M])<32||v>126&&v<m){this._printHandler(o,p,M),p=M-1;break}if(++M>=r||(v=o[M])<32||v>126&&v<m){this._printHandler(o,p,M),p=M-1;break}if(++M>=r||(v=o[M])<32||v>126&&v<m){this._printHandler(o,p,M),p=M-1;break}if(++M>=r||(v=o[M])<32||v>126&&v<m){this._printHandler(o,p,M),p=M-1;break}}break;case 3:this._executeHandlers[v]?this._executeHandlers[v]():this._executeHandlerFb(v),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:p,code:v,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const k=this._csiHandlers[this._collect<<8|v];let A=k?k.length-1:-1;for(;A>=0&&(d=k[A](this._params),d!==!0);A--)if(d instanceof Promise)return this._preserveStack(3,k,A,S,p),d;A<0&&this._csiHandlerFb(this._collect<<8|v,this._params),this.precedingJoinState=0;break;case 8:do switch(v){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(v-48)}while(++p<r&&(v=o[p])>47&&v<60);p--;break;case 9:this._collect<<=8,this._collect|=v;break;case 10:const P=this._escHandlers[this._collect<<8|v];let I=P?P.length-1:-1;for(;I>=0&&(d=P[I](),d!==!0);I--)if(d instanceof Promise)return this._preserveStack(4,P,I,S,p),d;I<0&&this._escHandlerFb(this._collect<<8|v),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|v,this._params);break;case 13:for(let M=p+1;;++M)if(M>=r||(v=o[M])===24||v===26||v===27||v>127&&v<m){this._dcsParser.put(o,p,M),p=M-1;break}break;case 14:if(d=this._dcsParser.unhook(v!==24&&v!==26),d)return this._preserveStack(6,[],0,S,p),d;v===27&&(S|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let M=p+1;;M++)if(M>=r||(v=o[M])<32||v>127&&v<m){this._oscParser.put(o,p,M),p=M-1;break}break;case 6:if(d=this._oscParser.end(v!==24&&v!==26),d)return this._preserveStack(5,[],0,S,p),d;v===27&&(S|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&S}}}t.EscapeSequenceParser=f},6242:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;const h=n(5770),_=n(482),c=[];t.OscParser=class{constructor(){this._state=0,this._active=c,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(u,g){this._handlers[u]===void 0&&(this._handlers[u]=[]);const m=this._handlers[u];return m.push(g),{dispose:()=>{const f=m.indexOf(g);f!==-1&&m.splice(f,1)}}}clearHandler(u){this._handlers[u]&&delete this._handlers[u]}setHandlerFallback(u){this._handlerFb=u}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=c}reset(){if(this._state===2)for(let u=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;u>=0;--u)this._active[u].end(!1);this._stack.paused=!1,this._active=c,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||c,this._active.length)for(let u=this._active.length-1;u>=0;u--)this._active[u].start();else this._handlerFb(this._id,"START")}_put(u,g,m){if(this._active.length)for(let f=this._active.length-1;f>=0;f--)this._active[f].put(u,g,m);else this._handlerFb(this._id,"PUT",(0,_.utf32ToString)(u,g,m))}start(){this.reset(),this._state=1}put(u,g,m){if(this._state!==3){if(this._state===1)for(;g<m;){const f=u[g++];if(f===59){this._state=2,this._start();break}if(f<48||57<f)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+f-48}this._state===2&&m-g>0&&this._put(u,g,m)}}end(u,g=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let m=!1,f=this._active.length-1,e=!1;if(this._stack.paused&&(f=this._stack.loopPosition-1,m=g,e=this._stack.fallThrough,this._stack.paused=!1),!e&&m===!1){for(;f>=0&&(m=this._active[f].end(u),m!==!0);f--)if(m instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!1,m;f--}for(;f>=0;f--)if(m=this._active[f].end(!1),m instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!0,m}else this._handlerFb(this._id,"END",u);this._active=c,this._id=-1,this._state=0}}},t.OscHandler=class{constructor(u){this._handler=u,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(u,g,m){this._hitLimit||(this._data+=(0,_.utf32ToString)(u,g,m),this._data.length>h.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(u){let g=!1;if(this._hitLimit)g=!1;else if(u&&(g=this._handler(this._data),g instanceof Promise))return g.then(m=>(this._data="",this._hitLimit=!1,m));return this._data="",this._hitLimit=!1,g}}},8742:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;const n=2147483647;class h{static fromArray(c){const u=new h;if(!c.length)return u;for(let g=Array.isArray(c[0])?1:0;g<c.length;++g){const m=c[g];if(Array.isArray(m))for(let f=0;f<m.length;++f)u.addSubParam(m[f]);else u.addParam(m)}return u}constructor(c=32,u=32){if(this.maxLength=c,this.maxSubParamsLength=u,u>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(c),this.length=0,this._subParams=new Int32Array(u),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(c),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const c=new h(this.maxLength,this.maxSubParamsLength);return c.params.set(this.params),c.length=this.length,c._subParams.set(this._subParams),c._subParamsLength=this._subParamsLength,c._subParamsIdx.set(this._subParamsIdx),c._rejectDigits=this._rejectDigits,c._rejectSubDigits=this._rejectSubDigits,c._digitIsSub=this._digitIsSub,c}toArray(){const c=[];for(let u=0;u<this.length;++u){c.push(this.params[u]);const g=this._subParamsIdx[u]>>8,m=255&this._subParamsIdx[u];m-g>0&&c.push(Array.prototype.slice.call(this._subParams,g,m))}return c}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(c){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(c<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=c>n?n:c}}addSubParam(c){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(c<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=c>n?n:c,this._subParamsIdx[this.length-1]++}}hasSubParams(c){return(255&this._subParamsIdx[c])-(this._subParamsIdx[c]>>8)>0}getSubParams(c){const u=this._subParamsIdx[c]>>8,g=255&this._subParamsIdx[c];return g-u>0?this._subParams.subarray(u,g):null}getSubParamsAll(){const c={};for(let u=0;u<this.length;++u){const g=this._subParamsIdx[u]>>8,m=255&this._subParamsIdx[u];m-g>0&&(c[u]=this._subParams.slice(g,m))}return c}addDigit(c){let u;if(this._rejectDigits||!(u=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const g=this._digitIsSub?this._subParams:this.params,m=g[u-1];g[u-1]=~m?Math.min(10*m+c,n):c}}t.Params=h},5741:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0,t.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let n=this._addons.length-1;n>=0;n--)this._addons[n].instance.dispose()}loadAddon(n,h){const _={instance:h,dispose:h.dispose,isDisposed:!1};this._addons.push(_),h.dispose=()=>this._wrappedAddonDispose(_),h.activate(n)}_wrappedAddonDispose(n){if(n.isDisposed)return;let h=-1;for(let _=0;_<this._addons.length;_++)if(this._addons[_]===n){h=_;break}if(h===-1)throw new Error("Could not dispose an addon that has not been loaded");n.isDisposed=!0,n.dispose.apply(n.instance),this._addons.splice(h,1)}}},8771:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;const h=n(3785),_=n(511);t.BufferApiView=class{constructor(c,u){this._buffer=c,this.type=u}init(c){return this._buffer=c,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(c){const u=this._buffer.lines.get(c);if(u)return new h.BufferLineApiView(u)}getNullCell(){return new _.CellData}}},3785:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;const h=n(511);t.BufferLineApiView=class{constructor(_){this._line=_}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(_,c){if(!(_<0||_>=this._line.length))return c?(this._line.loadCell(_,c),c):this._line.loadCell(_,new h.CellData)}translateToString(_,c,u){return this._line.translateToString(_,c,u)}}},8285:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;const h=n(8771),_=n(8460),c=n(844);class u extends c.Disposable{constructor(m){super(),this._core=m,this._onBufferChange=this.register(new _.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new h.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new h.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}t.BufferNamespaceApi=u},7975:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0,t.ParserApi=class{constructor(n){this._core=n}registerCsiHandler(n,h){return this._core.registerCsiHandler(n,_=>h(_.toArray()))}addCsiHandler(n,h){return this.registerCsiHandler(n,h)}registerDcsHandler(n,h){return this._core.registerDcsHandler(n,(_,c)=>h(_,c.toArray()))}addDcsHandler(n,h){return this.registerDcsHandler(n,h)}registerEscHandler(n,h){return this._core.registerEscHandler(n,h)}addEscHandler(n,h){return this.registerEscHandler(n,h)}registerOscHandler(n,h){return this._core.registerOscHandler(n,h)}addOscHandler(n,h){return this.registerOscHandler(n,h)}}},7090:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0,t.UnicodeApi=class{constructor(n){this._core=n}register(n){this._core.unicodeService.register(n)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(n){this._core.unicodeService.activeVersion=n}}},744:function(y,t,n){var h=this&&this.__decorate||function(e,o,r,s){var d,v=arguments.length,S=v<3?o:s===null?s=Object.getOwnPropertyDescriptor(o,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(e,o,r,s);else for(var x=e.length-1;x>=0;x--)(d=e[x])&&(S=(v<3?d(S):v>3?d(o,r,S):d(o,r))||S);return v>3&&S&&Object.defineProperty(o,r,S),S},_=this&&this.__param||function(e,o){return function(r,s){o(r,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;const c=n(8460),u=n(844),g=n(5295),m=n(2585);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;let f=t.BufferService=class extends u.Disposable{get buffer(){return this.buffers.active}constructor(e){super(),this.isUserScrolling=!1,this._onResize=this.register(new c.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new c.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(e.rawOptions.cols||0,t.MINIMUM_COLS),this.rows=Math.max(e.rawOptions.rows||0,t.MINIMUM_ROWS),this.buffers=this.register(new g.BufferSet(e,this))}resize(e,o){this.cols=e,this.rows=o,this.buffers.resize(e,o),this._onResize.fire({cols:e,rows:o})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(e,o=!1){const r=this.buffer;let s;s=this._cachedBlankLine,s&&s.length===this.cols&&s.getFg(0)===e.fg&&s.getBg(0)===e.bg||(s=r.getBlankLine(e,o),this._cachedBlankLine=s),s.isWrapped=o;const d=r.ybase+r.scrollTop,v=r.ybase+r.scrollBottom;if(r.scrollTop===0){const S=r.lines.isFull;v===r.lines.length-1?S?r.lines.recycle().copyFrom(s):r.lines.push(s.clone()):r.lines.splice(v+1,0,s.clone()),S?this.isUserScrolling&&(r.ydisp=Math.max(r.ydisp-1,0)):(r.ybase++,this.isUserScrolling||r.ydisp++)}else{const S=v-d+1;r.lines.shiftElements(d+1,S-1,-1),r.lines.set(v,s.clone())}this.isUserScrolling||(r.ydisp=r.ybase),this._onScroll.fire(r.ydisp)}scrollLines(e,o,r){const s=this.buffer;if(e<0){if(s.ydisp===0)return;this.isUserScrolling=!0}else e+s.ydisp>=s.ybase&&(this.isUserScrolling=!1);const d=s.ydisp;s.ydisp=Math.max(Math.min(s.ydisp+e,s.ybase),0),d!==s.ydisp&&(o||this._onScroll.fire(s.ydisp))}};t.BufferService=f=h([_(0,m.IOptionsService)],f)},7994:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0,t.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(n){this.glevel=n,this.charset=this._charsets[n]}setgCharset(n,h){this._charsets[n]=h,this.glevel===n&&(this.charset=h)}}},1753:function(y,t,n){var h=this&&this.__decorate||function(s,d,v,S){var x,p=arguments.length,k=p<3?d:S===null?S=Object.getOwnPropertyDescriptor(d,v):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(s,d,v,S);else for(var A=s.length-1;A>=0;A--)(x=s[A])&&(k=(p<3?x(k):p>3?x(d,v,k):x(d,v))||k);return p>3&&k&&Object.defineProperty(d,v,k),k},_=this&&this.__param||function(s,d){return function(v,S){d(v,S,s)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;const c=n(2585),u=n(8460),g=n(844),m={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:s=>s.button!==4&&s.action===1&&(s.ctrl=!1,s.alt=!1,s.shift=!1,!0)},VT200:{events:19,restrict:s=>s.action!==32},DRAG:{events:23,restrict:s=>s.action!==32||s.button!==3},ANY:{events:31,restrict:s=>!0}};function f(s,d){let v=(s.ctrl?16:0)|(s.shift?4:0)|(s.alt?8:0);return s.button===4?(v|=64,v|=s.action):(v|=3&s.button,4&s.button&&(v|=64),8&s.button&&(v|=128),s.action===32?v|=32:s.action!==0||d||(v|=3)),v}const e=String.fromCharCode,o={DEFAULT:s=>{const d=[f(s,!1)+32,s.col+32,s.row+32];return d[0]>255||d[1]>255||d[2]>255?"":`\x1B[M${e(d[0])}${e(d[1])}${e(d[2])}`},SGR:s=>{const d=s.action===0&&s.button!==4?"m":"M";return`\x1B[<${f(s,!0)};${s.col};${s.row}${d}`},SGR_PIXELS:s=>{const d=s.action===0&&s.button!==4?"m":"M";return`\x1B[<${f(s,!0)};${s.x};${s.y}${d}`}};let r=t.CoreMouseService=class extends g.Disposable{constructor(s,d){super(),this._bufferService=s,this._coreService=d,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new u.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const v of Object.keys(m))this.addProtocol(v,m[v]);for(const v of Object.keys(o))this.addEncoding(v,o[v]);this.reset()}addProtocol(s,d){this._protocols[s]=d}addEncoding(s,d){this._encodings[s]=d}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(s){if(!this._protocols[s])throw new Error(`unknown protocol "${s}"`);this._activeProtocol=s,this._onProtocolChange.fire(this._protocols[s].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(s){if(!this._encodings[s])throw new Error(`unknown encoding "${s}"`);this._activeEncoding=s}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(s){if(s.col<0||s.col>=this._bufferService.cols||s.row<0||s.row>=this._bufferService.rows||s.button===4&&s.action===32||s.button===3&&s.action!==32||s.button!==4&&(s.action===2||s.action===3)||(s.col++,s.row++,s.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,s,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(s))return!1;const d=this._encodings[this._activeEncoding](s);return d&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(d):this._coreService.triggerDataEvent(d,!0)),this._lastEvent=s,!0}explainEvents(s){return{down:!!(1&s),up:!!(2&s),drag:!!(4&s),move:!!(8&s),wheel:!!(16&s)}}_equalEvents(s,d,v){if(v){if(s.x!==d.x||s.y!==d.y)return!1}else if(s.col!==d.col||s.row!==d.row)return!1;return s.button===d.button&&s.action===d.action&&s.ctrl===d.ctrl&&s.alt===d.alt&&s.shift===d.shift}};t.CoreMouseService=r=h([_(0,c.IBufferService),_(1,c.ICoreService)],r)},6975:function(y,t,n){var h=this&&this.__decorate||function(r,s,d,v){var S,x=arguments.length,p=x<3?s:v===null?v=Object.getOwnPropertyDescriptor(s,d):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(r,s,d,v);else for(var k=r.length-1;k>=0;k--)(S=r[k])&&(p=(x<3?S(p):x>3?S(s,d,p):S(s,d))||p);return x>3&&p&&Object.defineProperty(s,d,p),p},_=this&&this.__param||function(r,s){return function(d,v){s(d,v,r)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;const c=n(1439),u=n(8460),g=n(844),m=n(2585),f=Object.freeze({insertMode:!1}),e=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let o=t.CoreService=class extends g.Disposable{constructor(r,s,d){super(),this._bufferService=r,this._logService=s,this._optionsService=d,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new u.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new u.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new u.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new u.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,c.clone)(f),this.decPrivateModes=(0,c.clone)(e)}reset(){this.modes=(0,c.clone)(f),this.decPrivateModes=(0,c.clone)(e)}triggerDataEvent(r,s=!1){if(this._optionsService.rawOptions.disableStdin)return;const d=this._bufferService.buffer;s&&this._optionsService.rawOptions.scrollOnUserInput&&d.ybase!==d.ydisp&&this._onRequestScrollToBottom.fire(),s&&this._onUserInput.fire(),this._logService.debug(`sending data "${r}"`,()=>r.split("").map(v=>v.charCodeAt(0))),this._onData.fire(r)}triggerBinaryEvent(r){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${r}"`,()=>r.split("").map(s=>s.charCodeAt(0))),this._onBinary.fire(r))}};t.CoreService=o=h([_(0,m.IBufferService),_(1,m.ILogService),_(2,m.IOptionsService)],o)},9074:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DecorationService=void 0;const h=n(8055),_=n(8460),c=n(844),u=n(6106);let g=0,m=0;class f extends c.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new u.SortedList(r=>r==null?void 0:r.marker.line),this._onDecorationRegistered=this.register(new _.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new _.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,c.toDisposable)(()=>this.reset()))}registerDecoration(r){if(r.marker.isDisposed)return;const s=new e(r);if(s){const d=s.marker.onDispose(()=>s.dispose());s.onDispose(()=>{s&&(this._decorations.delete(s)&&this._onDecorationRemoved.fire(s),d.dispose())}),this._decorations.insert(s),this._onDecorationRegistered.fire(s)}return s}reset(){for(const r of this._decorations.values())r.dispose();this._decorations.clear()}*getDecorationsAtCell(r,s,d){let v=0,S=0;for(const x of this._decorations.getKeyIterator(s))v=x.options.x??0,S=v+(x.options.width??1),r>=v&&r<S&&(!d||(x.options.layer??"bottom")===d)&&(yield x)}forEachDecorationAtCell(r,s,d,v){this._decorations.forEachByKey(s,S=>{g=S.options.x??0,m=g+(S.options.width??1),r>=g&&r<m&&(!d||(S.options.layer??"bottom")===d)&&v(S)})}}t.DecorationService=f;class e extends c.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=h.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=h.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(r){super(),this.options=r,this.onRenderEmitter=this.register(new _.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new _.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=r.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;const h=n(2585),_=n(8343);class c{constructor(...g){this._entries=new Map;for(const[m,f]of g)this.set(m,f)}set(g,m){const f=this._entries.get(g);return this._entries.set(g,m),f}forEach(g){for(const[m,f]of this._entries.entries())g(m,f)}has(g){return this._entries.has(g)}get(g){return this._entries.get(g)}}t.ServiceCollection=c,t.InstantiationService=class{constructor(){this._services=new c,this._services.set(h.IInstantiationService,this)}setService(u,g){this._services.set(u,g)}getService(u){return this._services.get(u)}createInstance(u,...g){const m=(0,_.getServiceDependencies)(u).sort((o,r)=>o.index-r.index),f=[];for(const o of m){const r=this._services.get(o.id);if(!r)throw new Error(`[createInstance] ${u.name} depends on UNKNOWN service ${o.id}.`);f.push(r)}const e=m.length>0?m[0].index:g.length;if(g.length!==e)throw new Error(`[createInstance] First service dependency of ${u.name} at position ${e+1} conflicts with ${g.length} static arguments`);return new u(...g,...f)}}},7866:function(y,t,n){var h=this&&this.__decorate||function(e,o,r,s){var d,v=arguments.length,S=v<3?o:s===null?s=Object.getOwnPropertyDescriptor(o,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(e,o,r,s);else for(var x=e.length-1;x>=0;x--)(d=e[x])&&(S=(v<3?d(S):v>3?d(o,r,S):d(o,r))||S);return v>3&&S&&Object.defineProperty(o,r,S),S},_=this&&this.__param||function(e,o){return function(r,s){o(r,s,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceCall=t.setTraceLogger=t.LogService=void 0;const c=n(844),u=n(2585),g={trace:u.LogLevelEnum.TRACE,debug:u.LogLevelEnum.DEBUG,info:u.LogLevelEnum.INFO,warn:u.LogLevelEnum.WARN,error:u.LogLevelEnum.ERROR,off:u.LogLevelEnum.OFF};let m,f=t.LogService=class extends c.Disposable{get logLevel(){return this._logLevel}constructor(e){super(),this._optionsService=e,this._logLevel=u.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),m=this}_updateLogLevel(){this._logLevel=g[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(e){for(let o=0;o<e.length;o++)typeof e[o]=="function"&&(e[o]=e[o]())}_log(e,o,r){this._evalLazyOptionalParams(r),e.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+o,...r)}trace(e,...o){var r;this._logLevel<=u.LogLevelEnum.TRACE&&this._log(((r=this._optionsService.options.logger)==null?void 0:r.trace.bind(this._optionsService.options.logger))??console.log,e,o)}debug(e,...o){var r;this._logLevel<=u.LogLevelEnum.DEBUG&&this._log(((r=this._optionsService.options.logger)==null?void 0:r.debug.bind(this._optionsService.options.logger))??console.log,e,o)}info(e,...o){var r;this._logLevel<=u.LogLevelEnum.INFO&&this._log(((r=this._optionsService.options.logger)==null?void 0:r.info.bind(this._optionsService.options.logger))??console.info,e,o)}warn(e,...o){var r;this._logLevel<=u.LogLevelEnum.WARN&&this._log(((r=this._optionsService.options.logger)==null?void 0:r.warn.bind(this._optionsService.options.logger))??console.warn,e,o)}error(e,...o){var r;this._logLevel<=u.LogLevelEnum.ERROR&&this._log(((r=this._optionsService.options.logger)==null?void 0:r.error.bind(this._optionsService.options.logger))??console.error,e,o)}};t.LogService=f=h([_(0,u.IOptionsService)],f),t.setTraceLogger=function(e){m=e},t.traceCall=function(e,o,r){if(typeof r.value!="function")throw new Error("not supported");const s=r.value;r.value=function(...d){if(m.logLevel!==u.LogLevelEnum.TRACE)return s.apply(this,d);m.trace(`GlyphRenderer#${s.name}(${d.map(S=>JSON.stringify(S)).join(", ")})`);const v=s.apply(this,d);return m.trace(`GlyphRenderer#${s.name} return`,v),v}}},7302:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=void 0;const h=n(8460),_=n(844),c=n(6114);t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:c.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const u=["normal","bold","100","200","300","400","500","600","700","800","900"];class g extends _.Disposable{constructor(f){super(),this._onOptionChange=this.register(new h.EventEmitter),this.onOptionChange=this._onOptionChange.event;const e={...t.DEFAULT_OPTIONS};for(const o in f)if(o in e)try{const r=f[o];e[o]=this._sanitizeAndValidateOption(o,r)}catch(r){console.error(r)}this.rawOptions=e,this.options={...e},this._setupOptions(),this.register((0,_.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(f,e){return this.onOptionChange(o=>{o===f&&e(this.rawOptions[f])})}onMultipleOptionChange(f,e){return this.onOptionChange(o=>{f.indexOf(o)!==-1&&e()})}_setupOptions(){const f=o=>{if(!(o in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${o}"`);return this.rawOptions[o]},e=(o,r)=>{if(!(o in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${o}"`);r=this._sanitizeAndValidateOption(o,r),this.rawOptions[o]!==r&&(this.rawOptions[o]=r,this._onOptionChange.fire(o))};for(const o in this.rawOptions){const r={get:f.bind(this,o),set:e.bind(this,o)};Object.defineProperty(this.options,o,r)}}_sanitizeAndValidateOption(f,e){switch(f){case"cursorStyle":if(e||(e=t.DEFAULT_OPTIONS[f]),!function(o){return o==="block"||o==="underline"||o==="bar"}(e))throw new Error(`"${e}" is not a valid value for ${f}`);break;case"wordSeparator":e||(e=t.DEFAULT_OPTIONS[f]);break;case"fontWeight":case"fontWeightBold":if(typeof e=="number"&&1<=e&&e<=1e3)break;e=u.includes(e)?e:t.DEFAULT_OPTIONS[f];break;case"cursorWidth":e=Math.floor(e);case"lineHeight":case"tabStopWidth":if(e<1)throw new Error(`${f} cannot be less than 1, value: ${e}`);break;case"minimumContrastRatio":e=Math.max(1,Math.min(21,Math.round(10*e)/10));break;case"scrollback":if((e=Math.min(e,4294967295))<0)throw new Error(`${f} cannot be less than 0, value: ${e}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(e<=0)throw new Error(`${f} cannot be less than or equal to 0, value: ${e}`);break;case"rows":case"cols":if(!e&&e!==0)throw new Error(`${f} must be numeric, value: ${e}`);break;case"windowsPty":e=e??{}}return e}}t.OptionsService=g},2660:function(y,t,n){var h=this&&this.__decorate||function(g,m,f,e){var o,r=arguments.length,s=r<3?m:e===null?e=Object.getOwnPropertyDescriptor(m,f):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(g,m,f,e);else for(var d=g.length-1;d>=0;d--)(o=g[d])&&(s=(r<3?o(s):r>3?o(m,f,s):o(m,f))||s);return r>3&&s&&Object.defineProperty(m,f,s),s},_=this&&this.__param||function(g,m){return function(f,e){m(f,e,g)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkService=void 0;const c=n(2585);let u=t.OscLinkService=class{constructor(g){this._bufferService=g,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(g){const m=this._bufferService.buffer;if(g.id===void 0){const d=m.addMarker(m.ybase+m.y),v={data:g,id:this._nextId++,lines:[d]};return d.onDispose(()=>this._removeMarkerFromLink(v,d)),this._dataByLinkId.set(v.id,v),v.id}const f=g,e=this._getEntryIdKey(f),o=this._entriesWithId.get(e);if(o)return this.addLineToLink(o.id,m.ybase+m.y),o.id;const r=m.addMarker(m.ybase+m.y),s={id:this._nextId++,key:this._getEntryIdKey(f),data:f,lines:[r]};return r.onDispose(()=>this._removeMarkerFromLink(s,r)),this._entriesWithId.set(s.key,s),this._dataByLinkId.set(s.id,s),s.id}addLineToLink(g,m){const f=this._dataByLinkId.get(g);if(f&&f.lines.every(e=>e.line!==m)){const e=this._bufferService.buffer.addMarker(m);f.lines.push(e),e.onDispose(()=>this._removeMarkerFromLink(f,e))}}getLinkData(g){var m;return(m=this._dataByLinkId.get(g))==null?void 0:m.data}_getEntryIdKey(g){return`${g.id};;${g.uri}`}_removeMarkerFromLink(g,m){const f=g.lines.indexOf(m);f!==-1&&(g.lines.splice(f,1),g.lines.length===0&&(g.data.id!==void 0&&this._entriesWithId.delete(g.key),this._dataByLinkId.delete(g.id)))}};t.OscLinkService=u=h([_(0,c.IBufferService)],u)},8343:(y,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0;const n="di$target",h="di$dependencies";t.serviceRegistry=new Map,t.getServiceDependencies=function(_){return _[h]||[]},t.createDecorator=function(_){if(t.serviceRegistry.has(_))return t.serviceRegistry.get(_);const c=function(u,g,m){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(f,e,o){e[n]===e?e[h].push({id:f,index:o}):(e[h]=[{id:f,index:o}],e[n]=e)})(c,u,m)};return c.toString=()=>_,t.serviceRegistry.set(_,c),c}},2585:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;const h=n(8343);var _;t.IBufferService=(0,h.createDecorator)("BufferService"),t.ICoreMouseService=(0,h.createDecorator)("CoreMouseService"),t.ICoreService=(0,h.createDecorator)("CoreService"),t.ICharsetService=(0,h.createDecorator)("CharsetService"),t.IInstantiationService=(0,h.createDecorator)("InstantiationService"),function(c){c[c.TRACE=0]="TRACE",c[c.DEBUG=1]="DEBUG",c[c.INFO=2]="INFO",c[c.WARN=3]="WARN",c[c.ERROR=4]="ERROR",c[c.OFF=5]="OFF"}(_||(t.LogLevelEnum=_={})),t.ILogService=(0,h.createDecorator)("LogService"),t.IOptionsService=(0,h.createDecorator)("OptionsService"),t.IOscLinkService=(0,h.createDecorator)("OscLinkService"),t.IUnicodeService=(0,h.createDecorator)("UnicodeService"),t.IDecorationService=(0,h.createDecorator)("DecorationService")},1480:(y,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;const h=n(8460),_=n(225);class c{static extractShouldJoin(g){return(1&g)!=0}static extractWidth(g){return g>>1&3}static extractCharKind(g){return g>>3}static createPropertyValue(g,m,f=!1){return(16777215&g)<<3|(3&m)<<1|(f?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new h.EventEmitter,this.onChange=this._onChange.event;const g=new _.UnicodeV6;this.register(g),this._active=g.version,this._activeProvider=g}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(g){if(!this._providers[g])throw new Error(`unknown Unicode version "${g}"`);this._active=g,this._activeProvider=this._providers[g],this._onChange.fire(g)}register(g){this._providers[g.version]=g}wcwidth(g){return this._activeProvider.wcwidth(g)}getStringCellWidth(g){let m=0,f=0;const e=g.length;for(let o=0;o<e;++o){let r=g.charCodeAt(o);if(55296<=r&&r<=56319){if(++o>=e)return m+this.wcwidth(r);const v=g.charCodeAt(o);56320<=v&&v<=57343?r=1024*(r-55296)+v-56320+65536:m+=this.wcwidth(v)}const s=this.charProperties(r,f);let d=c.extractWidth(s);c.extractShouldJoin(s)&&(d-=c.extractWidth(f)),m+=d,f=s}return m}charProperties(g,m){return this._activeProvider.charProperties(g,m)}}t.UnicodeService=c}},b={};function C(y){var t=b[y];if(t!==void 0)return t.exports;var n=b[y]={exports:{}};return a[y].call(n.exports,n,n.exports,C),n.exports}var R={};return(()=>{var y=R;Object.defineProperty(y,"__esModule",{value:!0}),y.Terminal=void 0;const t=C(9042),n=C(3236),h=C(844),_=C(5741),c=C(8285),u=C(7975),g=C(7090),m=["cols","rows"];class f extends h.Disposable{constructor(o){super(),this._core=this.register(new n.Terminal(o)),this._addonManager=this.register(new _.AddonManager),this._publicOptions={...this._core.options};const r=d=>this._core.options[d],s=(d,v)=>{this._checkReadonlyOptions(d),this._core.options[d]=v};for(const d in this._core.options){const v={get:r.bind(this,d),set:s.bind(this,d)};Object.defineProperty(this._publicOptions,d,v)}}_checkReadonlyOptions(o){if(m.includes(o))throw new Error(`Option "${o}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new u.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new g.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new c.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const o=this._core.coreService.decPrivateModes;let r="none";switch(this._core.coreMouseService.activeProtocol){case"X10":r="x10";break;case"VT200":r="vt200";break;case"DRAG":r="drag";break;case"ANY":r="any"}return{applicationCursorKeysMode:o.applicationCursorKeys,applicationKeypadMode:o.applicationKeypad,bracketedPasteMode:o.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:r,originMode:o.origin,reverseWraparoundMode:o.reverseWraparound,sendFocusMode:o.sendFocus,wraparoundMode:o.wraparound}}get options(){return this._publicOptions}set options(o){for(const r in o)this._publicOptions[r]=o[r]}blur(){this._core.blur()}focus(){this._core.focus()}input(o,r=!0){this._core.input(o,r)}resize(o,r){this._verifyIntegers(o,r),this._core.resize(o,r)}open(o){this._core.open(o)}attachCustomKeyEventHandler(o){this._core.attachCustomKeyEventHandler(o)}attachCustomWheelEventHandler(o){this._core.attachCustomWheelEventHandler(o)}registerLinkProvider(o){return this._core.registerLinkProvider(o)}registerCharacterJoiner(o){return this._checkProposedApi(),this._core.registerCharacterJoiner(o)}deregisterCharacterJoiner(o){this._checkProposedApi(),this._core.deregisterCharacterJoiner(o)}registerMarker(o=0){return this._verifyIntegers(o),this._core.registerMarker(o)}registerDecoration(o){return this._checkProposedApi(),this._verifyPositiveIntegers(o.x??0,o.width??0,o.height??0),this._core.registerDecoration(o)}hasSelection(){return this._core.hasSelection()}select(o,r,s){this._verifyIntegers(o,r,s),this._core.select(o,r,s)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(o,r){this._verifyIntegers(o,r),this._core.selectLines(o,r)}dispose(){super.dispose()}scrollLines(o){this._verifyIntegers(o),this._core.scrollLines(o)}scrollPages(o){this._verifyIntegers(o),this._core.scrollPages(o)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(o){this._verifyIntegers(o),this._core.scrollToLine(o)}clear(){this._core.clear()}write(o,r){this._core.write(o,r)}writeln(o,r){this._core.write(o),this._core.write(`\r
`,r)}paste(o){this._core.paste(o)}refresh(o,r){this._verifyIntegers(o,r),this._core.refresh(o,r)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(o){this._addonManager.loadAddon(this,o)}static get strings(){return t}_verifyIntegers(...o){for(const r of o)if(r===1/0||isNaN(r)||r%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...o){for(const r of o)if(r&&(r===1/0||isNaN(r)||r%1!=0||r<0))throw new Error("This API only accepts positive integers")}}y.Terminal=f})(),R})())})(li);var $i=li.exports,hi={exports:{}};(function(l,i){(function(a,b){l.exports=b()})(self,()=>(()=>{var a={};return(()=>{var b=a;Object.defineProperty(b,"__esModule",{value:!0}),b.FitAddon=void 0,b.FitAddon=class{activate(C){this._terminal=C}dispose(){}fit(){const C=this.proposeDimensions();if(!C||!this._terminal||isNaN(C.cols)||isNaN(C.rows))return;const R=this._terminal._core;this._terminal.rows===C.rows&&this._terminal.cols===C.cols||(R._renderService.clear(),this._terminal.resize(C.cols,C.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const C=this._terminal._core,R=C._renderService.dimensions;if(R.css.cell.width===0||R.css.cell.height===0)return;const y=this._terminal.options.scrollback===0?0:C.viewport.scrollBarWidth,t=window.getComputedStyle(this._terminal.element.parentElement),n=parseInt(t.getPropertyValue("height")),h=Math.max(0,parseInt(t.getPropertyValue("width"))),_=window.getComputedStyle(this._terminal.element),c=n-(parseInt(_.getPropertyValue("padding-top"))+parseInt(_.getPropertyValue("padding-bottom"))),u=h-(parseInt(_.getPropertyValue("padding-right"))+parseInt(_.getPropertyValue("padding-left")))-y;return{cols:Math.max(2,Math.floor(u/R.css.cell.width)),rows:Math.max(1,Math.floor(c/R.css.cell.height))}}}})(),a})())})(hi);var es=hi.exports,di={exports:{}};(function(l,i){(function(a,b){l.exports=b()})(self,()=>(()=>{var a={6:(y,t)=>{function n(_){try{const c=new URL(_),u=c.password&&c.username?`${c.protocol}//${c.username}:${c.password}@${c.host}`:c.username?`${c.protocol}//${c.username}@${c.host}`:`${c.protocol}//${c.host}`;return _.toLocaleLowerCase().startsWith(u.toLocaleLowerCase())}catch{return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.LinkComputer=t.WebLinkProvider=void 0,t.WebLinkProvider=class{constructor(_,c,u,g={}){this._terminal=_,this._regex=c,this._handler=u,this._options=g}provideLinks(_,c){const u=h.computeLink(_,this._regex,this._terminal,this._handler);c(this._addCallbacks(u))}_addCallbacks(_){return _.map(c=>(c.leave=this._options.leave,c.hover=(u,g)=>{if(this._options.hover){const{range:m}=c;this._options.hover(u,g,m)}},c))}};class h{static computeLink(c,u,g,m){const f=new RegExp(u.source,(u.flags||"")+"g"),[e,o]=h._getWindowedLineStrings(c-1,g),r=e.join("");let s;const d=[];for(;s=f.exec(r);){const v=s[0];if(!n(v))continue;const[S,x]=h._mapStrIdx(g,o,0,s.index),[p,k]=h._mapStrIdx(g,S,x,v.length);if(S===-1||x===-1||p===-1||k===-1)continue;const A={start:{x:x+1,y:S+1},end:{x:k,y:p+1}};d.push({range:A,text:v,activate:m})}return d}static _getWindowedLineStrings(c,u){let g,m=c,f=c,e=0,o="";const r=[];if(g=u.buffer.active.getLine(c)){const s=g.translateToString(!0);if(g.isWrapped&&s[0]!==" "){for(e=0;(g=u.buffer.active.getLine(--m))&&e<2048&&(o=g.translateToString(!0),e+=o.length,r.push(o),g.isWrapped&&o.indexOf(" ")===-1););r.reverse()}for(r.push(s),e=0;(g=u.buffer.active.getLine(++f))&&g.isWrapped&&e<2048&&(o=g.translateToString(!0),e+=o.length,r.push(o),o.indexOf(" ")===-1););}return[r,m]}static _mapStrIdx(c,u,g,m){const f=c.buffer.active,e=f.getNullCell();let o=g;for(;m;){const r=f.getLine(u);if(!r)return[-1,-1];for(let s=o;s<r.length;++s){r.getCell(s,e);const d=e.getChars();if(e.getWidth()&&(m-=d.length||1,s===r.length-1&&d==="")){const v=f.getLine(u+1);v&&v.isWrapped&&(v.getCell(0,e),e.getWidth()===2&&(m+=1))}if(m<0)return[u,s]}u++,o=0}return[u,o]}}t.LinkComputer=h}},b={};function C(y){var t=b[y];if(t!==void 0)return t.exports;var n=b[y]={exports:{}};return a[y](n,n.exports,C),n.exports}var R={};return(()=>{var y=R;Object.defineProperty(y,"__esModule",{value:!0}),y.WebLinksAddon=void 0;const t=C(6),n=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function h(_,c){const u=window.open();if(u){try{u.opener=null}catch{}u.location.href=c}else console.warn("Opening link blocked as opener could not be cleared")}y.WebLinksAddon=class{constructor(_=h,c={}){this._handler=_,this._options=c}activate(_){this._terminal=_;const c=this._options,u=c.urlRegex||n;this._linkProvider=this._terminal.registerLinkProvider(new t.WebLinkProvider(this._terminal,u,this._handler,c))}dispose(){var _;(_=this._linkProvider)==null||_.dispose()}}})(),R})())})(di);var ts=di.exports;function xr(l){let i,a,b,C,R,y,t,n,h,_,c,u=l[1].name+"",g,m,f,e=Ar(l[1].size)+"",o,r,s,d,v,S,x,p=l[3]&&Er(l),k=l[2]==="pending"&&Lr(l),A=l[2]==="accepting"&&Dr(),P=l[2]==="completed"&&Rr(l);return{c(){i=T("div"),a=T("div"),b=T("div"),b.innerHTML='<span class="zmodem-download-title">📥 ZMODEM 文件下载</span>',C=K(),R=T("div"),y=T("div"),t=T("div"),n=T("span"),n.textContent="📄",h=K(),_=T("div"),c=T("span"),g=ie(u),m=K(),f=T("span"),o=ie(e),r=ie(" 字节"),s=K(),d=T("div"),p&&p.c(),v=K(),k&&k.c(),S=K(),A&&A.c(),x=K(),P&&P.c(),w(b,"class","zmodem-download-header"),w(n,"class","zmodem-download-icon"),w(c,"class","zmodem-download-name"),w(f,"class","zmodem-download-size"),w(_,"class","zmodem-download-details"),w(t,"class","zmodem-download-file"),w(y,"class","zmodem-download-info"),w(d,"class","zmodem-download-actions"),w(R,"class","zmodem-download-body"),w(a,"class","zmodem-download-content"),w(i,"class","zmodem-download-modal")},m(I,M){ee(I,i,M),E(i,a),E(a,b),E(a,C),E(a,R),E(R,y),E(y,t),E(t,n),E(t,h),E(t,_),E(_,c),E(c,g),E(_,m),E(_,f),E(f,o),E(f,r),E(R,s),E(R,d),p&&p.m(d,null),E(d,v),k&&k.m(d,null),E(d,S),A&&A.m(d,null),E(d,x),P&&P.m(d,null)},p(I,M){M[0]&2&&u!==(u=I[1].name+"")&&de(g,u),M[0]&2&&e!==(e=Ar(I[1].size)+"")&&de(o,e),I[3]?p?p.p(I,M):(p=Er(I),p.c(),p.m(d,v)):p&&(p.d(1),p=null),I[2]==="pending"?k?k.p(I,M):(k=Lr(I),k.c(),k.m(d,S)):k&&(k.d(1),k=null),I[2]==="accepting"?A||(A=Dr(),A.c(),A.m(d,x)):A&&(A.d(1),A=null),I[2]==="completed"?P?P.p(I,M):(P=Rr(I),P.c(),P.m(d,null)):P&&(P.d(1),P=null)},d(I){I&&$(i),p&&p.d(),k&&k.d(),A&&A.d(),P&&P.d()}}}function Er(l){let i,a,b;return{c(){i=T("div"),a=ie("❌ "),b=ie(l[3]),w(i,"class","zmodem-error-message")},m(C,R){ee(C,i,R),E(i,a),E(i,b)},p(C,R){R[0]&8&&de(b,C[3])},d(C){C&&$(i)}}}function Lr(l){let i,a,b,C,R,y,t,n;return{c(){i=T("p"),i.textContent="服务器正在发送文件，是否接收？",a=K(),b=T("div"),C=T("button"),C.textContent="拒绝",R=K(),y=T("button"),y.textContent="接收文件",w(i,"class","zmodem-download-prompt"),w(C,"class","zmodem-download-btn zmodem-btn-reject"),w(y,"class","zmodem-download-btn zmodem-btn-accept"),w(b,"class","zmodem-download-buttons")},m(h,_){ee(h,i,_),ee(h,a,_),ee(h,b,_),E(b,C),E(b,R),E(b,y),t||(n=[se(C,"click",l[6]),se(y,"click",l[5])],t=!0)},p:Se,d(h){h&&($(i),$(a),$(b)),t=!1,ye(n)}}}function Dr(l){let i;return{c(){i=T("div"),i.innerHTML='<span class="zmodem-spinner"></span> <span>正在接收文件...</span>',w(i,"class","zmodem-downloading")},m(a,b){ee(a,i,b)},d(a){a&&$(i)}}}function Rr(l){let i,a,b,C,R,y=(l[4]||l[1].name)+"",t;return{c(){i=T("div"),a=T("span"),a.textContent="✓",b=K(),C=T("span"),R=ie("文件接收完成，已保存到："),t=ie(y),w(a,"class","zmodem-success-icon"),w(i,"class","zmodem-completed")},m(n,h){ee(n,i,h),E(i,a),E(i,b),E(i,C),E(C,R),E(C,t)},p(n,h){h[0]&18&&y!==(y=(n[4]||n[1].name)+"")&&de(t,y)},d(n){n&&$(i)}}}function rs(l){let i,a,b,C=l[1]&&xr(l);return{c(){i=T("div"),i.innerHTML="",a=K(),C&&C.c(),b=kt(),w(i,"class","terminal-container svelte-14g4vw6")},m(R,y){ee(R,i,y),l[16](i),ee(R,a,y),C&&C.m(R,y),ee(R,b,y)},p(R,y){R[1]?C?C.p(R,y):(C=xr(R),C.c(),C.m(b.parentNode,b)):C&&(C.d(1),C=null)},i:Se,o:Se,d(R){R&&($(i),$(a),$(b)),l[16](null),C&&C.d(R)}}}function is(l,i){try{const a=new Blob([l],{type:"application/octet-stream"}),b=window.URL.createObjectURL(a),C=document.createElement("a");C.href=b,C.download=i,document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(b),console.log("文件已保存:",i)}catch(a){console.error("保存文件失败:",a),alert("保存文件失败: "+a.message)}}function ss(l){let i="";for(let a=0;a<l.length;a++)i+=String.fromCharCode(l[a]);return i}async function ns(l){const i=[];let a=0;for await(const R of l)i.push(R),a+=R.length;const b=new Uint8Array(a);let C=0;for(const R of i)b.set(R,C),C+=R.length;return b}async function os(l,i){const a=await ns(l),{SaveBinaryFile:b}=window.wailsBindings||{};if(typeof b=="function"){const C=btoa(ss(a));return await b(i,C)}return is(a,i),null}function Ar(l){return l?l<1024?l+" B":l<1024*1024?(l/1024).toFixed(2)+" KB":l<1024*1024*1024?(l/(1024*1024)).toFixed(2)+" MB":(l/(1024*1024*1024)).toFixed(2)+" GB":"0 B"}function as(l,i,a){let{sessionId:b=null}=i,{onData:C=null}=i,{onResize:R=null}=i,{onZModemTransfer:y=null}=i,t,n,h,_=null,c=null,u=null,g=!1,m=null,f=!1,e=null,o="pending",r=null,s=null,d=null,v=xi(Ut);const S={background:"#1e1e1e",foreground:"#d4d4d4",cursor:"#d4d4d4",black:"#000000",red:"#cd3131",green:"#0dbc79",yellow:"#e5e510",blue:"#2472c8",magenta:"#bc3fbc",cyan:"#11a8cd",white:"#e5e5e5",brightBlack:"#666666",brightRed:"#f14c4c",brightGreen:"#23d18b",brightYellow:"#f5f543",brightBlue:"#3b8eea",brightMagenta:"#d670d6",brightCyan:"#29b8db",selectionBackground:"rgba(2, 136, 209, 0.3)",selectionForeground:void 0,selectionInactiveBackground:"rgba(2, 136, 209, 0.15)"},x={background:"#ffffff",foreground:"#333333",cursor:"#333333",black:"#000000",red:"#cd3131",green:"#00bc00",yellow:"#949800",blue:"#0451a5",magenta:"#bc05bc",cyan:"#0598bc",white:"#555555",brightBlack:"#666666",brightRed:"#cd3131",brightGreen:"#14ce14",brightYellow:"#b5ba00",brightBlue:"#0451a5",brightMagenta:"#bc05bc",brightCyan:"#0598bc",brightWhite:"#a5a5a5",selectionBackground:"rgba(225, 245, 254, 0.8)",selectionForeground:void 0,selectionInactiveBackground:"rgba(225, 245, 254, 0.5)"},p=Ut.subscribe(N=>{v=N,n&&(n.options.theme=v==="light"?x:S)});Rt(async()=>{n=new $i.Terminal({cursorBlink:!0,fontSize:14,fontFamily:'Menlo, Monaco, "Courier New", monospace',theme:v==="light"?x:S,allowProposedApi:!0,scrollback:1e3,convertEol:!1}),h=new es.FitAddon,n.loadAddon(h),n.loadAddon(new ts.WebLinksAddon),n.open(t),h.fit();try{const G=await ei(()=>import("./index2.js").then(V=>V.i),[]);_=G.default||G,c=new _.Sentry({to_terminal:V=>{n&&n.write(new Uint8Array(V))},sender:V=>{if(b){if(y){y(b,new Uint8Array(V));return}if(C){let j="";for(let B=0;B<V.length;B++)j+=String.fromCharCode(V[B]);C(b,j)}}},on_detect:V=>{if(console.log("ZMODEM detected:",V.type),console.log("Detection object:",V),u=V.confirm(),console.log("ZMODEM confirmed, type:",u.type,"has zsession:",!!u),!u){console.error("ERROR: zsession is null after confirm()");return}f=!0,n&&(n.options.disableStdin=!0),u.type==="receive"?(console.log("Calling handleZModemReceive for download"),I(u)):(console.log("Calling handleZModemSend for upload"),q(u))},on_retract:()=>{console.log("ZMODEM retracted"),u=null}}),console.log("ZMODEM initialized successfully")}catch(G){console.error("Failed to initialize ZMODEM:",G)}n.onData(G=>{C&&b&&C(b,G)}),n.onResize(({cols:G,rows:V})=>{R&&b&&R(b,G,V)});const N=new ResizeObserver(()=>{h.fit()});return N.observe(t),()=>{N.disconnect()}}),Nt(()=>{p&&p(),n&&n.dispose()});function k(N){d||(d=document.createElement("div"),d.className="zmodem-progress-modal",d.innerHTML=`
      <div class="zmodem-progress-content">
        <div class="zmodem-progress-header">
          <span>ZMODEM 文件传输</span>
        </div>
        <div class="zmodem-progress-body">
          <div class="zmodem-progress-item">
            <span id="zmodem-file-name">准备传输...</span>
            <div class="zmodem-progress-bar-container">
              <div class="zmodem-progress-bar" id="zmodem-progress-bar"></div>
            </div>
            <span id="zmodem-progress-text">0%</span>
          </div>
          <div class="zmodem-progress-details">
            <span id="zmodem-files-progress">1 / ${N}</span>
          </div>
        </div>
      </div>
    `,document.body.appendChild(d))}function A(N,G,V,j,B){if(!d)return;const D=Math.min(100,Math.round(j/B*100));document.getElementById("zmodem-file-name").textContent=`正在上传: ${V}`,document.getElementById("zmodem-progress-bar").style.width=`${D}%`,document.getElementById("zmodem-progress-text").textContent=`${D}%`,document.getElementById("zmodem-files-progress").textContent=`${N+1} / ${G}`}function P(){d&&(document.body.removeChild(d),d=null)}function I(N){a(1,e=null),m=null,a(2,o="pending"),a(3,r=null),a(4,s=null),N.on("offer",G=>{const V=G.get_details();m=G,a(1,e=V),a(2,o="pending"),a(3,r=null),a(4,s=null)}),N.on("session_end",()=>{m=null,u=null,f=!1,n&&(n.options.disableStdin=!1),o==="accepting"?(a(2,o="completed"),setTimeout(()=>{a(1,e=null),a(2,o="pending"),a(4,s=null)},1500)):(a(1,e=null),a(2,o="pending"),a(4,s=null))}),N.start()}async function M(){if(m){a(2,o="accepting"),a(3,r=null);try{await m.accept();const N=m.get_payloads(),G=m.get_details().name;a(4,s=await os(N,G)),m=null,a(2,o="completed")}catch(N){console.error("接收文件失败:",N),a(3,r=N.message||String(N)),a(2,o="pending")}}}function z(){m&&m.skip(),m=null,a(1,e=null),a(2,o="pending"),a(3,r=null),a(4,s=null)}async function q(N){console.log("handleZModemSend called, session:",N);const G=document.createElement("input");return G.type="file",G.multiple=!0,new Promise(V=>{G.onchange=async j=>{const B=Array.from(j.target.files);if(console.log("Files selected:",B.length,B.map(D=>D.name)),B.length===0){console.log("No files selected, closing session"),N.close(),g=!1,V();return}try{k(B.length),console.log("Starting to send files...");for(let D=0;D<B.length;D++){const U=B[D],W={name:U.name,size:U.size,mtime:new Date(U.lastModified)};console.log(`Sending file ${D+1}/${B.length}:`,U.name,U.size),await Y(N,U,W,D,B.length)}console.log("All files sent, closing session"),await N.close(),setTimeout(()=>{g=!1,P(),f=!1,n&&(n.options.disableStdin=!1),V()},500)}catch(D){console.error("发送文件失败:",D),console.error("Error details:",D.stack),N.close(),g=!1,P(),f=!1,n&&(n.options.disableStdin=!1),V()}},G.click()})}async function Y(N,G,V,j,B){return new Promise((D,U)=>{N.send_offer(V).then(W=>{if(!W){D();return}const J=new FileReader,X=8192;J.onload=te=>{const re=te.target.result;let ae=0,ue=0;function oe(){if(ae<re.byteLength){const he=new Uint8Array(re,ae,Math.min(X,re.byteLength-ae));W.send(he),ae+=X,ue+=he.byteLength,A(j,B,G.name,ue,G.size),setTimeout(oe,0)}else W.end().then(D).catch(U)}oe()},J.onerror=()=>{U(new Error("读取文件失败"))},J.readAsArrayBuffer(G)})})}function Z(N){if(!n)return;let G;if(typeof N=="string"?G=new Uint8Array(N.split("").map(V=>V.charCodeAt(0))):N instanceof Uint8Array?G=N:G=new Uint8Array(N),c&&!g)try{c.consume(G);return}catch(V){console.warn("ZMODEM consume failed:",V),u=null,m=null,f=!1,g=!1,n&&(n.options.disableStdin=!1)}n.write(G)}function Q(N){n&&n.writeln(N)}function L(){n&&n.clear()}function O(){n&&n.focus()}function H(){return n?{cols:n.cols,rows:n.rows}:{cols:80,rows:24}}function F(N){Xe[N?"unshift":"push"](()=>{t=N,a(0,t)})}return l.$$set=N=>{"sessionId"in N&&a(7,b=N.sessionId),"onData"in N&&a(8,C=N.onData),"onResize"in N&&a(9,R=N.onResize),"onZModemTransfer"in N&&a(10,y=N.onZModemTransfer)},[t,e,o,r,s,M,z,b,C,R,y,Z,Q,L,O,H,F]}class ls extends nt{constructor(i){super(),st(this,i,as,rs,Ze,{sessionId:7,onData:8,onResize:9,onZModemTransfer:10,write:11,writeln:12,clear:13,focus:14,getSize:15},null,[-1,-1])}get write(){return this.$$.ctx[11]}get writeln(){return this.$$.ctx[12]}get clear(){return this.$$.ctx[13]}get focus(){return this.$$.ctx[14]}get getSize(){return this.$$.ctx[15]}}function Br(l){let i,a,b,C,R,y,t,n,h,_,c,u,g,m;const f=l[6].default,e=Ei(f,l,l[5],null);return{c(){i=T("div"),a=T("div"),b=K(),C=T("div"),R=T("div"),y=T("h2"),t=ie(l[2]),n=K(),h=T("button"),h.innerHTML='<svg class="w-5 h-5 text-gray-500 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',_=K(),c=T("div"),e&&e.c(),w(a,"class","absolute inset-0 bg-black/20 backdrop-blur-sm transition-opacity pointer-events-auto"),w(y,"class","text-base font-semibold text-gray-900 dark:text-white"),w(h,"class","p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"),w(R,"class","flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700"),w(c,"class","flex-1 overflow-y-auto p-6"),w(C,"class","relative w-full max-w-xs bg-white dark:bg-gray-800 rounded-xl shadow-2xl m-4 max-h-[90vh] overflow-hidden flex flex-col transform transition-all"),w(i,"class","fixed inset-0 z-50 flex items-center justify-center"),w(i,"role","dialog"),w(i,"aria-modal","true")},m(o,r){ee(o,i,r),E(i,a),E(i,b),E(i,C),E(C,R),E(R,y),E(y,t),E(R,n),E(R,h),E(C,_),E(C,c),e&&e.m(c,null),u=!0,g||(m=[se(h,"click",function(){dt(l[1])&&l[1].apply(this,arguments)}),se(i,"click",l[3])],g=!0)},p(o,r){l=o,(!u||r&4)&&de(t,l[2]),e&&e.p&&(!u||r&32)&&Di(e,f,l,l[5],u?Li(f,l[5],r,null):Ri(l[5]),null)},i(o){u||(Te(e,o),u=!0)},o(o){Fe(e,o),u=!1},d(o){o&&$(i),e&&e.d(o),g=!1,ye(m)}}}function cs(l){let i,a,b=l[0]&&Br(l);return{c(){b&&b.c(),i=kt()},m(C,R){b&&b.m(C,R),ee(C,i,R),a=!0},p(C,[R]){C[0]?b?(b.p(C,R),R&1&&Te(b,1)):(b=Br(C),b.c(),Te(b,1),b.m(i.parentNode,i)):b&&(tr(),Fe(b,1,1,()=>{b=null}),rr())},i(C){a||(Te(b),a=!0)},o(C){Fe(b),a=!1},d(C){C&&$(i),b&&b.d(C)}}}function hs(l,i,a){let{$$slots:b={},$$scope:C}=i,{isOpen:R=!1}=i,{onClose:y=()=>{}}=i,{title:t=""}=i,{size:n="md"}=i;function h(c){c.target===c.currentTarget&&y()}function _(c){c.key==="Escape"&&R&&y()}return l.$$set=c=>{"isOpen"in c&&a(0,R=c.isOpen),"onClose"in c&&a(1,y=c.onClose),"title"in c&&a(2,t=c.title),"size"in c&&a(4,n=c.size),"$$scope"in c&&a(5,C=c.$$scope)},l.$$.update=()=>{l.$$.dirty&1&&(R?document.addEventListener("keydown",_):document.removeEventListener("keydown",_))},[R,y,t,h,n,C,b]}class ui extends nt{constructor(i){super(),st(this,i,hs,cs,Ze,{isOpen:0,onClose:1,title:2,size:4})}}function ds(l){let i,a,b,C,R,y,t,n,h,_,c,u,g;return{c(){i=T("div"),a=T("p"),b=ie(l[2]),C=K(),R=T("div"),y=T("button"),t=ie(l[4]),n=K(),h=T("button"),_=ie(l[3]),w(a,"class","text-sm text-gray-700 dark:text-gray-300 leading-relaxed"),w(y,"type","button"),w(y,"class","px-3 py-1.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md text-xs font-medium transition-colors"),w(h,"type","button"),w(h,"class",c="px-3 py-1.5 rounded-md text-xs font-medium transition-all shadow-sm "+(l[7]==="danger"?"bg-red-600 hover:bg-red-700 text-white":l[7]==="warning"?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-purple-600 hover:bg-purple-700 text-white")),w(R,"class","flex gap-2 pt-2"),w(i,"class","space-y-4")},m(m,f){ee(m,i,f),E(i,a),E(a,b),E(i,C),E(i,R),E(R,y),E(y,t),E(R,n),E(R,h),E(h,_),u||(g=[se(y,"click",function(){dt(l[6])&&l[6].apply(this,arguments)}),se(h,"click",function(){dt(l[5])&&l[5].apply(this,arguments)})],u=!0)},p(m,f){l=m,f&4&&de(b,l[2]),f&16&&de(t,l[4]),f&8&&de(_,l[3]),f&128&&c!==(c="px-3 py-1.5 rounded-md text-xs font-medium transition-all shadow-sm "+(l[7]==="danger"?"bg-red-600 hover:bg-red-700 text-white":l[7]==="warning"?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-purple-600 hover:bg-purple-700 text-white"))&&w(h,"class",c)},d(m){m&&$(i),u=!1,ye(g)}}}function us(l){let i,a,b;function C(y){l[8](y)}let R={onClose:l[6],title:l[1],size:"sm",$$slots:{default:[ds]},$$scope:{ctx:l}};return l[0]!==void 0&&(R.isOpen=l[0]),i=new ui({props:R}),Xe.push(()=>Ct(i,"isOpen",C)),{c(){rt(i.$$.fragment)},m(y,t){Ge(i,y,t),b=!0},p(y,[t]){const n={};t&64&&(n.onClose=y[6]),t&2&&(n.title=y[1]),t&764&&(n.$$scope={dirty:t,ctx:y}),!a&&t&1&&(a=!0,n.isOpen=y[0],yt(()=>a=!1)),i.$set(n)},i(y){b||(Te(i.$$.fragment,y),b=!0)},o(y){Fe(i.$$.fragment,y),b=!1},d(y){Je(i,y)}}}function fs(l,i,a){let{isOpen:b=!1}=i,{title:C=""}=i,{message:R=""}=i,{confirmText:y="确定"}=i,{cancelText:t="取消"}=i,{onConfirm:n=()=>{}}=i,{onCancel:h=()=>{}}=i,{type:_="default"}=i;function c(u){b=u,a(0,b)}return l.$$set=u=>{"isOpen"in u&&a(0,b=u.isOpen),"title"in u&&a(1,C=u.title),"message"in u&&a(2,R=u.message),"confirmText"in u&&a(3,y=u.confirmText),"cancelText"in u&&a(4,t=u.cancelText),"onConfirm"in u&&a(5,n=u.onConfirm),"onCancel"in u&&a(6,h=u.onCancel),"type"in u&&a(7,_=u.type)},[b,C,R,y,t,n,h,_,c]}class _s extends nt{constructor(i){super(),st(this,i,fs,us,Ze,{isOpen:0,title:1,message:2,confirmText:3,cancelText:4,onConfirm:5,onCancel:6,type:7})}}function ps(l,i,a){return window.runtime.EventsOnMultiple(l,i,a)}function Qt(l,i){return ps(l,i,-1)}const{Map:fi}=Ai;function Mr(l,i,a){const b=l.slice();return b[40]=i[a],b[41]=i,b[42]=a,b}function Tr(l,i,a){const b=l.slice();return b[40]=i[a],b}function gs(l){let i=[],a=new fi,b,C=Ve(l[1]);const R=y=>y[40].sessionId;for(let y=0;y<C.length;y+=1){let t=Tr(l,C,y),n=R(t);a.set(n,i[y]=Or(n,t))}return{c(){for(let y=0;y<i.length;y+=1)i[y].c();b=kt()},m(y,t){for(let n=0;n<i.length;n+=1)i[n]&&i[n].m(y,t);ee(y,b,t)},p(y,t){t[0]&29666&&(C=Ve(y[1]),i=At(i,t,R,1,y,C,a,b.parentNode,jt,Or,b,Tr))},d(y){y&&$(b);for(let t=0;t<i.length;t+=1)i[t].d(y)}}}function vs(l){let i;return{c(){i=T("div"),i.textContent="没有活动连接",w(i,"class","px-4 py-2.5 text-sm text-gray-500 dark:text-gray-400")},m(a,b){ee(a,i,b)},p:Se,d(a){a&&$(i)}}}function ms(l){let i,a=(l[40].tabName||l[40].connection.name)+"",b;return{c(){i=T("span"),b=ie(a),w(i,"class","text-sm font-medium truncate flex-1")},m(C,R){ee(C,i,R),E(i,b)},p(C,R){R[0]&2&&a!==(a=(C[40].tabName||C[40].connection.name)+"")&&de(b,a)},d(C){C&&$(i)}}}function bs(l){let i,a,b;return{c(){i=T("input"),w(i,"type","text"),w(i,"class","flex-1 bg-transparent text-sm outline-none px-1"),w(i,"focus","")},m(C,R){ee(C,i,R),pe(i,l[6]),a||(b=[se(i,"input",l[24]),se(i,"blur",l[13]),se(i,"keydown",l[14])],a=!0)},p(C,R){R[0]&64&&i.value!==C[6]&&pe(i,C[6])},d(C){C&&$(i),a=!1,ye(b)}}}function Or(l,i){let a,b,C,R,y,t,n,h,_,c;function u(r,s){return r[5]===r[40].sessionId?bs:ms}let g=u(i),m=g(i);function f(...r){return i[25](i[40],...r)}function e(){return i[26](i[40])}function o(){return i[27](i[40])}return{key:l,first:null,c(){a=T("div"),b=T("div"),R=K(),m.c(),y=K(),t=T("button"),t.innerHTML='<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',n=K(),w(b,"class",C=_r(`w-2 h-2 rounded-full flex-shrink-0 ${i[40].connected?"bg-green-500":"bg-gray-400 dark:bg-gray-600"}`)+" svelte-1v9xg5l"),w(t,"class","opacity-0 group-hover:opacity-100 p-0.5 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-opacity"),w(a,"class",h="group flex items-center gap-2 px-4 py-2.5 border-r border-gray-200 dark:border-gray-700 cursor-pointer transition-all min-w-[180px] "+(i[7]===i[40].sessionId?"bg-white dark:bg-gray-800 text-gray-900 dark:text-white border-b-2 border-b-purple-600":"bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600")),this.first=a},m(r,s){ee(r,a,s),E(a,b),E(a,R),m.m(a,null),E(a,y),E(a,t),E(a,n),_||(c=[se(t,"click",f),se(a,"click",e),se(a,"dblclick",o)],_=!0)},p(r,s){i=r,s[0]&2&&C!==(C=_r(`w-2 h-2 rounded-full flex-shrink-0 ${i[40].connected?"bg-green-500":"bg-gray-400 dark:bg-gray-600"}`)+" svelte-1v9xg5l")&&w(b,"class",C),g===(g=u(i))&&m?m.p(i,s):(m.d(1),m=g(i),m&&(m.c(),m.m(a,y))),s[0]&130&&h!==(h="group flex items-center gap-2 px-4 py-2.5 border-r border-gray-200 dark:border-gray-700 cursor-pointer transition-all min-w-[180px] "+(i[7]===i[40].sessionId?"bg-white dark:bg-gray-800 text-gray-900 dark:text-white border-b-2 border-b-purple-600":"bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"))&&w(a,"class",h)},d(r){r&&$(a),m.d(),_=!1,ye(c)}}}function Ss(l){let i;return{c(){i=T("div"),i.innerHTML='<div class="text-center"><div class="text-lg font-medium mb-2 text-gray-700 dark:text-gray-300">未选择连接</div> <div class="text-sm text-gray-500 dark:text-gray-400">从左侧资产列表选择一个服务器开始连接</div></div>',w(i,"class","flex-1 flex items-center justify-center text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800")},m(a,b){ee(a,i,b)},p:Se,i:Se,o:Se,d(a){a&&$(i)}}}function ws(l){let i,a=[],b=new fi,C,R=Ve(l[1]);const y=t=>t[40].sessionId;for(let t=0;t<R.length;t+=1){let n=Mr(l,R,t),h=y(n);b.set(h,a[t]=Pr(h,n))}return{c(){i=T("div");for(let t=0;t<a.length;t+=1)a[t].c();w(i,"class","terminal-content-area relative flex-1 flex flex-col svelte-1v9xg5l")},m(t,n){ee(t,i,n);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(i,null);C=!0},p(t,n){n[0]&1835139&&(R=Ve(t[1]),tr(),a=At(a,n,y,1,t,R,b,i,Fi,Pr,null,Mr),rr())},i(t){if(!C){for(let n=0;n<R.length;n+=1)Te(a[n]);C=!0}},o(t){for(let n=0;n<a.length;n+=1)Fe(a[n]);C=!1},d(t){t&&$(i);for(let n=0;n<a.length;n+=1)a[n].d()}}}function ys(l){let i=l[40].connection.username+"",a,b,C=l[40].connection.host+"",R,y,t=l[40].connection.port+"",n;return{c(){a=ie(i),b=ie("@"),R=ie(C),y=ie(":"),n=ie(t)},m(h,_){ee(h,a,_),ee(h,b,_),ee(h,R,_),ee(h,y,_),ee(h,n,_)},p(h,_){_[0]&2&&i!==(i=h[40].connection.username+"")&&de(a,i),_[0]&2&&C!==(C=h[40].connection.host+"")&&de(R,C),_[0]&2&&t!==(t=h[40].connection.port+"")&&de(n,t)},d(h){h&&($(a),$(b),$(R),$(y),$(n))}}}function Cs(l){let i,a=l[40].connection.name!=="Local Shell"?` (${l[40].connection.name})`:"",b;return{c(){i=ie("本地终端"),b=ie(a)},m(C,R){ee(C,i,R),ee(C,b,R)},p(C,R){R[0]&2&&a!==(a=C[40].connection.name!=="Local Shell"?` (${C[40].connection.name})`:"")&&de(b,a)},d(C){C&&($(i),$(b))}}}function Pr(l,i){let a,b,C,R,y,t,n,h,_=i[40],c,u,g;function m(d,v){return d[40].type==="local"?Cs:ys}let f=m(i),e=f(i);const o=()=>i[28](h,_),r=()=>i[28](null,_);let s={sessionId:i[40].sessionId,onData:i[18],onResize:i[20],onZModemTransfer:i[19]};return h=new ls({props:s}),o(),{key:l,first:null,c(){a=T("div"),b=T("div"),C=T("div"),e.c(),R=K(),y=T("div"),y.innerHTML='<button class="p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors" title="复制"><svg class="w-4 h-4 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 01-2 2z"></path></svg></button> <button class="p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors" title="最小化"><svg class="w-4 h-4 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path></svg></button> <button class="p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors" title="最大化"><svg class="w-4 h-4 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 4l-5 5M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-6 0a2 2 0 00-2 2v4a2 2 0 002 2m0 0v4a2 2 0 002 2v-4a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 01-2 2z"></path></svg></button>',t=K(),n=T("div"),rt(h.$$.fragment),c=K(),w(C,"class","text-sm text-gray-600 dark:text-gray-400 font-mono"),w(y,"class","flex items-center gap-1"),w(b,"class","flex items-center justify-between px-4 py-2.5 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700"),w(n,"class","flex-1 overflow-hidden"),w(a,"class",u="terminal-wrapper "+(i[7]===i[40].sessionId?"active":"inactive")+" svelte-1v9xg5l"),this.first=a},m(d,v){ee(d,a,v),E(a,b),E(b,C),e.m(C,null),E(b,R),E(b,y),E(a,t),E(a,n),Ge(h,n,null),E(a,c),g=!0},p(d,v){i=d,f===(f=m(i))&&e?e.p(i,v):(e.d(1),e=f(i),e&&(e.c(),e.m(C,null))),_!==i[40]&&(r(),_=i[40],o());const S={};v[0]&2&&(S.sessionId=i[40].sessionId),h.$set(S),(!g||v[0]&130&&u!==(u="terminal-wrapper "+(i[7]===i[40].sessionId?"active":"inactive")+" svelte-1v9xg5l"))&&w(a,"class",u)},i(d){g||(Te(h.$$.fragment,d),g=!0)},o(d){Fe(h.$$.fragment,d),g=!1},d(d){d&&$(a),e.d(),r(),Je(h)}}}function Ir(l){let i,a,b,C,R,y,t,n,h,_,c,u,g,m,f,e,o,r,s,d,v,S;return d=Ti(l[31][0]),{c(){i=T("div"),a=T("div"),b=T("div"),b.innerHTML='<h3 class="text-lg font-semibold text-gray-900 dark:text-white">选择 Shell</h3> <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">选择要打开的本地终端类型</p>',C=K(),R=T("div"),y=T("label"),t=T("input"),n=K(),h=T("div"),h.innerHTML='<div class="font-medium text-gray-900 dark:text-white">PowerShell</div> <div class="text-sm text-gray-500 dark:text-gray-400">推荐：更强大的命令行体验</div>',_=K(),c=T("label"),u=T("input"),g=K(),m=T("div"),m.innerHTML='<div class="font-medium text-gray-900 dark:text-white">CMD</div> <div class="text-sm text-gray-500 dark:text-gray-400">传统命令提示符</div>',f=K(),e=T("div"),o=T("button"),o.textContent="取消",r=K(),s=T("button"),s.textContent="确定",w(b,"class","px-6 py-4 border-b border-gray-200 dark:border-gray-700"),w(t,"type","radio"),t.__value="powershell",pe(t,t.__value),w(t,"class","w-4 h-4 text-purple-600"),w(y,"class","flex items-center space-x-3 cursor-pointer"),w(u,"type","radio"),u.__value="cmd",pe(u,u.__value),w(u,"class","w-4 h-4 text-purple-600"),w(c,"class","flex items-center space-x-3 cursor-pointer"),w(R,"class","px-6 py-4 space-y-3"),w(o,"class","px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors"),w(s,"class","px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors font-medium"),w(e,"class","px-6 py-4 bg-gray-50 dark:bg-gray-700/50 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3"),w(a,"class","bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4"),w(i,"class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"),d.p(t,u)},m(x,p){ee(x,i,p),E(i,a),E(a,b),E(a,C),E(a,R),E(R,y),E(y,t),t.checked=t.__value===l[4],E(y,n),E(y,h),E(R,_),E(R,c),E(c,u),u.checked=u.__value===l[4],E(c,g),E(c,m),E(a,f),E(a,e),E(e,o),E(e,r),E(e,s),v||(S=[se(t,"change",l[30]),se(u,"change",l[32]),se(o,"click",l[17]),se(s,"click",l[16])],v=!0)},p(x,p){p[0]&16&&(t.checked=t.__value===x[4]),p[0]&16&&(u.checked=u.__value===x[4])},d(x){x&&$(i),d.r(),v=!1,ye(S)}}}function ks(l){let i,a,b,C,R,y,t,n,h,_,c,u,g,m,f;function e(k,A){return k[1].length===0?vs:gs}let o=e(l),r=o(l);const s=[ws,Ss],d=[];function v(k,A){return k[1].length>0?0:1}y=v(l),t=d[y]=s[y](l);function S(k){l[29](k)}let x={title:"关闭 SSH 会话",message:"确定要关闭此 SSH 会话吗？",type:"warning",confirmText:"确定关闭",cancelText:"取消",onConfirm:l[10],onCancel:l[11]};l[2]!==void 0&&(x.isOpen=l[2]),h=new _s({props:x}),Xe.push(()=>Ct(h,"isOpen",S));let p=l[3]&&Ir(l);return{c(){i=T("div"),a=T("div"),r.c(),b=K(),C=T("button"),C.innerHTML='<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>',R=K(),t.c(),n=K(),rt(h.$$.fragment),c=K(),p&&p.c(),u=kt(),w(C,"class","flex items-center gap-2 px-4 py-2.5 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors min-w-[50px]"),w(C,"title","打开本地终端"),w(a,"class","flex items-center bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 overflow-x-auto"),w(i,"class","h-full flex flex-col bg-white dark:bg-gray-800")},m(k,A){ee(k,i,A),E(i,a),r.m(a,null),E(a,b),E(a,C),E(i,R),d[y].m(i,null),ee(k,n,A),Ge(h,k,A),ee(k,c,A),p&&p.m(k,A),ee(k,u,A),g=!0,m||(f=se(C,"click",l[15]),m=!0)},p(k,A){o===(o=e(k))&&r?r.p(k,A):(r.d(1),r=o(k),r&&(r.c(),r.m(a,b)));let P=y;y=v(k),y===P?d[y].p(k,A):(tr(),Fe(d[P],1,1,()=>{d[P]=null}),rr(),t=d[y],t?t.p(k,A):(t=d[y]=s[y](k),t.c()),Te(t,1),t.m(i,null));const I={};!_&&A[0]&4&&(_=!0,I.isOpen=k[2],yt(()=>_=!1)),h.$set(I),k[3]?p?p.p(k,A):(p=Ir(k),p.c(),p.m(u.parentNode,u)):p&&(p.d(1),p=null)},i(k){g||(Te(t),Te(h.$$.fragment,k),g=!0)},o(k){Fe(t),Fe(h.$$.fragment,k),g=!1},d(k){k&&($(i),$(n),$(c),$(u)),r.d(),d[y].d(),Je(h,k),p&&p.d(k),m=!1,f()}}}function $t(l){let i="";for(let a=0;a<l.length;a++)i+=String.fromCharCode(l[a]);return i}function Hr(l){return btoa($t(l))}function xs(l,i,a){let b,C;it(l,ht,B=>a(7,b=B)),it(l,tt,B=>a(23,C=B));let R={},y=[],t=new Map,n=!1,h=null,_=!1,c="powershell";async function u(B){var Ee;if(console.log("Connecting to:",B),!window.wailsBindings){console.error("Wails bindings not loaded"),alert("Wails 绑定未加载，请使用 wails dev 运行");return}const{ConnectSSH:D,GetPassword:U,HasPassword:W,SavePassword:J}=window.wailsBindings;if(typeof D!="function"){console.error("ConnectSSH not available"),alert("SSH 连接功能不可用");return}let X="",te="";if(B.auth_type==="key")te=prompt(`连接到 ${B.name}
如果 SSH 密钥已加密，请输入 Passphrase（否则留空）：`)||"",X=B.key_path||"";else try{if(typeof W=="function"&&await W(B.id))X=await U(B.id),console.log("Using saved password");else if(X=prompt(`连接到 ${B.name}
请输入密码：`)||"",X&&confirm("是否保存密码以便下次自动连接？")&&typeof J=="function")try{await J(B.id,X),console.log("Password saved successfully")}catch(ve){console.error("Failed to save password:",ve)}}catch(be){console.error("Failed to get saved password:",be),X=prompt(`连接到 ${B.name}
请输入密码：`)||""}if(!X){console.log("Connection cancelled - no auth value provided");return}const re=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;console.log("Connecting to server:",B.host,B.port,B.username,"auth_type:",B.auth_type);const ae={sessionId:re,connection:B,connected:!1,createdAt:Date.now(),lastActivity:Date.now()};tt.update(be=>(be.set(re,ae),be)),ht.set(re),await Jt(),await new Promise(be=>setTimeout(be,50));let ue=(Ee=R[re])==null?void 0:Ee.getSize();if(ue||(ue={cols:80,rows:24},console.warn("Terminal not ready, using default size:",ue)),console.log("Subscribing to events for session:",re),Z(re),await new Promise(be=>setTimeout(be,100)),!R[re]){console.error("Terminal component not ready after delay");return}const oe=R[re];if(!oe){console.error("Failed to get terminal reference for session:",re);return}console.log("Terminal ready, attempting to connect...");const he=B.auth_type==="key"?"SSH key":"password";oe.writeln(`正在连接 ${B.username}@${B.host}:${B.port} (${he})...`),oe.writeln("");try{await D(re,B.host,B.port,B.username,B.auth_type||"password",X,te,ue.cols,ue.rows),ae.connected=!0,tt.update(be=>(be.set(re,ae),be)),setTimeout(()=>{oe.focus()},100)}catch(be){console.error("Failed to connect:",be),oe&&oe.writeln(`\r
连接失败: ${be.message||be}`),await g(re)}}async function g(B){const D=t.get(B);D&&(D(),t.delete(B)),delete R[B];const{CloseSSH:U}=window.wailsBindings||{};if(typeof U=="function")try{await U(B)}catch(J){console.error("Failed to close session:",J)}tt.update(J=>(J.delete(B),J));const W=Array.from(C.keys());b===B&&(W.length>0?ht.set(W[0]):ht.set(null))}function m(B){C.has(B)&&(ht.set(B),setTimeout(()=>{const D=R[B];if(D){D.focus();const U=D.getSize(),{ResizeSSH:W}=window.wailsBindings||{};typeof W=="function"&&W(B,U.cols,U.rows).catch(console.error)}},50))}function f(B,D){D.stopPropagation();const U=C.get(B);U&&(U.connected?(h=B,a(2,n=!0)):g(B))}function e(){h&&(g(h),h=null),a(2,n=!1)}function o(){h=null,a(2,n=!1)}function r(B,D){const U=C.get(B);U&&(U.tabName=D.trim(),tt.update(W=>(W.set(B,U),W)))}let s=null,d="";function v(B){const D=C.get(B);D&&(a(5,s=B),a(6,d=D.tabName||D.connection.name))}function S(){s&&d.trim()&&r(s,d.trim()),a(5,s=null),a(6,d="")}function x(){a(5,s=null),a(6,d="")}function p(B){B.key==="Enter"?S():B.key==="Escape"&&x()}async function k(){if(!window.wailsBindings){console.error("Wails bindings not loaded"),alert("Wails 绑定未加载，请使用 wails dev 运行");return}const{ConnectLocalShell:B,SendSSHData:D,ResizeSSH:U}=window.wailsBindings;if(navigator.platform.toLowerCase().includes("win")){a(3,_=!0);return}await A("")}async function A(B){var te;const{ConnectLocalShell:D}=window.wailsBindings,U=`local_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,W={sessionId:U,connection:{name:"Local Shell",host:"localhost",port:0,username:""},connected:!1,createdAt:Date.now(),lastActivity:Date.now(),tabName:"Local",type:"local"};tt.update(re=>(re.set(U,W),re)),ht.set(U),await Jt(),await new Promise(re=>setTimeout(re,50));let J=(te=R[U])==null?void 0:te.getSize();if(J||(J={cols:80,rows:24},console.warn("Terminal not ready, using default size:",J)),console.log("Subscribing to local events for session:",U),M(U),await new Promise(re=>setTimeout(re,100)),!R[U]){console.error("Terminal component not ready after delay");return}const X=R[U];if(!X){console.error("Failed to get terminal reference for session:",U);return}console.log("Terminal ready, starting local shell..."),X.writeln(`正在启动本地终端${B?` (${B})`:""}...`),X.writeln("");try{await D(U,B,J.cols,J.rows),W.connected=!0,tt.update(re=>(re.set(U,W),re)),setTimeout(()=>{X.focus()},100)}catch(re){console.error("Failed to start local shell:",re),X&&X.writeln(`\r
启动本地终端失败: ${re.message||re}`),await g(U)}}function P(){a(3,_=!1),A(c)}function I(){a(3,_=!1)}function M(B){const D=`local:output:${B}`,U=Qt(D,W=>{const J=R[B];if(J){const X=atob(W),te=new Uint8Array(X.length);for(let re=0;re<X.length;re++)te[re]=X.charCodeAt(re);J.write(te)}});t.set(B,U)}function z(B,D){if(!C.has(B))return;const U=C.get(B),{SendSSHData:W,SendLocalShellData:J}=window.wailsBindings||{};U&&U.type==="local"?typeof J=="function"&&J(B,D).catch(X=>{console.error("Failed to send local shell data:",X)}):typeof W=="function"&&W(B,D).catch(X=>{console.error("Failed to send SSH data:",X)})}function q(B,D){if(!C.has(B))return;const U=C.get(B),{SendSSHData:W,SendSSHDataBinary:J,SendLocalShellData:X,SendLocalShellDataBinary:te}=window.wailsBindings||{};if(U&&U.type==="local"){if(typeof te=="function"){const re=Hr(D);te(B,re).catch(ae=>{console.error("Failed to send local shell binary data:",ae)})}else if(typeof X=="function"){const re=$t(D);X(B,re).catch(ae=>{console.error("Failed to send local shell data:",ae)})}}else if(typeof J=="function"){const re=Hr(D);J(B,re).catch(ae=>{console.error("Failed to send SSH binary data:",ae)})}else if(typeof W=="function"){const re=$t(D);W(B,re).catch(ae=>{console.error("Failed to send SSH data:",ae)})}}function Y(B,D,U){if(!C.has(B))return;const W=C.get(B),{ResizeSSH:J,ResizeLocalShell:X}=window.wailsBindings||{};W&&W.type==="local"?typeof X=="function"&&X(B,D,U).catch(te=>{console.error("Failed to resize local terminal:",te)}):typeof J=="function"&&J(B,D,U).catch(te=>{console.error("Failed to resize SSH terminal:",te)})}function Z(B){const D=`ssh:output:${B}`,U=Qt(D,W=>{const J=R[B];if(J){const X=atob(W),te=new Uint8Array(X.length);for(let re=0;re<X.length;re++)te[re]=X.charCodeAt(re);J.write(te)}});t.set(B,U)}Nt(()=>{t.forEach(B=>{B()})}),Rt(async()=>{window.wailsBindings&&console.log("Wails bindings already loaded"),window.terminalRefs=R,window.sessionUnsubscribers||(window.sessionUnsubscribers=t),console.log("TerminalPanel mounted, subscribing to events for sessions:",y),await Jt(),b&&R[b]&&setTimeout(()=>{R[b].focus()},100)});const Q=[[]];function L(){d=this.value,a(6,d)}const O=(B,D)=>f(B.sessionId,D),H=B=>m(B.sessionId),F=B=>v(B.sessionId);function N(B,D){Xe[B?"unshift":"push"](()=>{R[D.sessionId]=B,a(0,R)})}function G(B){n=B,a(2,n)}function V(){c=this.__value,a(4,c)}function j(){c=this.__value,a(4,c)}return l.$$.update=()=>{l.$$.dirty[0]&8388608&&a(1,y=C?Array.from(C.values()):[]),l.$$.dirty[0]&1&&window.terminalRefs!==void 0&&(window.terminalRefs=R)},[R,y,n,_,c,s,d,b,m,f,e,o,v,S,p,k,P,I,z,q,Y,u,Z,C,L,O,H,F,N,G,V,Q,j]}class Es extends nt{constructor(i){super(),st(this,i,xs,ks,Ze,{handleConnect:21,subscribeToOutput:22},null,[-1,-1])}get handleConnect(){return this.$$.ctx[21]}get subscribeToOutput(){return this.$$.ctx[22]}}function Ls(l){return window.go.main.App.AddConnection(l)}function Ds(l){return window.go.main.App.CancelTransfer(l)}function Rs(l,i){return window.go.main.App.ChangeDirectory(l,i)}function As(l){return window.go.main.App.CloseSSH(l)}function Bs(l,i,a,b){return window.go.main.App.ConnectLocalShell(l,i,a,b)}function Ms(l,i,a,b,C,R,y,t,n){return window.go.main.App.ConnectSSH(l,i,a,b,C,R,y,t,n)}function Ts(l,i){return window.go.main.App.CreateDirectory(l,i)}function Os(l,i){return window.go.main.App.DeleteFile(l,i)}function Ps(l,i){return window.go.main.App.DeleteFiles(l,i)}function Is(l){return window.go.main.App.DeletePassword(l)}function Hs(l,i,a){return window.go.main.App.DownloadFile(l,i,a)}function _i(l,i,a){return window.go.main.App.DownloadFiles(l,i,a)}function Fs(l){return window.go.main.App.EscapeJSON(l)}function Ws(l){return window.go.main.App.FormatJSON(l)}function zs(l){return window.go.main.App.GetConnection(l)}function Us(){return window.go.main.App.GetConnections()}function Ns(l){return window.go.main.App.GetCurrentPath(l)}function js(l,i){return window.go.main.App.GetFileInfo(l,i)}function Ks(l){return window.go.main.App.GetMonitoringData(l)}function qs(l){return window.go.main.App.GetPassword(l)}function Vs(){return window.go.main.App.GetSettings()}function Gs(l){return window.go.main.App.GetTransferStatus(l)}function Js(l){return window.go.main.App.Greet(l)}function Xs(l){return window.go.main.App.HasPassword(l)}function pi(l,i){return window.go.main.App.ListFiles(l,i)}function Zs(){return window.go.main.App.ListSSHSessions()}function Ys(l){return window.go.main.App.MinifyJSON(l)}function Qs(l){return window.go.main.App.RemoveConnection(l)}function $s(l,i,a){return window.go.main.App.RenameFile(l,i,a)}function en(l,i,a){return window.go.main.App.ResizeLocalShell(l,i,a)}function tn(l,i,a){return window.go.main.App.ResizeSSH(l,i,a)}function rn(l,i){return window.go.main.App.SaveBinaryFile(l,i)}function sn(l,i){return window.go.main.App.SavePassword(l,i)}function gi(){return window.go.main.App.SelectDownloadDirectory()}function nn(){return window.go.main.App.SelectSSHKeyFile()}function vi(){return window.go.main.App.SelectUploadFiles()}function on(l,i){return window.go.main.App.SendLocalShellData(l,i)}function an(l,i){return window.go.main.App.SendLocalShellDataBinary(l,i)}function ln(l,i){return window.go.main.App.SendSSHData(l,i)}function cn(l,i){return window.go.main.App.SendSSHDataBinary(l,i)}function hn(l,i){return window.go.main.App.ShowErrorDialog(l,i)}function dn(l,i){return window.go.main.App.ShowMessageDialog(l,i)}function un(l,i){return window.go.main.App.ShowQuestionDialog(l,i)}function fn(l,i,a,b,C,R){return window.go.main.App.TestConnection(l,i,a,b,C,R)}function _n(l){return window.go.main.App.UpdateConnection(l)}function pn(l){return window.go.main.App.UpdateSettings(l)}function gn(l,i,a){return window.go.main.App.UploadFile(l,i,a)}function mi(l,i,a){return window.go.main.App.UploadFiles(l,i,a)}function vn(l){return window.go.main.App.ValidateJSON(l)}const mn=Object.freeze(Object.defineProperty({__proto__:null,AddConnection:Ls,CancelTransfer:Ds,ChangeDirectory:Rs,CloseSSH:As,ConnectLocalShell:Bs,ConnectSSH:Ms,CreateDirectory:Ts,DeleteFile:Os,DeleteFiles:Ps,DeletePassword:Is,DownloadFile:Hs,DownloadFiles:_i,EscapeJSON:Fs,FormatJSON:Ws,GetConnection:zs,GetConnections:Us,GetCurrentPath:Ns,GetFileInfo:js,GetMonitoringData:Ks,GetPassword:qs,GetSettings:Vs,GetTransferStatus:Gs,Greet:Js,HasPassword:Xs,ListFiles:pi,ListSSHSessions:Zs,MinifyJSON:Ys,RemoveConnection:Qs,RenameFile:$s,ResizeLocalShell:en,ResizeSSH:tn,SaveBinaryFile:rn,SavePassword:sn,SelectDownloadDirectory:gi,SelectSSHKeyFile:nn,SelectUploadFiles:vi,SendLocalShellData:on,SendLocalShellDataBinary:an,SendSSHData:ln,SendSSHDataBinary:cn,ShowErrorDialog:hn,ShowMessageDialog:dn,ShowQuestionDialog:un,TestConnection:fn,UpdateConnection:_n,UpdateSettings:pn,UploadFile:gn,UploadFiles:mi,ValidateJSON:vn},Symbol.toStringTag,{value:"Module"}));function Fr(l,i,a){const b=l.slice();return b[39]=i[a],b[41]=a,b}function bn(l){let i,a,b;function C(t,n){return t[0]==="/"?yn:wn}let R=C(l),y=R(l);return{c(){i=T("span"),y.c(),w(i,"class","flex-1 text-purple-600 dark:text-purple-400 font-medium cursor-text hover:bg-purple-100 dark:hover:bg-purple-900/30 px-2 py-1 rounded transition-colors"),w(i,"title","点击编辑路径")},m(t,n){ee(t,i,n),y.m(i,null),a||(b=se(i,"click",l[15]),a=!0)},p(t,n){R===(R=C(t))&&y?y.p(t,n):(y.d(1),y=R(t),y&&(y.c(),y.m(i,null)))},d(t){t&&$(i),y.d(),a=!1,b()}}}function Sn(l){let i,a,b,C,R;return{c(){i=T("span"),i.textContent="/",a=K(),b=T("input"),w(i,"class","text-gray-400 dark:text-gray-500"),w(b,"type","text"),w(b,"class","flex-1 bg-white dark:bg-gray-800 border border-purple-300 dark:border-purple-600 rounded px-2 py-1 text-purple-600 dark:text-purple-400 font-medium focus:outline-none focus:ring-2 focus:ring-purple-500")},m(y,t){ee(y,i,t),ee(y,a,t),ee(y,b,t),pe(b,l[6]),C||(R=[se(b,"input",l[26]),se(b,"keydown",l[27]),se(b,"blur",l[16]),ii(focus.call(null,b))],C=!0)},p(y,t){t[0]&64&&b.value!==y[6]&&pe(b,y[6])},d(y){y&&($(i),$(a),$(b)),C=!1,ye(R)}}}function wn(l){let i=l[0].split("/").filter(Boolean).join(" / ")+"",a;return{c(){a=ie(i)},m(b,C){ee(b,a,C)},p(b,C){C[0]&1&&i!==(i=b[0].split("/").filter(Boolean).join(" / ")+"")&&de(a,i)},d(b){b&&$(a)}}}function yn(l){let i;return{c(){i=ie("/")},m(a,b){ee(a,i,b)},p:Se,d(a){a&&$(i)}}}function Wr(l){let i,a,b,C,R,y,t,n;return{c(){i=T("div"),a=T("input"),b=K(),C=T("button"),C.textContent="跳转",R=K(),y=T("button"),y.innerHTML='<svg class="w-3.5 h-3.5 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',w(a,"type","text"),w(a,"placeholder","输入路径,如：/var/www/html"),w(a,"class","flex-1 px-3 py-2 text-xs bg-white dark:bg-gray-800 border border-purple-200 dark:border-purple-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"),w(C,"class","px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white text-xs rounded-lg transition-colors font-medium"),w(y,"class","p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"),w(y,"title","取消"),w(i,"class","mt-2 flex items-center gap-2")},m(h,_){ee(h,i,_),E(i,a),pe(a,l[8]),E(i,b),E(i,C),E(i,R),E(i,y),t||(n=[se(a,"input",l[29]),se(a,"keydown",l[30]),ii(focus.call(null,a)),se(C,"click",l[18]),se(y,"click",l[31])],t=!0)},p(h,_){_[0]&256&&a.value!==h[8]&&pe(a,h[8])},d(h){h&&$(i),t=!1,ye(n)}}}function Cn(l){let i=[],a=new Map,b,C=Ve(l[9]);const R=y=>y[39].path;for(let y=0;y<C.length;y+=1){let t=Fr(l,C,y),n=R(t);a.set(n,i[y]=zr(n,t))}return{c(){for(let y=0;y<i.length;y+=1)i[y].c();b=kt()},m(y,t){for(let n=0;n<i.length;n+=1)i[n]&&i[n].m(y,t);ee(y,b,t)},p(y,t){t[0]&12804&&(C=Ve(y[9]),i=At(i,t,R,1,y,C,a,b.parentNode,jt,zr,b,Fr))},d(y){y&&$(b);for(let t=0;t<i.length;t+=1)i[t].d(y)}}}function kn(l){let i;return{c(){i=T("div"),i.innerHTML='<svg class="w-8 h-8 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path></svg> <span class="text-center px-4">本地终端不支持文件管理</span> <div class="text-xs text-gray-400 dark:text-gray-500 mt-2">文件管理仅适用于 SSH 远程连接</div>',w(i,"class","flex flex-col items-center justify-center h-40 text-gray-500 dark:text-gray-400 gap-2")},m(a,b){ee(a,i,b)},p:Se,d(a){a&&$(i)}}}function xn(l){let i;return{c(){i=T("div"),i.innerHTML='<svg class="w-8 h-8 opacity-50" fill="currentColor" viewBox="0 0 24 24"><path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path></svg> <span>目录为空</span>',w(i,"class","flex flex-col items-center justify-center h-40 text-gray-500 dark:text-gray-400 gap-2")},m(a,b){ee(a,i,b)},p:Se,d(a){a&&$(i)}}}function En(l){let i,a,b,C,R,y,t,n,h,_;return{c(){i=T("div"),a=_e("svg"),b=_e("path"),C=K(),R=T("span"),y=ie(l[4]),t=K(),n=T("button"),n.textContent="重试",w(b,"stroke-linecap","round"),w(b,"stroke-linejoin","round"),w(b,"stroke-width","2"),w(b,"d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),w(a,"class","w-6 h-6"),w(a,"fill","none"),w(a,"stroke","currentColor"),w(a,"viewBox","0 0 24 24"),w(R,"class","text-center px-4"),w(n,"class","text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300"),w(i,"class","flex flex-col items-center justify-center h-40 text-red-500 dark:text-red-400 gap-2")},m(c,u){ee(c,i,u),E(i,a),E(a,b),E(i,C),E(i,R),E(R,y),E(i,t),E(i,n),h||(_=se(n,"click",l[10]),h=!0)},p(c,u){u[0]&16&&de(y,c[4])},d(c){c&&$(i),h=!1,_()}}}function Ln(l){let i;return{c(){i=T("div"),i.innerHTML='<svg class="animate-spin w-6 h-6" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <span>加载中...</span>',w(i,"class","flex flex-col items-center justify-center h-40 text-gray-500 dark:text-gray-400 gap-2")},m(a,b){ee(a,i,b)},p:Se,d(a){a&&$(i)}}}function Dn(l){let i,a,b,C,R,y,t,n=l[39].name+"",h,_,c,u,g=Ur(l[39].size)+"",m,f,e,o,r,s=l[39].modified+"",d,v,S,x=l[39].mode+"",p;return{c(){i=T("div"),a=K(),b=_e("svg"),C=_e("path"),R=K(),y=T("div"),t=T("div"),h=ie(n),_=K(),c=T("div"),u=T("span"),m=ie(g),f=K(),e=T("span"),e.textContent="•",o=K(),r=T("span"),d=ie(s),v=K(),S=T("span"),p=ie(x),w(i,"class","w-3"),w(C,"stroke-linecap","round"),w(C,"stroke-linejoin","round"),w(C,"stroke-width","2"),w(C,"d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),w(b,"class","w-3.5 h-3.5 text-blue-500 flex-shrink-0"),w(b,"fill","none"),w(b,"stroke","currentColor"),w(b,"viewBox","0 0 24 24"),w(t,"class","text-gray-900 dark:text-white font-medium truncate"),w(c,"class","text-gray-500 dark:text-gray-400 flex items-center gap-2"),w(y,"class","flex-1 min-w-0"),w(S,"class","text-gray-400 dark:text-gray-500 font-mono text-[10px]")},m(k,A){ee(k,i,A),ee(k,a,A),ee(k,b,A),E(b,C),ee(k,R,A),ee(k,y,A),E(y,t),E(t,h),E(y,_),E(y,c),E(c,u),E(u,m),E(c,f),E(c,e),E(c,o),E(c,r),E(r,d),ee(k,v,A),ee(k,S,A),E(S,p)},p(k,A){A[0]&512&&n!==(n=k[39].name+"")&&de(h,n),A[0]&512&&g!==(g=Ur(k[39].size)+"")&&de(m,g),A[0]&512&&s!==(s=k[39].modified+"")&&de(d,s),A[0]&512&&x!==(x=k[39].mode+"")&&de(p,x)},d(k){k&&($(i),$(a),$(b),$(R),$(y),$(v),$(S))}}}function Rn(l){let i,a,b,C,R,y,t,n=l[39].name+"",h;function _(g,m){return m[0]&516&&(i=null),i==null&&(i=!!g[2].has(g[39].path)),i?Mn:Bn}let c=_(l,[-1,-1]),u=c(l);return{c(){u.c(),a=K(),b=_e("svg"),C=_e("path"),R=K(),y=T("div"),t=T("div"),h=ie(n),w(C,"d","M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"),w(b,"class","w-3.5 h-3.5 text-amber-500 flex-shrink-0"),w(b,"fill","currentColor"),w(b,"viewBox","0 0 24 24"),w(t,"class","text-gray-900 dark:text-white font-medium truncate"),w(y,"class","flex-1 min-w-0")},m(g,m){u.m(g,m),ee(g,a,m),ee(g,b,m),E(b,C),ee(g,R,m),ee(g,y,m),E(y,t),E(t,h)},p(g,m){c!==(c=_(g,m))&&(u.d(1),u=c(g),u&&(u.c(),u.m(a.parentNode,a))),m[0]&512&&n!==(n=g[39].name+"")&&de(h,n)},d(g){g&&($(a),$(b),$(R),$(y)),u.d(g)}}}function An(l){let i,a,b,C,R,y=l[39].name+"",t,n,h;return{c(){i=_e("svg"),a=_e("path"),b=K(),C=T("div"),R=T("div"),t=ie(y),n=K(),h=T("div"),h.textContent="返回上一层",w(a,"stroke-linecap","round"),w(a,"stroke-linejoin","round"),w(a,"stroke-width","2"),w(a,"d","M10 19l-7-7m0 0l7-7m-7 7h18"),w(i,"class","w-3.5 h-3.5 text-gray-400 dark:text-gray-500 flex-shrink-0"),w(i,"fill","none"),w(i,"stroke","currentColor"),w(i,"viewBox","0 0 24 24"),w(R,"class","text-gray-600 dark:text-gray-300"),w(h,"class","text-gray-400 dark:text-gray-500 text-[10px]"),w(C,"class","flex-1 min-w-0")},m(_,c){ee(_,i,c),E(i,a),ee(_,b,c),ee(_,C,c),E(C,R),E(R,t),E(C,n),E(C,h)},p(_,c){c[0]&512&&y!==(y=_[39].name+"")&&de(t,y)},d(_){_&&($(i),$(b),$(C))}}}function Bn(l){let i,a;return{c(){i=_e("svg"),a=_e("path"),w(a,"stroke-linecap","round"),w(a,"stroke-linejoin","round"),w(a,"stroke-width","2"),w(a,"d","M9 5l7 7-7 7"),w(i,"class","w-3 h-3 text-gray-500 dark:text-gray-400 flex-shrink-0"),w(i,"fill","none"),w(i,"stroke","currentColor"),w(i,"viewBox","0 0 24 24")},m(b,C){ee(b,i,C),E(i,a)},d(b){b&&$(i)}}}function Mn(l){let i,a;return{c(){i=_e("svg"),a=_e("path"),w(a,"stroke-linecap","round"),w(a,"stroke-linejoin","round"),w(a,"stroke-width","2"),w(a,"d","M19 9l-7 7-7-7"),w(i,"class","w-3 h-3 text-gray-500 dark:text-gray-400 flex-shrink-0"),w(i,"fill","none"),w(i,"stroke","currentColor"),w(i,"viewBox","0 0 24 24")},m(b,C){ee(b,i,C),E(i,a)},d(b){b&&$(i)}}}function zr(l,i){let a,b,C,R,y;function t(u,g){return u[39].is_parent?An:u[39].is_dir?Rn:Dn}let n=t(i),h=n(i);function _(){return i[32](i[39])}function c(){return i[33](i[39])}return{key:l,first:null,c(){a=T("div"),h.c(),b=K(),w(a,"class",C="group flex items-center gap-2 px-3 py-2 hover:bg-purple-50 dark:hover:bg-purple-900/20 cursor-pointer transition-colors mx-2 my-0.5 rounded-lg "+(i[39].is_parent?"text-gray-500 dark:text-gray-400 italic":"")),this.first=a},m(u,g){ee(u,a,g),h.m(a,null),E(a,b),R||(y=[se(a,"click",_),se(a,"dblclick",c)],R=!0)},p(u,g){i=u,n===(n=t(i))&&h?h.p(i,g):(h.d(1),h=n(i),h&&(h.c(),h.m(a,b))),g[0]&512&&C!==(C="group flex items-center gap-2 px-3 py-2 hover:bg-purple-50 dark:hover:bg-purple-900/20 cursor-pointer transition-colors mx-2 my-0.5 rounded-lg "+(i[39].is_parent?"text-gray-500 dark:text-gray-400 italic":""))&&w(a,"class",C)},d(u){u&&$(a),h.d(),R=!1,ye(y)}}}function Tn(l){let i,a,b,C,R,y,t,n,h,_,c,u,g,m,f,e,o,r,s,d,v,S,x,p,k,A,P;function I(L,O){return L[5]?Sn:bn}let M=I(l),z=M(l),q=l[7]&&Wr(l);function Y(L,O){return L[3]?Ln:L[4]?En:L[9].length===0?xn:L[1]?kn:Cn}let Z=Y(l),Q=Z(l);return{c(){i=T("div"),a=T("div"),b=T("div"),C=T("h3"),C.textContent="文件管理",R=K(),y=T("div"),t=T("button"),n=_e("svg"),h=_e("path"),_=K(),c=T("button"),u=_e("svg"),g=_e("path"),m=K(),f=T("button"),f.innerHTML='<svg class="w-3.5 h-3.5 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4 4l-4-4m0 0L8 8m4-4v12"></path></svg>',e=K(),o=T("div"),r=T("div"),s=T("button"),s.innerHTML='<svg class="w-3 h-3 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>',d=K(),z.c(),v=K(),S=T("button"),S.innerHTML='<svg class="w-3.5 h-3.5 text-purple-600 dark:text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>',x=K(),q&&q.c(),p=K(),k=T("div"),Q.c(),w(C,"class","text-sm font-semibold text-gray-900 dark:text-white"),w(h,"stroke-linecap","round"),w(h,"stroke-linejoin","round"),w(h,"stroke-width","2"),w(h,"d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"),w(n,"class","w-3.5 h-3.5 text-gray-600 dark:text-gray-400"),w(n,"fill","none"),w(n,"stroke","currentColor"),w(n,"viewBox","0 0 24 24"),t.disabled=l[1],w(t,"class","p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"),w(t,"title","刷新"),w(g,"stroke-linecap","round"),w(g,"stroke-linejoin","round"),w(g,"stroke-width","2"),w(g,"d","M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4 8l-4-4m0 0L8 8m4-4v12"),w(u,"class","w-3.5 h-3.5 text-gray-600 dark:text-gray-400"),w(u,"fill","none"),w(u,"stroke","currentColor"),w(u,"viewBox","0 0 24 24"),c.disabled=l[1],w(c,"class","p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"),w(c,"title","上传"),w(f,"class","p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"),w(f,"title","下载"),w(y,"class","flex items-center gap-1"),w(b,"class","flex items-center justify-between mb-2"),w(s,"class","p-0.5 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors"),w(s,"title","根目录"),w(r,"class","flex-1 flex items-center gap-1 text-xs bg-gray-50 dark:bg-gray-700 rounded-lg px-3 py-2"),w(S,"class","p-2 hover:bg-purple-100 dark:hover:bg-purple-900/30 rounded-lg transition-colors"),w(S,"title","跳转到指定目录"),w(o,"class","flex items-center gap-2"),w(a,"class","p-3 border-b border-gray-200 dark:border-gray-700"),w(k,"class","flex-1 overflow-y-auto scrollbar-thin text-xs"),w(i,"class","h-full flex flex-col bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700")},m(L,O){ee(L,i,O),E(i,a),E(a,b),E(b,C),E(b,R),E(b,y),E(y,t),E(t,n),E(n,h),E(y,_),E(y,c),E(c,u),E(u,g),E(y,m),E(y,f),E(a,e),E(a,o),E(o,r),E(r,s),E(r,d),z.m(r,null),E(o,v),E(o,S),E(a,x),q&&q.m(a,null),E(i,p),E(i,k),Q.m(k,null),A||(P=[se(t,"click",l[10]),se(c,"click",l[11]),se(s,"click",l[25]),se(S,"click",l[28])],A=!0)},p(L,O){O[0]&2&&(t.disabled=L[1]),O[0]&2&&(c.disabled=L[1]),M===(M=I(L))&&z?z.p(L,O):(z.d(1),z=M(L),z&&(z.c(),z.m(r,null))),L[7]?q?q.p(L,O):(q=Wr(L),q.c(),q.m(a,null)):q&&(q.d(1),q=null),Z===(Z=Y(L))&&Q?Q.p(L,O):(Q.d(1),Q=Z(L),Q&&(Q.c(),Q.m(k,null)))},i:Se,o:Se,d(L){L&&$(i),z.d(),q&&q.d(),Q.d(),A=!1,ye(P)}}}function On(l){return!l||l.length===0?[]:[...l].sort((i,a)=>i.is_dir&&!a.is_dir?-1:!i.is_dir&&a.is_dir?1:i.name.toLowerCase().localeCompare(a.name.toLowerCase()))}function Ur(l){if(!l)return"0 B";const i=["B","KB","MB","GB"];let a=0;for(;l>=1024&&a<i.length-1;)l/=1024,a++;return`${l.toFixed(1)} ${i[a]}`}function Pn(l,i,a){let b,C,R,y,t,n,h,_;it(l,ht,V=>a(23,h=V)),it(l,tt,V=>a(24,_=V));let c="/",u=new Set([]),g=[],m=!1,f=null,e=[],o=!1,r="",s=!1,d="";async function v(V){if(!(!h||!C)&&!R){a(3,m=!0),a(4,f=null);try{const j=await pi(h,V);a(19,g=j||[]),a(0,c=V)}catch(j){console.error("Failed to load directory:",j),a(4,f=j.message||"加载目录失败")}finally{a(3,m=!1)}}}async function S(){await v(c)}async function x(){if(!(!h||!C||R))try{const V=await vi();if(!V||V.length===0)return;(await mi(h,V,c)).forEach(B=>k(B)),setTimeout(()=>v(c),2e3)}catch(V){console.error("Upload failed:",V),a(4,f=V.message||"上传失败")}}async function p(V){if(!(!h||!C||R||V.is_dir))try{const j=await gi();if(!j)return;(await _i(h,[V.path],j)).forEach(D=>k(D))}catch(j){console.error("Download failed:",j),a(4,f=j.message||"下载失败")}}function k(V){const j=`sftp:progress:${V}`,B=Qt(j,D=>{(D.status==="completed"||D.status==="failed")&&setTimeout(()=>{},3e3)});e.push(B)}function A(V){v(V)}function P(V){if(V===-1)A("/");else{const j="/"+n.slice(0,V+1).join("/");A(j)}}function I(){a(6,r=c),a(5,o=!0)}function M(){r.trim()&&A(r.trim()),a(5,o=!1)}function z(){a(5,o=!1),a(6,r="")}function q(){d.trim()&&(A(d.trim()),a(7,s=!1),a(8,d=""))}Rt(()=>{}),Nt(()=>{e.forEach(V=>V())});const Y=()=>P(-1);function Z(){r=this.value,a(6,r)}const Q=V=>{V.key==="Enter"?M():V.key==="Escape"&&z()},L=()=>a(7,s=!s);function O(){d=this.value,a(8,d)}const H=V=>{V.key==="Enter"?q():V.key==="Escape"&&(a(7,s=!1),a(8,d=""))},F=()=>{a(7,s=!1),a(8,d="")},N=V=>V.is_dir&&A(V.path),G=V=>{V.is_dir||p(V)};return l.$$.update=()=>{l.$$.dirty[0]&25165824&&a(22,b=h?_.get(h):null),l.$$.dirty[0]&4194304&&a(21,C=(b==null?void 0:b.connected)||!1),l.$$.dirty[0]&4194304&&a(1,R=(b==null?void 0:b.type)==="local"),l.$$.dirty[0]&2097154&&a(20,y=C&&!R),l.$$.dirty[0]&524289&&a(9,t=(()=>{const V=On(g);return c==="/"?V:[{name:"..",path:c.split("/").filter(Boolean).slice(0,-1).join("/")||"/",is_dir:!0,is_parent:!0},...V]})()),l.$$.dirty[0]&1&&(n=c.split("/").filter(V=>V)),l.$$.dirty[0]&9437185&&h&&y&&v(c)},[c,R,u,m,f,o,r,s,d,t,S,x,p,A,P,I,M,z,q,g,y,C,b,h,_,Y,Z,Q,L,O,H,F,N,G]}class In extends nt{constructor(i){super(),st(this,i,Pn,Tn,Ze,{},null,[-1,-1])}}function Hn(l){let i;return{c(){i=ie("请先连接到服务器")},m(a,b){ee(a,i,b)},d(a){a&&$(i)}}}function Fn(l){let i;return{c(){i=ie("实时数据获取中...")},m(a,b){ee(a,i,b)},d(a){a&&$(i)}}}function Wn(l){let i;return{c(){i=ie("本地终端不支持服务器监控")},m(a,b){ee(a,i,b)},d(a){a&&$(i)}}}function Nr(l){let i;return{c(){i=T("div"),i.innerHTML='<div class="flex flex-col items-center justify-center h-40 text-gray-500 dark:text-gray-400 gap-2"><svg class="w-8 h-8 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2 2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <span class="text-center px-4">本地终端不支持服务器监控</span> <div class="text-xs text-gray-400 dark:text-gray-500 mt-2">服务器监控功能仅适用于 SSH 远程连接</div></div>',w(i,"class","p-3 space-y-3")},m(a,b){ee(a,i,b)},d(a){a&&$(i)}}}function zn(l){var lr,cr;let i,a,b,C,R,y,t,n,h,_,c,u,g,m=l[2].cpu+"",f,e,o,r,s,d,v,S,x,p,k=l[2].memory.toFixed(2)+"",A,P,I,M,z,q,Y,Z,Q,L,O=l[2].disk+"",H,F,N,G,V,j,B,D,U,W=l[4].used+"",J,X,te,re,ae=l[4].total+"",ue,oe,he,Ee,be,ve,We,Ce,Ne,ke,Oe=Ft(((lr=l[2].network)==null?void 0:lr.in)||0)+"",ze,ne,ce,Le,De,ge,Ke=Ft(((cr=l[2].network)==null?void 0:cr.out)||0)+"",qe,ut,Qe,ft,$e,Ue,et,at,Et,Re,Ae=(l[3].os||"Unknown")+"",Pe,Ie,xe,Be,He,le,me=(l[3].kernel||"Unknown")+"",Kt,ir,gt,Bt,sr,Mt,Tt=(l[3].uptime||"Unknown")+"",qt,nr,vt,Ot,or,Pt,It=(l[3].processes||"N/A")+"",Vt;function ar(we,Me){return we[0]?Wn:we[1]?Fn:Hn}let Ht=ar(l),lt=Ht(l),je=l[0]&&Nr();return{c(){i=T("div"),a=T("div"),b=T("h3"),b.textContent="服务器监控",C=K(),R=T("div"),lt.c(),y=K(),je&&je.c(),t=K(),n=T("div"),h=T("div"),_=T("div"),c=T("div"),c.innerHTML='<div class="p-1.5 bg-purple-100 dark:bg-purple-900 rounded-lg"><svg class="w-3.5 h-3.5 text-purple-600 dark:text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 002-2h2a2 2 0 002-2z"></path></svg></div> <span class="text-xs font-semibold text-gray-900 dark:text-white">CPU</span>',u=K(),g=T("span"),f=ie(m),e=ie("%"),o=K(),r=T("div"),r.textContent="CPU 图表待实现",s=K(),d=T("div"),v=T("div"),S=T("div"),S.innerHTML='<div class="p-1.5 bg-emerald-100 dark:bg-emerald-900 rounded-lg"><svg class="w-3.5 h-3.5 text-emerald-600 dark:text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 002-2h2a2 2 0 002-2z"></path></svg></div> <span class="text-xs font-semibold text-gray-900 dark:text-white">内存</span>',x=K(),p=T("span"),A=ie(k),P=ie("%"),I=K(),M=T("div"),M.textContent="内存图表待实现",z=K(),q=T("div"),Y=T("div"),Z=T("div"),Z.innerHTML='<div class="p-1.5 bg-amber-100 dark:bg-amber-900 rounded-lg"><svg class="w-3.5 h-3.5 text-amber-600 dark:text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"></path></svg></div> <span class="text-xs font-semibold text-gray-900 dark:text-white">磁盘</span>',Q=K(),L=T("span"),H=ie(O),F=ie("%"),N=K(),G=T("div"),V=T("div"),j=K(),B=T("div"),D=T("span"),U=ie("已用 "),J=ie(W),X=K(),te=T("span"),re=ie("总计 "),ue=ie(ae),oe=K(),he=T("div"),Ee=T("div"),Ee.innerHTML='<div class="p-1.5 bg-blue-100 dark:bg-blue-900 rounded-lg"><svg class="w-3.5 h-3.5 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"></path></svg></div> <span class="text-xs font-semibold text-gray-900 dark:text-white">网络流量</span>',be=K(),ve=T("div"),We=T("div"),Ce=T("div"),Ce.innerHTML='<div class="w-2 h-2 rounded-full bg-emerald-500"></div> <span class="text-xs text-gray-700 dark:text-gray-300 font-medium">入站</span>',Ne=K(),ke=T("span"),ze=ie(Oe),ne=K(),ce=T("div"),Le=T("div"),Le.innerHTML='<div class="w-2 h-2 rounded-full bg-rose-500"></div> <span class="text-xs text-gray-700 dark:text-gray-300 font-medium">出站</span>',De=K(),ge=T("span"),qe=ie(Ke),ut=K(),Qe=T("div"),ft=T("div"),ft.textContent="系统信息",$e=K(),Ue=T("div"),et=T("div"),at=T("span"),at.textContent="操作系统",Et=K(),Re=T("span"),Pe=ie(Ae),Ie=K(),xe=T("div"),Be=T("span"),Be.textContent="内核版本",He=K(),le=T("span"),Kt=ie(me),ir=K(),gt=T("div"),Bt=T("span"),Bt.textContent="运行时间",sr=K(),Mt=T("span"),qt=ie(Tt),nr=K(),vt=T("div"),Ot=T("span"),Ot.textContent="进程数",or=K(),Pt=T("span"),Vt=ie(It),w(b,"class","text-sm font-semibold text-gray-900 dark:text-white"),w(R,"class","text-xs text-gray-500 dark:text-gray-400 mt-1"),w(a,"class","p-3 border-b border-gray-200 dark:border-gray-700"),w(c,"class","flex items-center gap-2"),w(g,"class","text-xs font-bold px-2 py-1 rounded-lg bg-white dark:bg-gray-800"),fe(g,"color",ct(l[2].cpu)),w(_,"class","flex items-center justify-between mb-2"),w(r,"class","h-[80px] bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center text-xs text-gray-400"),w(h,"class","bg-gradient-to-br from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-xl p-3 shadow-sm border border-purple-100 dark:border-purple-800"),w(S,"class","flex items-center gap-2"),w(p,"class","text-xs font-bold px-2 py-1 rounded-lg bg-white dark:bg-gray-800"),fe(p,"color",ct(l[2].memory)),w(v,"class","flex items-center justify-between mb-2"),w(M,"class","h-[80px] bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center text-xs text-gray-400"),w(d,"class","bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 rounded-xl p-3 shadow-sm border border-emerald-100 dark:border-emerald-800"),w(Z,"class","flex items-center gap-2"),w(L,"class","text-xs font-bold px-2 py-1 rounded-lg bg-white dark:bg-gray-800"),fe(L,"color",ct(l[2].disk)),w(Y,"class","flex items-center justify-between mb-2"),w(V,"class","h-2 rounded-full transition-all duration-300"),fe(V,"width",l[2].disk+"%"),fe(V,"background-color",ct(l[2].disk)),w(G,"class","w-full bg-gray-100 dark:bg-gray-700 rounded-full h-2 overflow-hidden"),w(B,"class","flex justify-between mt-2 text-[10px] text-gray-600 dark:text-gray-400"),w(q,"class","bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 rounded-xl p-3 shadow-sm border border-amber-100 dark:border-amber-800"),w(Ee,"class","flex items-center gap-2 mb-3"),w(Ce,"class","flex items-center gap-2"),w(ke,"class","text-xs font-mono font-bold text-gray-900 dark:text-white"),w(We,"class","flex items-center justify-between bg-white dark:bg-gray-800 rounded-lg p-2"),w(Le,"class","flex items-center gap-2"),w(ge,"class","text-xs font-mono font-bold text-gray-900 dark:text-white"),w(ce,"class","flex items-center justify-between bg-white dark:bg-gray-800 rounded-lg p-2"),w(ve,"class","space-y-2"),w(he,"class","bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl p-3 shadow-sm border border-blue-100 dark:border-blue-800"),w(ft,"class","text-xs font-semibold text-gray-900 dark:text-white mb-2"),w(at,"class","text-gray-600 dark:text-gray-400"),w(Re,"class","text-gray-900 dark:text-white font-medium"),w(et,"class","flex justify-between py-1"),w(Be,"class","text-gray-600 dark:text-gray-400"),w(le,"class","text-gray-900 dark:text-white font-medium"),w(xe,"class","flex justify-between py-1"),w(Bt,"class","text-gray-600 dark:text-gray-400"),w(Mt,"class","text-gray-900 dark:text-white font-medium"),w(gt,"class","flex justify-between py-1"),w(Ot,"class","text-gray-600 dark:text-gray-400"),w(Pt,"class","text-gray-900 dark:text-white font-medium"),w(vt,"class","flex justify-between py-1"),w(Ue,"class","space-y-1.5 text-[10px]"),w(Qe,"class","bg-gray-50 dark:bg-gray-700 rounded-xl p-3 shadow-sm border border-gray-200 dark:border-gray-600"),w(n,"class","p-3 space-y-3"),w(i,"class","h-full flex flex-col bg-white dark:bg-gray-800 overflow-y-auto scrollbar-thin")},m(we,Me){ee(we,i,Me),E(i,a),E(a,b),E(a,C),E(a,R),lt.m(R,null),E(i,y),je&&je.m(i,null),E(i,t),E(i,n),E(n,h),E(h,_),E(_,c),E(_,u),E(_,g),E(g,f),E(g,e),E(h,o),E(h,r),E(n,s),E(n,d),E(d,v),E(v,S),E(v,x),E(v,p),E(p,A),E(p,P),E(d,I),E(d,M),E(n,z),E(n,q),E(q,Y),E(Y,Z),E(Y,Q),E(Y,L),E(L,H),E(L,F),E(q,N),E(q,G),E(G,V),E(q,j),E(q,B),E(B,D),E(D,U),E(D,J),E(B,X),E(B,te),E(te,re),E(te,ue),E(n,oe),E(n,he),E(he,Ee),E(he,be),E(he,ve),E(ve,We),E(We,Ce),E(We,Ne),E(We,ke),E(ke,ze),E(ve,ne),E(ve,ce),E(ce,Le),E(ce,De),E(ce,ge),E(ge,qe),E(n,ut),E(n,Qe),E(Qe,ft),E(Qe,$e),E(Qe,Ue),E(Ue,et),E(et,at),E(et,Et),E(et,Re),E(Re,Pe),E(Ue,Ie),E(Ue,xe),E(xe,Be),E(xe,He),E(xe,le),E(le,Kt),E(Ue,ir),E(Ue,gt),E(gt,Bt),E(gt,sr),E(gt,Mt),E(Mt,qt),E(Ue,nr),E(Ue,vt),E(vt,Ot),E(vt,or),E(vt,Pt),E(Pt,Vt)},p(we,[Me]){var hr,dr;Ht!==(Ht=ar(we))&&(lt.d(1),lt=Ht(we),lt&&(lt.c(),lt.m(R,null))),we[0]?je||(je=Nr(),je.c(),je.m(i,t)):je&&(je.d(1),je=null),Me&4&&m!==(m=we[2].cpu+"")&&de(f,m),Me&4&&fe(g,"color",ct(we[2].cpu)),Me&4&&k!==(k=we[2].memory.toFixed(2)+"")&&de(A,k),Me&4&&fe(p,"color",ct(we[2].memory)),Me&4&&O!==(O=we[2].disk+"")&&de(H,O),Me&4&&fe(L,"color",ct(we[2].disk)),Me&4&&fe(V,"width",we[2].disk+"%"),Me&4&&fe(V,"background-color",ct(we[2].disk)),Me&16&&W!==(W=we[4].used+"")&&de(J,W),Me&16&&ae!==(ae=we[4].total+"")&&de(ue,ae),Me&4&&Oe!==(Oe=Ft(((hr=we[2].network)==null?void 0:hr.in)||0)+"")&&de(ze,Oe),Me&4&&Ke!==(Ke=Ft(((dr=we[2].network)==null?void 0:dr.out)||0)+"")&&de(qe,Ke),Me&8&&Ae!==(Ae=(we[3].os||"Unknown")+"")&&de(Pe,Ae),Me&8&&me!==(me=(we[3].kernel||"Unknown")+"")&&de(Kt,me),Me&8&&Tt!==(Tt=(we[3].uptime||"Unknown")+"")&&de(qt,Tt),Me&8&&It!==(It=(we[3].processes||"N/A")+"")&&de(Vt,It)},i:Se,o:Se,d(we){we&&$(i),lt.d(),je&&je.d()}}}function ct(l){return l<50?"#10b981":l<80?"#f59e0b":"#ef4444"}function Ft(l){if(l===0)return"0 KB/s";const i=["KB/s","MB/s","GB/s"];let a=-1,b=l;for(;b>=1024&&a<i.length-1;)b/=1024,a++;return`${b.toFixed(1)} ${i[a]}`}function Un(l,i,a){let b,C,R,y,t,n;it(l,ht,o=>a(7,t=o)),it(l,tt,o=>a(8,n=o));let h=[],_=[],c={cpu:45,memory:62,disk:78,network:{in:125.5,out:89.3}},u={os:"Ubuntu 22.04 LTS",kernel:"5.15.0-91-generic",uptime:"15天 7小时 32分",processes:187},g={used:"156 GB",total:"200 GB"},m=null;function f(o){var s,d,v,S,x,p,k,A,P,I,M,z;if(!o)return null;(s=o.cpu)!=null&&s.per_core&&Array.isArray(o.cpu.per_core)&&o.cpu.per_core;const r={cpu:typeof o.cpu=="number"?o.cpu:((d=o.cpu)==null?void 0:d.overall)||0,memory:typeof o.memory=="number"?o.memory:((v=o.memory)==null?void 0:v.used_percent)||0,disk:typeof o.disk=="number"?o.disk:((p=(x=(S=o.disk)==null?void 0:S.partitions)==null?void 0:x[0])==null?void 0:p.used_percent)||0,network:{in:typeof((k=o.network)==null?void 0:k.in)=="number"?o.network.in*(1024*1024):typeof((A=o.network)==null?void 0:A.rx_rate)=="number"?o.network.rx_rate:0,out:typeof((P=o.network)==null?void 0:P.out)=="number"?o.network.out*(1024*1024):typeof((I=o.network)==null?void 0:I.tx_rate)=="number"?o.network.tx_rate:0}};if(o.system&&a(3,u={os:o.system.os||u.os,kernel:o.system.kernel||u.kernel,uptime:o.system.uptime||u.uptime,processes:u.processes}),(z=(M=o.disk)==null?void 0:M.partitions)!=null&&z[0]){const q=o.disk.partitions[0],Y=(q.used/(1024*1024*1024)).toFixed(1),Z=(q.total/(1024*1024*1024)).toFixed(1);a(4,g={used:`${Y} GB`,total:`${Z} GB`})}return r}async function e(){if(!t||!C||R)return;const{GetMonitoringData:o}=window.wailsBindings||{};if(typeof o=="function")try{const r=await o(t),s=f(r);console.log("data:",r),s&&(a(2,c=s),h=[...h,s.cpu].slice(-60),_=[..._,s.memory].slice(-60))}catch(r){console.error("Failed to fetch monitoring data:",r)}}return Rt(()=>(m=setInterval(e,2e3),()=>{clearInterval(m)})),Nt(()=>{m&&clearInterval(m)}),l.$$.update=()=>{l.$$.dirty&384&&a(6,b=t?n.get(t):null),l.$$.dirty&64&&a(1,C=(b==null?void 0:b.connected)||!1),l.$$.dirty&64&&a(0,R=(b==null?void 0:b.type)==="local"),l.$$.dirty&3&&a(5,y=C&&!R),l.$$.dirty&160&&t&&y&&e()},[R,C,c,u,g,y,b,t,n]}class Nn extends nt{constructor(i){super(),st(this,i,Un,zn,Ze,{})}}function jr(l,i,a){const b=l.slice();return b[13]=i[a],b}function Kr(l){var P;let i,a,b,C,R,y,t,n,h,_,c,u=[],g=new Map,m,f,e,o=(((P=l[4].find(l[9]))==null?void 0:P.name)||"选择工具")+"",r,s,d,v,S=Ve(l[4]);const x=I=>I[13].id;for(let I=0;I<S.length;I+=1){let M=jr(l,S,I),z=x(M);g.set(z,u[I]=qr(z,M))}function p(I,M){return I[1]==="json"?Kn:jn}let k=p(l),A=k(l);return{c(){i=T("div"),a=T("div"),b=K(),C=T("div"),R=T("div"),y=T("div"),t=T("h3"),t.textContent="开发工具",n=K(),h=T("button"),h.innerHTML='<svg class="w-4 h-4 text-gray-500 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',_=K(),c=T("div");for(let I=0;I<u.length;I+=1)u[I].c();m=K(),f=T("div"),e=T("h2"),r=ie(o),s=K(),A.c(),w(a,"class","absolute inset-0 bg-black/20 backdrop-blur-sm"),w(t,"class","text-sm font-semibold text-gray-900 dark:text-white"),w(h,"class","p-1.5 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors"),w(y,"class","flex items-center justify-between mb-4"),w(c,"class","space-y-1"),w(R,"class","w-64 bg-gray-50 dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 p-4"),w(e,"class","text-lg font-semibold text-gray-900 dark:text-white mb-6"),w(f,"class","flex-1 p-6 overflow-y-auto"),w(C,"class","relative w-full max-w-4xl bg-white dark:bg-gray-800 rounded-2xl shadow-2xl m-4 max-h-[80vh] overflow-hidden flex"),w(i,"class","fixed inset-0 z-50 flex items-start justify-center pt-16"),w(i,"role","dialog"),w(i,"aria-modal","true")},m(I,M){ee(I,i,M),E(i,a),E(i,b),E(i,C),E(C,R),E(R,y),E(y,t),E(y,n),E(y,h),E(R,_),E(R,c);for(let z=0;z<u.length;z+=1)u[z]&&u[z].m(c,null);E(C,m),E(C,f),E(f,e),E(e,r),E(f,s),A.m(f,null),d||(v=[se(h,"click",l[7]),se(i,"click",l[6])],d=!0)},p(I,M){var z;M&18&&(S=Ve(I[4]),u=At(u,M,x,1,I,S,g,c,jt,qr,null,jr)),M&2&&o!==(o=(((z=I[4].find(I[9]))==null?void 0:z.name)||"选择工具")+"")&&de(r,o),k===(k=p(I))&&A?A.p(I,M):(A.d(1),A=k(I),A&&(A.c(),A.m(f,null)))},d(I){I&&$(i);for(let M=0;M<u.length;M+=1)u[M].d();A.d(),d=!1,ye(v)}}}function qr(l,i){let a,b,C,R,y=i[13].name+"",t,n,h,_,c,u;function g(){return i[8](i[13])}return{key:l,first:null,c(){a=T("button"),b=T("span"),b.textContent=`${i[13].icon}`,C=K(),R=T("span"),t=ie(y),h=K(),w(b,"class","text-xl"),w(R,"class",n=`text-sm font-medium ${i[1]===i[13].id?"text-gray-900 dark:text-white":"text-gray-700 dark:text-gray-300"}`),w(a,"class",_="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all "+(i[1]===i[13].id?"bg-white dark:bg-gray-800 shadow-sm border border-gray-200 dark:border-gray-700":"hover:bg-gray-100 dark:hover:bg-gray-800")),this.first=a},m(m,f){ee(m,a,f),E(a,b),E(a,C),E(a,R),E(R,t),E(a,h),c||(u=se(a,"click",g),c=!0)},p(m,f){i=m,f&2&&n!==(n=`text-sm font-medium ${i[1]===i[13].id?"text-gray-900 dark:text-white":"text-gray-700 dark:text-gray-300"}`)&&w(R,"class",n),f&2&&_!==(_="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all "+(i[1]===i[13].id?"bg-white dark:bg-gray-800 shadow-sm border border-gray-200 dark:border-gray-700":"hover:bg-gray-100 dark:hover:bg-gray-800"))&&w(a,"class",_)},d(m){m&&$(a),c=!1,u()}}}function jn(l){var C;let i,a=((C=l[4].find(l[12]))==null?void 0:C.name)+" 功能待实现",b;return{c(){i=T("div"),b=ie(a),w(i,"class","text-center py-12 text-gray-500 dark:text-gray-400")},m(R,y){ee(R,i,y),E(i,b)},p(R,y){var t;y&2&&a!==(a=((t=R[4].find(R[12]))==null?void 0:t.name)+" 功能待实现")&&de(b,a)},d(R){R&&$(i)}}}function Kn(l){let i,a,b,C,R,y,t,n,h,_,c,u,g,m;return{c(){i=T("div"),a=T("div"),b=T("label"),b.textContent="输入 JSON",C=K(),R=T("textarea"),y=K(),t=T("button"),t.textContent="格式化",n=K(),h=T("div"),_=T("label"),_.textContent="输出",c=K(),u=T("textarea"),w(b,"class","block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"),w(R,"placeholder","{&quot;name&quot;: &quot;test&quot;}"),w(R,"class","w-full h-32 px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm font-mono resize-none focus:outline-none focus:ring-2 focus:ring-purple-500 dark:text-white"),w(t,"class","w-full px-4 py-2.5 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors"),w(_,"class","block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"),u.readOnly=!0,w(u,"class","w-full h-32 px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm font-mono resize-none focus:outline-none dark:text-white"),w(i,"class","space-y-4")},m(f,e){ee(f,i,e),E(i,a),E(a,b),E(a,C),E(a,R),pe(R,l[2]),E(i,y),E(i,t),E(i,n),E(i,h),E(h,_),E(h,c),E(h,u),pe(u,l[3]),g||(m=[se(R,"input",l[10]),se(t,"click",l[5]),se(u,"input",l[11])],g=!0)},p(f,e){e&4&&pe(R,f[2]),e&8&&pe(u,f[3])},d(f){f&&$(i),g=!1,ye(m)}}}function qn(l){let i,a=l[0]&&Kr(l);return{c(){a&&a.c(),i=kt()},m(b,C){a&&a.m(b,C),ee(b,i,C)},p(b,[C]){b[0]?a?a.p(b,C):(a=Kr(b),a.c(),a.m(i.parentNode,i)):a&&(a.d(1),a=null)},i:Se,o:Se,d(b){b&&$(i),a&&a.d(b)}}}function Vn(l,i,a){let{isOpen:b=!1}=i,C=null,R="",y="";const t=[{id:"json",name:"JSON 格式化",icon:"📄",color:"text-purple-600"},{id:"base64",name:"Base64 编解码",icon:"🔐",color:"text-blue-600"},{id:"hash",name:"Hash 计算",icon:"#️⃣",color:"text-green-600"},{id:"timestamp",name:"时间戳转换",icon:"🕐",color:"text-amber-600"},{id:"uuid",name:"UUID 生成",icon:"🆔",color:"text-indigo-600"}];function n(){try{const e=JSON.parse(R);a(3,y=JSON.stringify(e,null,2))}catch(e){a(3,y="JSON 格式错误: "+e.message)}}function h(e){e.target===e.currentTarget&&a(0,b=!1)}const _=()=>a(0,b=!1),c=e=>a(1,C=e.id),u=e=>e.id===C;function g(){R=this.value,a(2,R)}function m(){y=this.value,a(3,y)}const f=e=>e.id===C;return l.$$set=e=>{"isOpen"in e&&a(0,b=e.isOpen)},[b,C,R,y,t,n,h,_,c,u,g,m,f]}class Gn extends nt{constructor(i){super(),st(this,i,Vn,qn,Ze,{isOpen:0})}}function Vr(l){let i,a,b,C,R,y,t,n,h,_,c,u,g,m,f,e,o;return{c(){i=T("div"),a=T("label"),a.textContent="认证方式",b=K(),C=T("div"),R=T("button"),y=T("div"),t=ie("密码"),_=K(),c=T("button"),u=T("div"),g=ie("SSH 密钥"),w(a,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),w(y,"class",n=`text-xs font-medium ${l[3]==="password"?"text-purple-700 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`),w(R,"type","button"),w(R,"class",h=`flex-1 px-3 py-1.5 rounded-md border-2 transition-all ${l[3]==="password"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`),w(u,"class",m=`text-xs font-medium ${l[3]==="key"?"text-purple-700 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`),w(c,"type","button"),w(c,"class",f=`flex-1 px-3 py-1.5 rounded-md border-2 transition-all ${l[3]==="key"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`),w(C,"class","flex gap-2")},m(r,s){ee(r,i,s),E(i,a),E(i,b),E(i,C),E(C,R),E(R,y),E(y,t),E(C,_),E(C,c),E(c,u),E(u,g),e||(o=[se(R,"click",l[21]),se(c,"click",l[22])],e=!0)},p(r,s){s[0]&8&&n!==(n=`text-xs font-medium ${r[3]==="password"?"text-purple-700 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`)&&w(y,"class",n),s[0]&8&&h!==(h=`flex-1 px-3 py-1.5 rounded-md border-2 transition-all ${r[3]==="password"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`)&&w(R,"class",h),s[0]&8&&m!==(m=`text-xs font-medium ${r[3]==="key"?"text-purple-700 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`)&&w(u,"class",m),s[0]&8&&f!==(f=`flex-1 px-3 py-1.5 rounded-md border-2 transition-all ${r[3]==="key"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`)&&w(c,"class",f)},d(r){r&&$(i),e=!1,ye(o)}}}function Gr(l){let i,a,b,C,R,y,t,n,h,_,c,u,g,m,f,e,o,r;function s(k,A){return k[9]?Xn:Jn}let d=s(l),v=d(l);function S(k,A){return k[9]?Yn:Zn}let x=S(l),p=x(l);return{c(){i=T("div"),a=T("label"),a.textContent="SSH 私钥文件",b=K(),C=T("div"),R=T("input"),y=K(),t=T("button"),t.textContent="选择文件",n=K(),h=T("div"),_=T("label"),_.textContent="Passphrase（可选）",c=K(),u=T("div"),v.c(),g=K(),m=T("button"),p.c(),f=K(),e=T("p"),e.textContent="如果您的 SSH 密钥文件已加密，请输入 passphrase。否则留空即可。",w(a,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),w(R,"type","text"),w(R,"placeholder","点击选择密钥文件 (例如: ~/.ssh/id_rsa)"),R.readOnly=!0,w(R,"class","flex-1 px-3 py-1.5 bg-gray-100 dark:bg-gray-600 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none transition-all"),w(t,"type","button"),w(t,"class","px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white rounded-md text-xs font-medium transition-colors whitespace-nowrap"),w(C,"class","flex gap-1.5"),w(_,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),w(m,"type","button"),w(m,"class","absolute right-2 top-1/2 transform -translate-y-1/2 p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors"),w(u,"class","relative"),w(e,"class","mt-0.5 text-[10px] text-gray-500 dark:text-gray-400")},m(k,A){ee(k,i,A),E(i,a),E(i,b),E(i,C),E(C,R),pe(R,l[4].keyPath),E(C,y),E(C,t),ee(k,n,A),ee(k,h,A),E(h,_),E(h,c),E(h,u),v.m(u,null),E(u,g),E(u,m),p.m(m,null),E(h,f),E(h,e),o||(r=[se(R,"input",l[23]),se(t,"click",l[11]),se(m,"click",l[26])],o=!0)},p(k,A){A[0]&16&&R.value!==k[4].keyPath&&pe(R,k[4].keyPath),d===(d=s(k))&&v?v.p(k,A):(v.d(1),v=d(k),v&&(v.c(),v.m(u,g))),x!==(x=S(k))&&(p.d(1),p=x(k),p&&(p.c(),p.m(m,null)))},d(k){k&&($(i),$(n),$(h)),v.d(),p.d(),o=!1,ye(r)}}}function Jn(l){let i,a,b;return{c(){i=T("input"),w(i,"type","password"),w(i,"placeholder","如果密钥已加密，请输入 passphrase"),w(i,"class","w-full px-3 py-1.5 pr-10 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all")},m(C,R){ee(C,i,R),pe(i,l[4].passphrase),a||(b=se(i,"input",l[25]),a=!0)},p(C,R){R[0]&16&&i.value!==C[4].passphrase&&pe(i,C[4].passphrase)},d(C){C&&$(i),a=!1,b()}}}function Xn(l){let i,a,b;return{c(){i=T("input"),w(i,"type","text"),w(i,"placeholder","如果密钥已加密，请输入 passphrase"),w(i,"class","w-full px-3 py-1.5 pr-10 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all")},m(C,R){ee(C,i,R),pe(i,l[4].passphrase),a||(b=se(i,"input",l[24]),a=!0)},p(C,R){R[0]&16&&i.value!==C[4].passphrase&&pe(i,C[4].passphrase)},d(C){C&&$(i),a=!1,b()}}}function Zn(l){let i,a;return{c(){i=_e("svg"),a=_e("path"),w(a,"stroke-linecap","round"),w(a,"stroke-linejoin","round"),w(a,"stroke-width","2"),w(a,"d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"),w(i,"class","w-4 h-4 text-gray-500 dark:text-gray-400"),w(i,"fill","none"),w(i,"stroke","currentColor"),w(i,"viewBox","0 0 24 24")},m(b,C){ee(b,i,C),E(i,a)},d(b){b&&$(i)}}}function Yn(l){let i,a,b;return{c(){i=_e("svg"),a=_e("path"),b=_e("path"),w(a,"stroke-linecap","round"),w(a,"stroke-linejoin","round"),w(a,"stroke-width","2"),w(a,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),w(b,"stroke-linecap","round"),w(b,"stroke-linejoin","round"),w(b,"stroke-width","2"),w(b,"d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"),w(i,"class","w-4 h-4 text-gray-500 dark:text-gray-400"),w(i,"fill","none"),w(i,"stroke","currentColor"),w(i,"viewBox","0 0 24 24")},m(C,R){ee(C,i,R),E(i,a),E(i,b)},d(C){C&&$(i)}}}function Jr(l){let i,a,b;return{c(){i=T("div"),a=ie(l[6]),w(i,"class",b=`p-2 rounded-md text-xs ${l[6].includes("成功")?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300"}`)},m(C,R){ee(C,i,R),E(i,a)},p(C,R){R[0]&64&&de(a,C[6]),R[0]&64&&b!==(b=`p-2 rounded-md text-xs ${C[6].includes("成功")?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300"}`)&&w(i,"class",b)},d(C){C&&$(i)}}}function Xr(l){let i,a,b,C,R,y,t,n,h,_;return{c(){i=T("div"),a=T("label"),a.innerHTML='数据库类型 <span class="text-red-500">*</span>',b=K(),C=T("select"),R=T("option"),R.textContent="MySQL",y=T("option"),y.textContent="PostgreSQL",t=T("option"),t.textContent="MongoDB",n=T("option"),n.textContent="Redis",w(a,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),R.__value="mysql",pe(R,R.__value),y.__value="postgresql",pe(y,y.__value),t.__value="mongodb",pe(t,t.__value),n.__value="redis",pe(n,n.__value),w(C,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"),l[4].dbType===void 0&&zt(()=>l[27].call(C))},m(c,u){ee(c,i,u),E(i,a),E(i,b),E(i,C),E(C,R),E(C,y),E(C,t),E(C,n),gr(C,l[4].dbType,!0),h||(_=se(C,"change",l[27]),h=!0)},p(c,u){u[0]&16&&gr(C,c[4].dbType)},d(c){c&&$(i),h=!1,_()}}}function Zr(l){let i,a,b,C,R,y;return{c(){i=T("div"),a=T("label"),a.innerHTML='用户名 <span class="text-red-500">*</span>',b=K(),C=T("input"),w(a,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),w(C,"type","text"),C.required=!0,w(C,"placeholder","root"),w(C,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all")},m(t,n){ee(t,i,n),E(i,a),E(i,b),E(i,C),pe(C,l[4].username),R||(y=se(C,"input",l[30]),R=!0)},p(t,n){n[0]&16&&C.value!==t[4].username&&pe(C,t[4].username)},d(t){t&&$(i),R=!1,y()}}}function Yr(l){let i,a,b,C,R,y,t,n,h,_,c,u,g;function m(d,v){return d[8]?$n:Qn}let f=m(l),e=f(l);function o(d,v){return d[8]?to:eo}let r=o(l),s=r(l);return{c(){i=T("div"),a=T("label"),a.innerHTML='密码 <span class="text-red-500">*</span>',b=K(),C=T("div"),e.c(),R=K(),y=T("button"),s.c(),t=K(),n=T("div"),h=T("input"),_=K(),c=T("span"),c.textContent="保存密码",w(a,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),w(y,"type","button"),w(y,"class","absolute right-2 top-1/2 transform -translate-y-1/2 p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors"),w(C,"class","relative"),w(h,"type","checkbox"),w(h,"class","w-3.5 h-3.5 rounded border-gray-300 text-purple-600 focus:ring-purple-500"),w(c,"class","text-xs text-gray-700 dark:text-gray-300"),w(n,"class","flex items-center gap-1.5 cursor-pointer")},m(d,v){ee(d,i,v),E(i,a),E(i,b),E(i,C),e.m(C,null),E(C,R),E(C,y),s.m(y,null),ee(d,t,v),ee(d,n,v),E(n,h),h.checked=l[4].savePassword,E(n,_),E(n,c),u||(g=[se(y,"click",l[33]),se(h,"change",l[34])],u=!0)},p(d,v){f===(f=m(d))&&e?e.p(d,v):(e.d(1),e=f(d),e&&(e.c(),e.m(C,R))),r!==(r=o(d))&&(s.d(1),s=r(d),s&&(s.c(),s.m(y,null))),v[0]&16&&(h.checked=d[4].savePassword)},d(d){d&&($(i),$(t),$(n)),e.d(),s.d(),u=!1,ye(g)}}}function Qn(l){let i,a,b;return{c(){i=T("input"),w(i,"type","password"),w(i,"placeholder","输入密码"),w(i,"class","w-full px-3 py-1.5 pr-10 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all")},m(C,R){ee(C,i,R),pe(i,l[4].password),a||(b=se(i,"input",l[32]),a=!0)},p(C,R){R[0]&16&&i.value!==C[4].password&&pe(i,C[4].password)},d(C){C&&$(i),a=!1,b()}}}function $n(l){let i,a,b;return{c(){i=T("input"),w(i,"type","text"),w(i,"placeholder","输入密码"),w(i,"class","w-full px-3 py-1.5 pr-10 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all")},m(C,R){ee(C,i,R),pe(i,l[4].password),a||(b=se(i,"input",l[31]),a=!0)},p(C,R){R[0]&16&&i.value!==C[4].password&&pe(i,C[4].password)},d(C){C&&$(i),a=!1,b()}}}function eo(l){let i,a;return{c(){i=_e("svg"),a=_e("path"),w(a,"stroke-linecap","round"),w(a,"stroke-linejoin","round"),w(a,"stroke-width","2"),w(a,"d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"),w(i,"class","w-4 h-4 text-gray-500 dark:text-gray-400"),w(i,"fill","none"),w(i,"stroke","currentColor"),w(i,"viewBox","0 0 24 24")},m(b,C){ee(b,i,C),E(i,a)},d(b){b&&$(i)}}}function to(l){let i,a,b;return{c(){i=_e("svg"),a=_e("path"),b=_e("path"),w(a,"stroke-linecap","round"),w(a,"stroke-linejoin","round"),w(a,"stroke-width","2"),w(a,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),w(b,"stroke-linecap","round"),w(b,"stroke-linejoin","round"),w(b,"stroke-width","2"),w(b,"d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"),w(i,"class","w-4 h-4 text-gray-500 dark:text-gray-400"),w(i,"fill","none"),w(i,"stroke","currentColor"),w(i,"viewBox","0 0 24 24")},m(C,R){ee(C,i,R),E(i,a),E(i,b)},d(C){C&&$(i)}}}function Qr(l){let i,a,b,C,R,y;return{c(){i=T("div"),a=T("label"),a.textContent="数据库名",b=K(),C=T("input"),w(a,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),w(C,"type","text"),w(C,"placeholder","例如：production_db"),w(C,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all")},m(t,n){ee(t,i,n),E(i,a),E(i,b),E(i,C),pe(C,l[4].database),R||(y=se(C,"input",l[35]),R=!0)},p(t,n){n[0]&16&&C.value!==t[4].database&&pe(C,t[4].database)},d(t){t&&$(i),R=!1,y()}}}function ro(l){let i,a,b,C,R,y,t,n,h,_,c,u,g,m,f,e,o,r,s,d,v,S,x,p,k,A,P,I,M,z,q,Y,Z,Q,L,O,H,F,N,G,V,j,B,D,U,W,J,X,te,re,ae,ue,oe,he,Ee,be,ve,We,Ce,Ne,ke,Oe,ze,ne,ce,Le,De,ge,Ke,qe,ut=l[5]?"测试中...":"测试连接",Qe,ft,$e,Ue=l[7]?"保存中...":l[1]?"更新连接":"添加连接",et,at,Et,Re=l[2]==="ssh"&&Vr(l),Ae=l[3]==="key"&&Gr(l),Pe=l[6]&&Jr(l),Ie=l[2]==="database"&&Xr(l),xe=(l[3]==="password"||l[2]==="database"||l[2]==="docker")&&Zr(l),Be=l[3]==="password"&&Yr(l),He=l[2]==="database"&&Qr(l);return{c(){i=T("div"),a=T("label"),a.textContent="连接类型",b=K(),C=T("div"),R=T("button"),y=T("div"),t=_e("svg"),n=_e("path"),_=K(),c=T("span"),u=ie("SSH"),f=K(),e=T("button"),o=T("div"),r=_e("svg"),s=_e("path"),v=K(),S=T("span"),x=ie("数据库"),A=K(),P=T("button"),I=T("div"),M=_e("svg"),z=_e("path"),Y=K(),Z=T("span"),Q=ie("Docker"),H=K(),F=T("form"),N=T("div"),G=T("label"),G.innerHTML='连接名称 <span class="text-red-500">*</span>',V=K(),j=T("input"),B=K(),Re&&Re.c(),D=K(),Ae&&Ae.c(),U=K(),Pe&&Pe.c(),W=K(),Ie&&Ie.c(),J=K(),X=T("div"),te=T("div"),re=T("label"),re.innerHTML='主机地址 <span class="text-red-500">*</span>',ae=K(),ue=T("input"),oe=K(),he=T("div"),Ee=T("label"),Ee.innerHTML='端口 <span class="text-red-500">*</span>',be=K(),ve=T("input"),We=K(),xe&&xe.c(),Ce=K(),Be&&Be.c(),Ne=K(),He&&He.c(),ke=K(),Oe=T("div"),ze=T("label"),ze.textContent="分组",ne=K(),ce=T("input"),Le=K(),De=T("div"),ge=T("button"),ge.textContent="取消",Ke=K(),qe=T("button"),Qe=ie(ut),ft=K(),$e=T("button"),et=ie(Ue),w(a,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2"),w(n,"stroke-linecap","round"),w(n,"stroke-linejoin","round"),w(n,"stroke-width","2"),w(n,"d","M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"),w(t,"class",h=`w-4 h-4 ${l[2]==="ssh"?"text-purple-600":"text-gray-600 dark:text-gray-400"}`),w(t,"fill","none"),w(t,"stroke","currentColor"),w(t,"viewBox","0 0 24 24"),w(c,"class",g=`text-xs font-medium ${l[2]==="ssh"?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`),w(y,"class","flex items-center justify-center gap-1"),w(R,"type","button"),w(R,"class",m=`p-2 rounded-lg border-2 transition-all ${l[2]==="ssh"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`),w(s,"stroke-linecap","round"),w(s,"stroke-linejoin","round"),w(s,"stroke-width","2"),w(s,"d","M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"),w(r,"class",d=`w-4 h-4 ${l[2]==="database"?"text-purple-600":"text-gray-600 dark:text-gray-400"}`),w(r,"fill","none"),w(r,"stroke","currentColor"),w(r,"viewBox","0 0 24 24"),w(S,"class",p=`text-xs font-medium ${l[2]==="database"?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`),w(o,"class","flex items-center justify-center gap-1"),w(e,"type","button"),w(e,"class",k=`p-2 rounded-lg border-2 transition-all ${l[2]==="database"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`),w(z,"d","M13.983 11.078h2.119a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186h-2.119a.185.185 0 00-.185.185v1.888c0 .102.083.185.185.185m-2.954-3.333h2.118a.186.186 0 00.186-.186V5.671a.186.186 0 00-.186-.185h-2.118a.185.185 0 00-.185.185v1.888c0 .102.082.185.185.185m-2.954 3.333h2.118a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186H8.075a.186.186 0 00-.186.186v1.888c0 .102.083.185.186.185m-2.954-3.333h2.119a.186.186 0 00.185-.186V5.671a.185.185 0 00-.185-.185H5.12a.186.186 0 00-.186.185v1.888c0 .102.084.185.186.185m-2.93 3.333h2.12a.185.185 0 00.185-.185V9.006a.185.185 0 00-.186-.186h-2.12a.185.185 0 00-.184.186v1.888c0 .102.083.185.185.185M20.69 6.662c.057.16.09.331.09.51v7.9c0 3.058-2.724 4.928-8.78 4.928-6.055 0-8.779-1.87-8.779-4.928v-7.9c0-.179.033-.35.09-.51C1.536 7.396 0 9.522 0 12.072v3.639c0 4.072 3.608 6.789 12 6.789 8.391 0 12-2.717 12-6.79v-3.638c0-2.55-1.536-4.677-4.31-6.41"),w(M,"class",q=`w-4 h-4 ${l[2]==="docker"?"text-purple-600":"text-gray-600 dark:text-gray-400"}`),w(M,"fill","currentColor"),w(M,"viewBox","0 0 24 24"),w(Z,"class",L=`text-xs font-medium ${l[2]==="docker"?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`),w(I,"class","flex items-center justify-center gap-1"),w(P,"type","button"),w(P,"class",O=`p-2 rounded-lg border-2 transition-all ${l[2]==="docker"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`),w(C,"class","grid grid-cols-3 gap-2"),w(i,"class","mb-4"),w(G,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),w(j,"type","text"),j.required=!0,w(j,"placeholder","例如：生产服务器-01"),w(j,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"),w(re,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),w(ue,"type","text"),ue.required=!0,w(ue,"placeholder","192.168.1.10 或 example.com"),w(ue,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"),w(te,"class","col-span-2"),w(Ee,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),w(ve,"type","text"),ve.required=!0,w(ve,"placeholder",l[13]()),w(ve,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"),w(X,"class","grid grid-cols-3 gap-2"),w(ze,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),w(ce,"type","text"),w(ce,"placeholder","例如：生产环境"),w(ce,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"),w(ge,"type","button"),w(ge,"class","px-3 py-1.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md text-xs font-medium transition-colors"),w(qe,"type","button"),qe.disabled=l[5],w(qe,"class","px-3 py-1.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md text-xs font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed"),w($e,"type","submit"),$e.disabled=l[7],w($e,"class","flex-1 px-3 py-1.5 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-md text-xs font-medium transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed"),w(De,"class","flex gap-2 pt-3"),w(F,"class","space-y-3")},m(le,me){ee(le,i,me),E(i,a),E(i,b),E(i,C),E(C,R),E(R,y),E(y,t),E(t,n),E(y,_),E(y,c),E(c,u),E(C,f),E(C,e),E(e,o),E(o,r),E(r,s),E(o,v),E(o,S),E(S,x),E(C,A),E(C,P),E(P,I),E(I,M),E(M,z),E(I,Y),E(I,Z),E(Z,Q),ee(le,H,me),ee(le,F,me),E(F,N),E(N,G),E(N,V),E(N,j),pe(j,l[4].name),E(F,B),Re&&Re.m(F,null),E(F,D),Ae&&Ae.m(F,null),E(F,U),Pe&&Pe.m(F,null),E(F,W),Ie&&Ie.m(F,null),E(F,J),E(F,X),E(X,te),E(te,re),E(te,ae),E(te,ue),pe(ue,l[4].host),E(X,oe),E(X,he),E(he,Ee),E(he,be),E(he,ve),pe(ve,l[4].port),E(F,We),xe&&xe.m(F,null),E(F,Ce),Be&&Be.m(F,null),E(F,Ne),He&&He.m(F,null),E(F,ke),E(F,Oe),E(Oe,ze),E(Oe,ne),E(Oe,ce),pe(ce,l[4].group),E(F,Le),E(F,De),E(De,ge),E(De,Ke),E(De,qe),E(qe,Qe),E(De,ft),E(De,$e),E($e,et),at||(Et=[se(R,"click",l[17]),se(e,"click",l[18]),se(P,"click",l[19]),se(j,"input",l[20]),se(ue,"input",l[28]),se(ve,"input",l[29]),se(ce,"input",l[36]),se(ge,"click",l[37]),se(qe,"click",l[10]),se(F,"submit",Mi(l[12]))],at=!0)},p(le,me){me[0]&4&&h!==(h=`w-4 h-4 ${le[2]==="ssh"?"text-purple-600":"text-gray-600 dark:text-gray-400"}`)&&w(t,"class",h),me[0]&4&&g!==(g=`text-xs font-medium ${le[2]==="ssh"?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`)&&w(c,"class",g),me[0]&4&&m!==(m=`p-2 rounded-lg border-2 transition-all ${le[2]==="ssh"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`)&&w(R,"class",m),me[0]&4&&d!==(d=`w-4 h-4 ${le[2]==="database"?"text-purple-600":"text-gray-600 dark:text-gray-400"}`)&&w(r,"class",d),me[0]&4&&p!==(p=`text-xs font-medium ${le[2]==="database"?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`)&&w(S,"class",p),me[0]&4&&k!==(k=`p-2 rounded-lg border-2 transition-all ${le[2]==="database"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`)&&w(e,"class",k),me[0]&4&&q!==(q=`w-4 h-4 ${le[2]==="docker"?"text-purple-600":"text-gray-600 dark:text-gray-400"}`)&&w(M,"class",q),me[0]&4&&L!==(L=`text-xs font-medium ${le[2]==="docker"?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`)&&w(Z,"class",L),me[0]&4&&O!==(O=`p-2 rounded-lg border-2 transition-all ${le[2]==="docker"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`)&&w(P,"class",O),me[0]&16&&j.value!==le[4].name&&pe(j,le[4].name),le[2]==="ssh"?Re?Re.p(le,me):(Re=Vr(le),Re.c(),Re.m(F,D)):Re&&(Re.d(1),Re=null),le[3]==="key"?Ae?Ae.p(le,me):(Ae=Gr(le),Ae.c(),Ae.m(F,U)):Ae&&(Ae.d(1),Ae=null),le[6]?Pe?Pe.p(le,me):(Pe=Jr(le),Pe.c(),Pe.m(F,W)):Pe&&(Pe.d(1),Pe=null),le[2]==="database"?Ie?Ie.p(le,me):(Ie=Xr(le),Ie.c(),Ie.m(F,J)):Ie&&(Ie.d(1),Ie=null),me[0]&16&&ue.value!==le[4].host&&pe(ue,le[4].host),me[0]&16&&ve.value!==le[4].port&&pe(ve,le[4].port),le[3]==="password"||le[2]==="database"||le[2]==="docker"?xe?xe.p(le,me):(xe=Zr(le),xe.c(),xe.m(F,Ce)):xe&&(xe.d(1),xe=null),le[3]==="password"?Be?Be.p(le,me):(Be=Yr(le),Be.c(),Be.m(F,Ne)):Be&&(Be.d(1),Be=null),le[2]==="database"?He?He.p(le,me):(He=Qr(le),He.c(),He.m(F,ke)):He&&(He.d(1),He=null),me[0]&16&&ce.value!==le[4].group&&pe(ce,le[4].group),me[0]&32&&ut!==(ut=le[5]?"测试中...":"测试连接")&&de(Qe,ut),me[0]&32&&(qe.disabled=le[5]),me[0]&130&&Ue!==(Ue=le[7]?"保存中...":le[1]?"更新连接":"添加连接")&&de(et,Ue),me[0]&128&&($e.disabled=le[7])},d(le){le&&($(i),$(H),$(F)),Re&&Re.d(),Ae&&Ae.d(),Pe&&Pe.d(),Ie&&Ie.d(),xe&&xe.d(),Be&&Be.d(),He&&He.d(),at=!1,ye(Et)}}}function io(l){let i,a,b;function C(y){l[39](y)}let R={onClose:l[38],title:l[1]?"编辑连接":"添加连接",size:"sm",$$slots:{default:[ro]},$$scope:{ctx:l}};return l[0]!==void 0&&(R.isOpen=l[0]),i=new ui({props:R}),Xe.push(()=>Ct(i,"isOpen",C)),{c(){rt(i.$$.fragment)},m(y,t){Ge(i,y,t),b=!0},p(y,t){const n={};t[0]&1&&(n.onClose=y[38]),t[0]&2&&(n.title=y[1]?"编辑连接":"添加连接"),t[0]&1023|t[1]&4096&&(n.$$scope={dirty:t,ctx:y}),!a&&t[0]&1&&(a=!0,n.isOpen=y[0],yt(()=>a=!1)),i.$set(n)},i(y){b||(Te(i.$$.fragment,y),b=!0)},o(y){Fe(i.$$.fragment,y),b=!1},d(y){Je(i,y)}}}function so(l,i,a){let{isOpen:b=!1}=i,{onAdd:C=()=>{}}=i,{onUpdate:R=()=>{}}=i,{editingAsset:y=null}=i,t="ssh",n="password",h=!1,_="",c=!1,u=!1,g=!1,m=!1,f=!1,e={id:"",name:"",host:"",port:"",username:"",password:"",savePassword:!1,keyPath:"",passphrase:"",group:"",dbType:"mysql",database:""};async function o(){if(!window.wailsBindings){a(6,_="Wails 绑定未加载");return}if(!e.host){a(6,_="请填写主机地址");return}if(n==="password"&&!e.password){a(6,_="请输入密码以测试连接");return}if(n==="password"&&!e.username){a(6,_="请填写用户名");return}if(n==="key"&&!e.keyPath){a(6,_="请选择 SSH 密钥文件");return}a(5,h=!0),a(6,_="");try{const W=n==="key"?e.keyPath:e.password;await window.wailsBindings.TestConnection(e.host,parseInt(e.port),e.username,n,W,e.passphrase||""),a(6,_="✓ 连接成功")}catch(W){console.error("Connection test failed:",W),a(6,_="✗ 连接失败: "+W)}finally{a(5,h=!1)}}async function r(){if(!window.wailsBindings){alert("Wails 绑定未加载");return}try{const W=await window.wailsBindings.SelectSSHKeyFile();W&&a(4,e.keyPath=W,e)}catch(W){console.error("Failed to select key file:",W),a(6,_="选择密钥文件失败: "+W)}}async function s(){if(!window.wailsBindings){alert("Wails 绑定未加载");return}if(!e.name||!e.host){alert("请填写必填字段（连接名称、主机地址）");return}if(n==="password"&&!e.username){alert("密码认证需要填写用户名");return}if(n==="password"&&!e.password){alert("密码认证需要输入密码");return}if(n==="key"&&!e.keyPath){alert("密钥认证需要选择密钥文件");return}a(7,c=!0);try{const W=!!e.id,J={id:W?e.id:`conn_${Date.now()}`,name:e.name,host:e.host,port:parseInt(e.port),user:e.username,auth_type:n,key_path:n==="key"?e.keyPath:"",tags:[e.group||"默认分组"],type:t,metadata:{database:e.database||void 0}};W?(await window.wailsBindings.UpdateConnection(J),n==="password"&&e.password&&e.savePassword?await window.wailsBindings.SavePassword(J.id,e.password):n==="password"&&!e.savePassword&&await window.wailsBindings.DeletePassword(J.id),R(J)):(C(J),n==="password"&&e.password&&e.savePassword&&await window.wailsBindings.SavePassword(J.id,e.password)),a(0,b=!1)}catch(W){console.error("Failed to save connection:",W),alert("保存连接失败: "+W)}finally{a(7,c=!1)}}function d(){a(4,e={id:"",name:"",host:"",port:v(),username:"",password:"",savePassword:!1,keyPath:"",passphrase:"",group:"",dbType:"mysql",database:""}),a(6,_=""),a(8,u=!1),a(9,g=!1)}function v(){switch(t){case"ssh":return"22";case"docker":return"2375";case"database":switch(e.dbType){case"mysql":return"3306";case"postgresql":return"5432";case"mongodb":return"27017";case"redis":return"6379";default:return""}default:return""}}async function S(){var W,J,X;if(!(!y||!b||m))try{const te=await window.wailsBindings.GetConnection(y.id);if(te){a(4,e={id:te.id,name:te.name||"",host:te.host||"",port:((W=te.port)==null?void 0:W.toString())||"",username:te.user||"",password:"",savePassword:!1,keyPath:te.key_path||"",passphrase:"",group:((J=te.tags)==null?void 0:J[0])||"",dbType:"mysql",database:((X=te.metadata)==null?void 0:X.database)||""}),a(2,t=te.type||"ssh"),a(3,n=te.auth_type||"password"),m=!0;try{if(await window.wailsBindings.HasPassword(te.id)){a(4,e.savePassword=!0,e);const ae=await window.wailsBindings.GetPassword(te.id);a(4,e.password=ae||"",e)}}catch(re){console.warn("Failed to load password:",re)}}}catch(te){console.error("Failed to load connection:",te)}}const x=()=>a(2,t="ssh"),p=()=>a(2,t="database"),k=()=>a(2,t="docker");function A(){e.name=this.value,a(4,e),a(0,b),a(1,y)}const P=()=>{a(3,n="password"),a(6,_="")},I=()=>{a(3,n="key"),a(6,_="")};function M(){e.keyPath=this.value,a(4,e),a(0,b),a(1,y)}function z(){e.passphrase=this.value,a(4,e),a(0,b),a(1,y)}function q(){e.passphrase=this.value,a(4,e),a(0,b),a(1,y)}const Y=()=>a(9,g=!g);function Z(){e.dbType=Pi(this),a(4,e),a(0,b),a(1,y)}function Q(){e.host=this.value,a(4,e),a(0,b),a(1,y)}function L(){e.port=this.value,a(4,e),a(0,b),a(1,y)}function O(){e.username=this.value,a(4,e),a(0,b),a(1,y)}function H(){e.password=this.value,a(4,e),a(0,b),a(1,y)}function F(){e.password=this.value,a(4,e),a(0,b),a(1,y)}const N=()=>a(8,u=!u);function G(){e.savePassword=this.checked,a(4,e),a(0,b),a(1,y)}function V(){e.database=this.value,a(4,e),a(0,b),a(1,y)}function j(){e.group=this.value,a(4,e),a(0,b),a(1,y)}const B=()=>a(0,b=!1),D=()=>{a(0,b=!1)};function U(W){b=W,a(0,b)}return l.$$set=W=>{"isOpen"in W&&a(0,b=W.isOpen),"onAdd"in W&&a(14,C=W.onAdd),"onUpdate"in W&&a(15,R=W.onUpdate),"editingAsset"in W&&a(1,y=W.editingAsset)},l.$$.update=()=>{l.$$.dirty[0]&1&&a(16,f=b),l.$$.dirty[0]&65537&&f&&!b&&d(),l.$$.dirty[0]&19&&b&&!y&&!e.id&&(e.port||a(4,e.port=v(),e)),l.$$.dirty[0]&16&&e.port===""&&a(4,e.port=v(),e),l.$$.dirty[0]&12&&(t==="ssh"?n!=="password"&&n!=="key"&&a(3,n="password"):a(3,n="password")),l.$$.dirty[0]&3&&b&&y&&S(),l.$$.dirty[0]&18&&y&&e.id!==y.id&&(m=!1),l.$$.dirty[0]&65539&&!f&&b&&y&&(m=!1)},[b,y,t,n,e,h,_,c,u,g,o,r,s,v,C,R,f,x,p,k,A,P,I,M,z,q,Y,Z,Q,L,O,H,F,N,G,V,j,B,D,U]}class no extends nt{constructor(i){super(),st(this,i,so,io,Ze,{isOpen:0,onAdd:14,onUpdate:15,editingAsset:1},null,[-1,-1])}}function $r(l){let i,a,b,C;return{c(){i=T("div"),a=T("div"),w(a,"class","h-full w-full rounded svelte-h9djo3"),w(i,"class","resize-handle-horizontal flex-shrink-0 relative svelte-h9djo3"),fe(i,"cursor",l[2]?"default":"col-resize"),fe(i,"height","100%"),fe(i,"padding","0 2px"),fe(i,"pointer-events",l[2]?"none":"auto")},m(R,y){ee(R,i,y),E(i,a),b||(C=se(i,"mousedown",l[11]),b=!0)},p(R,y){y[0]&4&&fe(i,"cursor",R[2]?"default":"col-resize"),y[0]&4&&fe(i,"pointer-events",R[2]?"none":"auto")},d(R){R&&$(i),b=!1,C()}}}function oo(l){let i,a,b,C,R,y,t,n,h,_,c,u,g,m,f,e,o,r,s,d,v,S,x,p,k,A,P,I,M,z,q,Y,Z,Q,L,O,H,F,N,G,V,j,B,D,U,W,J,X,te,re,ae,ue,oe,he,Ee,be;k=new Qi({props:{onConnect:l[14],onAddClick:l[20],onDelete:l[21],onEdit:l[16]}});let ve=!l[3]&&$r(l),We={};z=new Es({props:We}),l[22](z),F=new In({}),D=new Nn({});function Ce(ne){l[23](ne)}function Ne(ne){l[24](ne)}let ke={onAdd:l[15],onUpdate:l[17]};l[2]!==void 0&&(ke.isOpen=l[2]),l[4]!==void 0&&(ke.editingAsset=l[4]),J=new no({props:ke}),Xe.push(()=>Ct(J,"isOpen",Ce)),Xe.push(()=>Ct(J,"editingAsset",Ne));function Oe(ne){l[25](ne)}let ze={};return l[1]!==void 0&&(ze.isOpen=l[1]),ae=new Gn({props:ze}),Xe.push(()=>Ct(ae,"isOpen",Oe)),{c(){i=T("div"),a=T("header"),b=T("div"),C=T("div"),C.textContent="哈",R=K(),y=T("div"),t=T("div"),n=ie("啊哈 SSH 连接工具"),_=K(),c=T("div"),u=ie("AHa SSH Manager"),m=K(),f=T("div"),e=T("button"),o=_e("svg"),r=_e("path"),s=K(),d=T("span"),d.textContent="开发工具",S=K(),x=T("div"),p=T("div"),rt(k.$$.fragment),P=K(),ve&&ve.c(),I=K(),M=T("div"),rt(z.$$.fragment),Y=K(),Z=T("div"),Q=T("div"),L=K(),O=T("div"),H=T("div"),rt(F.$$.fragment),N=K(),G=T("div"),V=T("div"),j=K(),B=T("div"),rt(D.$$.fragment),W=K(),rt(J.$$.fragment),re=K(),rt(ae.$$.fragment),w(C,"class","w-8 h-8 bg-gradient-to-br from-purple-600 to-blue-600 rounded-lg flex items-center justify-center font-bold text-sm text-white shadow-md"),w(t,"class",h="font-semibold text-sm "+(l[0]==="dark"?"text-white":"text-gray-900")),w(c,"class",g="text-xs "+(l[0]==="dark"?"text-gray-400":"text-gray-500")),w(b,"class","flex items-center gap-3"),w(r,"stroke-linecap","round"),w(r,"stroke-linejoin","round"),w(r,"stroke-width","2"),w(r,"d","M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"),w(o,"class","w-4 h-4"),w(o,"fill","none"),w(o,"stroke","currentColor"),w(o,"viewBox","0 0 24 24"),w(d,"class","text-sm"),e.disabled=l[2],w(e,"class","flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-lg font-medium transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed"),w(f,"class","ml-auto"),w(a,"class",v="h-14 flex-shrink-0 "+(l[0]==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200")+" border-b flex items-center px-6 shadow-sm"),fe(a,"pointer-events",l[2]?"none":"auto"),w(p,"class",A="flex-shrink-0 transition-all duration-200 "+(l[0]==="dark"?"border-gray-700 bg-gray-800":"border-gray-200 bg-white")+" border-r overflow-hidden"),fe(p,"width",(l[3]?"0":l[8])+"px"),fe(p,"min-width",(l[3]?"0":l[8])+"px"),vr(p,"collapsed",l[3]),w(M,"class",q="flex-1 min-w-0 min-h-0 flex flex-col "+(l[0]==="dark"?"bg-gray-900":"bg-gray-50")),w(Q,"class","h-full w-full rounded svelte-h9djo3"),w(Z,"class","resize-handle-horizontal flex-shrink-0 relative svelte-h9djo3"),fe(Z,"cursor",l[2]?"default":"col-resize"),fe(Z,"height","100%"),fe(Z,"padding","0 2px"),fe(Z,"pointer-events",l[2]?"none":"auto"),w(H,"class","flex-1 overflow-hidden"),fe(H,"height",l[6]+"%"),w(V,"class","w-full h-full rounded svelte-h9djo3"),w(G,"class","resize-handle-vertical flex-shrink-0 relative svelte-h9djo3"),fe(G,"cursor",l[2]?"default":"row-resize"),fe(G,"width","100%"),fe(G,"padding","2px 0"),fe(G,"pointer-events",l[2]?"none":"auto"),w(B,"class","flex-1 overflow-hidden"),fe(B,"height",100-l[6]+"%"),w(O,"data-right-panel","true"),w(O,"class",U="flex-shrink-0 flex flex-col overflow-hidden "+(l[0]==="dark"?"border-gray-700 bg-gray-800":"border-gray-200 bg-white")+" border-l shadow-sm"),fe(O,"width",l[7]+"px"),fe(O,"min-width","300px"),fe(O,"max-width","600px"),w(x,"class","flex-1 flex overflow-hidden min-h-0 svelte-h9djo3"),w(i,"class",oe="h-screen w-full flex flex-col "+l[9]+" "+(l[0]==="dark"?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900")+" svelte-h9djo3")},m(ne,ce){ee(ne,i,ce),E(i,a),E(a,b),E(b,C),E(b,R),E(b,y),E(y,t),E(t,n),E(y,_),E(y,c),E(c,u),E(a,m),E(a,f),E(f,e),E(e,o),E(o,r),E(e,s),E(e,d),E(i,S),E(i,x),E(x,p),Ge(k,p,null),E(x,P),ve&&ve.m(x,null),E(x,I),E(x,M),Ge(z,M,null),E(x,Y),E(x,Z),E(Z,Q),E(x,L),E(x,O),E(O,H),Ge(F,H,null),E(O,N),E(O,G),E(G,V),E(O,j),E(O,B),Ge(D,B,null),E(i,W),Ge(J,i,null),E(i,re),Ge(ae,i,null),he=!0,Ee||(be=[se(e,"click",l[10]),se(Z,"mousedown",l[12]),se(G,"mousedown",l[13])],Ee=!0)},p(ne,ce){(!he||ce[0]&1&&h!==(h="font-semibold text-sm "+(ne[0]==="dark"?"text-white":"text-gray-900")))&&w(t,"class",h),(!he||ce[0]&1&&g!==(g="text-xs "+(ne[0]==="dark"?"text-gray-400":"text-gray-500")))&&w(c,"class",g),(!he||ce[0]&4)&&(e.disabled=ne[2]),(!he||ce[0]&1&&v!==(v="h-14 flex-shrink-0 "+(ne[0]==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200")+" border-b flex items-center px-6 shadow-sm"))&&w(a,"class",v),(!he||ce[0]&4)&&fe(a,"pointer-events",ne[2]?"none":"auto");const Le={};ce[0]&20&&(Le.onAddClick=ne[20]),k.$set(Le),(!he||ce[0]&1&&A!==(A="flex-shrink-0 transition-all duration-200 "+(ne[0]==="dark"?"border-gray-700 bg-gray-800":"border-gray-200 bg-white")+" border-r overflow-hidden"))&&w(p,"class",A),(!he||ce[0]&264)&&fe(p,"width",(ne[3]?"0":ne[8])+"px"),(!he||ce[0]&264)&&fe(p,"min-width",(ne[3]?"0":ne[8])+"px"),(!he||ce[0]&9)&&vr(p,"collapsed",ne[3]),ne[3]?ve&&(ve.d(1),ve=null):ve?ve.p(ne,ce):(ve=$r(ne),ve.c(),ve.m(x,I));const De={};z.$set(De),(!he||ce[0]&1&&q!==(q="flex-1 min-w-0 min-h-0 flex flex-col "+(ne[0]==="dark"?"bg-gray-900":"bg-gray-50")))&&w(M,"class",q),(!he||ce[0]&4)&&fe(Z,"cursor",ne[2]?"default":"col-resize"),(!he||ce[0]&4)&&fe(Z,"pointer-events",ne[2]?"none":"auto"),(!he||ce[0]&64)&&fe(H,"height",ne[6]+"%"),(!he||ce[0]&4)&&fe(G,"cursor",ne[2]?"default":"row-resize"),(!he||ce[0]&4)&&fe(G,"pointer-events",ne[2]?"none":"auto"),(!he||ce[0]&64)&&fe(B,"height",100-ne[6]+"%"),(!he||ce[0]&1&&U!==(U="flex-shrink-0 flex flex-col overflow-hidden "+(ne[0]==="dark"?"border-gray-700 bg-gray-800":"border-gray-200 bg-white")+" border-l shadow-sm"))&&w(O,"class",U),(!he||ce[0]&128)&&fe(O,"width",ne[7]+"px");const ge={};!X&&ce[0]&4&&(X=!0,ge.isOpen=ne[2],yt(()=>X=!1)),!te&&ce[0]&16&&(te=!0,ge.editingAsset=ne[4],yt(()=>te=!1)),J.$set(ge);const Ke={};!ue&&ce[0]&2&&(ue=!0,Ke.isOpen=ne[1],yt(()=>ue=!1)),ae.$set(Ke),(!he||ce[0]&513&&oe!==(oe="h-screen w-full flex flex-col "+ne[9]+" "+(ne[0]==="dark"?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900")+" svelte-h9djo3"))&&w(i,"class",oe)},i(ne){he||(Te(k.$$.fragment,ne),Te(z.$$.fragment,ne),Te(F.$$.fragment,ne),Te(D.$$.fragment,ne),Te(J.$$.fragment,ne),Te(ae.$$.fragment,ne),he=!0)},o(ne){Fe(k.$$.fragment,ne),Fe(z.$$.fragment,ne),Fe(F.$$.fragment,ne),Fe(D.$$.fragment,ne),Fe(J.$$.fragment,ne),Fe(ae.$$.fragment,ne),he=!1},d(ne){ne&&$(i),Je(k),ve&&ve.d(),l[22](null),Je(z),Je(F),Je(D),Je(J),Je(ae),Ee=!1,ye(be)}}}function ao(l,i,a){let b,C,R,y,t,n,h;it(l,Ye,j=>a(18,t=j)),it(l,Ut,j=>a(0,n=j)),it(l,tt,j=>a(19,h=j));let _=!1,c=!1,u=!1,g=null,m,f=!1,e=!1,o=!1;function r(){c||a(1,_=!_)}function s(j){j.preventDefault(),!c&&(f=!0,document.addEventListener("mousemove",d),document.addEventListener("mouseup",v))}function d(j){if(!f)return;const B=Math.max(200,Math.min(500,j.clientX));qi(B)}function v(){f=!1,document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",v)}function S(j){j.preventDefault(),!c&&(e=!0,document.addEventListener("mousemove",x),document.addEventListener("mouseup",p))}function x(j){if(!e)return;const B=window.innerWidth,D=Math.max(300,Math.min(600,B-j.clientX));Vi(D)}function p(){e=!1,document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",p)}function k(j){if(j.preventDefault(),c)return;o=!0;const B=document.querySelector("[data-right-panel]");if(B){const D=B.getBoundingClientRect();A=j.clientY,P=y,I=D.height}document.addEventListener("mousemove",M),document.addEventListener("mouseup",z)}let A=0,P=50,I=0;function M(j){if(!o)return;const D=(j.clientY-A)/I*100,U=Math.max(20,Math.min(80,P+D));Gi(U)}function z(){o=!1,document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",z)}function q(j){m&&typeof m.handleConnect=="function"?m.handleConnect(j):(console.error("TerminalPanel not available"),alert("终端面板未初始化"))}async function Y(j){var B;if(!window.wailsBindings){console.error("Wails bindings not loaded");return}try{await window.wailsBindings.AddConnection(j);const D={id:j.id,name:j.name,host:j.host,port:j.port,username:j.user,group:((B=j.tags)==null?void 0:B[0])||"默认分组",status:"online",type:j.type||"ssh",auth_type:j.auth_type,key_path:j.key_path,tags:j.tags||[]};ot.update(U=>[...U,D])}catch(D){throw console.error("Failed to add asset:",D),D}}function Z(j){a(4,g=j),a(2,c=!0)}async function Q(j){if(!window.wailsBindings){console.error("Wails bindings not loaded");return}try{ot.update(B=>B.map(D=>{var U;return D.id===j.id?{...D,id:j.id,name:j.name,host:j.host,port:j.port,username:j.user,group:((U=j.tags)==null?void 0:U[0])||"默认分组",type:j.type||"ssh",auth_type:j.auth_type,key_path:j.key_path,tags:j.tags||[]}:D}))}catch(B){throw console.error("Failed to update asset:",B),B}}async function L(){if(!window.wailsBindings){console.warn("Wails bindings not loaded yet");return}try{const j=await window.wailsBindings.GetConnections();console.log("Loaded connections from backend:",j);const B=j.map(D=>{var U;return{id:D.id,name:D.name,host:D.host,port:D.port,username:D.user,group:((U=D.tags)==null?void 0:U[0])||"默认分组",status:"online",type:"ssh",auth_type:D.auth_type,key_path:D.key_path,tags:D.tags||[]}});ot.set(B)}catch(j){console.error("Failed to load connections:",j)}}Rt(async()=>{window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&Ut.set("dark");try{const B=await ei(()=>Promise.resolve().then(()=>mn),void 0);window.wailsBindings=B,window.dispatchEvent(new CustomEvent("wails-bindings-loaded",{detail:Object.keys(B.default||B).join(", ")})),await L()}catch(B){console.warn("Wails bindings not available yet:",B.message)}const j=()=>{const B=document.getElementById("app");B&&(B.style.height="100vh",B.style.width="100vw")};return j(),window.addEventListener("resize",j),()=>{window.removeEventListener("resize",j)}});const O=()=>{a(4,g=null),a(2,c=!0)},H=async j=>{if(!window.wailsBindings){ot.update(B=>B.filter(D=>D.id!==j.id));return}if(confirm(`确定要删除连接 "${j.name}" 吗？`))try{await window.wailsBindings.RemoveConnection(j.id),ot.update(B=>B.filter(D=>D.id!==j.id))}catch(B){console.error("Failed to delete asset:",B),alert("删除连接失败: "+B)}};function F(j){Xe[j?"unshift":"push"](()=>{m=j,a(5,m)})}function N(j){c=j,a(2,c)}function G(j){g=j,a(4,g)}function V(j){_=j,a(1,_)}return l.$$.update=()=>{l.$$.dirty[0]&524288&&h&&Array.from(h.values()),l.$$.dirty[0]&1&&a(9,b=n==="dark"?"dark":""),l.$$.dirty[0]&262144&&a(8,C=t.sidebarWidth),l.$$.dirty[0]&262144&&a(7,R=t.rightPanelWidth),l.$$.dirty[0]&262144&&a(6,y=t.fileManagerHeight)},[n,_,c,u,g,m,y,R,C,b,r,s,S,k,q,Y,Z,Q,t,h,O,H,F,N,G,V]}class lo extends nt{constructor(i){super(),st(this,i,ao,oo,Ze,{},null,[-1,-1])}}new lo({target:document.getElementById("app")});
