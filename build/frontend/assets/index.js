var yi=Object.defineProperty;var Ci=(n,r,c)=>r in n?yi(n,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[r]=c;var Ut=(n,r,c)=>Ci(n,typeof r!="symbol"?r+"":r,c);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const w of document.querySelectorAll('link[rel="modulepreload"]'))b(w);new MutationObserver(w=>{for(const x of w)if(x.type==="childList")for(const y of x.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&b(y)}).observe(document,{childList:!0,subtree:!0});function c(w){const x={};return w.integrity&&(x.integrity=w.integrity),w.referrerPolicy&&(x.referrerPolicy=w.referrerPolicy),w.crossOrigin==="use-credentials"?x.credentials="include":w.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function b(w){if(w.ep)return;w.ep=!0;const x=c(w);fetch(w.href,x)}})();const ki="modulepreload",Ei=function(n){return"/"+n},or={},xi=function(r,c,b){let w=Promise.resolve();if(c&&c.length>0){document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),e=(y==null?void 0:y.nonce)||(y==null?void 0:y.getAttribute("nonce"));w=Promise.allSettled(c.map(o=>{if(o=Ei(o),o in or)return;or[o]=!0;const h=o.endsWith(".css"),_=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${_}`))return;const l=document.createElement("link");if(l.rel=h?"stylesheet":ki,h||(l.as="script"),l.crossOrigin="",l.href=o,e&&l.setAttribute("nonce",e),document.head.appendChild(l),h)return new Promise((d,g)=>{l.addEventListener("load",d),l.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${o}`)))})}))}function x(y){const e=new Event("vite:preloadError",{cancelable:!0});if(e.payload=y,window.dispatchEvent(e),!e.defaultPrevented)throw y}return w.then(y=>{for(const e of y||[])e.status==="rejected"&&x(e.reason);return r().catch(x)})};function Me(){}const Yt=n=>n;function Li(n,r){for(const c in r)n[c]=r[c];return n}function Vr(n){return n()}function ar(){return Object.create(null)}function Ie(n){n.forEach(Vr)}function vt(n){return typeof n=="function"}function Ye(n,r){return n!=n?r==r:n!==r||n&&typeof n=="object"||typeof n=="function"}function Di(n){return Object.keys(n).length===0}function Zt(n,...r){if(n==null){for(const b of r)b(void 0);return Me}const c=n.subscribe(...r);return c.unsubscribe?()=>c.unsubscribe():c}function Ri(n){let r;return Zt(n,c=>r=c)(),r}function Ct(n,r,c){n.$$.on_destroy.push(Zt(r,c))}function Ai(n,r,c,b){if(n){const w=Gr(n,r,c,b);return n[0](w)}}function Gr(n,r,c,b){return n[1]&&b?Li(c.ctx.slice(),n[1](b(r))):c.ctx}function Mi(n,r,c,b){return n[2],r.dirty}function Bi(n,r,c,b,w,x){if(w){const y=Gr(r,c,b,x);n.p(y,w)}}function Ti(n){if(n.ctx.length>32){const r=[],c=n.ctx.length/32;for(let b=0;b<c;b++)r[b]=-1;return r}return-1}function It(n){return n??""}function lr(n){const r=typeof n=="string"&&n.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return r?[parseFloat(r[1]),r[2]||"px"]:[n,"px"]}const Jr=typeof window<"u";let Xr=Jr?()=>window.performance.now():()=>Date.now(),Qt=Jr?n=>requestAnimationFrame(n):Me;const kt=new Set;function Yr(n){kt.forEach(r=>{r.c(n)||(kt.delete(r),r.f())}),kt.size!==0&&Qt(Yr)}function Zr(n){let r;return kt.size===0&&Qt(Yr),{promise:new Promise(c=>{kt.add(r={c:n,f:c})}),abort(){kt.delete(r)}}}const Oi=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function L(n,r){n.appendChild(r)}function Qr(n){if(!n)return document;const r=n.getRootNode?n.getRootNode():n.ownerDocument;return r&&r.host?r:n.ownerDocument}function Pi(n){const r=P("style");return r.textContent="/* empty */",Ii(Qr(n),r),r.sheet}function Ii(n,r){return L(n.head||n,r),r.sheet}function se(n,r,c){n.insertBefore(r,c||null)}function te(n){n.parentNode&&n.parentNode.removeChild(n)}function ei(n,r){for(let c=0;c<n.length;c+=1)n[c]&&n[c].d(r)}function P(n){return document.createElement(n)}function Te(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function ce(n){return document.createTextNode(n)}function z(){return ce(" ")}function xt(){return ce("")}function ee(n,r,c,b){return n.addEventListener(r,c,b),()=>n.removeEventListener(r,c,b)}function Hi(n){return function(r){return r.preventDefault(),n.call(this,r)}}function Fi(n){return function(r){return r.stopPropagation(),n.call(this,r)}}function E(n,r,c){c==null?n.removeAttribute(r):n.getAttribute(r)!==c&&n.setAttribute(r,c)}function Wi(n){return Array.from(n.childNodes)}function Ce(n,r){r=""+r,n.data!==r&&(n.data=r)}function Ee(n,r){n.value=r??""}function pe(n,r,c,b){c==null?n.style.removeProperty(r):n.style.setProperty(r,c,"")}function cr(n,r,c){for(let b=0;b<n.options.length;b+=1){const w=n.options[b];if(w.__value===r){w.selected=!0;return}}(!c||r!==void 0)&&(n.selectedIndex=-1)}function Ni(n){const r=n.querySelector(":checked");return r&&r.__value}function ht(n,r,c){n.classList.toggle(r,!!c)}function ti(n,r,{bubbles:c=!1,cancelable:b=!1}={}){return new CustomEvent(n,{detail:r,bubbles:c,cancelable:b})}const Ht=new Map;let Ft=0;function ji(n){let r=5381,c=n.length;for(;c--;)r=(r<<5)-r^n.charCodeAt(c);return r>>>0}function zi(n,r){const c={stylesheet:Pi(r),rules:{}};return Ht.set(n,c),c}function qt(n,r,c,b,w,x,y,e=0){const o=16.666/b;let h=`{
`;for(let i=0;i<=1;i+=o){const a=r+(c-r)*x(i);h+=i*100+`%{${y(a,1-a)}}
`}const _=h+`100% {${y(c,1-c)}}
}`,l=`__svelte_${ji(_)}_${e}`,d=Qr(n),{stylesheet:g,rules:p}=Ht.get(d)||zi(d,n);p[l]||(p[l]=!0,g.insertRule(`@keyframes ${l} ${_}`,g.cssRules.length));const f=n.style.animation||"";return n.style.animation=`${f?`${f}, `:""}${l} ${b}ms linear ${w}ms 1 both`,Ft+=1,l}function Vt(n,r){const c=(n.style.animation||"").split(", "),b=c.filter(r?x=>x.indexOf(r)<0:x=>x.indexOf("__svelte")===-1),w=c.length-b.length;w&&(n.style.animation=b.join(", "),Ft-=w,Ft||Ui())}function Ui(){Qt(()=>{Ft||(Ht.forEach(n=>{const{ownerNode:r}=n.stylesheet;r&&te(r)}),Ht.clear())})}let Bt;function At(n){Bt=n}function er(){if(!Bt)throw new Error("Function called outside component initialization");return Bt}function Tt(n){er().$$.on_mount.push(n)}function Nt(n){er().$$.on_destroy.push(n)}function tr(){const n=er();return(r,c,{cancelable:b=!1}={})=>{const w=n.$$.callbacks[r];if(w){const x=ti(r,c,{cancelable:b});return w.slice().forEach(y=>{y.call(n,x)}),!x.defaultPrevented}return!0}}const wt=[],je=[];let Et=[];const Gt=[],ri=Promise.resolve();let Jt=!1;function ii(){Jt||(Jt=!0,ri.then(si))}function hr(){return ii(),ri}function Ue(n){Et.push(n)}function lt(n){Gt.push(n)}const $t=new Set;let bt=0;function si(){if(bt!==0)return;const n=Bt;do{try{for(;bt<wt.length;){const r=wt[bt];bt++,At(r),$i(r.$$)}}catch(r){throw wt.length=0,bt=0,r}for(At(null),wt.length=0,bt=0;je.length;)je.pop()();for(let r=0;r<Et.length;r+=1){const c=Et[r];$t.has(c)||($t.add(c),c())}Et.length=0}while(wt.length);for(;Gt.length;)Gt.pop()();Jt=!1,$t.clear(),At(n)}function $i(n){if(n.fragment!==null){n.update(),Ie(n.before_update);const r=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,r),n.after_update.forEach(Ue)}}function Ki(n){const r=[],c=[];Et.forEach(b=>n.indexOf(b)===-1?r.push(b):c.push(b)),c.forEach(b=>b()),Et=r}let Dt;function ni(){return Dt||(Dt=Promise.resolve(),Dt.then(()=>{Dt=null})),Dt}function Mt(n,r,c){n.dispatchEvent(ti(`${r?"intro":"outro"}${c}`))}const Pt=new Set;let ft;function tt(){ft={r:0,c:[],p:ft}}function rt(){ft.r||Ie(ft.c),ft=ft.p}function le(n,r){n&&n.i&&(Pt.delete(n),n.i(r))}function ue(n,r,c,b){if(n&&n.o){if(Pt.has(n))return;Pt.add(n),ft.c.push(()=>{Pt.delete(n),b&&(c&&n.d(1),b())}),n.o(r)}else b&&b()}const oi={duration:0};function rr(n,r,c){const b={direction:"in"};let w=r(n,c,b),x=!1,y,e,o=0;function h(){y&&Vt(n,y)}function _(){const{delay:d=0,duration:g=300,easing:p=Yt,tick:f=Me,css:i}=w||oi;i&&(y=qt(n,0,1,g,d,p,i,o++)),f(0,1);const a=Xr()+d,t=a+g;e&&e.abort(),x=!0,Ue(()=>Mt(n,!0,"start")),e=Zr(s=>{if(x){if(s>=t)return f(1,0),Mt(n,!0,"end"),h(),x=!1;if(s>=a){const u=p((s-a)/g);f(u,1-u)}}return x})}let l=!1;return{start(){l||(l=!0,Vt(n),vt(w)?(w=w(b),ni().then(_)):_())},invalidate(){l=!1},end(){x&&(h(),x=!1)}}}function it(n,r,c,b){let x=r(n,c,{direction:"both"}),y=b?0:1,e=null,o=null,h=null,_;function l(){h&&Vt(n,h)}function d(p,f){const i=p.b-y;return f*=Math.abs(i),{a:y,b:p.b,d:i,duration:f,start:p.start,end:p.start+f,group:p.group}}function g(p){const{delay:f=0,duration:i=300,easing:a=Yt,tick:t=Me,css:s}=x||oi,u={start:Xr()+f,b:p};p||(u.group=ft,ft.r+=1),"inert"in n&&(p?_!==void 0&&(n.inert=_):(_=n.inert,n.inert=!0)),e||o?o=u:(s&&(l(),h=qt(n,y,p,i,f,a,s)),p&&t(0,1),e=d(u,i),Ue(()=>Mt(n,p,"start")),Zr(m=>{if(o&&m>o.start&&(e=d(o,i),o=null,Mt(n,e.b,"start"),s&&(l(),h=qt(n,y,e.b,e.duration,0,a,x.css))),e){if(m>=e.end)t(y=e.b,1-y),Mt(n,e.b,"end"),o||(e.b?l():--e.group.r||Ie(e.group.c)),e=null;else if(m>=e.start){const S=m-e.start;y=e.a+e.d*a(S/e.duration),t(y,1-y)}}return!!(e||o)}))}return{run(p){vt(x)?ni().then(()=>{x=x({direction:p?"in":"out"}),g(p)}):g(p)},end(){l(),e=o=null}}}function ze(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function ir(n,r){n.d(1),r.delete(n.key)}function sr(n,r){ue(n,1,1,()=>{r.delete(n.key)})}function Lt(n,r,c,b,w,x,y,e,o,h,_,l){let d=n.length,g=x.length,p=d;const f={};for(;p--;)f[n[p].key]=p;const i=[],a=new Map,t=new Map,s=[];for(p=g;p--;){const C=l(w,x,p),v=c(C);let k=y.get(v);k?s.push(()=>k.p(C,r)):(k=h(v,C),k.c()),a.set(v,i[p]=k),v in f&&t.set(v,Math.abs(p-f[v]))}const u=new Set,m=new Set;function S(C){le(C,1),C.m(e,_),y.set(C.key,C),_=C.first,g--}for(;d&&g;){const C=i[g-1],v=n[d-1],k=C.key,T=v.key;C===v?(_=C.first,d--,g--):a.has(T)?!y.has(k)||u.has(k)?S(C):m.has(T)?d--:t.get(k)>t.get(T)?(m.add(k),S(C)):(u.add(T),d--):(o(v,y),d--)}for(;d--;){const C=n[d];a.has(C.key)||o(C,y)}for(;g;)S(i[g-1]);return Ie(s),i}function ct(n,r,c){const b=n.$$.props[r];b!==void 0&&(n.$$.bound[b]=c,c(n.$$.ctx[b]))}function Ae(n){n&&n.c()}function Le(n,r,c){const{fragment:b,after_update:w}=n.$$;b&&b.m(r,c),Ue(()=>{const x=n.$$.on_mount.map(Vr).filter(vt);n.$$.on_destroy?n.$$.on_destroy.push(...x):Ie(x),n.$$.on_mount=[]}),w.forEach(Ue)}function De(n,r){const c=n.$$;c.fragment!==null&&(Ki(c.after_update),Ie(c.on_destroy),c.fragment&&c.fragment.d(r),c.on_destroy=c.fragment=null,c.ctx=[])}function qi(n,r){n.$$.dirty[0]===-1&&(wt.push(n),ii(),n.$$.dirty.fill(0)),n.$$.dirty[r/31|0]|=1<<r%31}function Ze(n,r,c,b,w,x,y=null,e=[-1]){const o=Bt;At(n);const h=n.$$={fragment:null,ctx:[],props:x,update:Me,not_equal:w,bound:ar(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(o?o.$$.context:[])),callbacks:ar(),dirty:e,skip_bound:!1,root:r.target||o.$$.root};y&&y(h.root);let _=!1;if(h.ctx=c?c(n,r.props||{},(l,d,...g)=>{const p=g.length?g[0]:d;return h.ctx&&w(h.ctx[l],h.ctx[l]=p)&&(!h.skip_bound&&h.bound[l]&&h.bound[l](p),_&&qi(n,l)),d}):[],h.update(),_=!0,Ie(h.before_update),h.fragment=b?b(h.ctx):!1,r.target){if(r.hydrate){const l=Wi(r.target);h.fragment&&h.fragment.l(l),l.forEach(te)}else h.fragment&&h.fragment.c();r.intro&&le(n.$$.fragment),Le(n,r.target,r.anchor),si()}At(o)}class Qe{constructor(){Ut(this,"$$");Ut(this,"$$set")}$destroy(){De(this,1),this.$destroy=Me}$on(r,c){if(!vt(c))return Me;const b=this.$$.callbacks[r]||(this.$$.callbacks[r]=[]);return b.push(c),()=>{const w=b.indexOf(c);w!==-1&&b.splice(w,1)}}$set(r){this.$$set&&!Di(r)&&(this.$$.skip_bound=!0,this.$$set(r),this.$$.skip_bound=!1)}}const Vi="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Vi);const St=[];function Gi(n,r){return{subscribe:mt(n,r).subscribe}}function mt(n,r=Me){let c;const b=new Set;function w(e){if(Ye(n,e)&&(n=e,c)){const o=!St.length;for(const h of b)h[1](),St.push(h,n);if(o){for(let h=0;h<St.length;h+=2)St[h][0](St[h+1]);St.length=0}}}function x(e){w(e(n))}function y(e,o=Me){const h=[e,o];return b.add(h),b.size===1&&(c=r(w,x)||Me),e(n),()=>{b.delete(h),b.size===0&&c&&(c(),c=null)}}return{set:w,update:x,subscribe:y}}function dt(n,r,c){const b=!Array.isArray(n),w=b?[n]:n;if(!w.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const x=r.length<2;return Gi(c,(y,e)=>{let o=!1;const h=[];let _=0,l=Me;const d=()=>{if(_)return;l();const p=r(b?h[0]:h,y,e);x?y(p):l=vt(p)?p:Me},g=w.map((p,f)=>Zt(p,i=>{h[f]=i,_&=~(1<<f),o&&d()},()=>{_|=1<<f}));return o=!0,d(),function(){Ie(g),l(),o=!1}})}const Ji={collapsed:!0,width:400,sessionStates:{},transfers:{}};function Xi(){const{subscribe:n,set:r,update:c}=mt({...Ji});return{subscribe:n,set:r,async init(){if(!(typeof window>"u"))try{const b=localStorage.getItem("ssh-tools-file-manager");if(b){const w=JSON.parse(b);c(x=>({...x,collapsed:w.collapsed!==void 0?w.collapsed:x.collapsed,width:w.width||x.width}))}}catch(b){console.error("Failed to load file manager config:",b)}},saveConfig(){typeof window>"u"||n(b=>{try{localStorage.setItem("ssh-tools-file-manager",JSON.stringify({collapsed:b.collapsed,width:b.width}))}catch(w){console.error("Failed to save file manager config:",w)}})},async setCollapsed(b){c(w=>({...w,collapsed:b}))},async setWidth(b){c(w=>({...w,width:b}))},getSessionState(b){let w=null;return n(x=>{w=x.sessionStates[b]||null})(),w},setSessionState(b,w){c(x=>({...x,sessionStates:{...x.sessionStates,[b]:{...x.sessionStates[b]||{},...w}}}))},updateSessionProperty(b,w,x){c(y=>({...y,sessionStates:{...y.sessionStates,[b]:{...y.sessionStates[b]||{},[w]:x}}}))},clearSessionState(b){c(w=>{const x={...w.sessionStates};return delete x[b],{...w,sessionStates:x}})},updateTransfer(b,w){c(x=>({...x,transfers:{...x.transfers,[b]:{...x.transfers[b],transfer_id:b,...w}}}))},removeTransfer(b){c(w=>{const x={...w.transfers};return delete x[b],{...w,transfers:x}})},clearTransfers(){c(b=>({...b,transfers:{}}))}}}const st=Xi();dt(st,n=>n.collapsed);dt(st,n=>n.width);dt(st,n=>n.transfers);const ut=mt([]);dt(ut,n=>n.reduce((r,c)=>(r[c.group]||(r[c.group]=[]),r[c.group].push(c),r),{}));const yt=mt(new Map),Rt=mt(null),Wt=mt("light");function Yi(){if(typeof window>"u")return null;try{const n=localStorage.getItem("ssh-tools-ui-config");if(!n)return null;const r=JSON.parse(n);return r.sidebarWidth&&(r.sidebarWidth=Number(r.sidebarWidth)),r.rightPanelWidth&&(r.rightPanelWidth=Number(r.rightPanelWidth)),r.fileManagerHeight&&(r.fileManagerHeight=Number(r.fileManagerHeight)),r}catch{return null}}const Zi={isDevToolsOpen:!1,isFileManagerOpen:!1,isMonitorOpen:!1,sidebarWidth:288,rightPanelWidth:320,fileManagerHeight:50},Qi=Yi(),nt=mt({...Zi,...Qi});nt.subscribe(n=>{if(typeof window<"u")try{localStorage.setItem("ssh-tools-ui-config",JSON.stringify(n))}catch{}});dt(nt,n=>n.isDevToolsOpen);dt(nt,n=>n.isFileManagerOpen);dt(nt,n=>n.isMonitorOpen);dt(nt,n=>n.sidebarWidth);dt(nt,n=>n.rightPanelWidth);dt(nt,n=>n.fileManagerHeight);function es(n){nt.update(r=>({...r,sidebarWidth:n}))}function ts(n){nt.update(r=>({...r,rightPanelWidth:n}))}function rs(n){nt.update(r=>({...r,fileManagerHeight:n}))}function dr(n,r,c){const b=n.slice();return b[17]=r[c][0],b[18]=r[c][1],b}function ur(n,r,c){const b=n.slice();return b[21]=r[c],b}function is(n){let r,c;return{c(){r=Te("svg"),c=Te("path"),E(c,"stroke-linecap","round"),E(c,"stroke-linejoin","round"),E(c,"stroke-width","2"),E(c,"d","M9 5l7 7-7 7"),E(r,"class","w-4 h-4 text-gray-500 dark:text-gray-400"),E(r,"fill","none"),E(r,"stroke","currentColor"),E(r,"viewBox","0 0 24 24")},m(b,w){se(b,r,w),L(r,c)},d(b){b&&te(r)}}}function ss(n){let r,c;return{c(){r=Te("svg"),c=Te("path"),E(c,"stroke-linecap","round"),E(c,"stroke-linejoin","round"),E(c,"stroke-width","2"),E(c,"d","M19 9l-7 7-7-7"),E(r,"class","w-4 h-4 text-gray-500 dark:text-gray-400"),E(r,"fill","none"),E(r,"stroke","currentColor"),E(r,"viewBox","0 0 24 24")},m(b,w){se(b,r,w),L(r,c)},d(b){b&&te(r)}}}function fr(n){let r,c=[],b=new Map,w=ze(n[18]);const x=y=>y[21].id;for(let y=0;y<w.length;y+=1){let e=ur(n,w,y),o=x(e);b.set(o,c[y]=pr(o,e))}return{c(){r=P("div");for(let y=0;y<c.length;y+=1)c[y].c();E(r,"class","ml-4")},m(y,e){se(y,r,e);for(let o=0;o<c.length;o+=1)c[o]&&c[o].m(r,null)},p(y,e){e&165&&(w=ze(y[18]),c=Lt(c,e,x,1,y,w,b,r,ir,pr,null,ur))},d(y){y&&te(r);for(let e=0;e<c.length;e+=1)c[e].d()}}}function _r(n){let r,c=n[21].dbType.toUpperCase()+"",b;return{c(){r=ce("• "),b=ce(c)},m(w,x){se(w,r,x),se(w,b,x)},p(w,x){x&32&&c!==(c=w[21].dbType.toUpperCase()+"")&&Ce(b,c)},d(w){w&&(te(r),te(b))}}}function pr(n,r){let c,b,w=vr(r[21].type)+"",x,y,e,o,h=r[21].name+"",_,l,d,g,p,f,i=r[21].username+"",a,t,s=r[21].host+"",u,m,S=r[21].port+"",C,v,k,T,B,A,M,W,N,G,X,K,D=r[21].type==="database"&&r[21].dbType&&_r(r);function O(){return r[13](r[21])}function I(...V){return r[14](r[21],...V)}function H(...V){return r[15](r[21],...V)}function q(){return r[16](r[21])}return{key:n,first:null,c(){c=P("div"),b=P("div"),x=z(),y=P("div"),e=P("div"),o=P("span"),_=ce(h),l=z(),d=P("div"),p=z(),f=P("div"),a=ce(i),t=ce("@"),u=ce(s),m=ce(":"),C=ce(S),v=z(),D&&D.c(),k=z(),T=P("div"),B=P("button"),B.innerHTML='<svg class="w-3 h-3 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>',A=z(),M=P("button"),M.innerHTML='<svg class="w-3 h-3 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>',W=z(),N=P("button"),N.innerHTML='<svg class="w-3 h-3 text-red-600 dark:text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>',G=z(),E(b,"class","flex-shrink-0"),E(o,"class","text-sm font-medium text-gray-900 dark:text-white truncate"),E(d,"class",g=`w-2 h-2 rounded-full flex-shrink-0 ${r[21].status==="online"?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}`),E(e,"class","flex items-center gap-2"),E(f,"class","text-xs text-gray-500 dark:text-gray-400 truncate"),E(y,"class","flex-1 min-w-0"),E(B,"class","p-1 hover:bg-green-100 dark:hover:bg-green-800 rounded"),E(B,"title","连接"),E(M,"class","p-1 hover:bg-purple-100 dark:hover:bg-purple-800 rounded"),E(N,"class","p-1 hover:bg-red-100 dark:hover:bg-red-800 rounded"),E(T,"class","opacity-0 group-hover:opacity-100 flex gap-1 transition-opacity"),E(c,"class","group flex items-center gap-2 px-3 py-2.5 hover:bg-purple-50 dark:hover:bg-purple-900/20 rounded-lg mx-2 cursor-pointer transition-all"),this.first=c},m(V,Q){se(V,c,Q),L(c,b),b.innerHTML=w,L(c,x),L(c,y),L(y,e),L(e,o),L(o,_),L(e,l),L(e,d),L(y,p),L(y,f),L(f,a),L(f,t),L(f,u),L(f,m),L(f,C),L(f,v),D&&D.m(f,null),L(c,k),L(c,T),L(T,B),L(T,A),L(T,M),L(T,W),L(T,N),L(c,G),X||(K=[ee(B,"click",Fi(O)),ee(M,"click",I),ee(N,"click",H),ee(c,"click",q)],X=!0)},p(V,Q){r=V,Q&32&&w!==(w=vr(r[21].type)+"")&&(b.innerHTML=w),Q&32&&h!==(h=r[21].name+"")&&Ce(_,h),Q&32&&g!==(g=`w-2 h-2 rounded-full flex-shrink-0 ${r[21].status==="online"?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}`)&&E(d,"class",g),Q&32&&i!==(i=r[21].username+"")&&Ce(a,i),Q&32&&s!==(s=r[21].host+"")&&Ce(u,s),Q&32&&S!==(S=r[21].port+"")&&Ce(C,S),r[21].type==="database"&&r[21].dbType?D?D.p(r,Q):(D=_r(r),D.c(),D.m(f,null)):D&&(D.d(1),D=null)},d(V){V&&te(c),D&&D.d(),X=!1,Ie(K)}}}function gr(n){let r,c,b,w,x,y,e,o,h=n[17]+"",_,l,d,g,p=n[18].length+"",f,i,a,t=n[4].has(n[17]),s,u,m;function S(B,A){return A&48&&(b=null),b==null&&(b=!!B[4].has(B[17])),b?ss:is}let C=S(n,-1),v=C(n);function k(){return n[12](n[17])}let T=t&&fr(n);return{c(){r=P("div"),c=P("div"),v.c(),w=z(),x=Te("svg"),y=Te("path"),e=z(),o=P("span"),_=ce(h),l=z(),d=P("span"),g=ce("("),f=ce(p),i=ce(")"),a=z(),T&&T.c(),s=z(),E(y,"d","M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"),E(x,"class","w-4 h-4 text-amber-500"),E(x,"fill","currentColor"),E(x,"viewBox","0 0 24 24"),E(o,"class","text-sm font-medium text-gray-700 dark:text-gray-300"),E(d,"class","ml-auto text-xs text-gray-400 dark:text-gray-500"),E(c,"class","flex items-center gap-2 px-3 py-2 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors"),E(r,"class","mb-1")},m(B,A){se(B,r,A),L(r,c),v.m(c,null),L(c,w),L(c,x),L(x,y),L(c,e),L(c,o),L(o,_),L(c,l),L(c,d),L(d,g),L(d,f),L(d,i),L(r,a),T&&T.m(r,null),L(r,s),u||(m=ee(c,"click",k),u=!0)},p(B,A){n=B,C!==(C=S(n,A))&&(v.d(1),v=C(n),v&&(v.c(),v.m(c,w))),A&32&&h!==(h=n[17]+"")&&Ce(_,h),A&32&&p!==(p=n[18].length+"")&&Ce(f,p),A&48&&(t=n[4].has(n[17])),t?T?T.p(n,A):(T=fr(n),T.c(),T.m(r,s)):T&&(T.d(1),T=null)},d(B){B&&te(r),v.d(),T&&T.d(),u=!1,m()}}}function ns(n){let r,c,b,w,x,y,e,o,h,_,l,d,g,p,f,i,a=ze(Object.entries(n[5])),t=[];for(let s=0;s<a.length;s+=1)t[s]=gr(dr(n,a,s));return{c(){r=P("div"),c=P("div"),b=P("div"),w=P("h2"),w.textContent="服务器资产",x=z(),y=P("button"),y.innerHTML='<svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>',e=z(),o=P("div"),h=Te("svg"),_=Te("path"),l=z(),d=P("input"),g=z(),p=P("div");for(let s=0;s<t.length;s+=1)t[s].c();E(w,"class","text-sm font-semibold text-gray-900 dark:text-white"),E(y,"class","p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"),E(b,"class","flex items-center justify-between mb-3"),E(_,"stroke-linecap","round"),E(_,"stroke-linejoin","round"),E(_,"stroke-width","2"),E(_,"d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"),E(h,"class","absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"),E(h,"fill","none"),E(h,"stroke","currentColor"),E(h,"viewBox","0 0 24 24"),E(d,"type","text"),E(d,"placeholder","搜索服务器..."),E(d,"class","w-full pl-9 pr-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"),E(o,"class","relative"),E(c,"class","p-4 border-b border-gray-200 dark:border-gray-700"),E(p,"class","flex-1 overflow-y-auto scrollbar-thin"),E(r,"class","h-full flex flex-col bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700")},m(s,u){se(s,r,u),L(r,c),L(c,b),L(b,w),L(b,x),L(b,y),L(c,e),L(c,o),L(o,h),L(h,_),L(o,l),L(o,d),Ee(d,n[3]),L(r,g),L(r,p);for(let m=0;m<t.length;m+=1)t[m]&&t[m].m(p,null);f||(i=[ee(y,"click",function(){vt(n[1])&&n[1].apply(this,arguments)}),ee(d,"input",n[11])],f=!0)},p(s,[u]){if(n=s,u&8&&d.value!==n[3]&&Ee(d,n[3]),u&245){a=ze(Object.entries(n[5]));let m;for(m=0;m<a.length;m+=1){const S=dr(n,a,m);t[m]?t[m].p(S,u):(t[m]=gr(S),t[m].c(),t[m].m(p,null))}for(;m<t.length;m+=1)t[m].d(1);t.length=a.length}},i:Me,o:Me,d(s){s&&te(r),ei(t,s),f=!1,Ie(i)}}}function vr(n){switch(n){case"database":return`<svg class="w-4 h-4 text-blue-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4" />
        </svg>`;case"docker":return`<svg class="w-4 h-4 text-cyan-600 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24">
          <path d="M13.983 11.078h2.119a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186h-2.119a.185.185 0 00-.185.185v1.888c0 .102.083.185.185.185m-2.954-3.333h2.118a.186.186 0 00.186-.186V5.671a.186.186 0 00-.186-.185h-2.118a.185.185 0 00-.185.185v1.888c0 .102.082.185.185.185m-2.954 3.333h2.118a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186H8.075a.186.186 0 00-.186.186v1.888c0 .102.083.185.186.185m-2.954-3.333h2.119a.186.186 0 00.185-.186V5.671a.185.185 0 00-.185-.185H5.12a.186.186 0 00-.186.185v1.888c0 .102.084.185.186.185m-2.93 3.333h2.12a.185.185 0 00.185-.185V9.006a.185.185 0 00-.186-.186h-2.12a.185.185 0 00-.184.186v1.888c0 .102.083.185.185.185M20.69 6.662c.057.16.09.331.09.51v7.9c0 3.058-2.724 4.928-8.78 4.928-6.055 0-8.779-1.87-8.779-4.928v-7.9c0-.179.033-.35.09-.51C1.536 7.396 0 9.522 0 12.072v3.639c0 4.072 3.608 6.789 12 6.789 8.391 0 12-2.717 12-6.79v-3.638c0-2.55-1.536-4.677-4.31-6.41" />
        </svg>`;default:return`<svg class="w-4 h-4 text-purple-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01" />
        </svg>`}}function os(n,r,c){let b,w,x;Ct(n,ut,u=>c(10,x=u));let{onConnect:y}=r,{onAddClick:e}=r,{onDelete:o}=r,{onEdit:h}=r,_="",l=new Set(["生产环境","开发环境"]);function d(u){const m=new Set(l);m.has(u)?m.delete(u):m.add(u),c(4,l=m)}async function g(u,m){if(m.stopPropagation(),!window.wailsBindings){console.error("Wails bindings not loaded"),ut.update(S=>S.filter(C=>C.id!==u.id));return}if(confirm(`确定要删除连接 "${u.name}" 吗？`))try{await window.wailsBindings.RemoveConnection(u.id),ut.update(S=>S.filter(C=>C.id!==u.id))}catch(S){console.error("Failed to delete asset:",S)}}function p(){_=this.value,c(3,_)}const f=u=>d(u),i=u=>y(u),a=(u,m)=>h(u),t=(u,m)=>g(u,m),s=u=>y(u);return n.$$set=u=>{"onConnect"in u&&c(0,y=u.onConnect),"onAddClick"in u&&c(1,e=u.onAddClick),"onDelete"in u&&c(8,o=u.onDelete),"onEdit"in u&&c(2,h=u.onEdit)},n.$$.update=()=>{n.$$.dirty&1032&&c(9,b=x.filter(u=>{const m=_.toLowerCase();return u.name.toLowerCase().includes(m)||u.host.toLowerCase().includes(m)||u.group.toLowerCase().includes(m)||u.username.toLowerCase().includes(m)})),n.$$.dirty&512&&c(5,w=b.reduce((u,m)=>(u[m.group]||(u[m.group]=[]),u[m.group].push(m),u),{}))},[y,e,h,_,l,w,d,g,o,b,x,p,f,i,a,t,s]}class as extends Qe{constructor(r){super(),Ze(this,r,os,ns,Ye,{onConnect:0,onAddClick:1,onDelete:8,onEdit:2})}}var ai={exports:{}};(function(n,r){(function(c,b){n.exports=b()})(globalThis,()=>(()=>{var c={4567:function(y,e,o){var h=this&&this.__decorate||function(t,s,u,m){var S,C=arguments.length,v=C<3?s:m===null?m=Object.getOwnPropertyDescriptor(s,u):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(t,s,u,m);else for(var k=t.length-1;k>=0;k--)(S=t[k])&&(v=(C<3?S(v):C>3?S(s,u,v):S(s,u))||v);return C>3&&v&&Object.defineProperty(s,u,v),v},_=this&&this.__param||function(t,s){return function(u,m){s(u,m,t)}};Object.defineProperty(e,"__esModule",{value:!0}),e.AccessibilityManager=void 0;const l=o(9042),d=o(9924),g=o(844),p=o(4725),f=o(2585),i=o(3656);let a=e.AccessibilityManager=class extends g.Disposable{constructor(t,s,u,m){super(),this._terminal=t,this._coreBrowserService=u,this._renderService=m,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let S=0;S<this._terminal.rows;S++)this._rowElements[S]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[S]);if(this._topBoundaryFocusListener=S=>this._handleBoundaryFocus(S,0),this._bottomBoundaryFocusListener=S=>this._handleBoundaryFocus(S,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new d.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(S=>this._handleResize(S.rows))),this.register(this._terminal.onRender(S=>this._refreshRows(S.start,S.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(S=>this._handleChar(S))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(S=>this._handleTab(S))),this.register(this._terminal.onKey(S=>this._handleKey(S.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,i.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,g.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(t){for(let s=0;s<t;s++)this._handleChar(" ")}_handleChar(t){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==t&&(this._charsToAnnounce+=t):this._charsToAnnounce+=t,t===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=l.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(t){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(t)||this._charsToConsume.push(t)}_refreshRows(t,s){this._liveRegionDebouncer.refresh(t,s,this._terminal.rows)}_renderRows(t,s){const u=this._terminal.buffer,m=u.lines.length.toString();for(let S=t;S<=s;S++){const C=u.lines.get(u.ydisp+S),v=[],k=(C==null?void 0:C.translateToString(!0,void 0,void 0,v))||"",T=(u.ydisp+S+1).toString(),B=this._rowElements[S];B&&(k.length===0?(B.innerText=" ",this._rowColumns.set(B,[0,1])):(B.textContent=k,this._rowColumns.set(B,v)),B.setAttribute("aria-posinset",T),B.setAttribute("aria-setsize",m))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(t,s){const u=t.target,m=this._rowElements[s===0?1:this._rowElements.length-2];if(u.getAttribute("aria-posinset")===(s===0?"1":`${this._terminal.buffer.lines.length}`)||t.relatedTarget!==m)return;let S,C;if(s===0?(S=u,C=this._rowElements.pop(),this._rowContainer.removeChild(C)):(S=this._rowElements.shift(),C=u,this._rowContainer.removeChild(S)),S.removeEventListener("focus",this._topBoundaryFocusListener),C.removeEventListener("focus",this._bottomBoundaryFocusListener),s===0){const v=this._createAccessibilityTreeNode();this._rowElements.unshift(v),this._rowContainer.insertAdjacentElement("afterbegin",v)}else{const v=this._createAccessibilityTreeNode();this._rowElements.push(v),this._rowContainer.appendChild(v)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(s===0?-1:1),this._rowElements[s===0?1:this._rowElements.length-2].focus(),t.preventDefault(),t.stopImmediatePropagation()}_handleSelectionChange(){var k;if(this._rowElements.length===0)return;const t=document.getSelection();if(!t)return;if(t.isCollapsed)return void(this._rowContainer.contains(t.anchorNode)&&this._terminal.clearSelection());if(!t.anchorNode||!t.focusNode)return void console.error("anchorNode and/or focusNode are null");let s={node:t.anchorNode,offset:t.anchorOffset},u={node:t.focusNode,offset:t.focusOffset};if((s.node.compareDocumentPosition(u.node)&Node.DOCUMENT_POSITION_PRECEDING||s.node===u.node&&s.offset>u.offset)&&([s,u]=[u,s]),s.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(s={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(s.node))return;const m=this._rowElements.slice(-1)[0];if(u.node.compareDocumentPosition(m)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(u={node:m,offset:((k=m.textContent)==null?void 0:k.length)??0}),!this._rowContainer.contains(u.node))return;const S=({node:T,offset:B})=>{const A=T instanceof Text?T.parentNode:T;let M=parseInt(A==null?void 0:A.getAttribute("aria-posinset"),10)-1;if(isNaN(M))return console.warn("row is invalid. Race condition?"),null;const W=this._rowColumns.get(A);if(!W)return console.warn("columns is null. Race condition?"),null;let N=B<W.length?W[B]:W.slice(-1)[0]+1;return N>=this._terminal.cols&&(++M,N=0),{row:M,column:N}},C=S(s),v=S(u);if(C&&v){if(C.row>v.row||C.row===v.row&&C.column>=v.column)throw new Error("invalid range");this._terminal.select(C.column,C.row,(v.row-C.row)*this._terminal.cols-C.column+v.column)}}_handleResize(t){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let s=this._rowContainer.children.length;s<this._terminal.rows;s++)this._rowElements[s]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[s]);for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const t=this._coreBrowserService.mainDocument.createElement("div");return t.setAttribute("role","listitem"),t.tabIndex=-1,this._refreshRowDimensions(t),t}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let t=0;t<this._terminal.rows;t++)this._refreshRowDimensions(this._rowElements[t])}}_refreshRowDimensions(t){t.style.height=`${this._renderService.dimensions.css.cell.height}px`}};e.AccessibilityManager=a=h([_(1,f.IInstantiationService),_(2,p.ICoreBrowserService),_(3,p.IRenderService)],a)},3614:(y,e)=>{function o(d){return d.replace(/\r?\n/g,"\r")}function h(d,g){return g?"\x1B[200~"+d+"\x1B[201~":d}function _(d,g,p,f){d=h(d=o(d),p.decPrivateModes.bracketedPasteMode&&f.rawOptions.ignoreBracketedPasteMode!==!0),p.triggerDataEvent(d,!0),g.value=""}function l(d,g,p){const f=p.getBoundingClientRect(),i=d.clientX-f.left-10,a=d.clientY-f.top-10;g.style.width="20px",g.style.height="20px",g.style.left=`${i}px`,g.style.top=`${a}px`,g.style.zIndex="1000",g.focus()}Object.defineProperty(e,"__esModule",{value:!0}),e.rightClickHandler=e.moveTextAreaUnderMouseCursor=e.paste=e.handlePasteEvent=e.copyHandler=e.bracketTextForPaste=e.prepareTextForTerminal=void 0,e.prepareTextForTerminal=o,e.bracketTextForPaste=h,e.copyHandler=function(d,g){d.clipboardData&&d.clipboardData.setData("text/plain",g.selectionText),d.preventDefault()},e.handlePasteEvent=function(d,g,p,f){d.stopPropagation(),d.clipboardData&&_(d.clipboardData.getData("text/plain"),g,p,f)},e.paste=_,e.moveTextAreaUnderMouseCursor=l,e.rightClickHandler=function(d,g,p,f,i){l(d,g,p),i&&f.rightClickSelect(d),g.value=f.selectionText,g.select()}},7239:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorContrastCache=void 0;const h=o(1505);e.ColorContrastCache=class{constructor(){this._color=new h.TwoKeyMap,this._css=new h.TwoKeyMap}setCss(_,l,d){this._css.set(_,l,d)}getCss(_,l){return this._css.get(_,l)}setColor(_,l,d){this._color.set(_,l,d)}getColor(_,l){return this._color.get(_,l)}clear(){this._color.clear(),this._css.clear()}}},3656:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.addDisposableDomListener=void 0,e.addDisposableDomListener=function(o,h,_,l){o.addEventListener(h,_,l);let d=!1;return{dispose:()=>{d||(d=!0,o.removeEventListener(h,_,l))}}}},3551:function(y,e,o){var h=this&&this.__decorate||function(a,t,s,u){var m,S=arguments.length,C=S<3?t:u===null?u=Object.getOwnPropertyDescriptor(t,s):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(a,t,s,u);else for(var v=a.length-1;v>=0;v--)(m=a[v])&&(C=(S<3?m(C):S>3?m(t,s,C):m(t,s))||C);return S>3&&C&&Object.defineProperty(t,s,C),C},_=this&&this.__param||function(a,t){return function(s,u){t(s,u,a)}};Object.defineProperty(e,"__esModule",{value:!0}),e.Linkifier=void 0;const l=o(3656),d=o(8460),g=o(844),p=o(2585),f=o(4725);let i=e.Linkifier=class extends g.Disposable{get currentLink(){return this._currentLink}constructor(a,t,s,u,m){super(),this._element=a,this._mouseService=t,this._renderService=s,this._bufferService=u,this._linkProviderService=m,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new d.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new d.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,g.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,g.toDisposable)(()=>{var S;this._lastMouseEvent=void 0,(S=this._activeProviderReplies)==null||S.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,l.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,l.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,l.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,l.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(a){this._lastMouseEvent=a;const t=this._positionFromMouseEvent(a,this._element,this._mouseService);if(!t)return;this._isMouseOut=!1;const s=a.composedPath();for(let u=0;u<s.length;u++){const m=s[u];if(m.classList.contains("xterm"))break;if(m.classList.contains("xterm-hover"))return}this._lastBufferCell&&t.x===this._lastBufferCell.x&&t.y===this._lastBufferCell.y||(this._handleHover(t),this._lastBufferCell=t)}_handleHover(a){if(this._activeLine!==a.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(a,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,a)||(this._clearCurrentLink(),this._askForLink(a,!0))}_askForLink(a,t){var u,m;this._activeProviderReplies&&t||((u=this._activeProviderReplies)==null||u.forEach(S=>{S==null||S.forEach(C=>{C.link.dispose&&C.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=a.y);let s=!1;for(const[S,C]of this._linkProviderService.linkProviders.entries())t?(m=this._activeProviderReplies)!=null&&m.get(S)&&(s=this._checkLinkProviderResult(S,a,s)):C.provideLinks(a.y,v=>{var T,B;if(this._isMouseOut)return;const k=v==null?void 0:v.map(A=>({link:A}));(T=this._activeProviderReplies)==null||T.set(S,k),s=this._checkLinkProviderResult(S,a,s),((B=this._activeProviderReplies)==null?void 0:B.size)===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(a.y,this._activeProviderReplies)})}_removeIntersectingLinks(a,t){const s=new Set;for(let u=0;u<t.size;u++){const m=t.get(u);if(m)for(let S=0;S<m.length;S++){const C=m[S],v=C.link.range.start.y<a?0:C.link.range.start.x,k=C.link.range.end.y>a?this._bufferService.cols:C.link.range.end.x;for(let T=v;T<=k;T++){if(s.has(T)){m.splice(S--,1);break}s.add(T)}}}}_checkLinkProviderResult(a,t,s){var S;if(!this._activeProviderReplies)return s;const u=this._activeProviderReplies.get(a);let m=!1;for(let C=0;C<a;C++)this._activeProviderReplies.has(C)&&!this._activeProviderReplies.get(C)||(m=!0);if(!m&&u){const C=u.find(v=>this._linkAtPosition(v.link,t));C&&(s=!0,this._handleNewLink(C))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!s)for(let C=0;C<this._activeProviderReplies.size;C++){const v=(S=this._activeProviderReplies.get(C))==null?void 0:S.find(k=>this._linkAtPosition(k.link,t));if(v){s=!0,this._handleNewLink(v);break}}return s}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(a){if(!this._currentLink)return;const t=this._positionFromMouseEvent(a,this._element,this._mouseService);t&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,t)&&this._currentLink.link.activate(a,this._currentLink.link.text)}_clearCurrentLink(a,t){this._currentLink&&this._lastMouseEvent&&(!a||!t||this._currentLink.link.range.start.y>=a&&this._currentLink.link.range.end.y<=t)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,g.disposeArray)(this._linkCacheDisposables))}_handleNewLink(a){if(!this._lastMouseEvent)return;const t=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);t&&this._linkAtPosition(a.link,t)&&(this._currentLink=a,this._currentLink.state={decorations:{underline:a.link.decorations===void 0||a.link.decorations.underline,pointerCursor:a.link.decorations===void 0||a.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,a.link,this._lastMouseEvent),a.link.decorations={},Object.defineProperties(a.link.decorations,{pointerCursor:{get:()=>{var s,u;return(u=(s=this._currentLink)==null?void 0:s.state)==null?void 0:u.decorations.pointerCursor},set:s=>{var u;(u=this._currentLink)!=null&&u.state&&this._currentLink.state.decorations.pointerCursor!==s&&(this._currentLink.state.decorations.pointerCursor=s,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",s))}},underline:{get:()=>{var s,u;return(u=(s=this._currentLink)==null?void 0:s.state)==null?void 0:u.decorations.underline},set:s=>{var u,m,S;(u=this._currentLink)!=null&&u.state&&((S=(m=this._currentLink)==null?void 0:m.state)==null?void 0:S.decorations.underline)!==s&&(this._currentLink.state.decorations.underline=s,this._currentLink.state.isHovered&&this._fireUnderlineEvent(a.link,s))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(s=>{if(!this._currentLink)return;const u=s.start===0?0:s.start+1+this._bufferService.buffer.ydisp,m=this._bufferService.buffer.ydisp+1+s.end;if(this._currentLink.link.range.start.y>=u&&this._currentLink.link.range.end.y<=m&&(this._clearCurrentLink(u,m),this._lastMouseEvent)){const S=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);S&&this._askForLink(S,!1)}})))}_linkHover(a,t,s){var u;(u=this._currentLink)!=null&&u.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!0),this._currentLink.state.decorations.pointerCursor&&a.classList.add("xterm-cursor-pointer")),t.hover&&t.hover(s,t.text)}_fireUnderlineEvent(a,t){const s=a.range,u=this._bufferService.buffer.ydisp,m=this._createLinkUnderlineEvent(s.start.x-1,s.start.y-u-1,s.end.x,s.end.y-u-1,void 0);(t?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(m)}_linkLeave(a,t,s){var u;(u=this._currentLink)!=null&&u.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!1),this._currentLink.state.decorations.pointerCursor&&a.classList.remove("xterm-cursor-pointer")),t.leave&&t.leave(s,t.text)}_linkAtPosition(a,t){const s=a.range.start.y*this._bufferService.cols+a.range.start.x,u=a.range.end.y*this._bufferService.cols+a.range.end.x,m=t.y*this._bufferService.cols+t.x;return s<=m&&m<=u}_positionFromMouseEvent(a,t,s){const u=s.getCoords(a,t,this._bufferService.cols,this._bufferService.rows);if(u)return{x:u[0],y:u[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(a,t,s,u,m){return{x1:a,y1:t,x2:s,y2:u,cols:this._bufferService.cols,fg:m}}};e.Linkifier=i=h([_(1,f.IMouseService),_(2,f.IRenderService),_(3,p.IBufferService),_(4,f.ILinkProviderService)],i)},9042:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.tooMuchOutput=e.promptLabel=void 0,e.promptLabel="Terminal input",e.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(y,e,o){var h=this&&this.__decorate||function(f,i,a,t){var s,u=arguments.length,m=u<3?i:t===null?t=Object.getOwnPropertyDescriptor(i,a):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(f,i,a,t);else for(var S=f.length-1;S>=0;S--)(s=f[S])&&(m=(u<3?s(m):u>3?s(i,a,m):s(i,a))||m);return u>3&&m&&Object.defineProperty(i,a,m),m},_=this&&this.__param||function(f,i){return function(a,t){i(a,t,f)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OscLinkProvider=void 0;const l=o(511),d=o(2585);let g=e.OscLinkProvider=class{constructor(f,i,a){this._bufferService=f,this._optionsService=i,this._oscLinkService=a}provideLinks(f,i){var k;const a=this._bufferService.buffer.lines.get(f-1);if(!a)return void i(void 0);const t=[],s=this._optionsService.rawOptions.linkHandler,u=new l.CellData,m=a.getTrimmedLength();let S=-1,C=-1,v=!1;for(let T=0;T<m;T++)if(C!==-1||a.hasContent(T)){if(a.loadCell(T,u),u.hasExtendedAttrs()&&u.extended.urlId){if(C===-1){C=T,S=u.extended.urlId;continue}v=u.extended.urlId!==S}else C!==-1&&(v=!0);if(v||C!==-1&&T===m-1){const B=(k=this._oscLinkService.getLinkData(S))==null?void 0:k.uri;if(B){const A={start:{x:C+1,y:f},end:{x:T+(v||T!==m-1?0:1),y:f}};let M=!1;if(!(s!=null&&s.allowNonHttpProtocols))try{const W=new URL(B);["http:","https:"].includes(W.protocol)||(M=!0)}catch{M=!0}M||t.push({text:B,range:A,activate:(W,N)=>s?s.activate(W,N,A):p(0,N),hover:(W,N)=>{var G;return(G=s==null?void 0:s.hover)==null?void 0:G.call(s,W,N,A)},leave:(W,N)=>{var G;return(G=s==null?void 0:s.leave)==null?void 0:G.call(s,W,N,A)}})}v=!1,u.hasExtendedAttrs()&&u.extended.urlId?(C=T,S=u.extended.urlId):(C=-1,S=-1)}}i(t)}};function p(f,i){if(confirm(`Do you want to navigate to ${i}?

WARNING: This link could potentially be dangerous`)){const a=window.open();if(a){try{a.opener=null}catch{}a.location.href=i}else console.warn("Opening link blocked as opener could not be cleared")}}e.OscLinkProvider=g=h([_(0,d.IBufferService),_(1,d.IOptionsService),_(2,d.IOscLinkService)],g)},6193:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RenderDebouncer=void 0,e.RenderDebouncer=class{constructor(o,h){this._renderCallback=o,this._coreBrowserService=h,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(o){return this._refreshCallbacks.push(o),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(o,h,_){this._rowCount=_,o=o!==void 0?o:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,o):o,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const o=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(o,h),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const o of this._refreshCallbacks)o(0);this._refreshCallbacks=[]}}},3236:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;const h=o(3614),_=o(3656),l=o(3551),d=o(9042),g=o(3730),p=o(1680),f=o(3107),i=o(5744),a=o(2950),t=o(1296),s=o(428),u=o(4269),m=o(5114),S=o(8934),C=o(3230),v=o(9312),k=o(4725),T=o(6731),B=o(8055),A=o(8969),M=o(8460),W=o(844),N=o(6114),G=o(8437),X=o(2584),K=o(7399),D=o(5941),O=o(9074),I=o(2585),H=o(5435),q=o(4567),V=o(779);class Q extends A.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(F={}){super(F),this.browser=N,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new W.MutableDisposable),this._onCursorMove=this.register(new M.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new M.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new M.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new M.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new M.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new M.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new M.EventEmitter),this._onBlur=this.register(new M.EventEmitter),this._onA11yCharEmitter=this.register(new M.EventEmitter),this._onA11yTabEmitter=this.register(new M.EventEmitter),this._onWillOpen=this.register(new M.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(O.DecorationService),this._instantiationService.setService(I.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(V.LinkProviderService),this._instantiationService.setService(k.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(g.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((R,$)=>this.refresh(R,$))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(R=>this._reportWindowsOptions(R))),this.register(this._inputHandler.onColor(R=>this._handleColorEvent(R))),this.register((0,M.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,M.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,M.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,M.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(R=>this._afterResize(R.cols,R.rows))),this.register((0,W.toDisposable)(()=>{var R,$;this._customKeyEventHandler=void 0,($=(R=this.element)==null?void 0:R.parentNode)==null||$.removeChild(this.element)}))}_handleColorEvent(F){if(this._themeService)for(const R of F){let $,j="";switch(R.index){case 256:$="foreground",j="10";break;case 257:$="background",j="11";break;case 258:$="cursor",j="12";break;default:$="ansi",j="4;"+R.index}switch(R.type){case 0:const Y=B.color.toColorRGB($==="ansi"?this._themeService.colors.ansi[R.index]:this._themeService.colors[$]);this.coreService.triggerDataEvent(`${X.C0.ESC}]${j};${(0,D.toRgbString)(Y)}${X.C1_ESCAPED.ST}`);break;case 1:if($==="ansi")this._themeService.modifyColors(Z=>Z.ansi[R.index]=B.channels.toColor(...R.color));else{const Z=$;this._themeService.modifyColors(he=>he[Z]=B.channels.toColor(...R.color))}break;case 2:this._themeService.restoreColor(R.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(F){F?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(q.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(F){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(X.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var F;return(F=this.textarea)==null?void 0:F.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(X.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const F=this.buffer.ybase+this.buffer.y,R=this.buffer.lines.get(F);if(!R)return;const $=Math.min(this.buffer.x,this.cols-1),j=this._renderService.dimensions.css.cell.height,Y=R.getWidth($),Z=this._renderService.dimensions.css.cell.width*Y,he=this.buffer.y*this._renderService.dimensions.css.cell.height,me=$*this._renderService.dimensions.css.cell.width;this.textarea.style.left=me+"px",this.textarea.style.top=he+"px",this.textarea.style.width=Z+"px",this.textarea.style.height=j+"px",this.textarea.style.lineHeight=j+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,_.addDisposableDomListener)(this.element,"copy",R=>{this.hasSelection()&&(0,h.copyHandler)(R,this._selectionService)}));const F=R=>(0,h.handlePasteEvent)(R,this.textarea,this.coreService,this.optionsService);this.register((0,_.addDisposableDomListener)(this.textarea,"paste",F)),this.register((0,_.addDisposableDomListener)(this.element,"paste",F)),N.isFirefox?this.register((0,_.addDisposableDomListener)(this.element,"mousedown",R=>{R.button===2&&(0,h.rightClickHandler)(R,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,_.addDisposableDomListener)(this.element,"contextmenu",R=>{(0,h.rightClickHandler)(R,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),N.isLinux&&this.register((0,_.addDisposableDomListener)(this.element,"auxclick",R=>{R.button===1&&(0,h.moveTextAreaUnderMouseCursor)(R,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,_.addDisposableDomListener)(this.textarea,"keyup",F=>this._keyUp(F),!0)),this.register((0,_.addDisposableDomListener)(this.textarea,"keydown",F=>this._keyDown(F),!0)),this.register((0,_.addDisposableDomListener)(this.textarea,"keypress",F=>this._keyPress(F),!0)),this.register((0,_.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,_.addDisposableDomListener)(this.textarea,"compositionupdate",F=>this._compositionHelper.compositionupdate(F))),this.register((0,_.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,_.addDisposableDomListener)(this.textarea,"input",F=>this._inputEvent(F),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(F){var $;if(!F)throw new Error("Terminal requires a parent element.");if(F.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),(($=this.element)==null?void 0:$.ownerDocument.defaultView)&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=F.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),F.appendChild(this.element);const R=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),R.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,_.addDisposableDomListener)(this.screenElement,"mousemove",j=>this.updateCursorStyle(j))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),R.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",d.promptLabel),N.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(m.CoreBrowserService,this.textarea,F.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(k.ICoreBrowserService,this._coreBrowserService),this.register((0,_.addDisposableDomListener)(this.textarea,"focus",j=>this._handleTextAreaFocus(j))),this.register((0,_.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(s.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(k.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(T.ThemeService),this._instantiationService.setService(k.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(u.CharacterJoinerService),this._instantiationService.setService(k.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(C.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(k.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(j=>this._onRender.fire(j))),this.onResize(j=>this._renderService.resize(j.cols,j.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(a.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(S.MouseService),this._instantiationService.setService(k.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(l.Linkifier,this.screenElement)),this.element.appendChild(R);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(p.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(j=>this.scrollLines(j.amount,j.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(v.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(k.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(j=>this.scrollLines(j.amount,j.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(j=>this._renderService.handleSelectionChanged(j.start,j.end,j.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(j=>{this.textarea.value=j,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(j=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,_.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(f.BufferDecorationRenderer,this.screenElement)),this.register((0,_.addDisposableDomListener)(this.element,"mousedown",j=>this._selectionService.handleMouseDown(j))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(q.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",j=>this._handleScreenReaderModeOptionChange(j))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(i.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",j=>{!this._overviewRulerRenderer&&j&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(i.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(t.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const F=this,R=this.element;function $(Z){const he=F._mouseService.getMouseReportCoords(Z,F.screenElement);if(!he)return!1;let me,ye;switch(Z.overrideType||Z.type){case"mousemove":ye=32,Z.buttons===void 0?(me=3,Z.button!==void 0&&(me=Z.button<3?Z.button:3)):me=1&Z.buttons?0:4&Z.buttons?1:2&Z.buttons?2:3;break;case"mouseup":ye=0,me=Z.button<3?Z.button:3;break;case"mousedown":ye=1,me=Z.button<3?Z.button:3;break;case"wheel":if(F._customWheelEventHandler&&F._customWheelEventHandler(Z)===!1||F.viewport.getLinesScrolled(Z)===0)return!1;ye=Z.deltaY<0?0:1,me=4;break;default:return!1}return!(ye===void 0||me===void 0||me>4)&&F.coreMouseService.triggerMouseEvent({col:he.col,row:he.row,x:he.x,y:he.y,button:me,action:ye,ctrl:Z.ctrlKey,alt:Z.altKey,shift:Z.shiftKey})}const j={mouseup:null,wheel:null,mousedrag:null,mousemove:null},Y={mouseup:Z=>($(Z),Z.buttons||(this._document.removeEventListener("mouseup",j.mouseup),j.mousedrag&&this._document.removeEventListener("mousemove",j.mousedrag)),this.cancel(Z)),wheel:Z=>($(Z),this.cancel(Z,!0)),mousedrag:Z=>{Z.buttons&&$(Z)},mousemove:Z=>{Z.buttons||$(Z)}};this.register(this.coreMouseService.onProtocolChange(Z=>{Z?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(Z)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&Z?j.mousemove||(R.addEventListener("mousemove",Y.mousemove),j.mousemove=Y.mousemove):(R.removeEventListener("mousemove",j.mousemove),j.mousemove=null),16&Z?j.wheel||(R.addEventListener("wheel",Y.wheel,{passive:!1}),j.wheel=Y.wheel):(R.removeEventListener("wheel",j.wheel),j.wheel=null),2&Z?j.mouseup||(j.mouseup=Y.mouseup):(this._document.removeEventListener("mouseup",j.mouseup),j.mouseup=null),4&Z?j.mousedrag||(j.mousedrag=Y.mousedrag):(this._document.removeEventListener("mousemove",j.mousedrag),j.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,_.addDisposableDomListener)(R,"mousedown",Z=>{if(Z.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(Z))return $(Z),j.mouseup&&this._document.addEventListener("mouseup",j.mouseup),j.mousedrag&&this._document.addEventListener("mousemove",j.mousedrag),this.cancel(Z)})),this.register((0,_.addDisposableDomListener)(R,"wheel",Z=>{if(!j.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(Z)===!1)return!1;if(!this.buffer.hasScrollback){const he=this.viewport.getLinesScrolled(Z);if(he===0)return;const me=X.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(Z.deltaY<0?"A":"B");let ye="";for(let fe=0;fe<Math.abs(he);fe++)ye+=me;return this.coreService.triggerDataEvent(ye,!0),this.cancel(Z,!0)}return this.viewport.handleWheel(Z)?this.cancel(Z):void 0}},{passive:!1})),this.register((0,_.addDisposableDomListener)(R,"touchstart",Z=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(Z),this.cancel(Z)},{passive:!0})),this.register((0,_.addDisposableDomListener)(R,"touchmove",Z=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(Z)?void 0:this.cancel(Z)},{passive:!1}))}refresh(F,R){var $;($=this._renderService)==null||$.refreshRows(F,R)}updateCursorStyle(F){var R;(R=this._selectionService)!=null&&R.shouldColumnSelect(F)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(F,R,$=0){var j;$===1?(super.scrollLines(F,R,$),this.refresh(0,this.rows-1)):(j=this.viewport)==null||j.scrollLines(F)}paste(F){(0,h.paste)(F,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(F){this._customKeyEventHandler=F}attachCustomWheelEventHandler(F){this._customWheelEventHandler=F}registerLinkProvider(F){return this._linkProviderService.registerLinkProvider(F)}registerCharacterJoiner(F){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const R=this._characterJoinerService.register(F);return this.refresh(0,this.rows-1),R}deregisterCharacterJoiner(F){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(F)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(F){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+F)}registerDecoration(F){return this._decorationService.registerDecoration(F)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(F,R,$){this._selectionService.setSelection(F,R,$)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var F;(F=this._selectionService)==null||F.clearSelection()}selectAll(){var F;(F=this._selectionService)==null||F.selectAll()}selectLines(F,R){var $;($=this._selectionService)==null||$.selectLines(F,R)}_keyDown(F){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1)return!1;const R=this.browser.isMac&&this.options.macOptionIsMeta&&F.altKey;if(!R&&!this._compositionHelper.keydown(F))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;R||F.key!=="Dead"&&F.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const $=(0,K.evaluateKeyboardEvent)(F,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(F),$.type===3||$.type===2){const j=this.rows-1;return this.scrollLines($.type===2?-j:j),this.cancel(F,!0)}return $.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,F)||($.cancel&&this.cancel(F,!0),!$.key||!!(F.key&&!F.ctrlKey&&!F.altKey&&!F.metaKey&&F.key.length===1&&F.key.charCodeAt(0)>=65&&F.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):($.key!==X.C0.ETX&&$.key!==X.C0.CR||(this.textarea.value=""),this._onKey.fire({key:$.key,domEvent:F}),this._showCursor(),this.coreService.triggerDataEvent($.key,!0),!this.optionsService.rawOptions.screenReaderMode||F.altKey||F.ctrlKey?this.cancel(F,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(F,R){const $=F.isMac&&!this.options.macOptionIsMeta&&R.altKey&&!R.ctrlKey&&!R.metaKey||F.isWindows&&R.altKey&&R.ctrlKey&&!R.metaKey||F.isWindows&&R.getModifierState("AltGraph");return R.type==="keypress"?$:$&&(!R.keyCode||R.keyCode>47)}_keyUp(F){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1||(function(R){return R.keyCode===16||R.keyCode===17||R.keyCode===18}(F)||this.focus(),this.updateCursorStyle(F),this._keyPressHandled=!1)}_keyPress(F){let R;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1)return!1;if(this.cancel(F),F.charCode)R=F.charCode;else if(F.which===null||F.which===void 0)R=F.keyCode;else{if(F.which===0||F.charCode===0)return!1;R=F.which}return!(!R||(F.altKey||F.ctrlKey||F.metaKey)&&!this._isThirdLevelShift(this.browser,F)||(R=String.fromCharCode(R),this._onKey.fire({key:R,domEvent:F}),this._showCursor(),this.coreService.triggerDataEvent(R,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(F){if(F.data&&F.inputType==="insertText"&&(!F.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const R=F.data;return this.coreService.triggerDataEvent(R,!0),this.cancel(F),!0}return!1}resize(F,R){F!==this.cols||R!==this.rows?super.resize(F,R):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(F,R){var $,j;($=this._charSizeService)==null||$.measure(),(j=this.viewport)==null||j.syncScrollArea(!0)}clear(){var F;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let R=1;R<this.rows;R++)this.buffer.lines.push(this.buffer.getBlankLine(G.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(F=this.viewport)==null||F.reset(),this.refresh(0,this.rows-1)}}reset(){var R,$;this.options.rows=this.rows,this.options.cols=this.cols;const F=this._customKeyEventHandler;this._setup(),super.reset(),(R=this._selectionService)==null||R.reset(),this._decorationService.reset(),($=this.viewport)==null||$.reset(),this._customKeyEventHandler=F,this.refresh(0,this.rows-1)}clearTextureAtlas(){var F;(F=this._renderService)==null||F.clearTextureAtlas()}_reportFocus(){var F;(F=this.element)!=null&&F.classList.contains("focus")?this.coreService.triggerDataEvent(X.C0.ESC+"[I"):this.coreService.triggerDataEvent(X.C0.ESC+"[O")}_reportWindowsOptions(F){if(this._renderService)switch(F){case H.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const R=this._renderService.dimensions.css.canvas.width.toFixed(0),$=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${X.C0.ESC}[4;${$};${R}t`);break;case H.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const j=this._renderService.dimensions.css.cell.width.toFixed(0),Y=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${X.C0.ESC}[6;${Y};${j}t`)}}cancel(F,R){if(this.options.cancelEvents||R)return F.preventDefault(),F.stopPropagation(),!1}}e.Terminal=Q},9924:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TimeBasedDebouncer=void 0,e.TimeBasedDebouncer=class{constructor(o,h=1e3){this._renderCallback=o,this._debounceThresholdMS=h,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(o,h,_){this._rowCount=_,o=o!==void 0?o:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,o):o,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h;const l=Date.now();if(l-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=l,this._innerRefresh();else if(!this._additionalRefreshRequested){const d=l-this._lastRefreshMs,g=this._debounceThresholdMS-d;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},g)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const o=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(o,h)}}},1680:function(y,e,o){var h=this&&this.__decorate||function(a,t,s,u){var m,S=arguments.length,C=S<3?t:u===null?u=Object.getOwnPropertyDescriptor(t,s):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(a,t,s,u);else for(var v=a.length-1;v>=0;v--)(m=a[v])&&(C=(S<3?m(C):S>3?m(t,s,C):m(t,s))||C);return S>3&&C&&Object.defineProperty(t,s,C),C},_=this&&this.__param||function(a,t){return function(s,u){t(s,u,a)}};Object.defineProperty(e,"__esModule",{value:!0}),e.Viewport=void 0;const l=o(3656),d=o(4725),g=o(8460),p=o(844),f=o(2585);let i=e.Viewport=class extends p.Disposable{constructor(a,t,s,u,m,S,C,v){super(),this._viewportElement=a,this._scrollArea=t,this._bufferService=s,this._optionsService=u,this._charSizeService=m,this._renderService=S,this._coreBrowserService=C,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new g.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,l.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(k=>this._activeBuffer=k.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(k=>this._renderDimensions=k)),this._handleThemeChange(v.colors),this.register(v.onChangeColors(k=>this._handleThemeChange(k))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(a){this._viewportElement.style.backgroundColor=a.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(a){if(a)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const t=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==t&&(this._lastRecordedBufferHeight=t,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const a=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==a&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=a),this._refreshAnimationFrame=null}syncScrollArea(a=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(a);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(a)}_handleScroll(a){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const t=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:t,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const a=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(a*(this._smoothScrollState.target-this._smoothScrollState.origin)),a<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(a,t){const s=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(t<0&&this._viewportElement.scrollTop!==0||t>0&&s<this._lastRecordedBufferHeight)||(a.cancelable&&a.preventDefault(),!1)}handleWheel(a){const t=this._getPixelsScrolled(a);return t!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+t:this._smoothScrollState.target+=t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=t,this._bubbleScroll(a,t))}scrollLines(a){if(a!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const t=a*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:a,suppressScrollEvent:!1})}_getPixelsScrolled(a){if(a.deltaY===0||a.shiftKey)return 0;let t=this._applyScrollModifier(a.deltaY,a);return a.deltaMode===WheelEvent.DOM_DELTA_LINE?t*=this._currentRowHeight:a.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._currentRowHeight*this._bufferService.rows),t}getBufferElements(a,t){var v;let s,u="";const m=[],S=t??this._bufferService.buffer.lines.length,C=this._bufferService.buffer.lines;for(let k=a;k<S;k++){const T=C.get(k);if(!T)continue;const B=(v=C.get(k+1))==null?void 0:v.isWrapped;if(u+=T.translateToString(!B),!B||k===C.length-1){const A=document.createElement("div");A.textContent=u,m.push(A),u.length>0&&(s=A),u=""}}return{bufferElements:m,cursorElement:s}}getLinesScrolled(a){if(a.deltaY===0||a.shiftKey)return 0;let t=this._applyScrollModifier(a.deltaY,a);return a.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(t/=this._currentRowHeight+0,this._wheelPartialScroll+=t,t=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):a.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._bufferService.rows),t}_applyScrollModifier(a,t){const s=this._optionsService.rawOptions.fastScrollModifier;return s==="alt"&&t.altKey||s==="ctrl"&&t.ctrlKey||s==="shift"&&t.shiftKey?a*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:a*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(a){this._lastTouchY=a.touches[0].pageY}handleTouchMove(a){const t=this._lastTouchY-a.touches[0].pageY;return this._lastTouchY=a.touches[0].pageY,t!==0&&(this._viewportElement.scrollTop+=t,this._bubbleScroll(a,t))}};e.Viewport=i=h([_(2,f.IBufferService),_(3,f.IOptionsService),_(4,d.ICharSizeService),_(5,d.IRenderService),_(6,d.ICoreBrowserService),_(7,d.IThemeService)],i)},3107:function(y,e,o){var h=this&&this.__decorate||function(f,i,a,t){var s,u=arguments.length,m=u<3?i:t===null?t=Object.getOwnPropertyDescriptor(i,a):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(f,i,a,t);else for(var S=f.length-1;S>=0;S--)(s=f[S])&&(m=(u<3?s(m):u>3?s(i,a,m):s(i,a))||m);return u>3&&m&&Object.defineProperty(i,a,m),m},_=this&&this.__param||function(f,i){return function(a,t){i(a,t,f)}};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferDecorationRenderer=void 0;const l=o(4725),d=o(844),g=o(2585);let p=e.BufferDecorationRenderer=class extends d.Disposable{constructor(f,i,a,t,s){super(),this._screenElement=f,this._bufferService=i,this._coreBrowserService=a,this._decorationService=t,this._renderService=s,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(u=>this._removeDecoration(u))),this.register((0,d.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const f of this._decorationService.decorations)this._renderDecoration(f);this._dimensionsChanged=!1}_renderDecoration(f){this._refreshStyle(f),this._dimensionsChanged&&this._refreshXPosition(f)}_createElement(f){var t;const i=this._coreBrowserService.mainDocument.createElement("div");i.classList.add("xterm-decoration"),i.classList.toggle("xterm-decoration-top-layer",((t=f==null?void 0:f.options)==null?void 0:t.layer)==="top"),i.style.width=`${Math.round((f.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,i.style.height=(f.options.height||1)*this._renderService.dimensions.css.cell.height+"px",i.style.top=(f.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",i.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const a=f.options.x??0;return a&&a>this._bufferService.cols&&(i.style.display="none"),this._refreshXPosition(f,i),i}_refreshStyle(f){const i=f.marker.line-this._bufferService.buffers.active.ydisp;if(i<0||i>=this._bufferService.rows)f.element&&(f.element.style.display="none",f.onRenderEmitter.fire(f.element));else{let a=this._decorationElements.get(f);a||(a=this._createElement(f),f.element=a,this._decorationElements.set(f,a),this._container.appendChild(a),f.onDispose(()=>{this._decorationElements.delete(f),a.remove()})),a.style.top=i*this._renderService.dimensions.css.cell.height+"px",a.style.display=this._altBufferIsActive?"none":"block",f.onRenderEmitter.fire(a)}}_refreshXPosition(f,i=f.element){if(!i)return;const a=f.options.x??0;(f.options.anchor||"left")==="right"?i.style.right=a?a*this._renderService.dimensions.css.cell.width+"px":"":i.style.left=a?a*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(f){var i;(i=this._decorationElements.get(f))==null||i.remove(),this._decorationElements.delete(f),f.dispose()}};e.BufferDecorationRenderer=p=h([_(1,g.IBufferService),_(2,l.ICoreBrowserService),_(3,g.IDecorationService),_(4,l.IRenderService)],p)},5871:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorZoneStore=void 0,e.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(o){if(o.options.overviewRulerOptions){for(const h of this._zones)if(h.color===o.options.overviewRulerOptions.color&&h.position===o.options.overviewRulerOptions.position){if(this._lineIntersectsZone(h,o.marker.line))return;if(this._lineAdjacentToZone(h,o.marker.line,o.options.overviewRulerOptions.position))return void this._addLineToZone(h,o.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=o.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=o.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=o.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=o.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:o.options.overviewRulerOptions.color,position:o.options.overviewRulerOptions.position,startBufferLine:o.marker.line,endBufferLine:o.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(o){this._linePadding=o}_lineIntersectsZone(o,h){return h>=o.startBufferLine&&h<=o.endBufferLine}_lineAdjacentToZone(o,h,_){return h>=o.startBufferLine-this._linePadding[_||"full"]&&h<=o.endBufferLine+this._linePadding[_||"full"]}_addLineToZone(o,h){o.startBufferLine=Math.min(o.startBufferLine,h),o.endBufferLine=Math.max(o.endBufferLine,h)}}},5744:function(y,e,o){var h=this&&this.__decorate||function(s,u,m,S){var C,v=arguments.length,k=v<3?u:S===null?S=Object.getOwnPropertyDescriptor(u,m):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(s,u,m,S);else for(var T=s.length-1;T>=0;T--)(C=s[T])&&(k=(v<3?C(k):v>3?C(u,m,k):C(u,m))||k);return v>3&&k&&Object.defineProperty(u,m,k),k},_=this&&this.__param||function(s,u){return function(m,S){u(m,S,s)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OverviewRulerRenderer=void 0;const l=o(5871),d=o(4725),g=o(844),p=o(2585),f={full:0,left:0,center:0,right:0},i={full:0,left:0,center:0,right:0},a={full:0,left:0,center:0,right:0};let t=e.OverviewRulerRenderer=class extends g.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(s,u,m,S,C,v,k){var B;super(),this._viewportElement=s,this._screenElement=u,this._bufferService=m,this._decorationService=S,this._renderService=C,this._optionsService=v,this._coreBrowserService=k,this._colorZoneStore=new l.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(B=this._viewportElement.parentElement)==null||B.insertBefore(this._canvas,this._viewportElement);const T=this._canvas.getContext("2d");if(!T)throw new Error("Ctx cannot be null");this._ctx=T,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,g.toDisposable)(()=>{var A;(A=this._canvas)==null||A.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const s=Math.floor(this._canvas.width/3),u=Math.ceil(this._canvas.width/3);i.full=this._canvas.width,i.left=s,i.center=u,i.right=s,this._refreshDrawHeightConstants(),a.full=0,a.left=0,a.center=i.left,a.right=i.left+i.center}_refreshDrawHeightConstants(){f.full=Math.round(2*this._coreBrowserService.dpr);const s=this._canvas.height/this._bufferService.buffer.lines.length,u=Math.round(Math.max(Math.min(s,12),6)*this._coreBrowserService.dpr);f.left=u,f.center=u,f.right=u}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*f.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const u of this._decorationService.decorations)this._colorZoneStore.addDecoration(u);this._ctx.lineWidth=1;const s=this._colorZoneStore.zones;for(const u of s)u.position!=="full"&&this._renderColorZone(u);for(const u of s)u.position==="full"&&this._renderColorZone(u);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(s){this._ctx.fillStyle=s.color,this._ctx.fillRect(a[s.position||"full"],Math.round((this._canvas.height-1)*(s.startBufferLine/this._bufferService.buffers.active.lines.length)-f[s.position||"full"]/2),i[s.position||"full"],Math.round((this._canvas.height-1)*((s.endBufferLine-s.startBufferLine)/this._bufferService.buffers.active.lines.length)+f[s.position||"full"]))}_queueRefresh(s,u){this._shouldUpdateDimensions=s||this._shouldUpdateDimensions,this._shouldUpdateAnchor=u||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};e.OverviewRulerRenderer=t=h([_(2,p.IBufferService),_(3,p.IDecorationService),_(4,d.IRenderService),_(5,p.IOptionsService),_(6,d.ICoreBrowserService)],t)},2950:function(y,e,o){var h=this&&this.__decorate||function(f,i,a,t){var s,u=arguments.length,m=u<3?i:t===null?t=Object.getOwnPropertyDescriptor(i,a):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(f,i,a,t);else for(var S=f.length-1;S>=0;S--)(s=f[S])&&(m=(u<3?s(m):u>3?s(i,a,m):s(i,a))||m);return u>3&&m&&Object.defineProperty(i,a,m),m},_=this&&this.__param||function(f,i){return function(a,t){i(a,t,f)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CompositionHelper=void 0;const l=o(4725),d=o(2585),g=o(2584);let p=e.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(f,i,a,t,s,u){this._textarea=f,this._compositionView=i,this._bufferService=a,this._optionsService=t,this._coreService=s,this._renderService=u,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(f){this._compositionView.textContent=f.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(f){if(this._isComposing||this._isSendingComposition){if(f.keyCode===229||f.keyCode===16||f.keyCode===17||f.keyCode===18)return!1;this._finalizeComposition(!1)}return f.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(f){if(this._compositionView.classList.remove("active"),this._isComposing=!1,f){const i={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let a;this._isSendingComposition=!1,i.start+=this._dataAlreadySent.length,a=this._isComposing?this._textarea.value.substring(i.start,i.end):this._textarea.value.substring(i.start),a.length>0&&this._coreService.triggerDataEvent(a,!0)}},0)}else{this._isSendingComposition=!1;const i=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(i,!0)}}_handleAnyTextareaChanges(){const f=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const i=this._textarea.value,a=i.replace(f,"");this._dataAlreadySent=a,i.length>f.length?this._coreService.triggerDataEvent(a,!0):i.length<f.length?this._coreService.triggerDataEvent(`${g.C0.DEL}`,!0):i.length===f.length&&i!==f&&this._coreService.triggerDataEvent(i,!0)}},0)}updateCompositionElements(f){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const i=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),a=this._renderService.dimensions.css.cell.height,t=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,s=i*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=s+"px",this._compositionView.style.top=t+"px",this._compositionView.style.height=a+"px",this._compositionView.style.lineHeight=a+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const u=this._compositionView.getBoundingClientRect();this._textarea.style.left=s+"px",this._textarea.style.top=t+"px",this._textarea.style.width=Math.max(u.width,1)+"px",this._textarea.style.height=Math.max(u.height,1)+"px",this._textarea.style.lineHeight=u.height+"px"}f||setTimeout(()=>this.updateCompositionElements(!0),0)}}};e.CompositionHelper=p=h([_(2,d.IBufferService),_(3,d.IOptionsService),_(4,d.ICoreService),_(5,l.IRenderService)],p)},9806:(y,e)=>{function o(h,_,l){const d=l.getBoundingClientRect(),g=h.getComputedStyle(l),p=parseInt(g.getPropertyValue("padding-left")),f=parseInt(g.getPropertyValue("padding-top"));return[_.clientX-d.left-p,_.clientY-d.top-f]}Object.defineProperty(e,"__esModule",{value:!0}),e.getCoords=e.getCoordsRelativeToElement=void 0,e.getCoordsRelativeToElement=o,e.getCoords=function(h,_,l,d,g,p,f,i,a){if(!p)return;const t=o(h,_,l);return t?(t[0]=Math.ceil((t[0]+(a?f/2:0))/f),t[1]=Math.ceil(t[1]/i),t[0]=Math.min(Math.max(t[0],1),d+(a?1:0)),t[1]=Math.min(Math.max(t[1],1),g),t):void 0}},9504:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.moveToCellSequence=void 0;const h=o(2584);function _(i,a,t,s){const u=i-l(i,t),m=a-l(a,t),S=Math.abs(u-m)-function(C,v,k){let T=0;const B=C-l(C,k),A=v-l(v,k);for(let M=0;M<Math.abs(B-A);M++){const W=d(C,v)==="A"?-1:1,N=k.buffer.lines.get(B+W*M);N!=null&&N.isWrapped&&T++}return T}(i,a,t);return f(S,p(d(i,a),s))}function l(i,a){let t=0,s=a.buffer.lines.get(i),u=s==null?void 0:s.isWrapped;for(;u&&i>=0&&i<a.rows;)t++,s=a.buffer.lines.get(--i),u=s==null?void 0:s.isWrapped;return t}function d(i,a){return i>a?"A":"B"}function g(i,a,t,s,u,m){let S=i,C=a,v="";for(;S!==t||C!==s;)S+=u?1:-1,u&&S>m.cols-1?(v+=m.buffer.translateBufferLineToString(C,!1,i,S),S=0,i=0,C++):!u&&S<0&&(v+=m.buffer.translateBufferLineToString(C,!1,0,i+1),S=m.cols-1,i=S,C--);return v+m.buffer.translateBufferLineToString(C,!1,i,S)}function p(i,a){const t=a?"O":"[";return h.C0.ESC+t+i}function f(i,a){i=Math.floor(i);let t="";for(let s=0;s<i;s++)t+=a;return t}e.moveToCellSequence=function(i,a,t,s){const u=t.buffer.x,m=t.buffer.y;if(!t.buffer.hasScrollback)return function(v,k,T,B,A,M){return _(k,B,A,M).length===0?"":f(g(v,k,v,k-l(k,A),!1,A).length,p("D",M))}(u,m,0,a,t,s)+_(m,a,t,s)+function(v,k,T,B,A,M){let W;W=_(k,B,A,M).length>0?B-l(B,A):k;const N=B,G=function(X,K,D,O,I,H){let q;return q=_(D,O,I,H).length>0?O-l(O,I):K,X<D&&q<=O||X>=D&&q<O?"C":"D"}(v,k,T,B,A,M);return f(g(v,W,T,N,G==="C",A).length,p(G,M))}(u,m,i,a,t,s);let S;if(m===a)return S=u>i?"D":"C",f(Math.abs(u-i),p(S,s));S=m>a?"D":"C";const C=Math.abs(m-a);return f(function(v,k){return k.cols-v}(m>a?i:u,t)+(C-1)*t.cols+1+((m>a?u:i)-1),p(S,s))}},1296:function(y,e,o){var h=this&&this.__decorate||function(M,W,N,G){var X,K=arguments.length,D=K<3?W:G===null?G=Object.getOwnPropertyDescriptor(W,N):G;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(M,W,N,G);else for(var O=M.length-1;O>=0;O--)(X=M[O])&&(D=(K<3?X(D):K>3?X(W,N,D):X(W,N))||D);return K>3&&D&&Object.defineProperty(W,N,D),D},_=this&&this.__param||function(M,W){return function(N,G){W(N,G,M)}};Object.defineProperty(e,"__esModule",{value:!0}),e.DomRenderer=void 0;const l=o(3787),d=o(2550),g=o(2223),p=o(6171),f=o(6052),i=o(4725),a=o(8055),t=o(8460),s=o(844),u=o(2585),m="xterm-dom-renderer-owner-",S="xterm-rows",C="xterm-fg-",v="xterm-bg-",k="xterm-focus",T="xterm-selection";let B=1,A=e.DomRenderer=class extends s.Disposable{constructor(M,W,N,G,X,K,D,O,I,H,q,V,Q){super(),this._terminal=M,this._document=W,this._element=N,this._screenElement=G,this._viewportElement=X,this._helperContainer=K,this._linkifier2=D,this._charSizeService=I,this._optionsService=H,this._bufferService=q,this._coreBrowserService=V,this._themeService=Q,this._terminalClass=B++,this._rowElements=[],this._selectionRenderModel=(0,f.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new t.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(S),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(T),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,p.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(U=>this._injectCss(U))),this._injectCss(this._themeService.colors),this._rowFactory=O.createInstance(l.DomRendererRowFactory,document),this._element.classList.add(m+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(U=>this._handleLinkHover(U))),this.register(this._linkifier2.onHideLinkUnderline(U=>this._handleLinkLeave(U))),this.register((0,s.toDisposable)(()=>{this._element.classList.remove(m+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new d.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const M=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*M,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*M),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/M),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/M),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const N of this._rowElements)N.style.width=`${this.dimensions.css.canvas.width}px`,N.style.height=`${this.dimensions.css.cell.height}px`,N.style.lineHeight=`${this.dimensions.css.cell.height}px`,N.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const W=`${this._terminalSelector} .${S} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=W,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(M){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let W=`${this._terminalSelector} .${S} { color: ${M.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;W+=`${this._terminalSelector} .${S} .xterm-dim { color: ${a.color.multiplyOpacity(M.foreground,.5).css};}`,W+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const N=`blink_underline_${this._terminalClass}`,G=`blink_bar_${this._terminalClass}`,X=`blink_block_${this._terminalClass}`;W+=`@keyframes ${N} { 50% {  border-bottom-style: hidden; }}`,W+=`@keyframes ${G} { 50% {  box-shadow: none; }}`,W+=`@keyframes ${X} { 0% {  background-color: ${M.cursor.css};  color: ${M.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${M.cursor.css}; }}`,W+=`${this._terminalSelector} .${S}.${k} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${N} 1s step-end infinite;}${this._terminalSelector} .${S}.${k} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${G} 1s step-end infinite;}${this._terminalSelector} .${S}.${k} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${X} 1s step-end infinite;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-block { background-color: ${M.cursor.css}; color: ${M.cursorAccent.css};}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${M.cursor.css} !important; color: ${M.cursorAccent.css} !important;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${M.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${M.cursor.css} inset;}${this._terminalSelector} .${S} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${M.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,W+=`${this._terminalSelector} .${T} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${T} div { position: absolute; background-color: ${M.selectionBackgroundOpaque.css};}${this._terminalSelector} .${T} div { position: absolute; background-color: ${M.selectionInactiveBackgroundOpaque.css};}`;for(const[K,D]of M.ansi.entries())W+=`${this._terminalSelector} .${C}${K} { color: ${D.css}; }${this._terminalSelector} .${C}${K}.xterm-dim { color: ${a.color.multiplyOpacity(D,.5).css}; }${this._terminalSelector} .${v}${K} { background-color: ${D.css}; }`;W+=`${this._terminalSelector} .${C}${g.INVERTED_DEFAULT_COLOR} { color: ${a.color.opaque(M.background).css}; }${this._terminalSelector} .${C}${g.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${a.color.multiplyOpacity(a.color.opaque(M.background),.5).css}; }${this._terminalSelector} .${v}${g.INVERTED_DEFAULT_COLOR} { background-color: ${M.foreground.css}; }`,this._themeStyleElement.textContent=W}_setDefaultSpacing(){const M=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${M}px`,this._rowFactory.defaultSpacing=M}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(M,W){for(let N=this._rowElements.length;N<=W;N++){const G=this._document.createElement("div");this._rowContainer.appendChild(G),this._rowElements.push(G)}for(;this._rowElements.length>W;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(M,W){this._refreshRowElements(M,W),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(k),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(k),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(M,W,N){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(M,W,N),this.renderRows(0,this._bufferService.rows-1),!M||!W)return;this._selectionRenderModel.update(this._terminal,M,W,N);const G=this._selectionRenderModel.viewportStartRow,X=this._selectionRenderModel.viewportEndRow,K=this._selectionRenderModel.viewportCappedStartRow,D=this._selectionRenderModel.viewportCappedEndRow;if(K>=this._bufferService.rows||D<0)return;const O=this._document.createDocumentFragment();if(N){const I=M[0]>W[0];O.appendChild(this._createSelectionElement(K,I?W[0]:M[0],I?M[0]:W[0],D-K+1))}else{const I=G===K?M[0]:0,H=K===X?W[0]:this._bufferService.cols;O.appendChild(this._createSelectionElement(K,I,H));const q=D-K-1;if(O.appendChild(this._createSelectionElement(K+1,0,this._bufferService.cols,q)),K!==D){const V=X===D?W[0]:this._bufferService.cols;O.appendChild(this._createSelectionElement(D,0,V))}}this._selectionContainer.appendChild(O)}_createSelectionElement(M,W,N,G=1){const X=this._document.createElement("div"),K=W*this.dimensions.css.cell.width;let D=this.dimensions.css.cell.width*(N-W);return K+D>this.dimensions.css.canvas.width&&(D=this.dimensions.css.canvas.width-K),X.style.height=G*this.dimensions.css.cell.height+"px",X.style.top=M*this.dimensions.css.cell.height+"px",X.style.left=`${K}px`,X.style.width=`${D}px`,X}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const M of this._rowElements)M.replaceChildren()}renderRows(M,W){const N=this._bufferService.buffer,G=N.ybase+N.y,X=Math.min(N.x,this._bufferService.cols-1),K=this._optionsService.rawOptions.cursorBlink,D=this._optionsService.rawOptions.cursorStyle,O=this._optionsService.rawOptions.cursorInactiveStyle;for(let I=M;I<=W;I++){const H=I+N.ydisp,q=this._rowElements[I],V=N.lines.get(H);if(!q||!V)break;q.replaceChildren(...this._rowFactory.createRow(V,H,H===G,D,O,X,K,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${m}${this._terminalClass}`}_handleLinkHover(M){this._setCellUnderline(M.x1,M.x2,M.y1,M.y2,M.cols,!0)}_handleLinkLeave(M){this._setCellUnderline(M.x1,M.x2,M.y1,M.y2,M.cols,!1)}_setCellUnderline(M,W,N,G,X,K){N<0&&(M=0),G<0&&(W=0);const D=this._bufferService.rows-1;N=Math.max(Math.min(N,D),0),G=Math.max(Math.min(G,D),0),X=Math.min(X,this._bufferService.cols);const O=this._bufferService.buffer,I=O.ybase+O.y,H=Math.min(O.x,X-1),q=this._optionsService.rawOptions.cursorBlink,V=this._optionsService.rawOptions.cursorStyle,Q=this._optionsService.rawOptions.cursorInactiveStyle;for(let U=N;U<=G;++U){const F=U+O.ydisp,R=this._rowElements[U],$=O.lines.get(F);if(!R||!$)break;R.replaceChildren(...this._rowFactory.createRow($,F,F===I,V,Q,H,q,this.dimensions.css.cell.width,this._widthCache,K?U===N?M:0:-1,K?(U===G?W:X)-1:-1))}}};e.DomRenderer=A=h([_(7,u.IInstantiationService),_(8,i.ICharSizeService),_(9,u.IOptionsService),_(10,u.IBufferService),_(11,i.ICoreBrowserService),_(12,i.IThemeService)],A)},3787:function(y,e,o){var h=this&&this.__decorate||function(S,C,v,k){var T,B=arguments.length,A=B<3?C:k===null?k=Object.getOwnPropertyDescriptor(C,v):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(S,C,v,k);else for(var M=S.length-1;M>=0;M--)(T=S[M])&&(A=(B<3?T(A):B>3?T(C,v,A):T(C,v))||A);return B>3&&A&&Object.defineProperty(C,v,A),A},_=this&&this.__param||function(S,C){return function(v,k){C(v,k,S)}};Object.defineProperty(e,"__esModule",{value:!0}),e.DomRendererRowFactory=void 0;const l=o(2223),d=o(643),g=o(511),p=o(2585),f=o(8055),i=o(4725),a=o(4269),t=o(6171),s=o(3734);let u=e.DomRendererRowFactory=class{constructor(S,C,v,k,T,B,A){this._document=S,this._characterJoinerService=C,this._optionsService=v,this._coreBrowserService=k,this._coreService=T,this._decorationService=B,this._themeService=A,this._workCell=new g.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(S,C,v){this._selectionStart=S,this._selectionEnd=C,this._columnSelectMode=v}createRow(S,C,v,k,T,B,A,M,W,N,G){const X=[],K=this._characterJoinerService.getJoinedCharacters(C),D=this._themeService.colors;let O,I=S.getNoBgTrimmedLength();v&&I<B+1&&(I=B+1);let H=0,q="",V=0,Q=0,U=0,F=!1,R=0,$=!1,j=0;const Y=[],Z=N!==-1&&G!==-1;for(let he=0;he<I;he++){S.loadCell(he,this._workCell);let me=this._workCell.getWidth();if(me===0)continue;let ye=!1,fe=he,ne=this._workCell;if(K.length>0&&he===K[0][0]){ye=!0;const ae=K.shift();ne=new a.JoinedCellData(this._workCell,S.translateToString(!0,ae[0],ae[1]),ae[1]-ae[0]),fe=ae[1]-1,me=ne.getWidth()}const xe=this._isCellInSelection(he,C),be=v&&he===B,We=Z&&he>=N&&he<=G;let Pe=!1;this._decorationService.forEachDecorationAtCell(he,C,void 0,ae=>{Pe=!0});let we=ne.getChars()||d.WHITESPACE_CELL_CHAR;if(we===" "&&(ne.isUnderline()||ne.isOverline())&&(we=" "),j=me*M-W.get(we,ne.isBold(),ne.isItalic()),O){if(H&&(xe&&$||!xe&&!$&&ne.bg===V)&&(xe&&$&&D.selectionForeground||ne.fg===Q)&&ne.extended.ext===U&&We===F&&j===R&&!be&&!ye&&!Pe){ne.isInvisible()?q+=d.WHITESPACE_CELL_CHAR:q+=we,H++;continue}H&&(O.textContent=q),O=this._document.createElement("span"),H=0,q=""}else O=this._document.createElement("span");if(V=ne.bg,Q=ne.fg,U=ne.extended.ext,F=We,R=j,$=xe,ye&&B>=he&&B<=fe&&(B=he),!this._coreService.isCursorHidden&&be&&this._coreService.isCursorInitialized){if(Y.push("xterm-cursor"),this._coreBrowserService.isFocused)A&&Y.push("xterm-cursor-blink"),Y.push(k==="bar"?"xterm-cursor-bar":k==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(T)switch(T){case"outline":Y.push("xterm-cursor-outline");break;case"block":Y.push("xterm-cursor-block");break;case"bar":Y.push("xterm-cursor-bar");break;case"underline":Y.push("xterm-cursor-underline")}}if(ne.isBold()&&Y.push("xterm-bold"),ne.isItalic()&&Y.push("xterm-italic"),ne.isDim()&&Y.push("xterm-dim"),q=ne.isInvisible()?d.WHITESPACE_CELL_CHAR:ne.getChars()||d.WHITESPACE_CELL_CHAR,ne.isUnderline()&&(Y.push(`xterm-underline-${ne.extended.underlineStyle}`),q===" "&&(q=" "),!ne.isUnderlineColorDefault()))if(ne.isUnderlineColorRGB())O.style.textDecorationColor=`rgb(${s.AttributeData.toColorRGB(ne.getUnderlineColor()).join(",")})`;else{let ae=ne.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&ne.isBold()&&ae<8&&(ae+=8),O.style.textDecorationColor=D.ansi[ae].css}ne.isOverline()&&(Y.push("xterm-overline"),q===" "&&(q=" ")),ne.isStrikethrough()&&Y.push("xterm-strikethrough"),We&&(O.style.textDecoration="underline");let J=ne.getFgColor(),oe=ne.getFgColorMode(),de=ne.getBgColor(),ve=ne.getBgColorMode();const Se=!!ne.isInverse();if(Se){const ae=J;J=de,de=ae;const Oe=oe;oe=ve,ve=Oe}let He,re,_e,ke=!1;switch(this._decorationService.forEachDecorationAtCell(he,C,void 0,ae=>{ae.options.layer!=="top"&&ke||(ae.backgroundColorRGB&&(ve=50331648,de=ae.backgroundColorRGB.rgba>>8&16777215,He=ae.backgroundColorRGB),ae.foregroundColorRGB&&(oe=50331648,J=ae.foregroundColorRGB.rgba>>8&16777215,re=ae.foregroundColorRGB),ke=ae.options.layer==="top")}),!ke&&xe&&(He=this._coreBrowserService.isFocused?D.selectionBackgroundOpaque:D.selectionInactiveBackgroundOpaque,de=He.rgba>>8&16777215,ve=50331648,ke=!0,D.selectionForeground&&(oe=50331648,J=D.selectionForeground.rgba>>8&16777215,re=D.selectionForeground)),ke&&Y.push("xterm-decoration-top"),ve){case 16777216:case 33554432:_e=D.ansi[de],Y.push(`xterm-bg-${de}`);break;case 50331648:_e=f.channels.toColor(de>>16,de>>8&255,255&de),this._addStyle(O,`background-color:#${m((de>>>0).toString(16),"0",6)}`);break;default:Se?(_e=D.foreground,Y.push(`xterm-bg-${l.INVERTED_DEFAULT_COLOR}`)):_e=D.background}switch(He||ne.isDim()&&(He=f.color.multiplyOpacity(_e,.5)),oe){case 16777216:case 33554432:ne.isBold()&&J<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(J+=8),this._applyMinimumContrast(O,_e,D.ansi[J],ne,He,void 0)||Y.push(`xterm-fg-${J}`);break;case 50331648:const ae=f.channels.toColor(J>>16&255,J>>8&255,255&J);this._applyMinimumContrast(O,_e,ae,ne,He,re)||this._addStyle(O,`color:#${m(J.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(O,_e,D.foreground,ne,He,re)||Se&&Y.push(`xterm-fg-${l.INVERTED_DEFAULT_COLOR}`)}Y.length&&(O.className=Y.join(" "),Y.length=0),be||ye||Pe?O.textContent=q:H++,j!==this.defaultSpacing&&(O.style.letterSpacing=`${j}px`),X.push(O),he=fe}return O&&H&&(O.textContent=q),X}_applyMinimumContrast(S,C,v,k,T,B){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,t.treatGlyphAsBackgroundColor)(k.getCode()))return!1;const A=this._getContrastCache(k);let M;if(T||B||(M=A.getColor(C.rgba,v.rgba)),M===void 0){const W=this._optionsService.rawOptions.minimumContrastRatio/(k.isDim()?2:1);M=f.color.ensureContrastRatio(T||C,B||v,W),A.setColor((T||C).rgba,(B||v).rgba,M??null)}return!!M&&(this._addStyle(S,`color:${M.css}`),!0)}_getContrastCache(S){return S.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(S,C){S.setAttribute("style",`${S.getAttribute("style")||""}${C};`)}_isCellInSelection(S,C){const v=this._selectionStart,k=this._selectionEnd;return!(!v||!k)&&(this._columnSelectMode?v[0]<=k[0]?S>=v[0]&&C>=v[1]&&S<k[0]&&C<=k[1]:S<v[0]&&C>=v[1]&&S>=k[0]&&C<=k[1]:C>v[1]&&C<k[1]||v[1]===k[1]&&C===v[1]&&S>=v[0]&&S<k[0]||v[1]<k[1]&&C===k[1]&&S<k[0]||v[1]<k[1]&&C===v[1]&&S>=v[0])}};function m(S,C,v){for(;S.length<v;)S=C+S;return S}e.DomRendererRowFactory=u=h([_(1,i.ICharacterJoinerService),_(2,p.IOptionsService),_(3,i.ICoreBrowserService),_(4,p.ICoreService),_(5,p.IDecorationService),_(6,i.IThemeService)],u)},2550:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WidthCache=void 0,e.WidthCache=class{constructor(o,h){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=o.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const _=o.createElement("span");_.classList.add("xterm-char-measure-element");const l=o.createElement("span");l.classList.add("xterm-char-measure-element"),l.style.fontWeight="bold";const d=o.createElement("span");d.classList.add("xterm-char-measure-element"),d.style.fontStyle="italic";const g=o.createElement("span");g.classList.add("xterm-char-measure-element"),g.style.fontWeight="bold",g.style.fontStyle="italic",this._measureElements=[_,l,d,g],this._container.appendChild(_),this._container.appendChild(l),this._container.appendChild(d),this._container.appendChild(g),h.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(o,h,_,l){o===this._font&&h===this._fontSize&&_===this._weight&&l===this._weightBold||(this._font=o,this._fontSize=h,this._weight=_,this._weightBold=l,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${_}`,this._measureElements[1].style.fontWeight=`${l}`,this._measureElements[2].style.fontWeight=`${_}`,this._measureElements[3].style.fontWeight=`${l}`,this.clear())}get(o,h,_){let l=0;if(!h&&!_&&o.length===1&&(l=o.charCodeAt(0))<256){if(this._flat[l]!==-9999)return this._flat[l];const p=this._measure(o,0);return p>0&&(this._flat[l]=p),p}let d=o;h&&(d+="B"),_&&(d+="I");let g=this._holey.get(d);if(g===void 0){let p=0;h&&(p|=1),_&&(p|=2),g=this._measure(o,p),g>0&&this._holey.set(d,g)}return g}_measure(o,h){const _=this._measureElements[h];return _.textContent=o.repeat(32),_.offsetWidth/32}}},2223:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TEXT_BASELINE=e.DIM_OPACITY=e.INVERTED_DEFAULT_COLOR=void 0;const h=o(6114);e.INVERTED_DEFAULT_COLOR=257,e.DIM_OPACITY=.5,e.TEXT_BASELINE=h.isFirefox||h.isLegacyEdge?"bottom":"ideographic"},6171:(y,e)=>{function o(_){return 57508<=_&&_<=57558}function h(_){return _>=128512&&_<=128591||_>=127744&&_<=128511||_>=128640&&_<=128767||_>=9728&&_<=9983||_>=9984&&_<=10175||_>=65024&&_<=65039||_>=129280&&_<=129535||_>=127462&&_<=127487}Object.defineProperty(e,"__esModule",{value:!0}),e.computeNextVariantOffset=e.createRenderDimensions=e.treatGlyphAsBackgroundColor=e.allowRescaling=e.isEmoji=e.isRestrictedPowerlineGlyph=e.isPowerlineGlyph=e.throwIfFalsy=void 0,e.throwIfFalsy=function(_){if(!_)throw new Error("value must not be falsy");return _},e.isPowerlineGlyph=o,e.isRestrictedPowerlineGlyph=function(_){return 57520<=_&&_<=57527},e.isEmoji=h,e.allowRescaling=function(_,l,d,g){return l===1&&d>Math.ceil(1.5*g)&&_!==void 0&&_>255&&!h(_)&&!o(_)&&!function(p){return 57344<=p&&p<=63743}(_)},e.treatGlyphAsBackgroundColor=function(_){return o(_)||function(l){return 9472<=l&&l<=9631}(_)},e.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},e.computeNextVariantOffset=function(_,l,d=0){return(_-(2*Math.round(l)-d))%(2*Math.round(l))}},6052:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createSelectionRenderModel=void 0;class o{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(_,l,d,g=!1){if(this.selectionStart=l,this.selectionEnd=d,!l||!d||l[0]===d[0]&&l[1]===d[1])return void this.clear();const p=_.buffers.active.ydisp,f=l[1]-p,i=d[1]-p,a=Math.max(f,0),t=Math.min(i,_.rows-1);a>=_.rows||t<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=g,this.viewportStartRow=f,this.viewportEndRow=i,this.viewportCappedStartRow=a,this.viewportCappedEndRow=t,this.startCol=l[0],this.endCol=d[0])}isCellSelected(_,l,d){return!!this.hasSelection&&(d-=_.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?l>=this.startCol&&d>=this.viewportCappedStartRow&&l<this.endCol&&d<=this.viewportCappedEndRow:l<this.startCol&&d>=this.viewportCappedStartRow&&l>=this.endCol&&d<=this.viewportCappedEndRow:d>this.viewportStartRow&&d<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&d===this.viewportStartRow&&l>=this.startCol&&l<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportEndRow&&l<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportStartRow&&l>=this.startCol)}}e.createSelectionRenderModel=function(){return new o}},456:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionModel=void 0,e.SelectionModel=class{constructor(o){this._bufferService=o,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const o=this.selectionStart[0]+this.selectionStartLength;return o>this._bufferService.cols?o%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(o/this._bufferService.cols)-1]:[o%this._bufferService.cols,this.selectionStart[1]+Math.floor(o/this._bufferService.cols)]:[o,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const o=this.selectionStart[0]+this.selectionStartLength;return o>this._bufferService.cols?[o%this._bufferService.cols,this.selectionStart[1]+Math.floor(o/this._bufferService.cols)]:[Math.max(o,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const o=this.selectionStart,h=this.selectionEnd;return!(!o||!h)&&(o[1]>h[1]||o[1]===h[1]&&o[0]>h[0])}handleTrim(o){return this.selectionStart&&(this.selectionStart[1]-=o),this.selectionEnd&&(this.selectionEnd[1]-=o),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(y,e,o){var h=this&&this.__decorate||function(t,s,u,m){var S,C=arguments.length,v=C<3?s:m===null?m=Object.getOwnPropertyDescriptor(s,u):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(t,s,u,m);else for(var k=t.length-1;k>=0;k--)(S=t[k])&&(v=(C<3?S(v):C>3?S(s,u,v):S(s,u))||v);return C>3&&v&&Object.defineProperty(s,u,v),v},_=this&&this.__param||function(t,s){return function(u,m){s(u,m,t)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CharSizeService=void 0;const l=o(2585),d=o(8460),g=o(844);let p=e.CharSizeService=class extends g.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(t,s,u){super(),this._optionsService=u,this.width=0,this.height=0,this._onCharSizeChange=this.register(new d.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new a(this._optionsService))}catch{this._measureStrategy=this.register(new i(t,s,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const t=this._measureStrategy.measure();t.width===this.width&&t.height===this.height||(this.width=t.width,this.height=t.height,this._onCharSizeChange.fire())}};e.CharSizeService=p=h([_(2,l.IOptionsService)],p);class f extends g.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(s,u){s!==void 0&&s>0&&u!==void 0&&u>0&&(this._result.width=s,this._result.height=u)}}class i extends f{constructor(s,u,m){super(),this._document=s,this._parentElement=u,this._optionsService=m,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class a extends f{constructor(s){super(),this._optionsService=s,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const u=this._ctx.measureText("W");if(!("width"in u&&"fontBoundingBoxAscent"in u&&"fontBoundingBoxDescent"in u))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const s=this._ctx.measureText("W");return this._validateAndSet(s.width,s.fontBoundingBoxAscent+s.fontBoundingBoxDescent),this._result}}},4269:function(y,e,o){var h=this&&this.__decorate||function(a,t,s,u){var m,S=arguments.length,C=S<3?t:u===null?u=Object.getOwnPropertyDescriptor(t,s):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(a,t,s,u);else for(var v=a.length-1;v>=0;v--)(m=a[v])&&(C=(S<3?m(C):S>3?m(t,s,C):m(t,s))||C);return S>3&&C&&Object.defineProperty(t,s,C),C},_=this&&this.__param||function(a,t){return function(s,u){t(s,u,a)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CharacterJoinerService=e.JoinedCellData=void 0;const l=o(3734),d=o(643),g=o(511),p=o(2585);class f extends l.AttributeData{constructor(t,s,u){super(),this.content=0,this.combinedData="",this.fg=t.fg,this.bg=t.bg,this.combinedData=s,this._width=u}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(t){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}e.JoinedCellData=f;let i=e.CharacterJoinerService=class li{constructor(t){this._bufferService=t,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new g.CellData}register(t){const s={id:this._nextCharacterJoinerId++,handler:t};return this._characterJoiners.push(s),s.id}deregister(t){for(let s=0;s<this._characterJoiners.length;s++)if(this._characterJoiners[s].id===t)return this._characterJoiners.splice(s,1),!0;return!1}getJoinedCharacters(t){if(this._characterJoiners.length===0)return[];const s=this._bufferService.buffer.lines.get(t);if(!s||s.length===0)return[];const u=[],m=s.translateToString(!0);let S=0,C=0,v=0,k=s.getFg(0),T=s.getBg(0);for(let B=0;B<s.getTrimmedLength();B++)if(s.loadCell(B,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==k||this._workCell.bg!==T){if(B-S>1){const A=this._getJoinedRanges(m,v,C,s,S);for(let M=0;M<A.length;M++)u.push(A[M])}S=B,v=C,k=this._workCell.fg,T=this._workCell.bg}C+=this._workCell.getChars().length||d.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-S>1){const B=this._getJoinedRanges(m,v,C,s,S);for(let A=0;A<B.length;A++)u.push(B[A])}return u}_getJoinedRanges(t,s,u,m,S){const C=t.substring(s,u);let v=[];try{v=this._characterJoiners[0].handler(C)}catch(k){console.error(k)}for(let k=1;k<this._characterJoiners.length;k++)try{const T=this._characterJoiners[k].handler(C);for(let B=0;B<T.length;B++)li._mergeRanges(v,T[B])}catch(T){console.error(T)}return this._stringRangesToCellRanges(v,m,S),v}_stringRangesToCellRanges(t,s,u){let m=0,S=!1,C=0,v=t[m];if(v){for(let k=u;k<this._bufferService.cols;k++){const T=s.getWidth(k),B=s.getString(k).length||d.WHITESPACE_CELL_CHAR.length;if(T!==0){if(!S&&v[0]<=C&&(v[0]=k,S=!0),v[1]<=C){if(v[1]=k,v=t[++m],!v)break;v[0]<=C?(v[0]=k,S=!0):S=!1}C+=B}}v&&(v[1]=this._bufferService.cols)}}static _mergeRanges(t,s){let u=!1;for(let m=0;m<t.length;m++){const S=t[m];if(u){if(s[1]<=S[0])return t[m-1][1]=s[1],t;if(s[1]<=S[1])return t[m-1][1]=Math.max(s[1],S[1]),t.splice(m,1),t;t.splice(m,1),m--}else{if(s[1]<=S[0])return t.splice(m,0,s),t;if(s[1]<=S[1])return S[0]=Math.min(s[0],S[0]),t;s[0]<S[1]&&(S[0]=Math.min(s[0],S[0]),u=!0)}}return u?t[t.length-1][1]=s[1]:t.push(s),t}};e.CharacterJoinerService=i=h([_(0,p.IBufferService)],i)},5114:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CoreBrowserService=void 0;const h=o(844),_=o(8460),l=o(3656);class d extends h.Disposable{constructor(f,i,a){super(),this._textarea=f,this._window=i,this.mainDocument=a,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new g(this._window),this._onDprChange=this.register(new _.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new _.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(t=>this._screenDprMonitor.setWindow(t))),this.register((0,_.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(f){this._window!==f&&(this._window=f,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}e.CoreBrowserService=d;class g extends h.Disposable{constructor(f){super(),this._parentWindow=f,this._windowResizeListener=this.register(new h.MutableDisposable),this._onDprChange=this.register(new _.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,h.toDisposable)(()=>this.clearListener()))}setWindow(f){this._parentWindow=f,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,l.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){var f;this._outerListener&&((f=this._resolutionMediaMatchList)==null||f.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LinkProviderService=void 0;const h=o(844);class _ extends h.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,h.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(d){return this.linkProviders.push(d),{dispose:()=>{const g=this.linkProviders.indexOf(d);g!==-1&&this.linkProviders.splice(g,1)}}}}e.LinkProviderService=_},8934:function(y,e,o){var h=this&&this.__decorate||function(p,f,i,a){var t,s=arguments.length,u=s<3?f:a===null?a=Object.getOwnPropertyDescriptor(f,i):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(p,f,i,a);else for(var m=p.length-1;m>=0;m--)(t=p[m])&&(u=(s<3?t(u):s>3?t(f,i,u):t(f,i))||u);return s>3&&u&&Object.defineProperty(f,i,u),u},_=this&&this.__param||function(p,f){return function(i,a){f(i,a,p)}};Object.defineProperty(e,"__esModule",{value:!0}),e.MouseService=void 0;const l=o(4725),d=o(9806);let g=e.MouseService=class{constructor(p,f){this._renderService=p,this._charSizeService=f}getCoords(p,f,i,a,t){return(0,d.getCoords)(window,p,f,i,a,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,t)}getMouseReportCoords(p,f){const i=(0,d.getCoordsRelativeToElement)(window,p,f);if(this._charSizeService.hasValidSize)return i[0]=Math.min(Math.max(i[0],0),this._renderService.dimensions.css.canvas.width-1),i[1]=Math.min(Math.max(i[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(i[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(i[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(i[0]),y:Math.floor(i[1])}}};e.MouseService=g=h([_(0,l.IRenderService),_(1,l.ICharSizeService)],g)},3230:function(y,e,o){var h=this&&this.__decorate||function(t,s,u,m){var S,C=arguments.length,v=C<3?s:m===null?m=Object.getOwnPropertyDescriptor(s,u):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(t,s,u,m);else for(var k=t.length-1;k>=0;k--)(S=t[k])&&(v=(C<3?S(v):C>3?S(s,u,v):S(s,u))||v);return C>3&&v&&Object.defineProperty(s,u,v),v},_=this&&this.__param||function(t,s){return function(u,m){s(u,m,t)}};Object.defineProperty(e,"__esModule",{value:!0}),e.RenderService=void 0;const l=o(6193),d=o(4725),g=o(8460),p=o(844),f=o(7226),i=o(2585);let a=e.RenderService=class extends p.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(t,s,u,m,S,C,v,k){super(),this._rowCount=t,this._charSizeService=m,this._renderer=this.register(new p.MutableDisposable),this._pausedResizeTask=new f.DebouncedIdleTask,this._observerDisposable=this.register(new p.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new g.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new g.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new g.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new g.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new l.RenderDebouncer((T,B)=>this._renderRows(T,B),v),this.register(this._renderDebouncer),this.register(v.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(C.onResize(()=>this._fullRefresh())),this.register(C.buffers.onBufferActivate(()=>{var T;return(T=this._renderer.value)==null?void 0:T.clear()})),this.register(u.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(S.onDecorationRegistered(()=>this._fullRefresh())),this.register(S.onDecorationRemoved(()=>this._fullRefresh())),this.register(u.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(C.cols,C.rows),this._fullRefresh()})),this.register(u.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(C.buffer.y,C.buffer.y,!0))),this.register(k.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(v.window,s),this.register(v.onWindowChange(T=>this._registerIntersectionObserver(T,s)))}_registerIntersectionObserver(t,s){if("IntersectionObserver"in t){const u=new t.IntersectionObserver(m=>this._handleIntersectionChange(m[m.length-1]),{threshold:0});u.observe(s),this._observerDisposable.value=(0,p.toDisposable)(()=>u.disconnect())}}_handleIntersectionChange(t){this._isPaused=t.isIntersecting===void 0?t.intersectionRatio===0:!t.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(t,s,u=!1){this._isPaused?this._needsFullRefresh=!0:(u||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(t,s,this._rowCount))}_renderRows(t,s){this._renderer.value&&(t=Math.min(t,this._rowCount-1),s=Math.min(s,this._rowCount-1),this._renderer.value.renderRows(t,s),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:t,end:s}),this._onRender.fire({start:t,end:s}),this._isNextRenderRedrawOnly=!0)}resize(t,s){this._rowCount=s,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(t){this._renderer.value=t,this._renderer.value&&(this._renderer.value.onRequestRedraw(s=>this.refreshRows(s.start,s.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(t){return this._renderDebouncer.addRefreshCallback(t)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var t,s;this._renderer.value&&((s=(t=this._renderer.value).clearTextureAtlas)==null||s.call(t),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(t,s){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>{var u;return(u=this._renderer.value)==null?void 0:u.handleResize(t,s)}):this._renderer.value.handleResize(t,s),this._fullRefresh())}handleCharSizeChanged(){var t;(t=this._renderer.value)==null||t.handleCharSizeChanged()}handleBlur(){var t;(t=this._renderer.value)==null||t.handleBlur()}handleFocus(){var t;(t=this._renderer.value)==null||t.handleFocus()}handleSelectionChanged(t,s,u){var m;this._selectionState.start=t,this._selectionState.end=s,this._selectionState.columnSelectMode=u,(m=this._renderer.value)==null||m.handleSelectionChanged(t,s,u)}handleCursorMove(){var t;(t=this._renderer.value)==null||t.handleCursorMove()}clear(){var t;(t=this._renderer.value)==null||t.clear()}};e.RenderService=a=h([_(2,i.IOptionsService),_(3,d.ICharSizeService),_(4,i.IDecorationService),_(5,i.IBufferService),_(6,d.ICoreBrowserService),_(7,d.IThemeService)],a)},9312:function(y,e,o){var h=this&&this.__decorate||function(v,k,T,B){var A,M=arguments.length,W=M<3?k:B===null?B=Object.getOwnPropertyDescriptor(k,T):B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")W=Reflect.decorate(v,k,T,B);else for(var N=v.length-1;N>=0;N--)(A=v[N])&&(W=(M<3?A(W):M>3?A(k,T,W):A(k,T))||W);return M>3&&W&&Object.defineProperty(k,T,W),W},_=this&&this.__param||function(v,k){return function(T,B){k(T,B,v)}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionService=void 0;const l=o(9806),d=o(9504),g=o(456),p=o(4725),f=o(8460),i=o(844),a=o(6114),t=o(4841),s=o(511),u=o(2585),m=" ",S=new RegExp(m,"g");let C=e.SelectionService=class extends i.Disposable{constructor(v,k,T,B,A,M,W,N,G){super(),this._element=v,this._screenElement=k,this._linkifier=T,this._bufferService=B,this._coreService=A,this._mouseService=M,this._optionsService=W,this._renderService=N,this._coreBrowserService=G,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new s.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new f.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new f.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new f.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new f.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=X=>this._handleMouseMove(X),this._mouseUpListener=X=>this._handleMouseUp(X),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(X=>this._handleTrim(X)),this.register(this._bufferService.buffers.onBufferActivate(X=>this._handleBufferActivate(X))),this.enable(),this._model=new g.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,i.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const v=this._model.finalSelectionStart,k=this._model.finalSelectionEnd;return!(!v||!k||v[0]===k[0]&&v[1]===k[1])}get selectionText(){const v=this._model.finalSelectionStart,k=this._model.finalSelectionEnd;if(!v||!k)return"";const T=this._bufferService.buffer,B=[];if(this._activeSelectionMode===3){if(v[0]===k[0])return"";const A=v[0]<k[0]?v[0]:k[0],M=v[0]<k[0]?k[0]:v[0];for(let W=v[1];W<=k[1];W++){const N=T.translateBufferLineToString(W,!0,A,M);B.push(N)}}else{const A=v[1]===k[1]?k[0]:void 0;B.push(T.translateBufferLineToString(v[1],!0,v[0],A));for(let M=v[1]+1;M<=k[1]-1;M++){const W=T.lines.get(M),N=T.translateBufferLineToString(M,!0);W!=null&&W.isWrapped?B[B.length-1]+=N:B.push(N)}if(v[1]!==k[1]){const M=T.lines.get(k[1]),W=T.translateBufferLineToString(k[1],!0,0,k[0]);M&&M.isWrapped?B[B.length-1]+=W:B.push(W)}}return B.map(A=>A.replace(S," ")).join(a.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(v){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),a.isLinux&&v&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(v){const k=this._getMouseBufferCoords(v),T=this._model.finalSelectionStart,B=this._model.finalSelectionEnd;return!!(T&&B&&k)&&this._areCoordsInSelection(k,T,B)}isCellInSelection(v,k){const T=this._model.finalSelectionStart,B=this._model.finalSelectionEnd;return!(!T||!B)&&this._areCoordsInSelection([v,k],T,B)}_areCoordsInSelection(v,k,T){return v[1]>k[1]&&v[1]<T[1]||k[1]===T[1]&&v[1]===k[1]&&v[0]>=k[0]&&v[0]<T[0]||k[1]<T[1]&&v[1]===T[1]&&v[0]<T[0]||k[1]<T[1]&&v[1]===k[1]&&v[0]>=k[0]}_selectWordAtCursor(v,k){var A,M;const T=(M=(A=this._linkifier.currentLink)==null?void 0:A.link)==null?void 0:M.range;if(T)return this._model.selectionStart=[T.start.x-1,T.start.y-1],this._model.selectionStartLength=(0,t.getRangeLength)(T,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const B=this._getMouseBufferCoords(v);return!!B&&(this._selectWordAt(B,k),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(v,k){this._model.clearSelection(),v=Math.max(v,0),k=Math.min(k,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,v],this._model.selectionEnd=[this._bufferService.cols,k],this.refresh(),this._onSelectionChange.fire()}_handleTrim(v){this._model.handleTrim(v)&&this.refresh()}_getMouseBufferCoords(v){const k=this._mouseService.getCoords(v,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(k)return k[0]--,k[1]--,k[1]+=this._bufferService.buffer.ydisp,k}_getMouseEventScrollAmount(v){let k=(0,l.getCoordsRelativeToElement)(this._coreBrowserService.window,v,this._screenElement)[1];const T=this._renderService.dimensions.css.canvas.height;return k>=0&&k<=T?0:(k>T&&(k-=T),k=Math.min(Math.max(k,-50),50),k/=50,k/Math.abs(k)+Math.round(14*k))}shouldForceSelection(v){return a.isMac?v.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:v.shiftKey}handleMouseDown(v){if(this._mouseDownTimeStamp=v.timeStamp,(v.button!==2||!this.hasSelection)&&v.button===0){if(!this._enabled){if(!this.shouldForceSelection(v))return;v.stopPropagation()}v.preventDefault(),this._dragScrollAmount=0,this._enabled&&v.shiftKey?this._handleIncrementalClick(v):v.detail===1?this._handleSingleClick(v):v.detail===2?this._handleDoubleClick(v):v.detail===3&&this._handleTripleClick(v),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(v){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(v))}_handleSingleClick(v){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(v)?3:0,this._model.selectionStart=this._getMouseBufferCoords(v),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const k=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);k&&k.length!==this._model.selectionStart[0]&&k.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(v){this._selectWordAtCursor(v,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(v){const k=this._getMouseBufferCoords(v);k&&(this._activeSelectionMode=2,this._selectLineAt(k[1]))}shouldColumnSelect(v){return v.altKey&&!(a.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(v){if(v.stopImmediatePropagation(),!this._model.selectionStart)return;const k=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(v),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(v),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const T=this._bufferService.buffer;if(this._model.selectionEnd[1]<T.lines.length){const B=T.lines.get(this._model.selectionEnd[1]);B&&B.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}k&&k[0]===this._model.selectionEnd[0]&&k[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const v=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(v.ydisp+this._bufferService.rows,v.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=v.ydisp),this.refresh()}}_handleMouseUp(v){const k=v.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&k<500&&v.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const T=this._mouseService.getCoords(v,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(T&&T[0]!==void 0&&T[1]!==void 0){const B=(0,d.moveToCellSequence)(T[0]-1,T[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(B,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const v=this._model.finalSelectionStart,k=this._model.finalSelectionEnd,T=!(!v||!k||v[0]===k[0]&&v[1]===k[1]);T?v&&k&&(this._oldSelectionStart&&this._oldSelectionEnd&&v[0]===this._oldSelectionStart[0]&&v[1]===this._oldSelectionStart[1]&&k[0]===this._oldSelectionEnd[0]&&k[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(v,k,T)):this._oldHasSelection&&this._fireOnSelectionChange(v,k,T)}_fireOnSelectionChange(v,k,T){this._oldSelectionStart=v,this._oldSelectionEnd=k,this._oldHasSelection=T,this._onSelectionChange.fire()}_handleBufferActivate(v){this.clearSelection(),this._trimListener.dispose(),this._trimListener=v.activeBuffer.lines.onTrim(k=>this._handleTrim(k))}_convertViewportColToCharacterIndex(v,k){let T=k;for(let B=0;k>=B;B++){const A=v.loadCell(B,this._workCell).getChars().length;this._workCell.getWidth()===0?T--:A>1&&k!==B&&(T+=A-1)}return T}setSelection(v,k,T){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[v,k],this._model.selectionStartLength=T,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(v){this._isClickInSelection(v)||(this._selectWordAtCursor(v,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(v,k,T=!0,B=!0){if(v[0]>=this._bufferService.cols)return;const A=this._bufferService.buffer,M=A.lines.get(v[1]);if(!M)return;const W=A.translateBufferLineToString(v[1],!1);let N=this._convertViewportColToCharacterIndex(M,v[0]),G=N;const X=v[0]-N;let K=0,D=0,O=0,I=0;if(W.charAt(N)===" "){for(;N>0&&W.charAt(N-1)===" ";)N--;for(;G<W.length&&W.charAt(G+1)===" ";)G++}else{let V=v[0],Q=v[0];M.getWidth(V)===0&&(K++,V--),M.getWidth(Q)===2&&(D++,Q++);const U=M.getString(Q).length;for(U>1&&(I+=U-1,G+=U-1);V>0&&N>0&&!this._isCharWordSeparator(M.loadCell(V-1,this._workCell));){M.loadCell(V-1,this._workCell);const F=this._workCell.getChars().length;this._workCell.getWidth()===0?(K++,V--):F>1&&(O+=F-1,N-=F-1),N--,V--}for(;Q<M.length&&G+1<W.length&&!this._isCharWordSeparator(M.loadCell(Q+1,this._workCell));){M.loadCell(Q+1,this._workCell);const F=this._workCell.getChars().length;this._workCell.getWidth()===2?(D++,Q++):F>1&&(I+=F-1,G+=F-1),G++,Q++}}G++;let H=N+X-K+O,q=Math.min(this._bufferService.cols,G-N+K+D-O-I);if(k||W.slice(N,G).trim()!==""){if(T&&H===0&&M.getCodePoint(0)!==32){const V=A.lines.get(v[1]-1);if(V&&M.isWrapped&&V.getCodePoint(this._bufferService.cols-1)!==32){const Q=this._getWordAt([this._bufferService.cols-1,v[1]-1],!1,!0,!1);if(Q){const U=this._bufferService.cols-Q.start;H-=U,q+=U}}}if(B&&H+q===this._bufferService.cols&&M.getCodePoint(this._bufferService.cols-1)!==32){const V=A.lines.get(v[1]+1);if(V!=null&&V.isWrapped&&V.getCodePoint(0)!==32){const Q=this._getWordAt([0,v[1]+1],!1,!1,!0);Q&&(q+=Q.length)}}return{start:H,length:q}}}_selectWordAt(v,k){const T=this._getWordAt(v,k);if(T){for(;T.start<0;)T.start+=this._bufferService.cols,v[1]--;this._model.selectionStart=[T.start,v[1]],this._model.selectionStartLength=T.length}}_selectToWordAt(v){const k=this._getWordAt(v,!0);if(k){let T=v[1];for(;k.start<0;)k.start+=this._bufferService.cols,T--;if(!this._model.areSelectionValuesReversed())for(;k.start+k.length>this._bufferService.cols;)k.length-=this._bufferService.cols,T++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?k.start:k.start+k.length,T]}}_isCharWordSeparator(v){return v.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(v.getChars())>=0}_selectLineAt(v){const k=this._bufferService.buffer.getWrappedRangeForLine(v),T={start:{x:0,y:k.first},end:{x:this._bufferService.cols-1,y:k.last}};this._model.selectionStart=[0,k.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,t.getRangeLength)(T,this._bufferService.cols)}};e.SelectionService=C=h([_(3,u.IBufferService),_(4,u.ICoreService),_(5,p.IMouseService),_(6,u.IOptionsService),_(7,p.IRenderService),_(8,p.ICoreBrowserService)],C)},4725:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ILinkProviderService=e.IThemeService=e.ICharacterJoinerService=e.ISelectionService=e.IRenderService=e.IMouseService=e.ICoreBrowserService=e.ICharSizeService=void 0;const h=o(8343);e.ICharSizeService=(0,h.createDecorator)("CharSizeService"),e.ICoreBrowserService=(0,h.createDecorator)("CoreBrowserService"),e.IMouseService=(0,h.createDecorator)("MouseService"),e.IRenderService=(0,h.createDecorator)("RenderService"),e.ISelectionService=(0,h.createDecorator)("SelectionService"),e.ICharacterJoinerService=(0,h.createDecorator)("CharacterJoinerService"),e.IThemeService=(0,h.createDecorator)("ThemeService"),e.ILinkProviderService=(0,h.createDecorator)("LinkProviderService")},6731:function(y,e,o){var h=this&&this.__decorate||function(C,v,k,T){var B,A=arguments.length,M=A<3?v:T===null?T=Object.getOwnPropertyDescriptor(v,k):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(C,v,k,T);else for(var W=C.length-1;W>=0;W--)(B=C[W])&&(M=(A<3?B(M):A>3?B(v,k,M):B(v,k))||M);return A>3&&M&&Object.defineProperty(v,k,M),M},_=this&&this.__param||function(C,v){return function(k,T){v(k,T,C)}};Object.defineProperty(e,"__esModule",{value:!0}),e.ThemeService=e.DEFAULT_ANSI_COLORS=void 0;const l=o(7239),d=o(8055),g=o(8460),p=o(844),f=o(2585),i=d.css.toColor("#ffffff"),a=d.css.toColor("#000000"),t=d.css.toColor("#ffffff"),s=d.css.toColor("#000000"),u={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};e.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const C=[d.css.toColor("#2e3436"),d.css.toColor("#cc0000"),d.css.toColor("#4e9a06"),d.css.toColor("#c4a000"),d.css.toColor("#3465a4"),d.css.toColor("#75507b"),d.css.toColor("#06989a"),d.css.toColor("#d3d7cf"),d.css.toColor("#555753"),d.css.toColor("#ef2929"),d.css.toColor("#8ae234"),d.css.toColor("#fce94f"),d.css.toColor("#729fcf"),d.css.toColor("#ad7fa8"),d.css.toColor("#34e2e2"),d.css.toColor("#eeeeec")],v=[0,95,135,175,215,255];for(let k=0;k<216;k++){const T=v[k/36%6|0],B=v[k/6%6|0],A=v[k%6];C.push({css:d.channels.toCss(T,B,A),rgba:d.channels.toRgba(T,B,A)})}for(let k=0;k<24;k++){const T=8+10*k;C.push({css:d.channels.toCss(T,T,T),rgba:d.channels.toRgba(T,T,T)})}return C})());let m=e.ThemeService=class extends p.Disposable{get colors(){return this._colors}constructor(C){super(),this._optionsService=C,this._contrastCache=new l.ColorContrastCache,this._halfContrastCache=new l.ColorContrastCache,this._onChangeColors=this.register(new g.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:i,background:a,cursor:t,cursorAccent:s,selectionForeground:void 0,selectionBackgroundTransparent:u,selectionBackgroundOpaque:d.color.blend(a,u),selectionInactiveBackgroundTransparent:u,selectionInactiveBackgroundOpaque:d.color.blend(a,u),ansi:e.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(C={}){const v=this._colors;if(v.foreground=S(C.foreground,i),v.background=S(C.background,a),v.cursor=S(C.cursor,t),v.cursorAccent=S(C.cursorAccent,s),v.selectionBackgroundTransparent=S(C.selectionBackground,u),v.selectionBackgroundOpaque=d.color.blend(v.background,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundTransparent=S(C.selectionInactiveBackground,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundOpaque=d.color.blend(v.background,v.selectionInactiveBackgroundTransparent),v.selectionForeground=C.selectionForeground?S(C.selectionForeground,d.NULL_COLOR):void 0,v.selectionForeground===d.NULL_COLOR&&(v.selectionForeground=void 0),d.color.isOpaque(v.selectionBackgroundTransparent)&&(v.selectionBackgroundTransparent=d.color.opacity(v.selectionBackgroundTransparent,.3)),d.color.isOpaque(v.selectionInactiveBackgroundTransparent)&&(v.selectionInactiveBackgroundTransparent=d.color.opacity(v.selectionInactiveBackgroundTransparent,.3)),v.ansi=e.DEFAULT_ANSI_COLORS.slice(),v.ansi[0]=S(C.black,e.DEFAULT_ANSI_COLORS[0]),v.ansi[1]=S(C.red,e.DEFAULT_ANSI_COLORS[1]),v.ansi[2]=S(C.green,e.DEFAULT_ANSI_COLORS[2]),v.ansi[3]=S(C.yellow,e.DEFAULT_ANSI_COLORS[3]),v.ansi[4]=S(C.blue,e.DEFAULT_ANSI_COLORS[4]),v.ansi[5]=S(C.magenta,e.DEFAULT_ANSI_COLORS[5]),v.ansi[6]=S(C.cyan,e.DEFAULT_ANSI_COLORS[6]),v.ansi[7]=S(C.white,e.DEFAULT_ANSI_COLORS[7]),v.ansi[8]=S(C.brightBlack,e.DEFAULT_ANSI_COLORS[8]),v.ansi[9]=S(C.brightRed,e.DEFAULT_ANSI_COLORS[9]),v.ansi[10]=S(C.brightGreen,e.DEFAULT_ANSI_COLORS[10]),v.ansi[11]=S(C.brightYellow,e.DEFAULT_ANSI_COLORS[11]),v.ansi[12]=S(C.brightBlue,e.DEFAULT_ANSI_COLORS[12]),v.ansi[13]=S(C.brightMagenta,e.DEFAULT_ANSI_COLORS[13]),v.ansi[14]=S(C.brightCyan,e.DEFAULT_ANSI_COLORS[14]),v.ansi[15]=S(C.brightWhite,e.DEFAULT_ANSI_COLORS[15]),C.extendedAnsi){const k=Math.min(v.ansi.length-16,C.extendedAnsi.length);for(let T=0;T<k;T++)v.ansi[T+16]=S(C.extendedAnsi[T],e.DEFAULT_ANSI_COLORS[T+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(C){this._restoreColor(C),this._onChangeColors.fire(this.colors)}_restoreColor(C){if(C!==void 0)switch(C){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[C]=this._restoreColors.ansi[C]}else for(let v=0;v<this._restoreColors.ansi.length;++v)this._colors.ansi[v]=this._restoreColors.ansi[v]}modifyColors(C){C(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function S(C,v){if(C!==void 0)try{return d.css.toColor(C)}catch{}return v}e.ThemeService=m=h([_(0,f.IOptionsService)],m)},6349:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CircularList=void 0;const h=o(8460),_=o(844);class l extends _.Disposable{constructor(g){super(),this._maxLength=g,this.onDeleteEmitter=this.register(new h.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new h.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new h.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(g){if(this._maxLength===g)return;const p=new Array(g);for(let f=0;f<Math.min(g,this.length);f++)p[f]=this._array[this._getCyclicIndex(f)];this._array=p,this._maxLength=g,this._startIndex=0}get length(){return this._length}set length(g){if(g>this._length)for(let p=this._length;p<g;p++)this._array[p]=void 0;this._length=g}get(g){return this._array[this._getCyclicIndex(g)]}set(g,p){this._array[this._getCyclicIndex(g)]=p}push(g){this._array[this._getCyclicIndex(this._length)]=g,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(g,p,...f){if(p){for(let i=g;i<this._length-p;i++)this._array[this._getCyclicIndex(i)]=this._array[this._getCyclicIndex(i+p)];this._length-=p,this.onDeleteEmitter.fire({index:g,amount:p})}for(let i=this._length-1;i>=g;i--)this._array[this._getCyclicIndex(i+f.length)]=this._array[this._getCyclicIndex(i)];for(let i=0;i<f.length;i++)this._array[this._getCyclicIndex(g+i)]=f[i];if(f.length&&this.onInsertEmitter.fire({index:g,amount:f.length}),this._length+f.length>this._maxLength){const i=this._length+f.length-this._maxLength;this._startIndex+=i,this._length=this._maxLength,this.onTrimEmitter.fire(i)}else this._length+=f.length}trimStart(g){g>this._length&&(g=this._length),this._startIndex+=g,this._length-=g,this.onTrimEmitter.fire(g)}shiftElements(g,p,f){if(!(p<=0)){if(g<0||g>=this._length)throw new Error("start argument out of range");if(g+f<0)throw new Error("Cannot shift elements in list beyond index 0");if(f>0){for(let a=p-1;a>=0;a--)this.set(g+a+f,this.get(g+a));const i=g+p+f-this._length;if(i>0)for(this._length+=i;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let i=0;i<p;i++)this.set(g+i+f,this.get(g+i))}}_getCyclicIndex(g){return(this._startIndex+g)%this._maxLength}}e.CircularList=l},1439:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.clone=void 0,e.clone=function o(h,_=5){if(typeof h!="object")return h;const l=Array.isArray(h)?[]:{};for(const d in h)l[d]=_<=1?h[d]:h[d]&&o(h[d],_-1);return l}},8055:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.contrastRatio=e.toPaddedHex=e.rgba=e.rgb=e.css=e.color=e.channels=e.NULL_COLOR=void 0;let o=0,h=0,_=0,l=0;var d,g,p,f,i;function a(s){const u=s.toString(16);return u.length<2?"0"+u:u}function t(s,u){return s<u?(u+.05)/(s+.05):(s+.05)/(u+.05)}e.NULL_COLOR={css:"#00000000",rgba:0},function(s){s.toCss=function(u,m,S,C){return C!==void 0?`#${a(u)}${a(m)}${a(S)}${a(C)}`:`#${a(u)}${a(m)}${a(S)}`},s.toRgba=function(u,m,S,C=255){return(u<<24|m<<16|S<<8|C)>>>0},s.toColor=function(u,m,S,C){return{css:s.toCss(u,m,S,C),rgba:s.toRgba(u,m,S,C)}}}(d||(e.channels=d={})),function(s){function u(m,S){return l=Math.round(255*S),[o,h,_]=i.toChannels(m.rgba),{css:d.toCss(o,h,_,l),rgba:d.toRgba(o,h,_,l)}}s.blend=function(m,S){if(l=(255&S.rgba)/255,l===1)return{css:S.css,rgba:S.rgba};const C=S.rgba>>24&255,v=S.rgba>>16&255,k=S.rgba>>8&255,T=m.rgba>>24&255,B=m.rgba>>16&255,A=m.rgba>>8&255;return o=T+Math.round((C-T)*l),h=B+Math.round((v-B)*l),_=A+Math.round((k-A)*l),{css:d.toCss(o,h,_),rgba:d.toRgba(o,h,_)}},s.isOpaque=function(m){return(255&m.rgba)==255},s.ensureContrastRatio=function(m,S,C){const v=i.ensureContrastRatio(m.rgba,S.rgba,C);if(v)return d.toColor(v>>24&255,v>>16&255,v>>8&255)},s.opaque=function(m){const S=(255|m.rgba)>>>0;return[o,h,_]=i.toChannels(S),{css:d.toCss(o,h,_),rgba:S}},s.opacity=u,s.multiplyOpacity=function(m,S){return l=255&m.rgba,u(m,l*S/255)},s.toColorRGB=function(m){return[m.rgba>>24&255,m.rgba>>16&255,m.rgba>>8&255]}}(g||(e.color=g={})),function(s){let u,m;try{const S=document.createElement("canvas");S.width=1,S.height=1;const C=S.getContext("2d",{willReadFrequently:!0});C&&(u=C,u.globalCompositeOperation="copy",m=u.createLinearGradient(0,0,1,1))}catch{}s.toColor=function(S){if(S.match(/#[\da-f]{3,8}/i))switch(S.length){case 4:return o=parseInt(S.slice(1,2).repeat(2),16),h=parseInt(S.slice(2,3).repeat(2),16),_=parseInt(S.slice(3,4).repeat(2),16),d.toColor(o,h,_);case 5:return o=parseInt(S.slice(1,2).repeat(2),16),h=parseInt(S.slice(2,3).repeat(2),16),_=parseInt(S.slice(3,4).repeat(2),16),l=parseInt(S.slice(4,5).repeat(2),16),d.toColor(o,h,_,l);case 7:return{css:S,rgba:(parseInt(S.slice(1),16)<<8|255)>>>0};case 9:return{css:S,rgba:parseInt(S.slice(1),16)>>>0}}const C=S.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(C)return o=parseInt(C[1]),h=parseInt(C[2]),_=parseInt(C[3]),l=Math.round(255*(C[5]===void 0?1:parseFloat(C[5]))),d.toColor(o,h,_,l);if(!u||!m)throw new Error("css.toColor: Unsupported css format");if(u.fillStyle=m,u.fillStyle=S,typeof u.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(u.fillRect(0,0,1,1),[o,h,_,l]=u.getImageData(0,0,1,1).data,l!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:d.toRgba(o,h,_,l),css:S}}}(p||(e.css=p={})),function(s){function u(m,S,C){const v=m/255,k=S/255,T=C/255;return .2126*(v<=.03928?v/12.92:Math.pow((v+.055)/1.055,2.4))+.7152*(k<=.03928?k/12.92:Math.pow((k+.055)/1.055,2.4))+.0722*(T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))}s.relativeLuminance=function(m){return u(m>>16&255,m>>8&255,255&m)},s.relativeLuminance2=u}(f||(e.rgb=f={})),function(s){function u(S,C,v){const k=S>>24&255,T=S>>16&255,B=S>>8&255;let A=C>>24&255,M=C>>16&255,W=C>>8&255,N=t(f.relativeLuminance2(A,M,W),f.relativeLuminance2(k,T,B));for(;N<v&&(A>0||M>0||W>0);)A-=Math.max(0,Math.ceil(.1*A)),M-=Math.max(0,Math.ceil(.1*M)),W-=Math.max(0,Math.ceil(.1*W)),N=t(f.relativeLuminance2(A,M,W),f.relativeLuminance2(k,T,B));return(A<<24|M<<16|W<<8|255)>>>0}function m(S,C,v){const k=S>>24&255,T=S>>16&255,B=S>>8&255;let A=C>>24&255,M=C>>16&255,W=C>>8&255,N=t(f.relativeLuminance2(A,M,W),f.relativeLuminance2(k,T,B));for(;N<v&&(A<255||M<255||W<255);)A=Math.min(255,A+Math.ceil(.1*(255-A))),M=Math.min(255,M+Math.ceil(.1*(255-M))),W=Math.min(255,W+Math.ceil(.1*(255-W))),N=t(f.relativeLuminance2(A,M,W),f.relativeLuminance2(k,T,B));return(A<<24|M<<16|W<<8|255)>>>0}s.blend=function(S,C){if(l=(255&C)/255,l===1)return C;const v=C>>24&255,k=C>>16&255,T=C>>8&255,B=S>>24&255,A=S>>16&255,M=S>>8&255;return o=B+Math.round((v-B)*l),h=A+Math.round((k-A)*l),_=M+Math.round((T-M)*l),d.toRgba(o,h,_)},s.ensureContrastRatio=function(S,C,v){const k=f.relativeLuminance(S>>8),T=f.relativeLuminance(C>>8);if(t(k,T)<v){if(T<k){const M=u(S,C,v),W=t(k,f.relativeLuminance(M>>8));if(W<v){const N=m(S,C,v);return W>t(k,f.relativeLuminance(N>>8))?M:N}return M}const B=m(S,C,v),A=t(k,f.relativeLuminance(B>>8));if(A<v){const M=u(S,C,v);return A>t(k,f.relativeLuminance(M>>8))?B:M}return B}},s.reduceLuminance=u,s.increaseLuminance=m,s.toChannels=function(S){return[S>>24&255,S>>16&255,S>>8&255,255&S]}}(i||(e.rgba=i={})),e.toPaddedHex=a,e.contrastRatio=t},8969:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CoreTerminal=void 0;const h=o(844),_=o(2585),l=o(4348),d=o(7866),g=o(744),p=o(7302),f=o(6975),i=o(8460),a=o(1753),t=o(1480),s=o(7994),u=o(9282),m=o(5435),S=o(5981),C=o(2660);let v=!1;class k extends h.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new i.EventEmitter),this._onScroll.event(B=>{var A;(A=this._onScrollApi)==null||A.fire(B.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(B){for(const A in B)this.optionsService.options[A]=B[A]}constructor(B){super(),this._windowsWrappingHeuristics=this.register(new h.MutableDisposable),this._onBinary=this.register(new i.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new i.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new i.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new i.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new i.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new i.EventEmitter),this._instantiationService=new l.InstantiationService,this.optionsService=this.register(new p.OptionsService(B)),this._instantiationService.setService(_.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(g.BufferService)),this._instantiationService.setService(_.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(d.LogService)),this._instantiationService.setService(_.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(f.CoreService)),this._instantiationService.setService(_.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(a.CoreMouseService)),this._instantiationService.setService(_.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(t.UnicodeService)),this._instantiationService.setService(_.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(s.CharsetService),this._instantiationService.setService(_.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(C.OscLinkService),this._instantiationService.setService(_.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new m.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,i.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,i.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,i.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,i.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(A=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(A=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new S.WriteBuffer((A,M)=>this._inputHandler.parse(A,M))),this.register((0,i.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(B,A){this._writeBuffer.write(B,A)}writeSync(B,A){this._logService.logLevel<=_.LogLevelEnum.WARN&&!v&&(this._logService.warn("writeSync is unreliable and will be removed soon."),v=!0),this._writeBuffer.writeSync(B,A)}input(B,A=!0){this.coreService.triggerDataEvent(B,A)}resize(B,A){isNaN(B)||isNaN(A)||(B=Math.max(B,g.MINIMUM_COLS),A=Math.max(A,g.MINIMUM_ROWS),this._bufferService.resize(B,A))}scroll(B,A=!1){this._bufferService.scroll(B,A)}scrollLines(B,A,M){this._bufferService.scrollLines(B,A,M)}scrollPages(B){this.scrollLines(B*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(B){const A=B-this._bufferService.buffer.ydisp;A!==0&&this.scrollLines(A)}registerEscHandler(B,A){return this._inputHandler.registerEscHandler(B,A)}registerDcsHandler(B,A){return this._inputHandler.registerDcsHandler(B,A)}registerCsiHandler(B,A){return this._inputHandler.registerCsiHandler(B,A)}registerOscHandler(B,A){return this._inputHandler.registerOscHandler(B,A)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let B=!1;const A=this.optionsService.rawOptions.windowsPty;A&&A.buildNumber!==void 0&&A.buildNumber!==void 0?B=A.backend==="conpty"&&A.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(B=!0),B?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const B=[];B.push(this.onLineFeed(u.updateWindowsModeWrappedState.bind(null,this._bufferService))),B.push(this.registerCsiHandler({final:"H"},()=>((0,u.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,h.toDisposable)(()=>{for(const A of B)A.dispose()})}}}e.CoreTerminal=k},8460:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.runAndSubscribe=e.forwardEvent=e.EventEmitter=void 0,e.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=o=>(this._listeners.push(o),{dispose:()=>{if(!this._disposed){for(let h=0;h<this._listeners.length;h++)if(this._listeners[h]===o)return void this._listeners.splice(h,1)}}})),this._event}fire(o,h){const _=[];for(let l=0;l<this._listeners.length;l++)_.push(this._listeners[l]);for(let l=0;l<_.length;l++)_[l].call(void 0,o,h)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},e.forwardEvent=function(o,h){return o(_=>h.fire(_))},e.runAndSubscribe=function(o,h){return h(void 0),o(_=>h(_))}},5435:function(y,e,o){var h=this&&this.__decorate||function(K,D,O,I){var H,q=arguments.length,V=q<3?D:I===null?I=Object.getOwnPropertyDescriptor(D,O):I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")V=Reflect.decorate(K,D,O,I);else for(var Q=K.length-1;Q>=0;Q--)(H=K[Q])&&(V=(q<3?H(V):q>3?H(D,O,V):H(D,O))||V);return q>3&&V&&Object.defineProperty(D,O,V),V},_=this&&this.__param||function(K,D){return function(O,I){D(O,I,K)}};Object.defineProperty(e,"__esModule",{value:!0}),e.InputHandler=e.WindowsOptionsReportType=void 0;const l=o(2584),d=o(7116),g=o(2015),p=o(844),f=o(482),i=o(8437),a=o(8460),t=o(643),s=o(511),u=o(3734),m=o(2585),S=o(1480),C=o(6242),v=o(6351),k=o(5941),T={"(":0,")":1,"*":2,"+":3,"-":1,".":2},B=131072;function A(K,D){if(K>24)return D.setWinLines||!1;switch(K){case 1:return!!D.restoreWin;case 2:return!!D.minimizeWin;case 3:return!!D.setWinPosition;case 4:return!!D.setWinSizePixels;case 5:return!!D.raiseWin;case 6:return!!D.lowerWin;case 7:return!!D.refreshWin;case 8:return!!D.setWinSizeChars;case 9:return!!D.maximizeWin;case 10:return!!D.fullscreenWin;case 11:return!!D.getWinState;case 13:return!!D.getWinPosition;case 14:return!!D.getWinSizePixels;case 15:return!!D.getScreenSizePixels;case 16:return!!D.getCellSizePixels;case 18:return!!D.getWinSizeChars;case 19:return!!D.getScreenSizeChars;case 20:return!!D.getIconTitle;case 21:return!!D.getWinTitle;case 22:return!!D.pushTitle;case 23:return!!D.popTitle;case 24:return!!D.setWinLines}return!1}var M;(function(K){K[K.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",K[K.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(M||(e.WindowsOptionsReportType=M={}));let W=0;class N extends p.Disposable{getAttrData(){return this._curAttrData}constructor(D,O,I,H,q,V,Q,U,F=new g.EscapeSequenceParser){super(),this._bufferService=D,this._charsetService=O,this._coreService=I,this._logService=H,this._optionsService=q,this._oscLinkService=V,this._coreMouseService=Q,this._unicodeService=U,this._parser=F,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new f.StringToUtf32,this._utf8Decoder=new f.Utf8ToUtf32,this._workCell=new s.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=i.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new a.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new a.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new a.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new a.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new a.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new a.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new a.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new a.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new a.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new a.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new a.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new a.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new a.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new G(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(R=>this._activeBuffer=R.activeBuffer)),this._parser.setCsiHandlerFallback((R,$)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(R),params:$.toArray()})}),this._parser.setEscHandlerFallback(R=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(R)})}),this._parser.setExecuteHandlerFallback(R=>{this._logService.debug("Unknown EXECUTE code: ",{code:R})}),this._parser.setOscHandlerFallback((R,$,j)=>{this._logService.debug("Unknown OSC code: ",{identifier:R,action:$,data:j})}),this._parser.setDcsHandlerFallback((R,$,j)=>{$==="HOOK"&&(j=j.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(R),action:$,payload:j})}),this._parser.setPrintHandler((R,$,j)=>this.print(R,$,j)),this._parser.registerCsiHandler({final:"@"},R=>this.insertChars(R)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},R=>this.scrollLeft(R)),this._parser.registerCsiHandler({final:"A"},R=>this.cursorUp(R)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},R=>this.scrollRight(R)),this._parser.registerCsiHandler({final:"B"},R=>this.cursorDown(R)),this._parser.registerCsiHandler({final:"C"},R=>this.cursorForward(R)),this._parser.registerCsiHandler({final:"D"},R=>this.cursorBackward(R)),this._parser.registerCsiHandler({final:"E"},R=>this.cursorNextLine(R)),this._parser.registerCsiHandler({final:"F"},R=>this.cursorPrecedingLine(R)),this._parser.registerCsiHandler({final:"G"},R=>this.cursorCharAbsolute(R)),this._parser.registerCsiHandler({final:"H"},R=>this.cursorPosition(R)),this._parser.registerCsiHandler({final:"I"},R=>this.cursorForwardTab(R)),this._parser.registerCsiHandler({final:"J"},R=>this.eraseInDisplay(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},R=>this.eraseInDisplay(R,!0)),this._parser.registerCsiHandler({final:"K"},R=>this.eraseInLine(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},R=>this.eraseInLine(R,!0)),this._parser.registerCsiHandler({final:"L"},R=>this.insertLines(R)),this._parser.registerCsiHandler({final:"M"},R=>this.deleteLines(R)),this._parser.registerCsiHandler({final:"P"},R=>this.deleteChars(R)),this._parser.registerCsiHandler({final:"S"},R=>this.scrollUp(R)),this._parser.registerCsiHandler({final:"T"},R=>this.scrollDown(R)),this._parser.registerCsiHandler({final:"X"},R=>this.eraseChars(R)),this._parser.registerCsiHandler({final:"Z"},R=>this.cursorBackwardTab(R)),this._parser.registerCsiHandler({final:"`"},R=>this.charPosAbsolute(R)),this._parser.registerCsiHandler({final:"a"},R=>this.hPositionRelative(R)),this._parser.registerCsiHandler({final:"b"},R=>this.repeatPrecedingCharacter(R)),this._parser.registerCsiHandler({final:"c"},R=>this.sendDeviceAttributesPrimary(R)),this._parser.registerCsiHandler({prefix:">",final:"c"},R=>this.sendDeviceAttributesSecondary(R)),this._parser.registerCsiHandler({final:"d"},R=>this.linePosAbsolute(R)),this._parser.registerCsiHandler({final:"e"},R=>this.vPositionRelative(R)),this._parser.registerCsiHandler({final:"f"},R=>this.hVPosition(R)),this._parser.registerCsiHandler({final:"g"},R=>this.tabClear(R)),this._parser.registerCsiHandler({final:"h"},R=>this.setMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"h"},R=>this.setModePrivate(R)),this._parser.registerCsiHandler({final:"l"},R=>this.resetMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"l"},R=>this.resetModePrivate(R)),this._parser.registerCsiHandler({final:"m"},R=>this.charAttributes(R)),this._parser.registerCsiHandler({final:"n"},R=>this.deviceStatus(R)),this._parser.registerCsiHandler({prefix:"?",final:"n"},R=>this.deviceStatusPrivate(R)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},R=>this.softReset(R)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},R=>this.setCursorStyle(R)),this._parser.registerCsiHandler({final:"r"},R=>this.setScrollRegion(R)),this._parser.registerCsiHandler({final:"s"},R=>this.saveCursor(R)),this._parser.registerCsiHandler({final:"t"},R=>this.windowOptions(R)),this._parser.registerCsiHandler({final:"u"},R=>this.restoreCursor(R)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},R=>this.insertColumns(R)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},R=>this.deleteColumns(R)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},R=>this.selectProtected(R)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},R=>this.requestMode(R,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},R=>this.requestMode(R,!1)),this._parser.setExecuteHandler(l.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(l.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(l.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(l.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(l.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(l.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(l.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(l.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(l.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(l.C1.IND,()=>this.index()),this._parser.setExecuteHandler(l.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(l.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new C.OscHandler(R=>(this.setTitle(R),this.setIconName(R),!0))),this._parser.registerOscHandler(1,new C.OscHandler(R=>this.setIconName(R))),this._parser.registerOscHandler(2,new C.OscHandler(R=>this.setTitle(R))),this._parser.registerOscHandler(4,new C.OscHandler(R=>this.setOrReportIndexedColor(R))),this._parser.registerOscHandler(8,new C.OscHandler(R=>this.setHyperlink(R))),this._parser.registerOscHandler(10,new C.OscHandler(R=>this.setOrReportFgColor(R))),this._parser.registerOscHandler(11,new C.OscHandler(R=>this.setOrReportBgColor(R))),this._parser.registerOscHandler(12,new C.OscHandler(R=>this.setOrReportCursorColor(R))),this._parser.registerOscHandler(104,new C.OscHandler(R=>this.restoreIndexedColor(R))),this._parser.registerOscHandler(110,new C.OscHandler(R=>this.restoreFgColor(R))),this._parser.registerOscHandler(111,new C.OscHandler(R=>this.restoreBgColor(R))),this._parser.registerOscHandler(112,new C.OscHandler(R=>this.restoreCursorColor(R))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const R in d.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:R},()=>this.selectCharset("("+R)),this._parser.registerEscHandler({intermediates:")",final:R},()=>this.selectCharset(")"+R)),this._parser.registerEscHandler({intermediates:"*",final:R},()=>this.selectCharset("*"+R)),this._parser.registerEscHandler({intermediates:"+",final:R},()=>this.selectCharset("+"+R)),this._parser.registerEscHandler({intermediates:"-",final:R},()=>this.selectCharset("-"+R)),this._parser.registerEscHandler({intermediates:".",final:R},()=>this.selectCharset("."+R)),this._parser.registerEscHandler({intermediates:"/",final:R},()=>this.selectCharset("/"+R));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(R=>(this._logService.error("Parsing error: ",R),R)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new v.DcsHandler((R,$)=>this.requestStatusString(R,$)))}_preserveStack(D,O,I,H){this._parseStack.paused=!0,this._parseStack.cursorStartX=D,this._parseStack.cursorStartY=O,this._parseStack.decodedLength=I,this._parseStack.position=H}_logSlowResolvingAsync(D){this._logService.logLevel<=m.LogLevelEnum.WARN&&Promise.race([D,new Promise((O,I)=>setTimeout(()=>I("#SLOW_TIMEOUT"),5e3))]).catch(O=>{if(O!=="#SLOW_TIMEOUT")throw O;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(D,O){let I,H=this._activeBuffer.x,q=this._activeBuffer.y,V=0;const Q=this._parseStack.paused;if(Q){if(I=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,O))return this._logSlowResolvingAsync(I),I;H=this._parseStack.cursorStartX,q=this._parseStack.cursorStartY,this._parseStack.paused=!1,D.length>B&&(V=this._parseStack.position+B)}if(this._logService.logLevel<=m.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof D=="string"?` "${D}"`:` "${Array.prototype.map.call(D,R=>String.fromCharCode(R)).join("")}"`),typeof D=="string"?D.split("").map(R=>R.charCodeAt(0)):D),this._parseBuffer.length<D.length&&this._parseBuffer.length<B&&(this._parseBuffer=new Uint32Array(Math.min(D.length,B))),Q||this._dirtyRowTracker.clearRange(),D.length>B)for(let R=V;R<D.length;R+=B){const $=R+B<D.length?R+B:D.length,j=typeof D=="string"?this._stringDecoder.decode(D.substring(R,$),this._parseBuffer):this._utf8Decoder.decode(D.subarray(R,$),this._parseBuffer);if(I=this._parser.parse(this._parseBuffer,j))return this._preserveStack(H,q,j,R),this._logSlowResolvingAsync(I),I}else if(!Q){const R=typeof D=="string"?this._stringDecoder.decode(D,this._parseBuffer):this._utf8Decoder.decode(D,this._parseBuffer);if(I=this._parser.parse(this._parseBuffer,R))return this._preserveStack(H,q,R,0),this._logSlowResolvingAsync(I),I}this._activeBuffer.x===H&&this._activeBuffer.y===q||this._onCursorMove.fire();const U=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),F=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);F<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(F,this._bufferService.rows-1),Math.min(U,this._bufferService.rows-1))}print(D,O,I){let H,q;const V=this._charsetService.charset,Q=this._optionsService.rawOptions.screenReaderMode,U=this._bufferService.cols,F=this._coreService.decPrivateModes.wraparound,R=this._coreService.modes.insertMode,$=this._curAttrData;let j=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&I-O>0&&j.getWidth(this._activeBuffer.x-1)===2&&j.setCellFromCodepoint(this._activeBuffer.x-1,0,1,$);let Y=this._parser.precedingJoinState;for(let Z=O;Z<I;++Z){if(H=D[Z],H<127&&V){const fe=V[String.fromCharCode(H)];fe&&(H=fe.charCodeAt(0))}const he=this._unicodeService.charProperties(H,Y);q=S.UnicodeService.extractWidth(he);const me=S.UnicodeService.extractShouldJoin(he),ye=me?S.UnicodeService.extractWidth(Y):0;if(Y=he,Q&&this._onA11yChar.fire((0,f.stringFromCodePoint)(H)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+q-ye>U){if(F){const fe=j;let ne=this._activeBuffer.x-ye;for(this._activeBuffer.x=ye,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),j=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),ye>0&&j instanceof i.BufferLine&&j.copyCellsFrom(fe,ne,0,ye,!1);ne<U;)fe.setCellFromCodepoint(ne++,0,1,$)}else if(this._activeBuffer.x=U-1,q===2)continue}if(me&&this._activeBuffer.x){const fe=j.getWidth(this._activeBuffer.x-1)?1:2;j.addCodepointToCell(this._activeBuffer.x-fe,H,q);for(let ne=q-ye;--ne>=0;)j.setCellFromCodepoint(this._activeBuffer.x++,0,0,$)}else if(R&&(j.insertCells(this._activeBuffer.x,q-ye,this._activeBuffer.getNullCell($)),j.getWidth(U-1)===2&&j.setCellFromCodepoint(U-1,t.NULL_CELL_CODE,t.NULL_CELL_WIDTH,$)),j.setCellFromCodepoint(this._activeBuffer.x++,H,q,$),q>0)for(;--q;)j.setCellFromCodepoint(this._activeBuffer.x++,0,0,$)}this._parser.precedingJoinState=Y,this._activeBuffer.x<U&&I-O>0&&j.getWidth(this._activeBuffer.x)===0&&!j.hasContent(this._activeBuffer.x)&&j.setCellFromCodepoint(this._activeBuffer.x,0,1,$),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(D,O){return D.final!=="t"||D.prefix||D.intermediates?this._parser.registerCsiHandler(D,O):this._parser.registerCsiHandler(D,I=>!A(I.params[0],this._optionsService.rawOptions.windowOptions)||O(I))}registerDcsHandler(D,O){return this._parser.registerDcsHandler(D,new v.DcsHandler(O))}registerEscHandler(D,O){return this._parser.registerEscHandler(D,O)}registerOscHandler(D,O){return this._parser.registerOscHandler(D,new C.OscHandler(O))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var D;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&((D=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))!=null&&D.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);O.hasWidth(this._activeBuffer.x)&&!O.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const D=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-D),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(D=this._bufferService.cols-1){this._activeBuffer.x=Math.min(D,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(D,O){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=D,this._activeBuffer.y=this._activeBuffer.scrollTop+O):(this._activeBuffer.x=D,this._activeBuffer.y=O),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(D,O){this._restrictCursor(),this._setCursor(this._activeBuffer.x+D,this._activeBuffer.y+O)}cursorUp(D){const O=this._activeBuffer.y-this._activeBuffer.scrollTop;return O>=0?this._moveCursor(0,-Math.min(O,D.params[0]||1)):this._moveCursor(0,-(D.params[0]||1)),!0}cursorDown(D){const O=this._activeBuffer.scrollBottom-this._activeBuffer.y;return O>=0?this._moveCursor(0,Math.min(O,D.params[0]||1)):this._moveCursor(0,D.params[0]||1),!0}cursorForward(D){return this._moveCursor(D.params[0]||1,0),!0}cursorBackward(D){return this._moveCursor(-(D.params[0]||1),0),!0}cursorNextLine(D){return this.cursorDown(D),this._activeBuffer.x=0,!0}cursorPrecedingLine(D){return this.cursorUp(D),this._activeBuffer.x=0,!0}cursorCharAbsolute(D){return this._setCursor((D.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(D){return this._setCursor(D.length>=2?(D.params[1]||1)-1:0,(D.params[0]||1)-1),!0}charPosAbsolute(D){return this._setCursor((D.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(D){return this._moveCursor(D.params[0]||1,0),!0}linePosAbsolute(D){return this._setCursor(this._activeBuffer.x,(D.params[0]||1)-1),!0}vPositionRelative(D){return this._moveCursor(0,D.params[0]||1),!0}hVPosition(D){return this.cursorPosition(D),!0}tabClear(D){const O=D.params[0];return O===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:O===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(D){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let O=D.params[0]||1;for(;O--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(D){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let O=D.params[0]||1;for(;O--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(D){const O=D.params[0];return O===1&&(this._curAttrData.bg|=536870912),O!==2&&O!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(D,O,I,H=!1,q=!1){const V=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);V.replaceCells(O,I,this._activeBuffer.getNullCell(this._eraseAttrData()),q),H&&(V.isWrapped=!1)}_resetBufferLine(D,O=!1){const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);I&&(I.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),O),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+D),I.isWrapped=!1)}eraseInDisplay(D,O=!1){let I;switch(this._restrictCursor(this._bufferService.cols),D.params[0]){case 0:for(I=this._activeBuffer.y,this._dirtyRowTracker.markDirty(I),this._eraseInBufferLine(I++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,O);I<this._bufferService.rows;I++)this._resetBufferLine(I,O);this._dirtyRowTracker.markDirty(I);break;case 1:for(I=this._activeBuffer.y,this._dirtyRowTracker.markDirty(I),this._eraseInBufferLine(I,0,this._activeBuffer.x+1,!0,O),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(I+1).isWrapped=!1);I--;)this._resetBufferLine(I,O);this._dirtyRowTracker.markDirty(0);break;case 2:for(I=this._bufferService.rows,this._dirtyRowTracker.markDirty(I-1);I--;)this._resetBufferLine(I,O);this._dirtyRowTracker.markDirty(0);break;case 3:const H=this._activeBuffer.lines.length-this._bufferService.rows;H>0&&(this._activeBuffer.lines.trimStart(H),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-H,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-H,0),this._onScroll.fire(0))}return!0}eraseInLine(D,O=!1){switch(this._restrictCursor(this._bufferService.cols),D.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,O);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,O);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,O)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(D){this._restrictCursor();let O=D.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=this._activeBuffer.ybase+this._activeBuffer.y,H=this._bufferService.rows-1-this._activeBuffer.scrollBottom,q=this._bufferService.rows-1+this._activeBuffer.ybase-H+1;for(;O--;)this._activeBuffer.lines.splice(q-1,1),this._activeBuffer.lines.splice(I,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(D){this._restrictCursor();let O=D.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=this._activeBuffer.ybase+this._activeBuffer.y;let H;for(H=this._bufferService.rows-1-this._activeBuffer.scrollBottom,H=this._bufferService.rows-1+this._activeBuffer.ybase-H;O--;)this._activeBuffer.lines.splice(I,1),this._activeBuffer.lines.splice(H,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(D){this._restrictCursor();const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return O&&(O.insertCells(this._activeBuffer.x,D.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(D){this._restrictCursor();const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return O&&(O.deleteCells(this._activeBuffer.x,D.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(D){let O=D.params[0]||1;for(;O--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(D){let O=D.params[0]||1;for(;O--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(i.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=D.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);H.deleteCells(0,O,this._activeBuffer.getNullCell(this._eraseAttrData())),H.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=D.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);H.insertCells(0,O,this._activeBuffer.getNullCell(this._eraseAttrData())),H.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=D.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);H.insertCells(this._activeBuffer.x,O,this._activeBuffer.getNullCell(this._eraseAttrData())),H.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(D){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=D.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);H.deleteCells(this._activeBuffer.x,O,this._activeBuffer.getNullCell(this._eraseAttrData())),H.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(D){this._restrictCursor();const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return O&&(O.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(D.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(D){const O=this._parser.precedingJoinState;if(!O)return!0;const I=D.params[0]||1,H=S.UnicodeService.extractWidth(O),q=this._activeBuffer.x-H,V=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(q),Q=new Uint32Array(V.length*I);let U=0;for(let R=0;R<V.length;){const $=V.codePointAt(R)||0;Q[U++]=$,R+=$>65535?2:1}let F=U;for(let R=1;R<I;++R)Q.copyWithin(F,0,U),F+=U;return this.print(Q,0,F),!0}sendDeviceAttributesPrimary(D){return D.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(l.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(l.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(D){return D.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(l.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(l.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(D.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(l.C0.ESC+"[>83;40003;0c")),!0}_is(D){return(this._optionsService.rawOptions.termName+"").indexOf(D)===0}setMode(D){for(let O=0;O<D.length;O++)switch(D.params[O]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(D){for(let O=0;O<D.length;O++)switch(D.params[O]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),this._charsetService.setgCharset(1,d.DEFAULT_CHARSET),this._charsetService.setgCharset(2,d.DEFAULT_CHARSET),this._charsetService.setgCharset(3,d.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(D){for(let O=0;O<D.length;O++)switch(D.params[O]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(D){for(let O=0;O<D.length;O++)switch(D.params[O]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),D.params[O]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(D,O){const I=this._coreService.decPrivateModes,{activeProtocol:H,activeEncoding:q}=this._coreMouseService,V=this._coreService,{buffers:Q,cols:U}=this._bufferService,{active:F,alt:R}=Q,$=this._optionsService.rawOptions,j=me=>me?1:2,Y=D.params[0];return Z=Y,he=O?Y===2?4:Y===4?j(V.modes.insertMode):Y===12?3:Y===20?j($.convertEol):0:Y===1?j(I.applicationCursorKeys):Y===3?$.windowOptions.setWinLines?U===80?2:U===132?1:0:0:Y===6?j(I.origin):Y===7?j(I.wraparound):Y===8?3:Y===9?j(H==="X10"):Y===12?j($.cursorBlink):Y===25?j(!V.isCursorHidden):Y===45?j(I.reverseWraparound):Y===66?j(I.applicationKeypad):Y===67?4:Y===1e3?j(H==="VT200"):Y===1002?j(H==="DRAG"):Y===1003?j(H==="ANY"):Y===1004?j(I.sendFocus):Y===1005?4:Y===1006?j(q==="SGR"):Y===1015?4:Y===1016?j(q==="SGR_PIXELS"):Y===1048?1:Y===47||Y===1047||Y===1049?j(F===R):Y===2004?j(I.bracketedPasteMode):0,V.triggerDataEvent(`${l.C0.ESC}[${O?"":"?"}${Z};${he}$y`),!0;var Z,he}_updateAttrColor(D,O,I,H,q){return O===2?(D|=50331648,D&=-16777216,D|=u.AttributeData.fromColorRGB([I,H,q])):O===5&&(D&=-50331904,D|=33554432|255&I),D}_extractColor(D,O,I){const H=[0,0,-1,0,0,0];let q=0,V=0;do{if(H[V+q]=D.params[O+V],D.hasSubParams(O+V)){const Q=D.getSubParams(O+V);let U=0;do H[1]===5&&(q=1),H[V+U+1+q]=Q[U];while(++U<Q.length&&U+V+1+q<H.length);break}if(H[1]===5&&V+q>=2||H[1]===2&&V+q>=5)break;H[1]&&(q=1)}while(++V+O<D.length&&V+q<H.length);for(let Q=2;Q<H.length;++Q)H[Q]===-1&&(H[Q]=0);switch(H[0]){case 38:I.fg=this._updateAttrColor(I.fg,H[1],H[3],H[4],H[5]);break;case 48:I.bg=this._updateAttrColor(I.bg,H[1],H[3],H[4],H[5]);break;case 58:I.extended=I.extended.clone(),I.extended.underlineColor=this._updateAttrColor(I.extended.underlineColor,H[1],H[3],H[4],H[5])}return V}_processUnderline(D,O){O.extended=O.extended.clone(),(!~D||D>5)&&(D=1),O.extended.underlineStyle=D,O.fg|=268435456,D===0&&(O.fg&=-268435457),O.updateExtended()}_processSGR0(D){D.fg=i.DEFAULT_ATTR_DATA.fg,D.bg=i.DEFAULT_ATTR_DATA.bg,D.extended=D.extended.clone(),D.extended.underlineStyle=0,D.extended.underlineColor&=-67108864,D.updateExtended()}charAttributes(D){if(D.length===1&&D.params[0]===0)return this._processSGR0(this._curAttrData),!0;const O=D.length;let I;const H=this._curAttrData;for(let q=0;q<O;q++)I=D.params[q],I>=30&&I<=37?(H.fg&=-50331904,H.fg|=16777216|I-30):I>=40&&I<=47?(H.bg&=-50331904,H.bg|=16777216|I-40):I>=90&&I<=97?(H.fg&=-50331904,H.fg|=16777224|I-90):I>=100&&I<=107?(H.bg&=-50331904,H.bg|=16777224|I-100):I===0?this._processSGR0(H):I===1?H.fg|=134217728:I===3?H.bg|=67108864:I===4?(H.fg|=268435456,this._processUnderline(D.hasSubParams(q)?D.getSubParams(q)[0]:1,H)):I===5?H.fg|=536870912:I===7?H.fg|=67108864:I===8?H.fg|=1073741824:I===9?H.fg|=2147483648:I===2?H.bg|=134217728:I===21?this._processUnderline(2,H):I===22?(H.fg&=-134217729,H.bg&=-134217729):I===23?H.bg&=-67108865:I===24?(H.fg&=-268435457,this._processUnderline(0,H)):I===25?H.fg&=-536870913:I===27?H.fg&=-67108865:I===28?H.fg&=-1073741825:I===29?H.fg&=2147483647:I===39?(H.fg&=-67108864,H.fg|=16777215&i.DEFAULT_ATTR_DATA.fg):I===49?(H.bg&=-67108864,H.bg|=16777215&i.DEFAULT_ATTR_DATA.bg):I===38||I===48||I===58?q+=this._extractColor(D,q,H):I===53?H.bg|=1073741824:I===55?H.bg&=-1073741825:I===59?(H.extended=H.extended.clone(),H.extended.underlineColor=-1,H.updateExtended()):I===100?(H.fg&=-67108864,H.fg|=16777215&i.DEFAULT_ATTR_DATA.fg,H.bg&=-67108864,H.bg|=16777215&i.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",I);return!0}deviceStatus(D){switch(D.params[0]){case 5:this._coreService.triggerDataEvent(`${l.C0.ESC}[0n`);break;case 6:const O=this._activeBuffer.y+1,I=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${l.C0.ESC}[${O};${I}R`)}return!0}deviceStatusPrivate(D){if(D.params[0]===6){const O=this._activeBuffer.y+1,I=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${l.C0.ESC}[?${O};${I}R`)}return!0}softReset(D){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(D){const O=D.params[0]||1;switch(O){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const I=O%2==1;return this._optionsService.options.cursorBlink=I,!0}setScrollRegion(D){const O=D.params[0]||1;let I;return(D.length<2||(I=D.params[1])>this._bufferService.rows||I===0)&&(I=this._bufferService.rows),I>O&&(this._activeBuffer.scrollTop=O-1,this._activeBuffer.scrollBottom=I-1,this._setCursor(0,0)),!0}windowOptions(D){if(!A(D.params[0],this._optionsService.rawOptions.windowOptions))return!0;const O=D.length>1?D.params[1]:0;switch(D.params[0]){case 14:O!==2&&this._onRequestWindowsOptionsReport.fire(M.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(M.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${l.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:O!==0&&O!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),O!==0&&O!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:O!==0&&O!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),O!==0&&O!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(D){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(D){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(D){return this._windowTitle=D,this._onTitleChange.fire(D),!0}setIconName(D){return this._iconName=D,!0}setOrReportIndexedColor(D){const O=[],I=D.split(";");for(;I.length>1;){const H=I.shift(),q=I.shift();if(/^\d+$/.exec(H)){const V=parseInt(H);if(X(V))if(q==="?")O.push({type:0,index:V});else{const Q=(0,k.parseColor)(q);Q&&O.push({type:1,index:V,color:Q})}}}return O.length&&this._onColor.fire(O),!0}setHyperlink(D){const O=D.split(";");return!(O.length<2)&&(O[1]?this._createHyperlink(O[0],O[1]):!O[0]&&this._finishHyperlink())}_createHyperlink(D,O){this._getCurrentLinkId()&&this._finishHyperlink();const I=D.split(":");let H;const q=I.findIndex(V=>V.startsWith("id="));return q!==-1&&(H=I[q].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:H,uri:O}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(D,O){const I=D.split(";");for(let H=0;H<I.length&&!(O>=this._specialColors.length);++H,++O)if(I[H]==="?")this._onColor.fire([{type:0,index:this._specialColors[O]}]);else{const q=(0,k.parseColor)(I[H]);q&&this._onColor.fire([{type:1,index:this._specialColors[O],color:q}])}return!0}setOrReportFgColor(D){return this._setOrReportSpecialColor(D,0)}setOrReportBgColor(D){return this._setOrReportSpecialColor(D,1)}setOrReportCursorColor(D){return this._setOrReportSpecialColor(D,2)}restoreIndexedColor(D){if(!D)return this._onColor.fire([{type:2}]),!0;const O=[],I=D.split(";");for(let H=0;H<I.length;++H)if(/^\d+$/.exec(I[H])){const q=parseInt(I[H]);X(q)&&O.push({type:2,index:q})}return O.length&&this._onColor.fire(O),!0}restoreFgColor(D){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(D){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(D){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),!0}selectCharset(D){return D.length!==2?(this.selectDefaultCharset(),!0):(D[0]==="/"||this._charsetService.setgCharset(T[D[0]],d.CHARSETS[D[1]]||d.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const D=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,D,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=i.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(D){return this._charsetService.setgLevel(D),!0}screenAlignmentPattern(){const D=new s.CellData;D.content=4194373,D.fg=this._curAttrData.fg,D.bg=this._curAttrData.bg,this._setCursor(0,0);for(let O=0;O<this._bufferService.rows;++O){const I=this._activeBuffer.ybase+this._activeBuffer.y+O,H=this._activeBuffer.lines.get(I);H&&(H.fill(D),H.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(D,O){const I=this._bufferService.buffer,H=this._optionsService.rawOptions;return(q=>(this._coreService.triggerDataEvent(`${l.C0.ESC}${q}${l.C0.ESC}\\`),!0))(D==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:D==='"p'?'P1$r61;1"p':D==="r"?`P1$r${I.scrollTop+1};${I.scrollBottom+1}r`:D==="m"?"P1$r0m":D===" q"?`P1$r${{block:2,underline:4,bar:6}[H.cursorStyle]-(H.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(D,O){this._dirtyRowTracker.markRangeDirty(D,O)}}e.InputHandler=N;let G=class{constructor(K){this._bufferService=K,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(K){K<this.start?this.start=K:K>this.end&&(this.end=K)}markRangeDirty(K,D){K>D&&(W=K,K=D,D=W),K<this.start&&(this.start=K),D>this.end&&(this.end=D)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function X(K){return 0<=K&&K<256}G=h([_(0,m.IBufferService)],G)},844:(y,e)=>{function o(h){for(const _ of h)_.dispose();h.length=0}Object.defineProperty(e,"__esModule",{value:!0}),e.getDisposeArrayDisposable=e.disposeArray=e.toDisposable=e.MutableDisposable=e.Disposable=void 0,e.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const h of this._disposables)h.dispose();this._disposables.length=0}register(h){return this._disposables.push(h),h}unregister(h){const _=this._disposables.indexOf(h);_!==-1&&this._disposables.splice(_,1)}},e.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(h){var _;this._isDisposed||h===this._value||((_=this._value)==null||_.dispose(),this._value=h)}clear(){this.value=void 0}dispose(){var h;this._isDisposed=!0,(h=this._value)==null||h.dispose(),this._value=void 0}},e.toDisposable=function(h){return{dispose:h}},e.disposeArray=o,e.getDisposeArrayDisposable=function(h){return{dispose:()=>o(h)}}},1505:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FourKeyMap=e.TwoKeyMap=void 0;class o{constructor(){this._data={}}set(_,l,d){this._data[_]||(this._data[_]={}),this._data[_][l]=d}get(_,l){return this._data[_]?this._data[_][l]:void 0}clear(){this._data={}}}e.TwoKeyMap=o,e.FourKeyMap=class{constructor(){this._data=new o}set(h,_,l,d,g){this._data.get(h,_)||this._data.set(h,_,new o),this._data.get(h,_).set(l,d,g)}get(h,_,l,d){var g;return(g=this._data.get(h,_))==null?void 0:g.get(l,d)}clear(){this._data.clear()}}},6114:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isChromeOS=e.isLinux=e.isWindows=e.isIphone=e.isIpad=e.isMac=e.getSafariVersion=e.isSafari=e.isLegacyEdge=e.isFirefox=e.isNode=void 0,e.isNode=typeof process<"u"&&"title"in process;const o=e.isNode?"node":navigator.userAgent,h=e.isNode?"node":navigator.platform;e.isFirefox=o.includes("Firefox"),e.isLegacyEdge=o.includes("Edge"),e.isSafari=/^((?!chrome|android).)*safari/i.test(o),e.getSafariVersion=function(){if(!e.isSafari)return 0;const _=o.match(/Version\/(\d+)/);return _===null||_.length<2?0:parseInt(_[1])},e.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(h),e.isIpad=h==="iPad",e.isIphone=h==="iPhone",e.isWindows=["Windows","Win16","Win32","WinCE"].includes(h),e.isLinux=h.indexOf("Linux")>=0,e.isChromeOS=/\bCrOS\b/.test(o)},6106:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SortedList=void 0;let o=0;e.SortedList=class{constructor(h){this._getKey=h,this._array=[]}clear(){this._array.length=0}insert(h){this._array.length!==0?(o=this._search(this._getKey(h)),this._array.splice(o,0,h)):this._array.push(h)}delete(h){if(this._array.length===0)return!1;const _=this._getKey(h);if(_===void 0||(o=this._search(_),o===-1)||this._getKey(this._array[o])!==_)return!1;do if(this._array[o]===h)return this._array.splice(o,1),!0;while(++o<this._array.length&&this._getKey(this._array[o])===_);return!1}*getKeyIterator(h){if(this._array.length!==0&&(o=this._search(h),!(o<0||o>=this._array.length)&&this._getKey(this._array[o])===h))do yield this._array[o];while(++o<this._array.length&&this._getKey(this._array[o])===h)}forEachByKey(h,_){if(this._array.length!==0&&(o=this._search(h),!(o<0||o>=this._array.length)&&this._getKey(this._array[o])===h))do _(this._array[o]);while(++o<this._array.length&&this._getKey(this._array[o])===h)}values(){return[...this._array].values()}_search(h){let _=0,l=this._array.length-1;for(;l>=_;){let d=_+l>>1;const g=this._getKey(this._array[d]);if(g>h)l=d-1;else{if(!(g<h)){for(;d>0&&this._getKey(this._array[d-1])===h;)d--;return d}_=d+1}}return _}}},7226:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DebouncedIdleTask=e.IdleTaskQueue=e.PriorityTaskQueue=void 0;const h=o(6114);class _{constructor(){this._tasks=[],this._i=0}enqueue(g){this._tasks.push(g),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(g){this._idleCallback=void 0;let p=0,f=0,i=g.timeRemaining(),a=0;for(;this._i<this._tasks.length;){if(p=Date.now(),this._tasks[this._i]()||this._i++,p=Math.max(1,Date.now()-p),f=Math.max(p,f),a=g.timeRemaining(),1.5*f>a)return i-p<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(i-p))}ms`),void this._start();i=a}this.clear()}}class l extends _{_requestCallback(g){return setTimeout(()=>g(this._createDeadline(16)))}_cancelCallback(g){clearTimeout(g)}_createDeadline(g){const p=Date.now()+g;return{timeRemaining:()=>Math.max(0,p-Date.now())}}}e.PriorityTaskQueue=l,e.IdleTaskQueue=!h.isNode&&"requestIdleCallback"in window?class extends _{_requestCallback(d){return requestIdleCallback(d)}_cancelCallback(d){cancelIdleCallback(d)}}:l,e.DebouncedIdleTask=class{constructor(){this._queue=new e.IdleTaskQueue}set(d){this._queue.clear(),this._queue.enqueue(d)}flush(){this._queue.flush()}}},9282:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.updateWindowsModeWrappedState=void 0;const h=o(643);e.updateWindowsModeWrappedState=function(_){const l=_.buffer.lines.get(_.buffer.ybase+_.buffer.y-1),d=l==null?void 0:l.get(_.cols-1),g=_.buffer.lines.get(_.buffer.ybase+_.buffer.y);g&&d&&(g.isWrapped=d[h.CHAR_DATA_CODE_INDEX]!==h.NULL_CELL_CODE&&d[h.CHAR_DATA_CODE_INDEX]!==h.WHITESPACE_CELL_CODE)}},3734:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendedAttrs=e.AttributeData=void 0;class o{constructor(){this.fg=0,this.bg=0,this.extended=new h}static toColorRGB(l){return[l>>>16&255,l>>>8&255,255&l]}static fromColorRGB(l){return(255&l[0])<<16|(255&l[1])<<8|255&l[2]}clone(){const l=new o;return l.fg=this.fg,l.bg=this.bg,l.extended=this.extended.clone(),l}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}e.AttributeData=o;class h{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(l){this._ext=l}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(l){this._ext&=-469762049,this._ext|=l<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(l){this._ext&=-67108864,this._ext|=67108863&l}get urlId(){return this._urlId}set urlId(l){this._urlId=l}get underlineVariantOffset(){const l=(3758096384&this._ext)>>29;return l<0?4294967288^l:l}set underlineVariantOffset(l){this._ext&=536870911,this._ext|=l<<29&3758096384}constructor(l=0,d=0){this._ext=0,this._urlId=0,this._ext=l,this._urlId=d}clone(){return new h(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}e.ExtendedAttrs=h},9092:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Buffer=e.MAX_BUFFER_SIZE=void 0;const h=o(6349),_=o(7226),l=o(3734),d=o(8437),g=o(4634),p=o(511),f=o(643),i=o(4863),a=o(7116);e.MAX_BUFFER_SIZE=4294967295,e.Buffer=class{constructor(t,s,u){this._hasScrollback=t,this._optionsService=s,this._bufferService=u,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=d.DEFAULT_ATTR_DATA.clone(),this.savedCharset=a.DEFAULT_CHARSET,this.markers=[],this._nullCell=p.CellData.fromCharData([0,f.NULL_CELL_CHAR,f.NULL_CELL_WIDTH,f.NULL_CELL_CODE]),this._whitespaceCell=p.CellData.fromCharData([0,f.WHITESPACE_CELL_CHAR,f.WHITESPACE_CELL_WIDTH,f.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new _.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(t){return t?(this._nullCell.fg=t.fg,this._nullCell.bg=t.bg,this._nullCell.extended=t.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new l.ExtendedAttrs),this._nullCell}getWhitespaceCell(t){return t?(this._whitespaceCell.fg=t.fg,this._whitespaceCell.bg=t.bg,this._whitespaceCell.extended=t.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new l.ExtendedAttrs),this._whitespaceCell}getBlankLine(t,s){return new d.BufferLine(this._bufferService.cols,this.getNullCell(t),s)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const t=this.ybase+this.y-this.ydisp;return t>=0&&t<this._rows}_getCorrectBufferLength(t){if(!this._hasScrollback)return t;const s=t+this._optionsService.rawOptions.scrollback;return s>e.MAX_BUFFER_SIZE?e.MAX_BUFFER_SIZE:s}fillViewportRows(t){if(this.lines.length===0){t===void 0&&(t=d.DEFAULT_ATTR_DATA);let s=this._rows;for(;s--;)this.lines.push(this.getBlankLine(t))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(t,s){const u=this.getNullCell(d.DEFAULT_ATTR_DATA);let m=0;const S=this._getCorrectBufferLength(s);if(S>this.lines.maxLength&&(this.lines.maxLength=S),this.lines.length>0){if(this._cols<t)for(let v=0;v<this.lines.length;v++)m+=+this.lines.get(v).resize(t,u);let C=0;if(this._rows<s)for(let v=this._rows;v<s;v++)this.lines.length<s+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new d.BufferLine(t,u)):this.ybase>0&&this.lines.length<=this.ybase+this.y+C+1?(this.ybase--,C++,this.ydisp>0&&this.ydisp--):this.lines.push(new d.BufferLine(t,u)));else for(let v=this._rows;v>s;v--)this.lines.length>s+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(S<this.lines.maxLength){const v=this.lines.length-S;v>0&&(this.lines.trimStart(v),this.ybase=Math.max(this.ybase-v,0),this.ydisp=Math.max(this.ydisp-v,0),this.savedY=Math.max(this.savedY-v,0)),this.lines.maxLength=S}this.x=Math.min(this.x,t-1),this.y=Math.min(this.y,s-1),C&&(this.y+=C),this.savedX=Math.min(this.savedX,t-1),this.scrollTop=0}if(this.scrollBottom=s-1,this._isReflowEnabled&&(this._reflow(t,s),this._cols>t))for(let C=0;C<this.lines.length;C++)m+=+this.lines.get(C).resize(t,u);this._cols=t,this._rows=s,this._memoryCleanupQueue.clear(),m>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let t=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,t=!1);let s=0;for(;this._memoryCleanupPosition<this.lines.length;)if(s+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),s>100)return!0;return t}get _isReflowEnabled(){const t=this._optionsService.rawOptions.windowsPty;return t&&t.buildNumber?this._hasScrollback&&t.backend==="conpty"&&t.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(t,s){this._cols!==t&&(t>this._cols?this._reflowLarger(t,s):this._reflowSmaller(t,s))}_reflowLarger(t,s){const u=(0,g.reflowLargerGetLinesToRemove)(this.lines,this._cols,t,this.ybase+this.y,this.getNullCell(d.DEFAULT_ATTR_DATA));if(u.length>0){const m=(0,g.reflowLargerCreateNewLayout)(this.lines,u);(0,g.reflowLargerApplyNewLayout)(this.lines,m.layout),this._reflowLargerAdjustViewport(t,s,m.countRemoved)}}_reflowLargerAdjustViewport(t,s,u){const m=this.getNullCell(d.DEFAULT_ATTR_DATA);let S=u;for(;S-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<s&&this.lines.push(new d.BufferLine(t,m))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-u,0)}_reflowSmaller(t,s){const u=this.getNullCell(d.DEFAULT_ATTR_DATA),m=[];let S=0;for(let C=this.lines.length-1;C>=0;C--){let v=this.lines.get(C);if(!v||!v.isWrapped&&v.getTrimmedLength()<=t)continue;const k=[v];for(;v.isWrapped&&C>0;)v=this.lines.get(--C),k.unshift(v);const T=this.ybase+this.y;if(T>=C&&T<C+k.length)continue;const B=k[k.length-1].getTrimmedLength(),A=(0,g.reflowSmallerGetNewLineLengths)(k,this._cols,t),M=A.length-k.length;let W;W=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+M):Math.max(0,this.lines.length-this.lines.maxLength+M);const N=[];for(let I=0;I<M;I++){const H=this.getBlankLine(d.DEFAULT_ATTR_DATA,!0);N.push(H)}N.length>0&&(m.push({start:C+k.length+S,newLines:N}),S+=N.length),k.push(...N);let G=A.length-1,X=A[G];X===0&&(G--,X=A[G]);let K=k.length-M-1,D=B;for(;K>=0;){const I=Math.min(D,X);if(k[G]===void 0)break;if(k[G].copyCellsFrom(k[K],D-I,X-I,I,!0),X-=I,X===0&&(G--,X=A[G]),D-=I,D===0){K--;const H=Math.max(K,0);D=(0,g.getWrappedLineTrimmedLength)(k,H,this._cols)}}for(let I=0;I<k.length;I++)A[I]<t&&k[I].setCell(A[I],u);let O=M-W;for(;O-- >0;)this.ybase===0?this.y<s-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+S)-s&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+M,this.ybase+s-1)}if(m.length>0){const C=[],v=[];for(let G=0;G<this.lines.length;G++)v.push(this.lines.get(G));const k=this.lines.length;let T=k-1,B=0,A=m[B];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+S);let M=0;for(let G=Math.min(this.lines.maxLength-1,k+S-1);G>=0;G--)if(A&&A.start>T+M){for(let X=A.newLines.length-1;X>=0;X--)this.lines.set(G--,A.newLines[X]);G++,C.push({index:T+1,amount:A.newLines.length}),M+=A.newLines.length,A=m[++B]}else this.lines.set(G,v[T--]);let W=0;for(let G=C.length-1;G>=0;G--)C[G].index+=W,this.lines.onInsertEmitter.fire(C[G]),W+=C[G].amount;const N=Math.max(0,k+S-this.lines.maxLength);N>0&&this.lines.onTrimEmitter.fire(N)}}translateBufferLineToString(t,s,u=0,m){const S=this.lines.get(t);return S?S.translateToString(s,u,m):""}getWrappedRangeForLine(t){let s=t,u=t;for(;s>0&&this.lines.get(s).isWrapped;)s--;for(;u+1<this.lines.length&&this.lines.get(u+1).isWrapped;)u++;return{first:s,last:u}}setupTabStops(t){for(t!=null?this.tabs[t]||(t=this.prevStop(t)):(this.tabs={},t=0);t<this._cols;t+=this._optionsService.rawOptions.tabStopWidth)this.tabs[t]=!0}prevStop(t){for(t==null&&(t=this.x);!this.tabs[--t]&&t>0;);return t>=this._cols?this._cols-1:t<0?0:t}nextStop(t){for(t==null&&(t=this.x);!this.tabs[++t]&&t<this._cols;);return t>=this._cols?this._cols-1:t<0?0:t}clearMarkers(t){this._isClearing=!0;for(let s=0;s<this.markers.length;s++)this.markers[s].line===t&&(this.markers[s].dispose(),this.markers.splice(s--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let t=0;t<this.markers.length;t++)this.markers[t].dispose(),this.markers.splice(t--,1);this._isClearing=!1}addMarker(t){const s=new i.Marker(t);return this.markers.push(s),s.register(this.lines.onTrim(u=>{s.line-=u,s.line<0&&s.dispose()})),s.register(this.lines.onInsert(u=>{s.line>=u.index&&(s.line+=u.amount)})),s.register(this.lines.onDelete(u=>{s.line>=u.index&&s.line<u.index+u.amount&&s.dispose(),s.line>u.index&&(s.line-=u.amount)})),s.register(s.onDispose(()=>this._removeMarker(s))),s}_removeMarker(t){this._isClearing||this.markers.splice(this.markers.indexOf(t),1)}}},8437:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferLine=e.DEFAULT_ATTR_DATA=void 0;const h=o(3734),_=o(511),l=o(643),d=o(482);e.DEFAULT_ATTR_DATA=Object.freeze(new h.AttributeData);let g=0;class p{constructor(i,a,t=!1){this.isWrapped=t,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*i);const s=a||_.CellData.fromCharData([0,l.NULL_CELL_CHAR,l.NULL_CELL_WIDTH,l.NULL_CELL_CODE]);for(let u=0;u<i;++u)this.setCell(u,s);this.length=i}get(i){const a=this._data[3*i+0],t=2097151&a;return[this._data[3*i+1],2097152&a?this._combined[i]:t?(0,d.stringFromCodePoint)(t):"",a>>22,2097152&a?this._combined[i].charCodeAt(this._combined[i].length-1):t]}set(i,a){this._data[3*i+1]=a[l.CHAR_DATA_ATTR_INDEX],a[l.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[i]=a[1],this._data[3*i+0]=2097152|i|a[l.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*i+0]=a[l.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|a[l.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(i){return this._data[3*i+0]>>22}hasWidth(i){return 12582912&this._data[3*i+0]}getFg(i){return this._data[3*i+1]}getBg(i){return this._data[3*i+2]}hasContent(i){return 4194303&this._data[3*i+0]}getCodePoint(i){const a=this._data[3*i+0];return 2097152&a?this._combined[i].charCodeAt(this._combined[i].length-1):2097151&a}isCombined(i){return 2097152&this._data[3*i+0]}getString(i){const a=this._data[3*i+0];return 2097152&a?this._combined[i]:2097151&a?(0,d.stringFromCodePoint)(2097151&a):""}isProtected(i){return 536870912&this._data[3*i+2]}loadCell(i,a){return g=3*i,a.content=this._data[g+0],a.fg=this._data[g+1],a.bg=this._data[g+2],2097152&a.content&&(a.combinedData=this._combined[i]),268435456&a.bg&&(a.extended=this._extendedAttrs[i]),a}setCell(i,a){2097152&a.content&&(this._combined[i]=a.combinedData),268435456&a.bg&&(this._extendedAttrs[i]=a.extended),this._data[3*i+0]=a.content,this._data[3*i+1]=a.fg,this._data[3*i+2]=a.bg}setCellFromCodepoint(i,a,t,s){268435456&s.bg&&(this._extendedAttrs[i]=s.extended),this._data[3*i+0]=a|t<<22,this._data[3*i+1]=s.fg,this._data[3*i+2]=s.bg}addCodepointToCell(i,a,t){let s=this._data[3*i+0];2097152&s?this._combined[i]+=(0,d.stringFromCodePoint)(a):2097151&s?(this._combined[i]=(0,d.stringFromCodePoint)(2097151&s)+(0,d.stringFromCodePoint)(a),s&=-2097152,s|=2097152):s=a|4194304,t&&(s&=-12582913,s|=t<<22),this._data[3*i+0]=s}insertCells(i,a,t){if((i%=this.length)&&this.getWidth(i-1)===2&&this.setCellFromCodepoint(i-1,0,1,t),a<this.length-i){const s=new _.CellData;for(let u=this.length-i-a-1;u>=0;--u)this.setCell(i+a+u,this.loadCell(i+u,s));for(let u=0;u<a;++u)this.setCell(i+u,t)}else for(let s=i;s<this.length;++s)this.setCell(s,t);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,t)}deleteCells(i,a,t){if(i%=this.length,a<this.length-i){const s=new _.CellData;for(let u=0;u<this.length-i-a;++u)this.setCell(i+u,this.loadCell(i+a+u,s));for(let u=this.length-a;u<this.length;++u)this.setCell(u,t)}else for(let s=i;s<this.length;++s)this.setCell(s,t);i&&this.getWidth(i-1)===2&&this.setCellFromCodepoint(i-1,0,1,t),this.getWidth(i)!==0||this.hasContent(i)||this.setCellFromCodepoint(i,0,1,t)}replaceCells(i,a,t,s=!1){if(s)for(i&&this.getWidth(i-1)===2&&!this.isProtected(i-1)&&this.setCellFromCodepoint(i-1,0,1,t),a<this.length&&this.getWidth(a-1)===2&&!this.isProtected(a)&&this.setCellFromCodepoint(a,0,1,t);i<a&&i<this.length;)this.isProtected(i)||this.setCell(i,t),i++;else for(i&&this.getWidth(i-1)===2&&this.setCellFromCodepoint(i-1,0,1,t),a<this.length&&this.getWidth(a-1)===2&&this.setCellFromCodepoint(a,0,1,t);i<a&&i<this.length;)this.setCell(i++,t)}resize(i,a){if(i===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const t=3*i;if(i>this.length){if(this._data.buffer.byteLength>=4*t)this._data=new Uint32Array(this._data.buffer,0,t);else{const s=new Uint32Array(t);s.set(this._data),this._data=s}for(let s=this.length;s<i;++s)this.setCell(s,a)}else{this._data=this._data.subarray(0,t);const s=Object.keys(this._combined);for(let m=0;m<s.length;m++){const S=parseInt(s[m],10);S>=i&&delete this._combined[S]}const u=Object.keys(this._extendedAttrs);for(let m=0;m<u.length;m++){const S=parseInt(u[m],10);S>=i&&delete this._extendedAttrs[S]}}return this.length=i,4*t*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const i=new Uint32Array(this._data.length);return i.set(this._data),this._data=i,1}return 0}fill(i,a=!1){if(a)for(let t=0;t<this.length;++t)this.isProtected(t)||this.setCell(t,i);else{this._combined={},this._extendedAttrs={};for(let t=0;t<this.length;++t)this.setCell(t,i)}}copyFrom(i){this.length!==i.length?this._data=new Uint32Array(i._data):this._data.set(i._data),this.length=i.length,this._combined={};for(const a in i._combined)this._combined[a]=i._combined[a];this._extendedAttrs={};for(const a in i._extendedAttrs)this._extendedAttrs[a]=i._extendedAttrs[a];this.isWrapped=i.isWrapped}clone(){const i=new p(0);i._data=new Uint32Array(this._data),i.length=this.length;for(const a in this._combined)i._combined[a]=this._combined[a];for(const a in this._extendedAttrs)i._extendedAttrs[a]=this._extendedAttrs[a];return i.isWrapped=this.isWrapped,i}getTrimmedLength(){for(let i=this.length-1;i>=0;--i)if(4194303&this._data[3*i+0])return i+(this._data[3*i+0]>>22);return 0}getNoBgTrimmedLength(){for(let i=this.length-1;i>=0;--i)if(4194303&this._data[3*i+0]||50331648&this._data[3*i+2])return i+(this._data[3*i+0]>>22);return 0}copyCellsFrom(i,a,t,s,u){const m=i._data;if(u)for(let C=s-1;C>=0;C--){for(let v=0;v<3;v++)this._data[3*(t+C)+v]=m[3*(a+C)+v];268435456&m[3*(a+C)+2]&&(this._extendedAttrs[t+C]=i._extendedAttrs[a+C])}else for(let C=0;C<s;C++){for(let v=0;v<3;v++)this._data[3*(t+C)+v]=m[3*(a+C)+v];268435456&m[3*(a+C)+2]&&(this._extendedAttrs[t+C]=i._extendedAttrs[a+C])}const S=Object.keys(i._combined);for(let C=0;C<S.length;C++){const v=parseInt(S[C],10);v>=a&&(this._combined[v-a+t]=i._combined[v])}}translateToString(i,a,t,s){a=a??0,t=t??this.length,i&&(t=Math.min(t,this.getTrimmedLength())),s&&(s.length=0);let u="";for(;a<t;){const m=this._data[3*a+0],S=2097151&m,C=2097152&m?this._combined[a]:S?(0,d.stringFromCodePoint)(S):l.WHITESPACE_CELL_CHAR;if(u+=C,s)for(let v=0;v<C.length;++v)s.push(a);a+=m>>22||1}return s&&s.push(a),u}}e.BufferLine=p},4841:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getRangeLength=void 0,e.getRangeLength=function(o,h){if(o.start.y>o.end.y)throw new Error(`Buffer range end (${o.end.x}, ${o.end.y}) cannot be before start (${o.start.x}, ${o.start.y})`);return h*(o.end.y-o.start.y)+(o.end.x-o.start.x+1)}},4634:(y,e)=>{function o(h,_,l){if(_===h.length-1)return h[_].getTrimmedLength();const d=!h[_].hasContent(l-1)&&h[_].getWidth(l-1)===1,g=h[_+1].getWidth(0)===2;return d&&g?l-1:l}Object.defineProperty(e,"__esModule",{value:!0}),e.getWrappedLineTrimmedLength=e.reflowSmallerGetNewLineLengths=e.reflowLargerApplyNewLayout=e.reflowLargerCreateNewLayout=e.reflowLargerGetLinesToRemove=void 0,e.reflowLargerGetLinesToRemove=function(h,_,l,d,g){const p=[];for(let f=0;f<h.length-1;f++){let i=f,a=h.get(++i);if(!a.isWrapped)continue;const t=[h.get(f)];for(;i<h.length&&a.isWrapped;)t.push(a),a=h.get(++i);if(d>=f&&d<i){f+=t.length-1;continue}let s=0,u=o(t,s,_),m=1,S=0;for(;m<t.length;){const v=o(t,m,_),k=v-S,T=l-u,B=Math.min(k,T);t[s].copyCellsFrom(t[m],S,u,B,!1),u+=B,u===l&&(s++,u=0),S+=B,S===v&&(m++,S=0),u===0&&s!==0&&t[s-1].getWidth(l-1)===2&&(t[s].copyCellsFrom(t[s-1],l-1,u++,1,!1),t[s-1].setCell(l-1,g))}t[s].replaceCells(u,l,g);let C=0;for(let v=t.length-1;v>0&&(v>s||t[v].getTrimmedLength()===0);v--)C++;C>0&&(p.push(f+t.length-C),p.push(C)),f+=t.length-1}return p},e.reflowLargerCreateNewLayout=function(h,_){const l=[];let d=0,g=_[d],p=0;for(let f=0;f<h.length;f++)if(g===f){const i=_[++d];h.onDeleteEmitter.fire({index:f-p,amount:i}),f+=i-1,p+=i,g=_[++d]}else l.push(f);return{layout:l,countRemoved:p}},e.reflowLargerApplyNewLayout=function(h,_){const l=[];for(let d=0;d<_.length;d++)l.push(h.get(_[d]));for(let d=0;d<l.length;d++)h.set(d,l[d]);h.length=_.length},e.reflowSmallerGetNewLineLengths=function(h,_,l){const d=[],g=h.map((a,t)=>o(h,t,_)).reduce((a,t)=>a+t);let p=0,f=0,i=0;for(;i<g;){if(g-i<l){d.push(g-i);break}p+=l;const a=o(h,f,_);p>a&&(p-=a,f++);const t=h[f].getWidth(p-1)===2;t&&p--;const s=t?l-1:l;d.push(s),i+=s}return d},e.getWrappedLineTrimmedLength=o},5295:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferSet=void 0;const h=o(8460),_=o(844),l=o(9092);class d extends _.Disposable{constructor(p,f){super(),this._optionsService=p,this._bufferService=f,this._onBufferActivate=this.register(new h.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new l.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new l.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(p){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(p),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(p,f){this._normal.resize(p,f),this._alt.resize(p,f),this.setupTabStops(p)}setupTabStops(p){this._normal.setupTabStops(p),this._alt.setupTabStops(p)}}e.BufferSet=d},511:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CellData=void 0;const h=o(482),_=o(643),l=o(3734);class d extends l.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new l.ExtendedAttrs,this.combinedData=""}static fromCharData(p){const f=new d;return f.setFromCharData(p),f}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,h.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(p){this.fg=p[_.CHAR_DATA_ATTR_INDEX],this.bg=0;let f=!1;if(p[_.CHAR_DATA_CHAR_INDEX].length>2)f=!0;else if(p[_.CHAR_DATA_CHAR_INDEX].length===2){const i=p[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){const a=p[_.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=a&&a<=57343?this.content=1024*(i-55296)+a-56320+65536|p[_.CHAR_DATA_WIDTH_INDEX]<<22:f=!0}else f=!0}else this.content=p[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|p[_.CHAR_DATA_WIDTH_INDEX]<<22;f&&(this.combinedData=p[_.CHAR_DATA_CHAR_INDEX],this.content=2097152|p[_.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}e.CellData=d},643:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WHITESPACE_CELL_CODE=e.WHITESPACE_CELL_WIDTH=e.WHITESPACE_CELL_CHAR=e.NULL_CELL_CODE=e.NULL_CELL_WIDTH=e.NULL_CELL_CHAR=e.CHAR_DATA_CODE_INDEX=e.CHAR_DATA_WIDTH_INDEX=e.CHAR_DATA_CHAR_INDEX=e.CHAR_DATA_ATTR_INDEX=e.DEFAULT_EXT=e.DEFAULT_ATTR=e.DEFAULT_COLOR=void 0,e.DEFAULT_COLOR=0,e.DEFAULT_ATTR=256|e.DEFAULT_COLOR<<9,e.DEFAULT_EXT=0,e.CHAR_DATA_ATTR_INDEX=0,e.CHAR_DATA_CHAR_INDEX=1,e.CHAR_DATA_WIDTH_INDEX=2,e.CHAR_DATA_CODE_INDEX=3,e.NULL_CELL_CHAR="",e.NULL_CELL_WIDTH=1,e.NULL_CELL_CODE=0,e.WHITESPACE_CELL_CHAR=" ",e.WHITESPACE_CELL_WIDTH=1,e.WHITESPACE_CELL_CODE=32},4863:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Marker=void 0;const h=o(8460),_=o(844);class l{get id(){return this._id}constructor(g){this.line=g,this.isDisposed=!1,this._disposables=[],this._id=l._nextId++,this._onDispose=this.register(new h.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,_.disposeArray)(this._disposables),this._disposables.length=0)}register(g){return this._disposables.push(g),g}}e.Marker=l,l._nextId=1},7116:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_CHARSET=e.CHARSETS=void 0,e.CHARSETS={},e.DEFAULT_CHARSET=e.CHARSETS.B,e.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},e.CHARSETS.A={"#":"£"},e.CHARSETS.B=void 0,e.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},e.CHARSETS.C=e.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},e.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},e.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},e.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},e.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},e.CHARSETS.E=e.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},e.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},e.CHARSETS.H=e.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},e.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(y,e)=>{var o,h,_;Object.defineProperty(e,"__esModule",{value:!0}),e.C1_ESCAPED=e.C1=e.C0=void 0,function(l){l.NUL="\0",l.SOH="",l.STX="",l.ETX="",l.EOT="",l.ENQ="",l.ACK="",l.BEL="\x07",l.BS="\b",l.HT="	",l.LF=`
`,l.VT="\v",l.FF="\f",l.CR="\r",l.SO="",l.SI="",l.DLE="",l.DC1="",l.DC2="",l.DC3="",l.DC4="",l.NAK="",l.SYN="",l.ETB="",l.CAN="",l.EM="",l.SUB="",l.ESC="\x1B",l.FS="",l.GS="",l.RS="",l.US="",l.SP=" ",l.DEL=""}(o||(e.C0=o={})),function(l){l.PAD="",l.HOP="",l.BPH="",l.NBH="",l.IND="",l.NEL="",l.SSA="",l.ESA="",l.HTS="",l.HTJ="",l.VTS="",l.PLD="",l.PLU="",l.RI="",l.SS2="",l.SS3="",l.DCS="",l.PU1="",l.PU2="",l.STS="",l.CCH="",l.MW="",l.SPA="",l.EPA="",l.SOS="",l.SGCI="",l.SCI="",l.CSI="",l.ST="",l.OSC="",l.PM="",l.APC=""}(h||(e.C1=h={})),function(l){l.ST=`${o.ESC}\\`}(_||(e.C1_ESCAPED=_={}))},7399:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.evaluateKeyboardEvent=void 0;const h=o(2584),_={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};e.evaluateKeyboardEvent=function(l,d,g,p){const f={type:0,cancel:!1,key:void 0},i=(l.shiftKey?1:0)|(l.altKey?2:0)|(l.ctrlKey?4:0)|(l.metaKey?8:0);switch(l.keyCode){case 0:l.key==="UIKeyInputUpArrow"?f.key=d?h.C0.ESC+"OA":h.C0.ESC+"[A":l.key==="UIKeyInputLeftArrow"?f.key=d?h.C0.ESC+"OD":h.C0.ESC+"[D":l.key==="UIKeyInputRightArrow"?f.key=d?h.C0.ESC+"OC":h.C0.ESC+"[C":l.key==="UIKeyInputDownArrow"&&(f.key=d?h.C0.ESC+"OB":h.C0.ESC+"[B");break;case 8:f.key=l.ctrlKey?"\b":h.C0.DEL,l.altKey&&(f.key=h.C0.ESC+f.key);break;case 9:if(l.shiftKey){f.key=h.C0.ESC+"[Z";break}f.key=h.C0.HT,f.cancel=!0;break;case 13:f.key=l.altKey?h.C0.ESC+h.C0.CR:h.C0.CR,f.cancel=!0;break;case 27:f.key=h.C0.ESC,l.altKey&&(f.key=h.C0.ESC+h.C0.ESC),f.cancel=!0;break;case 37:if(l.metaKey)break;i?(f.key=h.C0.ESC+"[1;"+(i+1)+"D",f.key===h.C0.ESC+"[1;3D"&&(f.key=h.C0.ESC+(g?"b":"[1;5D"))):f.key=d?h.C0.ESC+"OD":h.C0.ESC+"[D";break;case 39:if(l.metaKey)break;i?(f.key=h.C0.ESC+"[1;"+(i+1)+"C",f.key===h.C0.ESC+"[1;3C"&&(f.key=h.C0.ESC+(g?"f":"[1;5C"))):f.key=d?h.C0.ESC+"OC":h.C0.ESC+"[C";break;case 38:if(l.metaKey)break;i?(f.key=h.C0.ESC+"[1;"+(i+1)+"A",g||f.key!==h.C0.ESC+"[1;3A"||(f.key=h.C0.ESC+"[1;5A")):f.key=d?h.C0.ESC+"OA":h.C0.ESC+"[A";break;case 40:if(l.metaKey)break;i?(f.key=h.C0.ESC+"[1;"+(i+1)+"B",g||f.key!==h.C0.ESC+"[1;3B"||(f.key=h.C0.ESC+"[1;5B")):f.key=d?h.C0.ESC+"OB":h.C0.ESC+"[B";break;case 45:l.shiftKey||l.ctrlKey||(f.key=h.C0.ESC+"[2~");break;case 46:f.key=i?h.C0.ESC+"[3;"+(i+1)+"~":h.C0.ESC+"[3~";break;case 36:f.key=i?h.C0.ESC+"[1;"+(i+1)+"H":d?h.C0.ESC+"OH":h.C0.ESC+"[H";break;case 35:f.key=i?h.C0.ESC+"[1;"+(i+1)+"F":d?h.C0.ESC+"OF":h.C0.ESC+"[F";break;case 33:l.shiftKey?f.type=2:l.ctrlKey?f.key=h.C0.ESC+"[5;"+(i+1)+"~":f.key=h.C0.ESC+"[5~";break;case 34:l.shiftKey?f.type=3:l.ctrlKey?f.key=h.C0.ESC+"[6;"+(i+1)+"~":f.key=h.C0.ESC+"[6~";break;case 112:f.key=i?h.C0.ESC+"[1;"+(i+1)+"P":h.C0.ESC+"OP";break;case 113:f.key=i?h.C0.ESC+"[1;"+(i+1)+"Q":h.C0.ESC+"OQ";break;case 114:f.key=i?h.C0.ESC+"[1;"+(i+1)+"R":h.C0.ESC+"OR";break;case 115:f.key=i?h.C0.ESC+"[1;"+(i+1)+"S":h.C0.ESC+"OS";break;case 116:f.key=i?h.C0.ESC+"[15;"+(i+1)+"~":h.C0.ESC+"[15~";break;case 117:f.key=i?h.C0.ESC+"[17;"+(i+1)+"~":h.C0.ESC+"[17~";break;case 118:f.key=i?h.C0.ESC+"[18;"+(i+1)+"~":h.C0.ESC+"[18~";break;case 119:f.key=i?h.C0.ESC+"[19;"+(i+1)+"~":h.C0.ESC+"[19~";break;case 120:f.key=i?h.C0.ESC+"[20;"+(i+1)+"~":h.C0.ESC+"[20~";break;case 121:f.key=i?h.C0.ESC+"[21;"+(i+1)+"~":h.C0.ESC+"[21~";break;case 122:f.key=i?h.C0.ESC+"[23;"+(i+1)+"~":h.C0.ESC+"[23~";break;case 123:f.key=i?h.C0.ESC+"[24;"+(i+1)+"~":h.C0.ESC+"[24~";break;default:if(!l.ctrlKey||l.shiftKey||l.altKey||l.metaKey)if(g&&!p||!l.altKey||l.metaKey)!g||l.altKey||l.ctrlKey||l.shiftKey||!l.metaKey?l.key&&!l.ctrlKey&&!l.altKey&&!l.metaKey&&l.keyCode>=48&&l.key.length===1?f.key=l.key:l.key&&l.ctrlKey&&(l.key==="_"&&(f.key=h.C0.US),l.key==="@"&&(f.key=h.C0.NUL)):l.keyCode===65&&(f.type=1);else{const a=_[l.keyCode],t=a==null?void 0:a[l.shiftKey?1:0];if(t)f.key=h.C0.ESC+t;else if(l.keyCode>=65&&l.keyCode<=90){const s=l.ctrlKey?l.keyCode-64:l.keyCode+32;let u=String.fromCharCode(s);l.shiftKey&&(u=u.toUpperCase()),f.key=h.C0.ESC+u}else if(l.keyCode===32)f.key=h.C0.ESC+(l.ctrlKey?h.C0.NUL:" ");else if(l.key==="Dead"&&l.code.startsWith("Key")){let s=l.code.slice(3,4);l.shiftKey||(s=s.toLowerCase()),f.key=h.C0.ESC+s,f.cancel=!0}}else l.keyCode>=65&&l.keyCode<=90?f.key=String.fromCharCode(l.keyCode-64):l.keyCode===32?f.key=h.C0.NUL:l.keyCode>=51&&l.keyCode<=55?f.key=String.fromCharCode(l.keyCode-51+27):l.keyCode===56?f.key=h.C0.DEL:l.keyCode===219?f.key=h.C0.ESC:l.keyCode===220?f.key=h.C0.FS:l.keyCode===221&&(f.key=h.C0.GS)}return f}},482:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Utf8ToUtf32=e.StringToUtf32=e.utf32ToString=e.stringFromCodePoint=void 0,e.stringFromCodePoint=function(o){return o>65535?(o-=65536,String.fromCharCode(55296+(o>>10))+String.fromCharCode(o%1024+56320)):String.fromCharCode(o)},e.utf32ToString=function(o,h=0,_=o.length){let l="";for(let d=h;d<_;++d){let g=o[d];g>65535?(g-=65536,l+=String.fromCharCode(55296+(g>>10))+String.fromCharCode(g%1024+56320)):l+=String.fromCharCode(g)}return l},e.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(o,h){const _=o.length;if(!_)return 0;let l=0,d=0;if(this._interim){const g=o.charCodeAt(d++);56320<=g&&g<=57343?h[l++]=1024*(this._interim-55296)+g-56320+65536:(h[l++]=this._interim,h[l++]=g),this._interim=0}for(let g=d;g<_;++g){const p=o.charCodeAt(g);if(55296<=p&&p<=56319){if(++g>=_)return this._interim=p,l;const f=o.charCodeAt(g);56320<=f&&f<=57343?h[l++]=1024*(p-55296)+f-56320+65536:(h[l++]=p,h[l++]=f)}else p!==65279&&(h[l++]=p)}return l}},e.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(o,h){const _=o.length;if(!_)return 0;let l,d,g,p,f=0,i=0,a=0;if(this.interim[0]){let u=!1,m=this.interim[0];m&=(224&m)==192?31:(240&m)==224?15:7;let S,C=0;for(;(S=63&this.interim[++C])&&C<4;)m<<=6,m|=S;const v=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,k=v-C;for(;a<k;){if(a>=_)return 0;if(S=o[a++],(192&S)!=128){a--,u=!0;break}this.interim[C++]=S,m<<=6,m|=63&S}u||(v===2?m<128?a--:h[f++]=m:v===3?m<2048||m>=55296&&m<=57343||m===65279||(h[f++]=m):m<65536||m>1114111||(h[f++]=m)),this.interim.fill(0)}const t=_-4;let s=a;for(;s<_;){for(;!(!(s<t)||128&(l=o[s])||128&(d=o[s+1])||128&(g=o[s+2])||128&(p=o[s+3]));)h[f++]=l,h[f++]=d,h[f++]=g,h[f++]=p,s+=4;if(l=o[s++],l<128)h[f++]=l;else if((224&l)==192){if(s>=_)return this.interim[0]=l,f;if(d=o[s++],(192&d)!=128){s--;continue}if(i=(31&l)<<6|63&d,i<128){s--;continue}h[f++]=i}else if((240&l)==224){if(s>=_)return this.interim[0]=l,f;if(d=o[s++],(192&d)!=128){s--;continue}if(s>=_)return this.interim[0]=l,this.interim[1]=d,f;if(g=o[s++],(192&g)!=128){s--;continue}if(i=(15&l)<<12|(63&d)<<6|63&g,i<2048||i>=55296&&i<=57343||i===65279)continue;h[f++]=i}else if((248&l)==240){if(s>=_)return this.interim[0]=l,f;if(d=o[s++],(192&d)!=128){s--;continue}if(s>=_)return this.interim[0]=l,this.interim[1]=d,f;if(g=o[s++],(192&g)!=128){s--;continue}if(s>=_)return this.interim[0]=l,this.interim[1]=d,this.interim[2]=g,f;if(p=o[s++],(192&p)!=128){s--;continue}if(i=(7&l)<<18|(63&d)<<12|(63&g)<<6|63&p,i<65536||i>1114111)continue;h[f++]=i}}return f}}},225:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeV6=void 0;const h=o(1480),_=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],l=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let d;e.UnicodeV6=class{constructor(){if(this.version="6",!d){d=new Uint8Array(65536),d.fill(1),d[0]=0,d.fill(0,1,32),d.fill(0,127,160),d.fill(2,4352,4448),d[9001]=2,d[9002]=2,d.fill(2,11904,42192),d[12351]=1,d.fill(2,44032,55204),d.fill(2,63744,64256),d.fill(2,65040,65050),d.fill(2,65072,65136),d.fill(2,65280,65377),d.fill(2,65504,65511);for(let g=0;g<_.length;++g)d.fill(0,_[g][0],_[g][1]+1)}}wcwidth(g){return g<32?0:g<127?1:g<65536?d[g]:function(p,f){let i,a=0,t=f.length-1;if(p<f[0][0]||p>f[t][1])return!1;for(;t>=a;)if(i=a+t>>1,p>f[i][1])a=i+1;else{if(!(p<f[i][0]))return!0;t=i-1}return!1}(g,l)?0:g>=131072&&g<=196605||g>=196608&&g<=262141?2:1}charProperties(g,p){let f=this.wcwidth(g),i=f===0&&p!==0;if(i){const a=h.UnicodeService.extractWidth(p);a===0?i=!1:a>f&&(f=a)}return h.UnicodeService.createPropertyValue(0,f,i)}}},5981:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WriteBuffer=void 0;const h=o(8460),_=o(844);class l extends _.Disposable{constructor(g){super(),this._action=g,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new h.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(g,p){if(p!==void 0&&this._syncCalls>p)return void(this._syncCalls=0);if(this._pendingData+=g.length,this._writeBuffer.push(g),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let f;for(this._isSyncWriting=!0;f=this._writeBuffer.shift();){this._action(f);const i=this._callbacks.shift();i&&i()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(g,p){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=g.length,this._writeBuffer.push(g),this._callbacks.push(p),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=g.length,this._writeBuffer.push(g),this._callbacks.push(p)}_innerWrite(g=0,p=!0){const f=g||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const i=this._writeBuffer[this._bufferOffset],a=this._action(i,p);if(a){const s=u=>Date.now()-f>=12?setTimeout(()=>this._innerWrite(0,u)):this._innerWrite(f,u);return void a.catch(u=>(queueMicrotask(()=>{throw u}),Promise.resolve(!1))).then(s)}const t=this._callbacks[this._bufferOffset];if(t&&t(),this._bufferOffset++,this._pendingData-=i.length,Date.now()-f>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}e.WriteBuffer=l},5941:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.toRgbString=e.parseColor=void 0;const o=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,h=/^[\da-f]+$/;function _(l,d){const g=l.toString(16),p=g.length<2?"0"+g:g;switch(d){case 4:return g[0];case 8:return p;case 12:return(p+p).slice(0,3);default:return p+p}}e.parseColor=function(l){if(!l)return;let d=l.toLowerCase();if(d.indexOf("rgb:")===0){d=d.slice(4);const g=o.exec(d);if(g){const p=g[1]?15:g[4]?255:g[7]?4095:65535;return[Math.round(parseInt(g[1]||g[4]||g[7]||g[10],16)/p*255),Math.round(parseInt(g[2]||g[5]||g[8]||g[11],16)/p*255),Math.round(parseInt(g[3]||g[6]||g[9]||g[12],16)/p*255)]}}else if(d.indexOf("#")===0&&(d=d.slice(1),h.exec(d)&&[3,6,9,12].includes(d.length))){const g=d.length/3,p=[0,0,0];for(let f=0;f<3;++f){const i=parseInt(d.slice(g*f,g*f+g),16);p[f]=g===1?i<<4:g===2?i:g===3?i>>4:i>>8}return p}},e.toRgbString=function(l,d=16){const[g,p,f]=l;return`rgb:${_(g,d)}/${_(p,d)}/${_(f,d)}`}},5770:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PAYLOAD_LIMIT=void 0,e.PAYLOAD_LIMIT=1e7},6351:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DcsHandler=e.DcsParser=void 0;const h=o(482),_=o(8742),l=o(5770),d=[];e.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=d,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=d}registerHandler(p,f){this._handlers[p]===void 0&&(this._handlers[p]=[]);const i=this._handlers[p];return i.push(f),{dispose:()=>{const a=i.indexOf(f);a!==-1&&i.splice(a,1)}}}clearHandler(p){this._handlers[p]&&delete this._handlers[p]}setHandlerFallback(p){this._handlerFb=p}reset(){if(this._active.length)for(let p=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;p>=0;--p)this._active[p].unhook(!1);this._stack.paused=!1,this._active=d,this._ident=0}hook(p,f){if(this.reset(),this._ident=p,this._active=this._handlers[p]||d,this._active.length)for(let i=this._active.length-1;i>=0;i--)this._active[i].hook(f);else this._handlerFb(this._ident,"HOOK",f)}put(p,f,i){if(this._active.length)for(let a=this._active.length-1;a>=0;a--)this._active[a].put(p,f,i);else this._handlerFb(this._ident,"PUT",(0,h.utf32ToString)(p,f,i))}unhook(p,f=!0){if(this._active.length){let i=!1,a=this._active.length-1,t=!1;if(this._stack.paused&&(a=this._stack.loopPosition-1,i=f,t=this._stack.fallThrough,this._stack.paused=!1),!t&&i===!1){for(;a>=0&&(i=this._active[a].unhook(p),i!==!0);a--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!1,i;a--}for(;a>=0;a--)if(i=this._active[a].unhook(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!0,i}else this._handlerFb(this._ident,"UNHOOK",p);this._active=d,this._ident=0}};const g=new _.Params;g.addParam(0),e.DcsHandler=class{constructor(p){this._handler=p,this._data="",this._params=g,this._hitLimit=!1}hook(p){this._params=p.length>1||p.params[0]?p.clone():g,this._data="",this._hitLimit=!1}put(p,f,i){this._hitLimit||(this._data+=(0,h.utf32ToString)(p,f,i),this._data.length>l.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(p){let f=!1;if(this._hitLimit)f=!1;else if(p&&(f=this._handler(this._data,this._params),f instanceof Promise))return f.then(i=>(this._params=g,this._data="",this._hitLimit=!1,i));return this._params=g,this._data="",this._hitLimit=!1,f}}},2015:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EscapeSequenceParser=e.VT500_TRANSITION_TABLE=e.TransitionTable=void 0;const h=o(844),_=o(8742),l=o(6242),d=o(6351);class g{constructor(a){this.table=new Uint8Array(a)}setDefault(a,t){this.table.fill(a<<4|t)}add(a,t,s,u){this.table[t<<8|a]=s<<4|u}addMany(a,t,s,u){for(let m=0;m<a.length;m++)this.table[t<<8|a[m]]=s<<4|u}}e.TransitionTable=g;const p=160;e.VT500_TRANSITION_TABLE=function(){const i=new g(4095),a=Array.apply(null,Array(256)).map((C,v)=>v),t=(C,v)=>a.slice(C,v),s=t(32,127),u=t(0,24);u.push(25),u.push.apply(u,t(28,32));const m=t(0,14);let S;for(S in i.setDefault(1,0),i.addMany(s,0,2,0),m)i.addMany([24,26,153,154],S,3,0),i.addMany(t(128,144),S,3,0),i.addMany(t(144,152),S,3,0),i.add(156,S,0,0),i.add(27,S,11,1),i.add(157,S,4,8),i.addMany([152,158,159],S,0,7),i.add(155,S,11,3),i.add(144,S,11,9);return i.addMany(u,0,3,0),i.addMany(u,1,3,1),i.add(127,1,0,1),i.addMany(u,8,0,8),i.addMany(u,3,3,3),i.add(127,3,0,3),i.addMany(u,4,3,4),i.add(127,4,0,4),i.addMany(u,6,3,6),i.addMany(u,5,3,5),i.add(127,5,0,5),i.addMany(u,2,3,2),i.add(127,2,0,2),i.add(93,1,4,8),i.addMany(s,8,5,8),i.add(127,8,5,8),i.addMany([156,27,24,26,7],8,6,0),i.addMany(t(28,32),8,0,8),i.addMany([88,94,95],1,0,7),i.addMany(s,7,0,7),i.addMany(u,7,0,7),i.add(156,7,0,0),i.add(127,7,0,7),i.add(91,1,11,3),i.addMany(t(64,127),3,7,0),i.addMany(t(48,60),3,8,4),i.addMany([60,61,62,63],3,9,4),i.addMany(t(48,60),4,8,4),i.addMany(t(64,127),4,7,0),i.addMany([60,61,62,63],4,0,6),i.addMany(t(32,64),6,0,6),i.add(127,6,0,6),i.addMany(t(64,127),6,0,0),i.addMany(t(32,48),3,9,5),i.addMany(t(32,48),5,9,5),i.addMany(t(48,64),5,0,6),i.addMany(t(64,127),5,7,0),i.addMany(t(32,48),4,9,5),i.addMany(t(32,48),1,9,2),i.addMany(t(32,48),2,9,2),i.addMany(t(48,127),2,10,0),i.addMany(t(48,80),1,10,0),i.addMany(t(81,88),1,10,0),i.addMany([89,90,92],1,10,0),i.addMany(t(96,127),1,10,0),i.add(80,1,11,9),i.addMany(u,9,0,9),i.add(127,9,0,9),i.addMany(t(28,32),9,0,9),i.addMany(t(32,48),9,9,12),i.addMany(t(48,60),9,8,10),i.addMany([60,61,62,63],9,9,10),i.addMany(u,11,0,11),i.addMany(t(32,128),11,0,11),i.addMany(t(28,32),11,0,11),i.addMany(u,10,0,10),i.add(127,10,0,10),i.addMany(t(28,32),10,0,10),i.addMany(t(48,60),10,8,10),i.addMany([60,61,62,63],10,0,11),i.addMany(t(32,48),10,9,12),i.addMany(u,12,0,12),i.add(127,12,0,12),i.addMany(t(28,32),12,0,12),i.addMany(t(32,48),12,9,12),i.addMany(t(48,64),12,0,11),i.addMany(t(64,127),12,12,13),i.addMany(t(64,127),10,12,13),i.addMany(t(64,127),9,12,13),i.addMany(u,13,13,13),i.addMany(s,13,13,13),i.add(127,13,0,13),i.addMany([27,156,24,26],13,14,0),i.add(p,0,2,0),i.add(p,8,5,8),i.add(p,6,0,6),i.add(p,11,0,11),i.add(p,13,13,13),i}();class f extends h.Disposable{constructor(a=e.VT500_TRANSITION_TABLE){super(),this._transitions=a,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new _.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(t,s,u)=>{},this._executeHandlerFb=t=>{},this._csiHandlerFb=(t,s)=>{},this._escHandlerFb=t=>{},this._errorHandlerFb=t=>t,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,h.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new l.OscParser),this._dcsParser=this.register(new d.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(a,t=[64,126]){let s=0;if(a.prefix){if(a.prefix.length>1)throw new Error("only one byte as prefix supported");if(s=a.prefix.charCodeAt(0),s&&60>s||s>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(a.intermediates){if(a.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let m=0;m<a.intermediates.length;++m){const S=a.intermediates.charCodeAt(m);if(32>S||S>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");s<<=8,s|=S}}if(a.final.length!==1)throw new Error("final must be a single byte");const u=a.final.charCodeAt(0);if(t[0]>u||u>t[1])throw new Error(`final must be in range ${t[0]} .. ${t[1]}`);return s<<=8,s|=u,s}identToString(a){const t=[];for(;a;)t.push(String.fromCharCode(255&a)),a>>=8;return t.reverse().join("")}setPrintHandler(a){this._printHandler=a}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(a,t){const s=this._identifier(a,[48,126]);this._escHandlers[s]===void 0&&(this._escHandlers[s]=[]);const u=this._escHandlers[s];return u.push(t),{dispose:()=>{const m=u.indexOf(t);m!==-1&&u.splice(m,1)}}}clearEscHandler(a){this._escHandlers[this._identifier(a,[48,126])]&&delete this._escHandlers[this._identifier(a,[48,126])]}setEscHandlerFallback(a){this._escHandlerFb=a}setExecuteHandler(a,t){this._executeHandlers[a.charCodeAt(0)]=t}clearExecuteHandler(a){this._executeHandlers[a.charCodeAt(0)]&&delete this._executeHandlers[a.charCodeAt(0)]}setExecuteHandlerFallback(a){this._executeHandlerFb=a}registerCsiHandler(a,t){const s=this._identifier(a);this._csiHandlers[s]===void 0&&(this._csiHandlers[s]=[]);const u=this._csiHandlers[s];return u.push(t),{dispose:()=>{const m=u.indexOf(t);m!==-1&&u.splice(m,1)}}}clearCsiHandler(a){this._csiHandlers[this._identifier(a)]&&delete this._csiHandlers[this._identifier(a)]}setCsiHandlerFallback(a){this._csiHandlerFb=a}registerDcsHandler(a,t){return this._dcsParser.registerHandler(this._identifier(a),t)}clearDcsHandler(a){this._dcsParser.clearHandler(this._identifier(a))}setDcsHandlerFallback(a){this._dcsParser.setHandlerFallback(a)}registerOscHandler(a,t){return this._oscParser.registerHandler(a,t)}clearOscHandler(a){this._oscParser.clearHandler(a)}setOscHandlerFallback(a){this._oscParser.setHandlerFallback(a)}setErrorHandler(a){this._errorHandler=a}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(a,t,s,u,m){this._parseStack.state=a,this._parseStack.handlers=t,this._parseStack.handlerPos=s,this._parseStack.transition=u,this._parseStack.chunkPos=m}parse(a,t,s){let u,m=0,S=0,C=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,C=this._parseStack.chunkPos+1;else{if(s===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const v=this._parseStack.handlers;let k=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(s===!1&&k>-1){for(;k>=0&&(u=v[k](this._params),u!==!0);k--)if(u instanceof Promise)return this._parseStack.handlerPos=k,u}this._parseStack.handlers=[];break;case 4:if(s===!1&&k>-1){for(;k>=0&&(u=v[k](),u!==!0);k--)if(u instanceof Promise)return this._parseStack.handlerPos=k,u}this._parseStack.handlers=[];break;case 6:if(m=a[this._parseStack.chunkPos],u=this._dcsParser.unhook(m!==24&&m!==26,s),u)return u;m===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(m=a[this._parseStack.chunkPos],u=this._oscParser.end(m!==24&&m!==26,s),u)return u;m===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,C=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let v=C;v<t;++v){switch(m=a[v],S=this._transitions.table[this.currentState<<8|(m<160?m:p)],S>>4){case 2:for(let M=v+1;;++M){if(M>=t||(m=a[M])<32||m>126&&m<p){this._printHandler(a,v,M),v=M-1;break}if(++M>=t||(m=a[M])<32||m>126&&m<p){this._printHandler(a,v,M),v=M-1;break}if(++M>=t||(m=a[M])<32||m>126&&m<p){this._printHandler(a,v,M),v=M-1;break}if(++M>=t||(m=a[M])<32||m>126&&m<p){this._printHandler(a,v,M),v=M-1;break}}break;case 3:this._executeHandlers[m]?this._executeHandlers[m]():this._executeHandlerFb(m),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:v,code:m,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const k=this._csiHandlers[this._collect<<8|m];let T=k?k.length-1:-1;for(;T>=0&&(u=k[T](this._params),u!==!0);T--)if(u instanceof Promise)return this._preserveStack(3,k,T,S,v),u;T<0&&this._csiHandlerFb(this._collect<<8|m,this._params),this.precedingJoinState=0;break;case 8:do switch(m){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(m-48)}while(++v<t&&(m=a[v])>47&&m<60);v--;break;case 9:this._collect<<=8,this._collect|=m;break;case 10:const B=this._escHandlers[this._collect<<8|m];let A=B?B.length-1:-1;for(;A>=0&&(u=B[A](),u!==!0);A--)if(u instanceof Promise)return this._preserveStack(4,B,A,S,v),u;A<0&&this._escHandlerFb(this._collect<<8|m),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|m,this._params);break;case 13:for(let M=v+1;;++M)if(M>=t||(m=a[M])===24||m===26||m===27||m>127&&m<p){this._dcsParser.put(a,v,M),v=M-1;break}break;case 14:if(u=this._dcsParser.unhook(m!==24&&m!==26),u)return this._preserveStack(6,[],0,S,v),u;m===27&&(S|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let M=v+1;;M++)if(M>=t||(m=a[M])<32||m>127&&m<p){this._oscParser.put(a,v,M),v=M-1;break}break;case 6:if(u=this._oscParser.end(m!==24&&m!==26),u)return this._preserveStack(5,[],0,S,v),u;m===27&&(S|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&S}}}e.EscapeSequenceParser=f},6242:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OscHandler=e.OscParser=void 0;const h=o(5770),_=o(482),l=[];e.OscParser=class{constructor(){this._state=0,this._active=l,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(d,g){this._handlers[d]===void 0&&(this._handlers[d]=[]);const p=this._handlers[d];return p.push(g),{dispose:()=>{const f=p.indexOf(g);f!==-1&&p.splice(f,1)}}}clearHandler(d){this._handlers[d]&&delete this._handlers[d]}setHandlerFallback(d){this._handlerFb=d}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=l}reset(){if(this._state===2)for(let d=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;d>=0;--d)this._active[d].end(!1);this._stack.paused=!1,this._active=l,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||l,this._active.length)for(let d=this._active.length-1;d>=0;d--)this._active[d].start();else this._handlerFb(this._id,"START")}_put(d,g,p){if(this._active.length)for(let f=this._active.length-1;f>=0;f--)this._active[f].put(d,g,p);else this._handlerFb(this._id,"PUT",(0,_.utf32ToString)(d,g,p))}start(){this.reset(),this._state=1}put(d,g,p){if(this._state!==3){if(this._state===1)for(;g<p;){const f=d[g++];if(f===59){this._state=2,this._start();break}if(f<48||57<f)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+f-48}this._state===2&&p-g>0&&this._put(d,g,p)}}end(d,g=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let p=!1,f=this._active.length-1,i=!1;if(this._stack.paused&&(f=this._stack.loopPosition-1,p=g,i=this._stack.fallThrough,this._stack.paused=!1),!i&&p===!1){for(;f>=0&&(p=this._active[f].end(d),p!==!0);f--)if(p instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!1,p;f--}for(;f>=0;f--)if(p=this._active[f].end(!1),p instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!0,p}else this._handlerFb(this._id,"END",d);this._active=l,this._id=-1,this._state=0}}},e.OscHandler=class{constructor(d){this._handler=d,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(d,g,p){this._hitLimit||(this._data+=(0,_.utf32ToString)(d,g,p),this._data.length>h.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(d){let g=!1;if(this._hitLimit)g=!1;else if(d&&(g=this._handler(this._data),g instanceof Promise))return g.then(p=>(this._data="",this._hitLimit=!1,p));return this._data="",this._hitLimit=!1,g}}},8742:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Params=void 0;const o=2147483647;class h{static fromArray(l){const d=new h;if(!l.length)return d;for(let g=Array.isArray(l[0])?1:0;g<l.length;++g){const p=l[g];if(Array.isArray(p))for(let f=0;f<p.length;++f)d.addSubParam(p[f]);else d.addParam(p)}return d}constructor(l=32,d=32){if(this.maxLength=l,this.maxSubParamsLength=d,d>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(l),this.length=0,this._subParams=new Int32Array(d),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(l),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const l=new h(this.maxLength,this.maxSubParamsLength);return l.params.set(this.params),l.length=this.length,l._subParams.set(this._subParams),l._subParamsLength=this._subParamsLength,l._subParamsIdx.set(this._subParamsIdx),l._rejectDigits=this._rejectDigits,l._rejectSubDigits=this._rejectSubDigits,l._digitIsSub=this._digitIsSub,l}toArray(){const l=[];for(let d=0;d<this.length;++d){l.push(this.params[d]);const g=this._subParamsIdx[d]>>8,p=255&this._subParamsIdx[d];p-g>0&&l.push(Array.prototype.slice.call(this._subParams,g,p))}return l}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(l){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(l<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=l>o?o:l}}addSubParam(l){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(l<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=l>o?o:l,this._subParamsIdx[this.length-1]++}}hasSubParams(l){return(255&this._subParamsIdx[l])-(this._subParamsIdx[l]>>8)>0}getSubParams(l){const d=this._subParamsIdx[l]>>8,g=255&this._subParamsIdx[l];return g-d>0?this._subParams.subarray(d,g):null}getSubParamsAll(){const l={};for(let d=0;d<this.length;++d){const g=this._subParamsIdx[d]>>8,p=255&this._subParamsIdx[d];p-g>0&&(l[d]=this._subParams.slice(g,p))}return l}addDigit(l){let d;if(this._rejectDigits||!(d=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const g=this._digitIsSub?this._subParams:this.params,p=g[d-1];g[d-1]=~p?Math.min(10*p+l,o):l}}e.Params=h},5741:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AddonManager=void 0,e.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let o=this._addons.length-1;o>=0;o--)this._addons[o].instance.dispose()}loadAddon(o,h){const _={instance:h,dispose:h.dispose,isDisposed:!1};this._addons.push(_),h.dispose=()=>this._wrappedAddonDispose(_),h.activate(o)}_wrappedAddonDispose(o){if(o.isDisposed)return;let h=-1;for(let _=0;_<this._addons.length;_++)if(this._addons[_]===o){h=_;break}if(h===-1)throw new Error("Could not dispose an addon that has not been loaded");o.isDisposed=!0,o.dispose.apply(o.instance),this._addons.splice(h,1)}}},8771:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferApiView=void 0;const h=o(3785),_=o(511);e.BufferApiView=class{constructor(l,d){this._buffer=l,this.type=d}init(l){return this._buffer=l,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(l){const d=this._buffer.lines.get(l);if(d)return new h.BufferLineApiView(d)}getNullCell(){return new _.CellData}}},3785:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferLineApiView=void 0;const h=o(511);e.BufferLineApiView=class{constructor(_){this._line=_}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(_,l){if(!(_<0||_>=this._line.length))return l?(this._line.loadCell(_,l),l):this._line.loadCell(_,new h.CellData)}translateToString(_,l,d){return this._line.translateToString(_,l,d)}}},8285:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferNamespaceApi=void 0;const h=o(8771),_=o(8460),l=o(844);class d extends l.Disposable{constructor(p){super(),this._core=p,this._onBufferChange=this.register(new _.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new h.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new h.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}e.BufferNamespaceApi=d},7975:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ParserApi=void 0,e.ParserApi=class{constructor(o){this._core=o}registerCsiHandler(o,h){return this._core.registerCsiHandler(o,_=>h(_.toArray()))}addCsiHandler(o,h){return this.registerCsiHandler(o,h)}registerDcsHandler(o,h){return this._core.registerDcsHandler(o,(_,l)=>h(_,l.toArray()))}addDcsHandler(o,h){return this.registerDcsHandler(o,h)}registerEscHandler(o,h){return this._core.registerEscHandler(o,h)}addEscHandler(o,h){return this.registerEscHandler(o,h)}registerOscHandler(o,h){return this._core.registerOscHandler(o,h)}addOscHandler(o,h){return this.registerOscHandler(o,h)}}},7090:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeApi=void 0,e.UnicodeApi=class{constructor(o){this._core=o}register(o){this._core.unicodeService.register(o)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(o){this._core.unicodeService.activeVersion=o}}},744:function(y,e,o){var h=this&&this.__decorate||function(i,a,t,s){var u,m=arguments.length,S=m<3?a:s===null?s=Object.getOwnPropertyDescriptor(a,t):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(i,a,t,s);else for(var C=i.length-1;C>=0;C--)(u=i[C])&&(S=(m<3?u(S):m>3?u(a,t,S):u(a,t))||S);return m>3&&S&&Object.defineProperty(a,t,S),S},_=this&&this.__param||function(i,a){return function(t,s){a(t,s,i)}};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferService=e.MINIMUM_ROWS=e.MINIMUM_COLS=void 0;const l=o(8460),d=o(844),g=o(5295),p=o(2585);e.MINIMUM_COLS=2,e.MINIMUM_ROWS=1;let f=e.BufferService=class extends d.Disposable{get buffer(){return this.buffers.active}constructor(i){super(),this.isUserScrolling=!1,this._onResize=this.register(new l.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new l.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(i.rawOptions.cols||0,e.MINIMUM_COLS),this.rows=Math.max(i.rawOptions.rows||0,e.MINIMUM_ROWS),this.buffers=this.register(new g.BufferSet(i,this))}resize(i,a){this.cols=i,this.rows=a,this.buffers.resize(i,a),this._onResize.fire({cols:i,rows:a})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(i,a=!1){const t=this.buffer;let s;s=this._cachedBlankLine,s&&s.length===this.cols&&s.getFg(0)===i.fg&&s.getBg(0)===i.bg||(s=t.getBlankLine(i,a),this._cachedBlankLine=s),s.isWrapped=a;const u=t.ybase+t.scrollTop,m=t.ybase+t.scrollBottom;if(t.scrollTop===0){const S=t.lines.isFull;m===t.lines.length-1?S?t.lines.recycle().copyFrom(s):t.lines.push(s.clone()):t.lines.splice(m+1,0,s.clone()),S?this.isUserScrolling&&(t.ydisp=Math.max(t.ydisp-1,0)):(t.ybase++,this.isUserScrolling||t.ydisp++)}else{const S=m-u+1;t.lines.shiftElements(u+1,S-1,-1),t.lines.set(m,s.clone())}this.isUserScrolling||(t.ydisp=t.ybase),this._onScroll.fire(t.ydisp)}scrollLines(i,a,t){const s=this.buffer;if(i<0){if(s.ydisp===0)return;this.isUserScrolling=!0}else i+s.ydisp>=s.ybase&&(this.isUserScrolling=!1);const u=s.ydisp;s.ydisp=Math.max(Math.min(s.ydisp+i,s.ybase),0),u!==s.ydisp&&(a||this._onScroll.fire(s.ydisp))}};e.BufferService=f=h([_(0,p.IOptionsService)],f)},7994:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CharsetService=void 0,e.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(o){this.glevel=o,this.charset=this._charsets[o]}setgCharset(o,h){this._charsets[o]=h,this.glevel===o&&(this.charset=h)}}},1753:function(y,e,o){var h=this&&this.__decorate||function(s,u,m,S){var C,v=arguments.length,k=v<3?u:S===null?S=Object.getOwnPropertyDescriptor(u,m):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(s,u,m,S);else for(var T=s.length-1;T>=0;T--)(C=s[T])&&(k=(v<3?C(k):v>3?C(u,m,k):C(u,m))||k);return v>3&&k&&Object.defineProperty(u,m,k),k},_=this&&this.__param||function(s,u){return function(m,S){u(m,S,s)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CoreMouseService=void 0;const l=o(2585),d=o(8460),g=o(844),p={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:s=>s.button!==4&&s.action===1&&(s.ctrl=!1,s.alt=!1,s.shift=!1,!0)},VT200:{events:19,restrict:s=>s.action!==32},DRAG:{events:23,restrict:s=>s.action!==32||s.button!==3},ANY:{events:31,restrict:s=>!0}};function f(s,u){let m=(s.ctrl?16:0)|(s.shift?4:0)|(s.alt?8:0);return s.button===4?(m|=64,m|=s.action):(m|=3&s.button,4&s.button&&(m|=64),8&s.button&&(m|=128),s.action===32?m|=32:s.action!==0||u||(m|=3)),m}const i=String.fromCharCode,a={DEFAULT:s=>{const u=[f(s,!1)+32,s.col+32,s.row+32];return u[0]>255||u[1]>255||u[2]>255?"":`\x1B[M${i(u[0])}${i(u[1])}${i(u[2])}`},SGR:s=>{const u=s.action===0&&s.button!==4?"m":"M";return`\x1B[<${f(s,!0)};${s.col};${s.row}${u}`},SGR_PIXELS:s=>{const u=s.action===0&&s.button!==4?"m":"M";return`\x1B[<${f(s,!0)};${s.x};${s.y}${u}`}};let t=e.CoreMouseService=class extends g.Disposable{constructor(s,u){super(),this._bufferService=s,this._coreService=u,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new d.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const m of Object.keys(p))this.addProtocol(m,p[m]);for(const m of Object.keys(a))this.addEncoding(m,a[m]);this.reset()}addProtocol(s,u){this._protocols[s]=u}addEncoding(s,u){this._encodings[s]=u}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(s){if(!this._protocols[s])throw new Error(`unknown protocol "${s}"`);this._activeProtocol=s,this._onProtocolChange.fire(this._protocols[s].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(s){if(!this._encodings[s])throw new Error(`unknown encoding "${s}"`);this._activeEncoding=s}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(s){if(s.col<0||s.col>=this._bufferService.cols||s.row<0||s.row>=this._bufferService.rows||s.button===4&&s.action===32||s.button===3&&s.action!==32||s.button!==4&&(s.action===2||s.action===3)||(s.col++,s.row++,s.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,s,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(s))return!1;const u=this._encodings[this._activeEncoding](s);return u&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(u):this._coreService.triggerDataEvent(u,!0)),this._lastEvent=s,!0}explainEvents(s){return{down:!!(1&s),up:!!(2&s),drag:!!(4&s),move:!!(8&s),wheel:!!(16&s)}}_equalEvents(s,u,m){if(m){if(s.x!==u.x||s.y!==u.y)return!1}else if(s.col!==u.col||s.row!==u.row)return!1;return s.button===u.button&&s.action===u.action&&s.ctrl===u.ctrl&&s.alt===u.alt&&s.shift===u.shift}};e.CoreMouseService=t=h([_(0,l.IBufferService),_(1,l.ICoreService)],t)},6975:function(y,e,o){var h=this&&this.__decorate||function(t,s,u,m){var S,C=arguments.length,v=C<3?s:m===null?m=Object.getOwnPropertyDescriptor(s,u):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(t,s,u,m);else for(var k=t.length-1;k>=0;k--)(S=t[k])&&(v=(C<3?S(v):C>3?S(s,u,v):S(s,u))||v);return C>3&&v&&Object.defineProperty(s,u,v),v},_=this&&this.__param||function(t,s){return function(u,m){s(u,m,t)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CoreService=void 0;const l=o(1439),d=o(8460),g=o(844),p=o(2585),f=Object.freeze({insertMode:!1}),i=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let a=e.CoreService=class extends g.Disposable{constructor(t,s,u){super(),this._bufferService=t,this._logService=s,this._optionsService=u,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new d.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new d.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new d.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new d.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,l.clone)(f),this.decPrivateModes=(0,l.clone)(i)}reset(){this.modes=(0,l.clone)(f),this.decPrivateModes=(0,l.clone)(i)}triggerDataEvent(t,s=!1){if(this._optionsService.rawOptions.disableStdin)return;const u=this._bufferService.buffer;s&&this._optionsService.rawOptions.scrollOnUserInput&&u.ybase!==u.ydisp&&this._onRequestScrollToBottom.fire(),s&&this._onUserInput.fire(),this._logService.debug(`sending data "${t}"`,()=>t.split("").map(m=>m.charCodeAt(0))),this._onData.fire(t)}triggerBinaryEvent(t){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${t}"`,()=>t.split("").map(s=>s.charCodeAt(0))),this._onBinary.fire(t))}};e.CoreService=a=h([_(0,p.IBufferService),_(1,p.ILogService),_(2,p.IOptionsService)],a)},9074:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DecorationService=void 0;const h=o(8055),_=o(8460),l=o(844),d=o(6106);let g=0,p=0;class f extends l.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new d.SortedList(t=>t==null?void 0:t.marker.line),this._onDecorationRegistered=this.register(new _.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new _.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,l.toDisposable)(()=>this.reset()))}registerDecoration(t){if(t.marker.isDisposed)return;const s=new i(t);if(s){const u=s.marker.onDispose(()=>s.dispose());s.onDispose(()=>{s&&(this._decorations.delete(s)&&this._onDecorationRemoved.fire(s),u.dispose())}),this._decorations.insert(s),this._onDecorationRegistered.fire(s)}return s}reset(){for(const t of this._decorations.values())t.dispose();this._decorations.clear()}*getDecorationsAtCell(t,s,u){let m=0,S=0;for(const C of this._decorations.getKeyIterator(s))m=C.options.x??0,S=m+(C.options.width??1),t>=m&&t<S&&(!u||(C.options.layer??"bottom")===u)&&(yield C)}forEachDecorationAtCell(t,s,u,m){this._decorations.forEachByKey(s,S=>{g=S.options.x??0,p=g+(S.options.width??1),t>=g&&t<p&&(!u||(S.options.layer??"bottom")===u)&&m(S)})}}e.DecorationService=f;class i extends l.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=h.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=h.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(t){super(),this.options=t,this.onRenderEmitter=this.register(new _.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new _.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=t.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InstantiationService=e.ServiceCollection=void 0;const h=o(2585),_=o(8343);class l{constructor(...g){this._entries=new Map;for(const[p,f]of g)this.set(p,f)}set(g,p){const f=this._entries.get(g);return this._entries.set(g,p),f}forEach(g){for(const[p,f]of this._entries.entries())g(p,f)}has(g){return this._entries.has(g)}get(g){return this._entries.get(g)}}e.ServiceCollection=l,e.InstantiationService=class{constructor(){this._services=new l,this._services.set(h.IInstantiationService,this)}setService(d,g){this._services.set(d,g)}getService(d){return this._services.get(d)}createInstance(d,...g){const p=(0,_.getServiceDependencies)(d).sort((a,t)=>a.index-t.index),f=[];for(const a of p){const t=this._services.get(a.id);if(!t)throw new Error(`[createInstance] ${d.name} depends on UNKNOWN service ${a.id}.`);f.push(t)}const i=p.length>0?p[0].index:g.length;if(g.length!==i)throw new Error(`[createInstance] First service dependency of ${d.name} at position ${i+1} conflicts with ${g.length} static arguments`);return new d(...g,...f)}}},7866:function(y,e,o){var h=this&&this.__decorate||function(i,a,t,s){var u,m=arguments.length,S=m<3?a:s===null?s=Object.getOwnPropertyDescriptor(a,t):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(i,a,t,s);else for(var C=i.length-1;C>=0;C--)(u=i[C])&&(S=(m<3?u(S):m>3?u(a,t,S):u(a,t))||S);return m>3&&S&&Object.defineProperty(a,t,S),S},_=this&&this.__param||function(i,a){return function(t,s){a(t,s,i)}};Object.defineProperty(e,"__esModule",{value:!0}),e.traceCall=e.setTraceLogger=e.LogService=void 0;const l=o(844),d=o(2585),g={trace:d.LogLevelEnum.TRACE,debug:d.LogLevelEnum.DEBUG,info:d.LogLevelEnum.INFO,warn:d.LogLevelEnum.WARN,error:d.LogLevelEnum.ERROR,off:d.LogLevelEnum.OFF};let p,f=e.LogService=class extends l.Disposable{get logLevel(){return this._logLevel}constructor(i){super(),this._optionsService=i,this._logLevel=d.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),p=this}_updateLogLevel(){this._logLevel=g[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(i){for(let a=0;a<i.length;a++)typeof i[a]=="function"&&(i[a]=i[a]())}_log(i,a,t){this._evalLazyOptionalParams(t),i.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+a,...t)}trace(i,...a){var t;this._logLevel<=d.LogLevelEnum.TRACE&&this._log(((t=this._optionsService.options.logger)==null?void 0:t.trace.bind(this._optionsService.options.logger))??console.log,i,a)}debug(i,...a){var t;this._logLevel<=d.LogLevelEnum.DEBUG&&this._log(((t=this._optionsService.options.logger)==null?void 0:t.debug.bind(this._optionsService.options.logger))??console.log,i,a)}info(i,...a){var t;this._logLevel<=d.LogLevelEnum.INFO&&this._log(((t=this._optionsService.options.logger)==null?void 0:t.info.bind(this._optionsService.options.logger))??console.info,i,a)}warn(i,...a){var t;this._logLevel<=d.LogLevelEnum.WARN&&this._log(((t=this._optionsService.options.logger)==null?void 0:t.warn.bind(this._optionsService.options.logger))??console.warn,i,a)}error(i,...a){var t;this._logLevel<=d.LogLevelEnum.ERROR&&this._log(((t=this._optionsService.options.logger)==null?void 0:t.error.bind(this._optionsService.options.logger))??console.error,i,a)}};e.LogService=f=h([_(0,d.IOptionsService)],f),e.setTraceLogger=function(i){p=i},e.traceCall=function(i,a,t){if(typeof t.value!="function")throw new Error("not supported");const s=t.value;t.value=function(...u){if(p.logLevel!==d.LogLevelEnum.TRACE)return s.apply(this,u);p.trace(`GlyphRenderer#${s.name}(${u.map(S=>JSON.stringify(S)).join(", ")})`);const m=s.apply(this,u);return p.trace(`GlyphRenderer#${s.name} return`,m),m}}},7302:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionsService=e.DEFAULT_OPTIONS=void 0;const h=o(8460),_=o(844),l=o(6114);e.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:l.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const d=["normal","bold","100","200","300","400","500","600","700","800","900"];class g extends _.Disposable{constructor(f){super(),this._onOptionChange=this.register(new h.EventEmitter),this.onOptionChange=this._onOptionChange.event;const i={...e.DEFAULT_OPTIONS};for(const a in f)if(a in i)try{const t=f[a];i[a]=this._sanitizeAndValidateOption(a,t)}catch(t){console.error(t)}this.rawOptions=i,this.options={...i},this._setupOptions(),this.register((0,_.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(f,i){return this.onOptionChange(a=>{a===f&&i(this.rawOptions[f])})}onMultipleOptionChange(f,i){return this.onOptionChange(a=>{f.indexOf(a)!==-1&&i()})}_setupOptions(){const f=a=>{if(!(a in e.DEFAULT_OPTIONS))throw new Error(`No option with key "${a}"`);return this.rawOptions[a]},i=(a,t)=>{if(!(a in e.DEFAULT_OPTIONS))throw new Error(`No option with key "${a}"`);t=this._sanitizeAndValidateOption(a,t),this.rawOptions[a]!==t&&(this.rawOptions[a]=t,this._onOptionChange.fire(a))};for(const a in this.rawOptions){const t={get:f.bind(this,a),set:i.bind(this,a)};Object.defineProperty(this.options,a,t)}}_sanitizeAndValidateOption(f,i){switch(f){case"cursorStyle":if(i||(i=e.DEFAULT_OPTIONS[f]),!function(a){return a==="block"||a==="underline"||a==="bar"}(i))throw new Error(`"${i}" is not a valid value for ${f}`);break;case"wordSeparator":i||(i=e.DEFAULT_OPTIONS[f]);break;case"fontWeight":case"fontWeightBold":if(typeof i=="number"&&1<=i&&i<=1e3)break;i=d.includes(i)?i:e.DEFAULT_OPTIONS[f];break;case"cursorWidth":i=Math.floor(i);case"lineHeight":case"tabStopWidth":if(i<1)throw new Error(`${f} cannot be less than 1, value: ${i}`);break;case"minimumContrastRatio":i=Math.max(1,Math.min(21,Math.round(10*i)/10));break;case"scrollback":if((i=Math.min(i,4294967295))<0)throw new Error(`${f} cannot be less than 0, value: ${i}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(i<=0)throw new Error(`${f} cannot be less than or equal to 0, value: ${i}`);break;case"rows":case"cols":if(!i&&i!==0)throw new Error(`${f} must be numeric, value: ${i}`);break;case"windowsPty":i=i??{}}return i}}e.OptionsService=g},2660:function(y,e,o){var h=this&&this.__decorate||function(g,p,f,i){var a,t=arguments.length,s=t<3?p:i===null?i=Object.getOwnPropertyDescriptor(p,f):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(g,p,f,i);else for(var u=g.length-1;u>=0;u--)(a=g[u])&&(s=(t<3?a(s):t>3?a(p,f,s):a(p,f))||s);return t>3&&s&&Object.defineProperty(p,f,s),s},_=this&&this.__param||function(g,p){return function(f,i){p(f,i,g)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OscLinkService=void 0;const l=o(2585);let d=e.OscLinkService=class{constructor(g){this._bufferService=g,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(g){const p=this._bufferService.buffer;if(g.id===void 0){const u=p.addMarker(p.ybase+p.y),m={data:g,id:this._nextId++,lines:[u]};return u.onDispose(()=>this._removeMarkerFromLink(m,u)),this._dataByLinkId.set(m.id,m),m.id}const f=g,i=this._getEntryIdKey(f),a=this._entriesWithId.get(i);if(a)return this.addLineToLink(a.id,p.ybase+p.y),a.id;const t=p.addMarker(p.ybase+p.y),s={id:this._nextId++,key:this._getEntryIdKey(f),data:f,lines:[t]};return t.onDispose(()=>this._removeMarkerFromLink(s,t)),this._entriesWithId.set(s.key,s),this._dataByLinkId.set(s.id,s),s.id}addLineToLink(g,p){const f=this._dataByLinkId.get(g);if(f&&f.lines.every(i=>i.line!==p)){const i=this._bufferService.buffer.addMarker(p);f.lines.push(i),i.onDispose(()=>this._removeMarkerFromLink(f,i))}}getLinkData(g){var p;return(p=this._dataByLinkId.get(g))==null?void 0:p.data}_getEntryIdKey(g){return`${g.id};;${g.uri}`}_removeMarkerFromLink(g,p){const f=g.lines.indexOf(p);f!==-1&&(g.lines.splice(f,1),g.lines.length===0&&(g.data.id!==void 0&&this._entriesWithId.delete(g.key),this._dataByLinkId.delete(g.id)))}};e.OscLinkService=d=h([_(0,l.IBufferService)],d)},8343:(y,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createDecorator=e.getServiceDependencies=e.serviceRegistry=void 0;const o="di$target",h="di$dependencies";e.serviceRegistry=new Map,e.getServiceDependencies=function(_){return _[h]||[]},e.createDecorator=function(_){if(e.serviceRegistry.has(_))return e.serviceRegistry.get(_);const l=function(d,g,p){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(f,i,a){i[o]===i?i[h].push({id:f,index:a}):(i[h]=[{id:f,index:a}],i[o]=i)})(l,d,p)};return l.toString=()=>_,e.serviceRegistry.set(_,l),l}},2585:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IDecorationService=e.IUnicodeService=e.IOscLinkService=e.IOptionsService=e.ILogService=e.LogLevelEnum=e.IInstantiationService=e.ICharsetService=e.ICoreService=e.ICoreMouseService=e.IBufferService=void 0;const h=o(8343);var _;e.IBufferService=(0,h.createDecorator)("BufferService"),e.ICoreMouseService=(0,h.createDecorator)("CoreMouseService"),e.ICoreService=(0,h.createDecorator)("CoreService"),e.ICharsetService=(0,h.createDecorator)("CharsetService"),e.IInstantiationService=(0,h.createDecorator)("InstantiationService"),function(l){l[l.TRACE=0]="TRACE",l[l.DEBUG=1]="DEBUG",l[l.INFO=2]="INFO",l[l.WARN=3]="WARN",l[l.ERROR=4]="ERROR",l[l.OFF=5]="OFF"}(_||(e.LogLevelEnum=_={})),e.ILogService=(0,h.createDecorator)("LogService"),e.IOptionsService=(0,h.createDecorator)("OptionsService"),e.IOscLinkService=(0,h.createDecorator)("OscLinkService"),e.IUnicodeService=(0,h.createDecorator)("UnicodeService"),e.IDecorationService=(0,h.createDecorator)("DecorationService")},1480:(y,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeService=void 0;const h=o(8460),_=o(225);class l{static extractShouldJoin(g){return(1&g)!=0}static extractWidth(g){return g>>1&3}static extractCharKind(g){return g>>3}static createPropertyValue(g,p,f=!1){return(16777215&g)<<3|(3&p)<<1|(f?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new h.EventEmitter,this.onChange=this._onChange.event;const g=new _.UnicodeV6;this.register(g),this._active=g.version,this._activeProvider=g}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(g){if(!this._providers[g])throw new Error(`unknown Unicode version "${g}"`);this._active=g,this._activeProvider=this._providers[g],this._onChange.fire(g)}register(g){this._providers[g.version]=g}wcwidth(g){return this._activeProvider.wcwidth(g)}getStringCellWidth(g){let p=0,f=0;const i=g.length;for(let a=0;a<i;++a){let t=g.charCodeAt(a);if(55296<=t&&t<=56319){if(++a>=i)return p+this.wcwidth(t);const m=g.charCodeAt(a);56320<=m&&m<=57343?t=1024*(t-55296)+m-56320+65536:p+=this.wcwidth(m)}const s=this.charProperties(t,f);let u=l.extractWidth(s);l.extractShouldJoin(s)&&(u-=l.extractWidth(f)),p+=u,f=s}return p}charProperties(g,p){return this._activeProvider.charProperties(g,p)}}e.UnicodeService=l}},b={};function w(y){var e=b[y];if(e!==void 0)return e.exports;var o=b[y]={exports:{}};return c[y].call(o.exports,o,o.exports,w),o.exports}var x={};return(()=>{var y=x;Object.defineProperty(y,"__esModule",{value:!0}),y.Terminal=void 0;const e=w(9042),o=w(3236),h=w(844),_=w(5741),l=w(8285),d=w(7975),g=w(7090),p=["cols","rows"];class f extends h.Disposable{constructor(a){super(),this._core=this.register(new o.Terminal(a)),this._addonManager=this.register(new _.AddonManager),this._publicOptions={...this._core.options};const t=u=>this._core.options[u],s=(u,m)=>{this._checkReadonlyOptions(u),this._core.options[u]=m};for(const u in this._core.options){const m={get:t.bind(this,u),set:s.bind(this,u)};Object.defineProperty(this._publicOptions,u,m)}}_checkReadonlyOptions(a){if(p.includes(a))throw new Error(`Option "${a}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new d.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new g.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new l.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const a=this._core.coreService.decPrivateModes;let t="none";switch(this._core.coreMouseService.activeProtocol){case"X10":t="x10";break;case"VT200":t="vt200";break;case"DRAG":t="drag";break;case"ANY":t="any"}return{applicationCursorKeysMode:a.applicationCursorKeys,applicationKeypadMode:a.applicationKeypad,bracketedPasteMode:a.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:t,originMode:a.origin,reverseWraparoundMode:a.reverseWraparound,sendFocusMode:a.sendFocus,wraparoundMode:a.wraparound}}get options(){return this._publicOptions}set options(a){for(const t in a)this._publicOptions[t]=a[t]}blur(){this._core.blur()}focus(){this._core.focus()}input(a,t=!0){this._core.input(a,t)}resize(a,t){this._verifyIntegers(a,t),this._core.resize(a,t)}open(a){this._core.open(a)}attachCustomKeyEventHandler(a){this._core.attachCustomKeyEventHandler(a)}attachCustomWheelEventHandler(a){this._core.attachCustomWheelEventHandler(a)}registerLinkProvider(a){return this._core.registerLinkProvider(a)}registerCharacterJoiner(a){return this._checkProposedApi(),this._core.registerCharacterJoiner(a)}deregisterCharacterJoiner(a){this._checkProposedApi(),this._core.deregisterCharacterJoiner(a)}registerMarker(a=0){return this._verifyIntegers(a),this._core.registerMarker(a)}registerDecoration(a){return this._checkProposedApi(),this._verifyPositiveIntegers(a.x??0,a.width??0,a.height??0),this._core.registerDecoration(a)}hasSelection(){return this._core.hasSelection()}select(a,t,s){this._verifyIntegers(a,t,s),this._core.select(a,t,s)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(a,t){this._verifyIntegers(a,t),this._core.selectLines(a,t)}dispose(){super.dispose()}scrollLines(a){this._verifyIntegers(a),this._core.scrollLines(a)}scrollPages(a){this._verifyIntegers(a),this._core.scrollPages(a)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(a){this._verifyIntegers(a),this._core.scrollToLine(a)}clear(){this._core.clear()}write(a,t){this._core.write(a,t)}writeln(a,t){this._core.write(a),this._core.write(`\r
`,t)}paste(a){this._core.paste(a)}refresh(a,t){this._verifyIntegers(a,t),this._core.refresh(a,t)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(a){this._addonManager.loadAddon(this,a)}static get strings(){return e}_verifyIntegers(...a){for(const t of a)if(t===1/0||isNaN(t)||t%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...a){for(const t of a)if(t&&(t===1/0||isNaN(t)||t%1!=0||t<0))throw new Error("This API only accepts positive integers")}}y.Terminal=f})(),x})())})(ai);var ls=ai.exports,ci={exports:{}};(function(n,r){(function(c,b){n.exports=b()})(self,()=>(()=>{var c={};return(()=>{var b=c;Object.defineProperty(b,"__esModule",{value:!0}),b.FitAddon=void 0,b.FitAddon=class{activate(w){this._terminal=w}dispose(){}fit(){const w=this.proposeDimensions();if(!w||!this._terminal||isNaN(w.cols)||isNaN(w.rows))return;const x=this._terminal._core;this._terminal.rows===w.rows&&this._terminal.cols===w.cols||(x._renderService.clear(),this._terminal.resize(w.cols,w.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const w=this._terminal._core,x=w._renderService.dimensions;if(x.css.cell.width===0||x.css.cell.height===0)return;const y=this._terminal.options.scrollback===0?0:w.viewport.scrollBarWidth,e=window.getComputedStyle(this._terminal.element.parentElement),o=parseInt(e.getPropertyValue("height")),h=Math.max(0,parseInt(e.getPropertyValue("width"))),_=window.getComputedStyle(this._terminal.element),l=o-(parseInt(_.getPropertyValue("padding-top"))+parseInt(_.getPropertyValue("padding-bottom"))),d=h-(parseInt(_.getPropertyValue("padding-right"))+parseInt(_.getPropertyValue("padding-left")))-y;return{cols:Math.max(2,Math.floor(d/x.css.cell.width)),rows:Math.max(1,Math.floor(l/x.css.cell.height))}}}})(),c})())})(ci);var cs=ci.exports,hi={exports:{}};(function(n,r){(function(c,b){n.exports=b()})(self,()=>(()=>{var c={6:(y,e)=>{function o(_){try{const l=new URL(_),d=l.password&&l.username?`${l.protocol}//${l.username}:${l.password}@${l.host}`:l.username?`${l.protocol}//${l.username}@${l.host}`:`${l.protocol}//${l.host}`;return _.toLocaleLowerCase().startsWith(d.toLocaleLowerCase())}catch{return!1}}Object.defineProperty(e,"__esModule",{value:!0}),e.LinkComputer=e.WebLinkProvider=void 0,e.WebLinkProvider=class{constructor(_,l,d,g={}){this._terminal=_,this._regex=l,this._handler=d,this._options=g}provideLinks(_,l){const d=h.computeLink(_,this._regex,this._terminal,this._handler);l(this._addCallbacks(d))}_addCallbacks(_){return _.map(l=>(l.leave=this._options.leave,l.hover=(d,g)=>{if(this._options.hover){const{range:p}=l;this._options.hover(d,g,p)}},l))}};class h{static computeLink(l,d,g,p){const f=new RegExp(d.source,(d.flags||"")+"g"),[i,a]=h._getWindowedLineStrings(l-1,g),t=i.join("");let s;const u=[];for(;s=f.exec(t);){const m=s[0];if(!o(m))continue;const[S,C]=h._mapStrIdx(g,a,0,s.index),[v,k]=h._mapStrIdx(g,S,C,m.length);if(S===-1||C===-1||v===-1||k===-1)continue;const T={start:{x:C+1,y:S+1},end:{x:k,y:v+1}};u.push({range:T,text:m,activate:p})}return u}static _getWindowedLineStrings(l,d){let g,p=l,f=l,i=0,a="";const t=[];if(g=d.buffer.active.getLine(l)){const s=g.translateToString(!0);if(g.isWrapped&&s[0]!==" "){for(i=0;(g=d.buffer.active.getLine(--p))&&i<2048&&(a=g.translateToString(!0),i+=a.length,t.push(a),g.isWrapped&&a.indexOf(" ")===-1););t.reverse()}for(t.push(s),i=0;(g=d.buffer.active.getLine(++f))&&g.isWrapped&&i<2048&&(a=g.translateToString(!0),i+=a.length,t.push(a),a.indexOf(" ")===-1););}return[t,p]}static _mapStrIdx(l,d,g,p){const f=l.buffer.active,i=f.getNullCell();let a=g;for(;p;){const t=f.getLine(d);if(!t)return[-1,-1];for(let s=a;s<t.length;++s){t.getCell(s,i);const u=i.getChars();if(i.getWidth()&&(p-=u.length||1,s===t.length-1&&u==="")){const m=f.getLine(d+1);m&&m.isWrapped&&(m.getCell(0,i),i.getWidth()===2&&(p+=1))}if(p<0)return[d,s]}d++,a=0}return[d,a]}}e.LinkComputer=h}},b={};function w(y){var e=b[y];if(e!==void 0)return e.exports;var o=b[y]={exports:{}};return c[y](o,o.exports,w),o.exports}var x={};return(()=>{var y=x;Object.defineProperty(y,"__esModule",{value:!0}),y.WebLinksAddon=void 0;const e=w(6),o=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function h(_,l){const d=window.open();if(d){try{d.opener=null}catch{}d.location.href=l}else console.warn("Opening link blocked as opener could not be cleared")}y.WebLinksAddon=class{constructor(_=h,l={}){this._handler=_,this._options=l}activate(_){this._terminal=_;const l=this._options,d=l.urlRegex||o;this._linkProvider=this._terminal.registerLinkProvider(new e.WebLinkProvider(this._terminal,d,this._handler,l))}dispose(){var _;(_=this._linkProvider)==null||_.dispose()}}})(),x})())})(hi);var hs=hi.exports;function ds(n){let r;return{c(){r=P("div"),r.innerHTML="",E(r,"class","terminal-container svelte-1otjf4i")},m(c,b){se(c,r,b),n[9](r)},p:Me,i:Me,o:Me,d(c){c&&te(r),n[9](null)}}}function us(n,r,c){let{sessionId:b=null}=r,{onData:w=null}=r,{onResize:x=null}=r,y,e,o,h=Ri(Wt);const _={background:"#1e1e1e",foreground:"#d4d4d4",cursor:"#d4d4d4",black:"#000000",red:"#cd3131",green:"#0dbc79",yellow:"#e5e510",blue:"#2472c8",magenta:"#bc3fbc",cyan:"#11a8cd",white:"#e5e5e5",brightBlack:"#666666",brightRed:"#f14c4c",brightGreen:"#23d18b",brightYellow:"#f5f543",brightBlue:"#3b8eea",brightMagenta:"#d670d6",brightCyan:"#29b8db",selectionBackground:"rgba(2, 136, 209, 0.3)",selectionForeground:void 0,selectionInactiveBackground:"rgba(2, 136, 209, 0.15)"},l={background:"#ffffff",foreground:"#333333",cursor:"#333333",black:"#000000",red:"#cd3131",green:"#00bc00",yellow:"#949800",blue:"#0451a5",magenta:"#bc05bc",cyan:"#0598bc",white:"#555555",brightBlack:"#666666",brightRed:"#cd3131",brightGreen:"#14ce14",brightYellow:"#b5ba00",brightBlue:"#0451a5",brightMagenta:"#bc05bc",brightCyan:"#0598bc",brightWhite:"#a5a5a5",selectionBackground:"rgba(225, 245, 254, 0.8)",selectionForeground:void 0,selectionInactiveBackground:"rgba(225, 245, 254, 0.5)"},d=Wt.subscribe(s=>{h=s,e&&(e.options.theme=h==="light"?l:_)});Tt(()=>{e=new ls.Terminal({cursorBlink:!0,fontSize:14,fontFamily:'Menlo, Monaco, "Courier New", monospace',theme:h==="light"?l:_,allowProposedApi:!0,scrollback:1e3,convertEol:!0}),o=new cs.FitAddon,e.loadAddon(o),e.loadAddon(new hs.WebLinksAddon),e.open(y),o.fit(),e.onData(u=>{w&&b&&w(b,u)}),e.onResize(({cols:u,rows:m})=>{x&&b&&x(b,u,m)});const s=new ResizeObserver(()=>{o.fit()});return s.observe(y),()=>{s.disconnect()}}),Nt(()=>{d&&d(),e&&e.dispose()});function g(s){e&&e.write(s)}function p(s){e&&e.writeln(s)}function f(){e&&e.clear()}function i(){e&&e.focus()}function a(){return e?{cols:e.cols,rows:e.rows}:{cols:80,rows:24}}function t(s){je[s?"unshift":"push"](()=>{y=s,c(0,y)})}return n.$$set=s=>{"sessionId"in s&&c(1,b=s.sessionId),"onData"in s&&c(2,w=s.onData),"onResize"in s&&c(3,x=s.onResize)},[y,b,w,x,g,p,f,i,a,t]}class fs extends Qe{constructor(r){super(),Ze(this,r,us,ds,Ye,{sessionId:1,onData:2,onResize:3,write:4,writeln:5,clear:6,focus:7,getSize:8})}get write(){return this.$$.ctx[4]}get writeln(){return this.$$.ctx[5]}get clear(){return this.$$.ctx[6]}get focus(){return this.$$.ctx[7]}get getSize(){return this.$$.ctx[8]}}function _s(n,r,c){return window.runtime.EventsOnMultiple(n,r,c)}function di(n,r){return _s(n,r,-1)}const{Map:ui}=Oi;function mr(n,r,c){const b=n.slice();return b[24]=r[c],b[25]=r,b[26]=c,b}function br(n,r,c){const b=n.slice();return b[24]=r[c],b}function ps(n){let r=[],c=new ui,b,w=ze(n[1]);const x=y=>y[24].sessionId;for(let y=0;y<w.length;y+=1){let e=br(n,w,y),o=x(e);c.set(o,r[y]=Sr(o,e))}return{c(){for(let y=0;y<r.length;y+=1)r[y].c();b=xt()},m(y,e){for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(y,e);se(y,b,e)},p(y,e){e&1022&&(w=ze(y[1]),r=Lt(r,e,x,1,y,w,c,b.parentNode,ir,Sr,b,br))},d(y){y&&te(b);for(let e=0;e<r.length;e+=1)r[e].d(y)}}}function gs(n){let r;return{c(){r=P("div"),r.textContent="没有活动连接",E(r,"class","px-4 py-2.5 text-sm text-gray-500 dark:text-gray-400")},m(c,b){se(c,r,b)},p:Me,d(c){c&&te(r)}}}function vs(n){let r,c=(n[24].tabName||n[24].connection.name)+"",b;return{c(){r=P("span"),b=ce(c),E(r,"class","text-sm font-medium truncate flex-1")},m(w,x){se(w,r,x),L(r,b)},p(w,x){x&2&&c!==(c=(w[24].tabName||w[24].connection.name)+"")&&Ce(b,c)},d(w){w&&te(r)}}}function ms(n){let r,c,b;return{c(){r=P("input"),E(r,"type","text"),E(r,"class","flex-1 bg-transparent text-sm outline-none px-1"),E(r,"focus","")},m(w,x){se(w,r,x),Ee(r,n[3]),c||(b=[ee(r,"input",n[15]),ee(r,"blur",n[8]),ee(r,"keydown",n[9])],c=!0)},p(w,x){x&8&&r.value!==w[3]&&Ee(r,w[3])},d(w){w&&te(r),c=!1,Ie(b)}}}function Sr(n,r){let c,b,w,x,y,e,o,h,_,l;function d(t,s){return t[2]===t[24].sessionId?ms:vs}let g=d(r),p=g(r);function f(...t){return r[16](r[24],...t)}function i(){return r[17](r[24])}function a(){return r[18](r[24])}return{key:n,first:null,c(){c=P("div"),b=P("div"),x=z(),p.c(),y=z(),e=P("button"),e.innerHTML='<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',o=z(),E(b,"class",w=It(`w-2 h-2 rounded-full flex-shrink-0 ${r[24].connected?"bg-green-500":"bg-gray-400 dark:bg-gray-600"}`)+" svelte-1v9xg5l"),E(e,"class","opacity-0 group-hover:opacity-100 p-0.5 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-opacity"),E(c,"class",h="group flex items-center gap-2 px-4 py-2.5 border-r border-gray-200 dark:border-gray-700 cursor-pointer transition-all min-w-[180px] "+(r[4]===r[24].sessionId?"bg-white dark:bg-gray-800 text-gray-900 dark:text-white border-b-2 border-b-purple-600":"bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600")),this.first=c},m(t,s){se(t,c,s),L(c,b),L(c,x),p.m(c,null),L(c,y),L(c,e),L(c,o),_||(l=[ee(e,"click",f),ee(c,"click",i),ee(c,"dblclick",a)],_=!0)},p(t,s){r=t,s&2&&w!==(w=It(`w-2 h-2 rounded-full flex-shrink-0 ${r[24].connected?"bg-green-500":"bg-gray-400 dark:bg-gray-600"}`)+" svelte-1v9xg5l")&&E(b,"class",w),g===(g=d(r))&&p?p.p(r,s):(p.d(1),p=g(r),p&&(p.c(),p.m(c,y))),s&18&&h!==(h="group flex items-center gap-2 px-4 py-2.5 border-r border-gray-200 dark:border-gray-700 cursor-pointer transition-all min-w-[180px] "+(r[4]===r[24].sessionId?"bg-white dark:bg-gray-800 text-gray-900 dark:text-white border-b-2 border-b-purple-600":"bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"))&&E(c,"class",h)},d(t){t&&te(c),p.d(),_=!1,Ie(l)}}}function bs(n){let r;return{c(){r=P("div"),r.innerHTML='<div class="text-center"><div class="text-lg font-medium mb-2 text-gray-700 dark:text-gray-300">未选择连接</div> <div class="text-sm text-gray-500 dark:text-gray-400">从左侧资产列表选择一个服务器开始连接</div></div>',E(r,"class","flex-1 flex items-center justify-center text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800")},m(c,b){se(c,r,b)},p:Me,i:Me,o:Me,d(c){c&&te(r)}}}function Ss(n){let r,c=[],b=new ui,w,x=ze(n[1]);const y=e=>e[24].sessionId;for(let e=0;e<x.length;e+=1){let o=mr(n,x,e),h=y(o);b.set(h,c[e]=wr(h,o))}return{c(){r=P("div");for(let e=0;e<c.length;e+=1)c[e].c();E(r,"class","terminal-content-area relative flex-1 flex flex-col svelte-1v9xg5l")},m(e,o){se(e,r,o);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(r,null);w=!0},p(e,o){o&3091&&(x=ze(e[1]),tt(),c=Lt(c,o,y,1,e,x,b,r,sr,wr,null,mr),rt())},i(e){if(!w){for(let o=0;o<x.length;o+=1)le(c[o]);w=!0}},o(e){for(let o=0;o<c.length;o+=1)ue(c[o]);w=!1},d(e){e&&te(r);for(let o=0;o<c.length;o+=1)c[o].d()}}}function wr(n,r){let c,b,w,x=r[24].connection.username+"",y,e,o=r[24].connection.host+"",h,_,l=r[24].connection.port+"",d,g,p,f,i,a,t=r[24],s,u,m;const S=()=>r[19](a,t),C=()=>r[19](null,t);let v={sessionId:r[24].sessionId,onData:r[10],onResize:r[11]};return a=new fs({props:v}),S(),{key:n,first:null,c(){c=P("div"),b=P("div"),w=P("div"),y=ce(x),e=ce("@"),h=ce(o),_=ce(":"),d=ce(l),g=z(),p=P("div"),p.innerHTML='<button class="p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors" title="复制"><svg class="w-4 h-4 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 01-2 2z"></path></svg></button> <button class="p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors" title="最小化"><svg class="w-4 h-4 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path></svg></button> <button class="p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors" title="最大化"><svg class="w-4 h-4 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 4l-5 5M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-6 0a2 2 0 00-2 2v4a2 2 0 002 2m0 0v4a2 2 0 002 2v-4a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 01-2 2z"></path></svg></button>',f=z(),i=P("div"),Ae(a.$$.fragment),s=z(),E(w,"class","text-sm text-gray-600 dark:text-gray-400 font-mono"),E(p,"class","flex items-center gap-1"),E(b,"class","flex items-center justify-between px-4 py-2.5 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700"),E(i,"class","flex-1 overflow-hidden"),E(c,"class",u="terminal-wrapper "+(r[4]===r[24].sessionId?"active":"inactive")+" svelte-1v9xg5l"),this.first=c},m(k,T){se(k,c,T),L(c,b),L(b,w),L(w,y),L(w,e),L(w,h),L(w,_),L(w,d),L(b,g),L(b,p),L(c,f),L(c,i),Le(a,i,null),L(c,s),m=!0},p(k,T){r=k,(!m||T&2)&&x!==(x=r[24].connection.username+"")&&Ce(y,x),(!m||T&2)&&o!==(o=r[24].connection.host+"")&&Ce(h,o),(!m||T&2)&&l!==(l=r[24].connection.port+"")&&Ce(d,l),t!==r[24]&&(C(),t=r[24],S());const B={};T&2&&(B.sessionId=r[24].sessionId),a.$set(B),(!m||T&18&&u!==(u="terminal-wrapper "+(r[4]===r[24].sessionId?"active":"inactive")+" svelte-1v9xg5l"))&&E(c,"class",u)},i(k){m||(le(a.$$.fragment,k),m=!0)},o(k){ue(a.$$.fragment,k),m=!1},d(k){k&&te(c),C(),De(a)}}}function ws(n){let r,c,b,w,x,y;function e(g,p){return g[1].length===0?gs:ps}let o=e(n),h=o(n);const _=[Ss,bs],l=[];function d(g,p){return g[1].length>0?0:1}return w=d(n),x=l[w]=_[w](n),{c(){r=P("div"),c=P("div"),h.c(),b=z(),x.c(),E(c,"class","flex items-center bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 overflow-x-auto"),E(r,"class","h-full flex flex-col bg-white dark:bg-gray-800")},m(g,p){se(g,r,p),L(r,c),h.m(c,null),L(r,b),l[w].m(r,null),y=!0},p(g,[p]){o===(o=e(g))&&h?h.p(g,p):(h.d(1),h=o(g),h&&(h.c(),h.m(c,null)));let f=w;w=d(g),w===f?l[w].p(g,p):(tt(),ue(l[f],1,1,()=>{l[f]=null}),rt(),x=l[w],x?x.p(g,p):(x=l[w]=_[w](g),x.c()),le(x,1),x.m(r,null))},i(g){y||(le(x),y=!0)},o(g){ue(x),y=!1},d(g){g&&te(r),h.d(),l[w].d()}}}function ys(n,r,c){let b,w;Ct(n,Rt,B=>c(4,b=B)),Ct(n,yt,B=>c(14,w=B));let x={},y=[],e=new Map;async function o(B){var q;if(console.log("Connecting to:",B),!window.wailsBindings){console.error("Wails bindings not loaded"),alert("Wails 绑定未加载，请使用 wails dev 运行");return}const{ConnectSSH:A,GetPassword:M,HasPassword:W,SavePassword:N}=window.wailsBindings;if(typeof A!="function"){console.error("ConnectSSH not available"),alert("SSH 连接功能不可用");return}let G="",X="";if(B.auth_type==="key")X=prompt(`连接到 ${B.name}
如果 SSH 密钥已加密，请输入 Passphrase（否则留空）：`)||"",G=B.key_path||"";else try{if(typeof W=="function"&&await W(B.id))G=await M(B.id),console.log("Using saved password");else if(G=prompt(`连接到 ${B.name}
请输入密码：`)||"",G&&confirm("是否保存密码以便下次自动连接？")&&typeof N=="function")try{await N(B.id,G),console.log("Password saved successfully")}catch(Q){console.error("Failed to save password:",Q)}}catch(V){console.error("Failed to get saved password:",V),G=prompt(`连接到 ${B.name}
请输入密码：`)||""}if(!G){console.log("Connection cancelled - no auth value provided");return}const K=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;console.log("Connecting to server:",B.host,B.port,B.username,"auth_type:",B.auth_type);const D={sessionId:K,connection:B,connected:!1,createdAt:Date.now(),lastActivity:Date.now()};yt.update(V=>(V.set(K,D),V)),Rt.set(K),await hr(),await new Promise(V=>setTimeout(V,50));let O=(q=x[K])==null?void 0:q.getSize();if(O||(O={cols:80,rows:24},console.warn("Terminal not ready, using default size:",O)),console.log("Subscribing to events for session:",K),m(K),await new Promise(V=>setTimeout(V,100)),!x[K]){console.error("Terminal component not ready after delay");return}const I=x[K];if(!I){console.error("Failed to get terminal reference for session:",K);return}console.log("Terminal ready, attempting to connect...");const H=B.auth_type==="key"?"SSH key":"password";I.writeln(`正在连接 ${B.username}@${B.host}:${B.port} (${H})...`),I.writeln("");try{await A(K,B.host,B.port,B.username,B.auth_type||"password",G,X,O.cols,O.rows),yt.update(V=>(V.set(K,D),V)),setTimeout(()=>{I.focus()},100)}catch(V){console.error("Failed to connect:",V),I&&I.writeln(`\r
连接失败: ${V.message||V}`),await h(K)}}async function h(B){const A=e.get(B);A&&(A(),e.delete(B)),delete x[B];const{CloseSSH:M}=window.wailsBindings||{};if(typeof M=="function")try{await M(B)}catch(N){console.error("Failed to close session:",N)}yt.update(N=>(N.delete(B),N));const W=Array.from(w.keys());b===B&&(W.length>0?Rt.set(W[0]):Rt.set(null))}function _(B){w.has(B)&&(Rt.set(B),setTimeout(()=>{const A=x[B];if(A){A.focus();const M=A.getSize(),{ResizeSSH:W}=window.wailsBindings||{};typeof W=="function"&&W(B,M.cols,M.rows).catch(console.error)}},50))}function l(B,A){A.stopPropagation();const M=w.get(B);M&&(M.connected&&!confirm("确定关闭此 SSH 会话吗？")||h(B))}function d(B,A){const M=w.get(B);M&&(M.tabName=A.trim(),yt.update(W=>(W.set(B,M),W)))}let g=null,p="";function f(B){const A=w.get(B);A&&(c(2,g=B),c(3,p=A.tabName||A.connection.name))}function i(){g&&p.trim()&&d(g,p.trim()),c(2,g=null),c(3,p="")}function a(){c(2,g=null),c(3,p="")}function t(B){B.key==="Enter"?i():B.key==="Escape"&&a()}function s(B,A){if(!w.has(B))return;const{SendSSHData:M}=window.wailsBindings||{};typeof M=="function"&&M(B,A).catch(W=>{console.error("Failed to send data:",W)})}function u(B,A,M){if(!w.has(B))return;const{ResizeSSH:W}=window.wailsBindings||{};typeof W=="function"&&W(B,A,M).catch(N=>{console.error("Failed to resize terminal:",N)})}function m(B){const A=`ssh:output:${B}`,M=di(A,W=>{const N=x[B];N&&N.write(W)});e.set(B,M)}Nt(()=>{e.forEach(B=>{B()})}),Tt(async()=>{window.wailsBindings&&console.log("Wails bindings already loaded"),window.terminalRefs=x,window.sessionUnsubscribers||(window.sessionUnsubscribers=e),console.log("TerminalPanel mounted, subscribing to events for sessions:",y),await hr(),b&&x[b]&&setTimeout(()=>{x[b].focus()},100)});function S(){p=this.value,c(3,p)}const C=(B,A)=>l(B.sessionId,A),v=B=>_(B.sessionId),k=B=>f(B.sessionId);function T(B,A){je[B?"unshift":"push"](()=>{x[A.sessionId]=B,c(0,x)})}return n.$$.update=()=>{n.$$.dirty&16384&&c(1,y=w?Array.from(w.values()):[]),n.$$.dirty&1&&window.terminalRefs!==void 0&&(window.terminalRefs=x)},[x,y,g,p,b,_,l,f,i,t,s,u,o,m,w,S,C,v,k,T]}class Cs extends Qe{constructor(r){super(),Ze(this,r,ys,ws,Ye,{handleConnect:12,subscribeToOutput:13})}get handleConnect(){return this.$$.ctx[12]}get subscribeToOutput(){return this.$$.ctx[13]}}function ks(n){const r=n-1;return r*r*r+1}function gt(n,{delay:r=0,duration:c=400,easing:b=Yt}={}){const w=+getComputedStyle(n).opacity;return{delay:r,duration:c,easing:b,css:x=>`opacity: ${x*w}`}}function pt(n,{delay:r=0,duration:c=400,easing:b=ks,x:w=0,y:x=0,opacity:y=0}={}){const e=getComputedStyle(n),o=+e.opacity,h=e.transform==="none"?"":e.transform,_=o*(1-y),[l,d]=lr(w),[g,p]=lr(x);return{delay:r,duration:c,easing:b,css:(f,i)=>`
			transform: ${h} translate(${(1-f)*l}${d}, ${(1-f)*g}${p});
			opacity: ${o-_*i}`}}function Es(n){return window.go.main.App.AddConnection(n)}function fi(n){return window.go.main.App.CancelTransfer(n)}function xs(n,r){return window.go.main.App.ChangeDirectory(n,r)}function Ls(n){return window.go.main.App.CloseSSH(n)}function Ds(n,r,c,b,w,x,y,e,o){return window.go.main.App.ConnectSSH(n,r,c,b,w,x,y,e,o)}function _i(n,r){return window.go.main.App.CreateDirectory(n,r)}function Rs(n,r){return window.go.main.App.DeleteFile(n,r)}function pi(n,r){return window.go.main.App.DeleteFiles(n,r)}function As(n){return window.go.main.App.DeletePassword(n)}function Ms(n,r,c){return window.go.main.App.DownloadFile(n,r,c)}function gi(n,r,c){return window.go.main.App.DownloadFiles(n,r,c)}function Bs(n){return window.go.main.App.EscapeJSON(n)}function Ts(n){return window.go.main.App.FormatJSON(n)}function Os(n){return window.go.main.App.GetConnection(n)}function Ps(){return window.go.main.App.GetConnections()}function Is(n){return window.go.main.App.GetCurrentPath(n)}function Hs(n,r){return window.go.main.App.GetFileInfo(n,r)}function Fs(n){return window.go.main.App.GetMonitoringData(n)}function Ws(n){return window.go.main.App.GetPassword(n)}function Ns(){return window.go.main.App.GetSettings()}function js(n){return window.go.main.App.GetTransferStatus(n)}function zs(n){return window.go.main.App.Greet(n)}function Us(n){return window.go.main.App.HasPassword(n)}function vi(n,r){return window.go.main.App.ListFiles(n,r)}function $s(){return window.go.main.App.ListSSHSessions()}function Ks(n){return window.go.main.App.MinifyJSON(n)}function qs(n){return window.go.main.App.RemoveConnection(n)}function mi(n,r,c){return window.go.main.App.RenameFile(n,r,c)}function Vs(n,r,c){return window.go.main.App.ResizeSSH(n,r,c)}function Gs(n,r){return window.go.main.App.SavePassword(n,r)}function bi(){return window.go.main.App.SelectDownloadDirectory()}function Js(){return window.go.main.App.SelectSSHKeyFile()}function Si(){return window.go.main.App.SelectUploadFiles()}function Xs(n,r){return window.go.main.App.SendSSHData(n,r)}function at(n,r){return window.go.main.App.ShowErrorDialog(n,r)}function Ys(n,r){return window.go.main.App.ShowMessageDialog(n,r)}function wi(n,r){return window.go.main.App.ShowQuestionDialog(n,r)}function Zs(n,r,c,b,w,x){return window.go.main.App.TestConnection(n,r,c,b,w,x)}function Qs(n){return window.go.main.App.UpdateConnection(n)}function en(n){return window.go.main.App.UpdateSettings(n)}function tn(n,r,c){return window.go.main.App.UploadFile(n,r,c)}function Xt(n,r,c){return window.go.main.App.UploadFiles(n,r,c)}function rn(n){return window.go.main.App.ValidateJSON(n)}const sn=Object.freeze(Object.defineProperty({__proto__:null,AddConnection:Es,CancelTransfer:fi,ChangeDirectory:xs,CloseSSH:Ls,ConnectSSH:Ds,CreateDirectory:_i,DeleteFile:Rs,DeleteFiles:pi,DeletePassword:As,DownloadFile:Ms,DownloadFiles:gi,EscapeJSON:Bs,FormatJSON:Ts,GetConnection:Os,GetConnections:Ps,GetCurrentPath:Is,GetFileInfo:Hs,GetMonitoringData:Fs,GetPassword:Ws,GetSettings:Ns,GetTransferStatus:js,Greet:zs,HasPassword:Us,ListFiles:vi,ListSSHSessions:$s,MinifyJSON:Ks,RemoveConnection:qs,RenameFile:mi,ResizeSSH:Vs,SavePassword:Gs,SelectDownloadDirectory:bi,SelectSSHKeyFile:Js,SelectUploadFiles:Si,SendSSHData:Xs,ShowErrorDialog:at,ShowMessageDialog:Ys,ShowQuestionDialog:wi,TestConnection:Zs,UpdateConnection:Qs,UpdateSettings:en,UploadFile:tn,UploadFiles:Xt,ValidateJSON:rn},Symbol.toStringTag,{value:"Module"}));function nn(n){let r,c;return{c(){r=Te("svg"),E(r,"viewBox","0 0 24 24"),E(r,"fill","none"),E(r,"stroke",n[1]),E(r,"stroke-width","2"),E(r,"stroke-linecap","round"),E(r,"stroke-linejoin","round"),E(r,"class",c=It(n[2])+" svelte-n2le2v"),E(r,"xmlns","http://www.w3.org/2000/svg"),pe(r,"width",`${n[0]}px`),pe(r,"height",`${n[0]}px`)},m(b,w){se(b,r,w),r.innerHTML=n[3]},p(b,[w]){w&8&&(r.innerHTML=b[3]),w&2&&E(r,"stroke",b[1]),w&4&&c!==(c=It(b[2])+" svelte-n2le2v")&&E(r,"class",c),w&1&&pe(r,"width",`${b[0]}px`),w&1&&pe(r,"height",`${b[0]}px`)},i:Me,o:Me,d(b){b&&te(r)}}}function on(n,r,c){let b,{name:w=""}=r,{size:x=20}=r,{color:y="currentColor"}=r,{className:e=""}=r;const o={folder:'<path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />',"folder-plus":'<path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/><path d="M12 10h6"/><path d="M15 7v6"/>',file:'<path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />',home:'<path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />',menu:'<path d="M4 6h16M4 12h16M4 18h16" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />',chevronLeft:'<path d="M15 19l-7-7 7-7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />',chevronRight:'<path d="M9 5l7 7-7 7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />',upload:'<path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />',download:'<path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0L8 8m4-4V4" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />',edit:'<path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" /><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />',refresh:'<path d="M23 4v6h-6M1 20v-6h6" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" /><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />',search:'<circle cx="11" cy="11" r="8" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" /><path d="M21 21l-4.35-4.35" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />',trash:'<path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2M10 11v6M14 11v6" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />',close:'<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />',check:'<path d="M5 13l4 4L19 7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />',alert:'<path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />'};return n.$$set=h=>{"name"in h&&c(4,w=h.name),"size"in h&&c(0,x=h.size),"color"in h&&c(1,y=h.color),"className"in h&&c(2,e=h.className)},n.$$.update=()=>{n.$$.dirty&16&&c(3,b=o[w]||o.file)},[x,y,e,b,w]}class Fe extends Qe{constructor(r){super(),Ze(this,r,on,nn,Ye,{name:4,size:0,color:1,className:2})}}function an(n){let r,c,b,w,x,y=n[0].name+"",e,o,h,_,l=n[5](n[0].size)+"",d,g,p,f=yr(n[0].modified)+"",i,a,t,s,u;return b=new Fe({props:{name:n[0].is_dir?"folder":"file",size:18,color:n[0].is_dir?"var(--accent-warning)":"var(--text-tertiary)"}}),{c(){r=P("div"),c=P("div"),Ae(b.$$.fragment),w=z(),x=P("div"),e=ce(y),h=z(),_=P("div"),d=ce(l),g=z(),p=P("div"),i=ce(f),E(c,"class","col-icon svelte-1ucepkc"),E(x,"class","col-name svelte-1ucepkc"),E(x,"title",o=n[0].name),E(_,"class","col-size svelte-1ucepkc"),E(p,"class","col-date svelte-1ucepkc"),E(r,"class",a="file-list-item "+(n[1]?"selected":"")+" svelte-1ucepkc"),E(r,"role","button"),E(r,"tabindex","0")},m(m,S){se(m,r,S),L(r,c),Le(b,c,null),L(r,w),L(r,x),L(x,e),L(r,h),L(r,_),L(_,d),L(r,g),L(r,p),L(p,i),t=!0,s||(u=[ee(r,"click",n[2]),ee(r,"dblclick",n[3]),ee(r,"contextmenu",n[4])],s=!0)},p(m,[S]){const C={};S&1&&(C.name=m[0].is_dir?"folder":"file"),S&1&&(C.color=m[0].is_dir?"var(--accent-warning)":"var(--text-tertiary)"),b.$set(C),(!t||S&1)&&y!==(y=m[0].name+"")&&Ce(e,y),(!t||S&1&&o!==(o=m[0].name))&&E(x,"title",o),(!t||S&1)&&l!==(l=m[5](m[0].size)+"")&&Ce(d,l),(!t||S&1)&&f!==(f=yr(m[0].modified)+"")&&Ce(i,f),(!t||S&2&&a!==(a="file-list-item "+(m[1]?"selected":"")+" svelte-1ucepkc"))&&E(r,"class",a)},i(m){t||(le(b.$$.fragment,m),t=!0)},o(m){ue(b.$$.fragment,m),t=!1},d(m){m&&te(r),De(b),s=!1,Ie(u)}}}function yr(n){if(!n)return"";try{const r=new Date(n);return new Date-r<864e5?r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):r.toLocaleDateString([],{month:"short",day:"numeric"})}catch{return n}}function ln(n,r,c){let{file:b={name:"",path:"",size:0,modified:"",permissions:"",is_dir:!1}}=r,{selected:w=!1}=r;const x=tr();function y(_){x("click",{file:b,event:_})}function e(_){x("dblclick",b)}function o(_){x("contextmenu",_)}function h(_){if(_===0||_===void 0||b.is_dir)return"";const l=["B","KB","MB","GB","TB"],d=1024,g=Math.floor(Math.log(_)/Math.log(d));return parseFloat((_/Math.pow(d,g)).toFixed(1))+" "+l[g]}return n.$$set=_=>{"file"in _&&c(0,b=_.file),"selected"in _&&c(1,w=_.selected)},[b,w,y,e,o,h]}class cn extends Qe{constructor(r){super(),Ze(this,r,ln,an,Ye,{file:0,selected:1})}}function Cr(n){let r,c=n[0].error+"",b,w;return{c(){r=P("div"),b=ce(c),E(r,"class","transfer-error svelte-o2pr7n"),E(r,"title",w=n[0].error)},m(x,y){se(x,r,y),L(r,b)},p(x,y){y&1&&c!==(c=x[0].error+"")&&Ce(b,c),y&1&&w!==(w=x[0].error)&&E(r,"title",w)},d(x){x&&te(r)}}}function kr(n){let r,c,b,w,x,y;return c=new Fe({props:{name:"close",size:12}}),{c(){r=P("button"),Ae(c.$$.fragment),b=ce(`
      取消`),E(r,"class","cancel-btn svelte-o2pr7n")},m(e,o){se(e,r,o),Le(c,r,null),L(r,b),w=!0,x||(y=ee(r,"click",n[4]),x=!0)},p:Me,i(e){w||(le(c.$$.fragment,e),w=!0)},o(e){ue(c.$$.fragment,e),w=!1},d(e){e&&te(r),De(c),x=!1,y()}}}function hn(n){let r,c,b,w,x,y,e=n[0].filename+"",o,h,_,l,d,g=n[0].progress+"",p,f,i,a,t=Er(n[0].speed)+"",s,u,m,S,C,v,k;w=new Fe({props:{name:n[3],size:16,color:n[2]}});let T=n[0].error&&Cr(n),B=n[0].status==="transferring"&&kr(n);return{c(){r=P("div"),c=P("div"),b=P("div"),Ae(w.$$.fragment),x=z(),y=P("span"),o=ce(e),_=z(),l=P("div"),d=P("span"),p=ce(g),f=ce("%"),i=z(),a=P("span"),s=ce(t),u=z(),m=P("div"),S=P("div"),C=z(),T&&T.c(),v=z(),B&&B.c(),E(y,"class","transfer-filename svelte-o2pr7n"),E(y,"title",h=n[0].filename),E(b,"class","transfer-info svelte-o2pr7n"),E(d,"class","transfer-status svelte-o2pr7n"),E(a,"class","transfer-speed"),E(l,"class","transfer-meta svelte-o2pr7n"),E(c,"class","transfer-header svelte-o2pr7n"),E(S,"class","progress-fill svelte-o2pr7n"),pe(S,"width",n[1]+"%"),pe(S,"background",n[2]),ht(S,"completed",n[0].status==="completed"),ht(S,"failed",n[0].status==="failed"),E(m,"class","progress-bar svelte-o2pr7n"),E(r,"class","transfer-item svelte-o2pr7n")},m(A,M){se(A,r,M),L(r,c),L(c,b),Le(w,b,null),L(b,x),L(b,y),L(y,o),L(c,_),L(c,l),L(l,d),L(d,p),L(d,f),L(l,i),L(l,a),L(a,s),L(r,u),L(r,m),L(m,S),L(r,C),T&&T.m(r,null),L(r,v),B&&B.m(r,null),k=!0},p(A,[M]){const W={};M&8&&(W.name=A[3]),M&4&&(W.color=A[2]),w.$set(W),(!k||M&1)&&e!==(e=A[0].filename+"")&&Ce(o,e),(!k||M&1&&h!==(h=A[0].filename))&&E(y,"title",h),(!k||M&1)&&g!==(g=A[0].progress+"")&&Ce(p,g),(!k||M&1)&&t!==(t=Er(A[0].speed)+"")&&Ce(s,t),(!k||M&2)&&pe(S,"width",A[1]+"%"),(!k||M&4)&&pe(S,"background",A[2]),(!k||M&1)&&ht(S,"completed",A[0].status==="completed"),(!k||M&1)&&ht(S,"failed",A[0].status==="failed"),A[0].error?T?T.p(A,M):(T=Cr(A),T.c(),T.m(r,v)):T&&(T.d(1),T=null),A[0].status==="transferring"?B?(B.p(A,M),M&1&&le(B,1)):(B=kr(A),B.c(),le(B,1),B.m(r,null)):B&&(tt(),ue(B,1,1,()=>{B=null}),rt())},i(A){k||(le(w.$$.fragment,A),le(B),k=!0)},o(A){ue(w.$$.fragment,A),ue(B),k=!1},d(A){A&&te(r),De(w),T&&T.d(),B&&B.d()}}}function Er(n){if(!n||n===0)return"";const r=["B/s","KB/s","MB/s","GB/s"],c=1024,b=Math.floor(Math.log(n)/Math.log(c));return parseFloat((n/Math.pow(c,b)).toFixed(1))+" "+r[b]}function dn(n,r,c){let b,w,x,{transfer:y={transfer_id:"",filename:"",direction:"upload",progress:0,speed:0,status:"transferring",error:""}}=r;const e=tr();function o(){e("cancel",y.transfer_id)}return n.$$set=h=>{"transfer"in h&&c(0,y=h.transfer)},n.$$.update=()=>{n.$$.dirty&1&&c(3,b={uploading:"upload",downloading:"download",completed:"check",failed:"alert",cancelled:"close"}[y.status]||"upload"),n.$$.dirty&1&&c(2,w={uploading:"var(--accent-primary)",downloading:"var(--accent-primary)",completed:"var(--accent-success)",failed:"var(--accent-error)",cancelled:"var(--text-tertiary)"}[y.status]||"var(--accent-primary)"),n.$$.dirty&1&&c(1,x=Math.min(100,Math.max(0,y.progress||0)))},[y,x,w,b,o]}class un extends Qe{constructor(r){super(),Ze(this,r,dn,hn,Ye,{transfer:0})}}function xr(n){let r,c,b,w,x,y,e,o,h,_,l,d,g,p,f,i,a,t,s,u,m,S,C,v,k,T,B;return o=new Fe({props:{name:"close",size:18}}),{c(){r=P("div"),c=P("div"),b=P("div"),w=P("h2"),x=ce(n[2]),y=z(),e=P("button"),Ae(o.$$.fragment),h=z(),_=P("div"),l=P("label"),d=ce(n[3]),g=z(),p=P("input"),f=z(),i=P("div"),a=P("button"),t=ce(n[6]),s=z(),u=P("button"),m=ce(n[5]),E(w,"class","modal-title svelte-kiemj5"),E(e,"class","modal-close svelte-kiemj5"),E(e,"aria-label","关闭"),E(b,"class","modal-header svelte-kiemj5"),E(l,"class","input-label svelte-kiemj5"),E(l,"for","modal-input"),E(p,"id","modal-input"),E(p,"type","text"),E(p,"class","input-field svelte-kiemj5"),E(p,"placeholder",n[4]),E(_,"class","modal-body svelte-kiemj5"),E(a,"class","btn btn-secondary svelte-kiemj5"),E(u,"class","btn btn-primary svelte-kiemj5"),u.disabled=S=!n[0].trim(),E(i,"class","modal-footer svelte-kiemj5"),E(c,"class","modal-content svelte-kiemj5"),E(r,"class","modal-backdrop svelte-kiemj5"),E(r,"role","dialog"),E(r,"aria-modal","true")},m(A,M){se(A,r,M),L(r,c),L(c,b),L(b,w),L(w,x),L(b,y),L(b,e),Le(o,e,null),L(c,h),L(c,_),L(_,l),L(l,d),L(_,g),L(_,p),n[12](p),Ee(p,n[0]),L(c,f),L(c,i),L(i,a),L(a,t),L(i,s),L(i,u),L(u,m),k=!0,T||(B=[ee(e,"click",n[9]),ee(p,"input",n[13]),ee(p,"keydown",n[11]),ee(a,"click",n[9]),ee(u,"click",n[8]),ee(r,"click",n[10]),ee(r,"keydown",n[11])],T=!0)},p(A,M){(!k||M&4)&&Ce(x,A[2]),(!k||M&8)&&Ce(d,A[3]),(!k||M&16)&&E(p,"placeholder",A[4]),M&1&&p.value!==A[0]&&Ee(p,A[0]),(!k||M&64)&&Ce(t,A[6]),(!k||M&32)&&Ce(m,A[5]),(!k||M&1&&S!==(S=!A[0].trim()))&&(u.disabled=S)},i(A){k||(le(o.$$.fragment,A),A&&Ue(()=>{k&&(C||(C=it(c,pt,{y:-20,duration:200},!0)),C.run(1))}),A&&Ue(()=>{k&&(v||(v=it(r,gt,{duration:150},!0)),v.run(1))}),k=!0)},o(A){ue(o.$$.fragment,A),A&&(C||(C=it(c,pt,{y:-20,duration:200},!1)),C.run(0)),A&&(v||(v=it(r,gt,{duration:150},!1)),v.run(0)),k=!1},d(A){A&&te(r),De(o),n[12](null),A&&C&&C.end(),A&&v&&v.end(),T=!1,Ie(B)}}}function fn(n){let r,c,b=n[1]&&xr(n);return{c(){b&&b.c(),r=xt()},m(w,x){b&&b.m(w,x),se(w,r,x),c=!0},p(w,[x]){w[1]?b?(b.p(w,x),x&2&&le(b,1)):(b=xr(w),b.c(),le(b,1),b.m(r.parentNode,r)):b&&(tt(),ue(b,1,1,()=>{b=null}),rt())},i(w){c||(le(b),c=!0)},o(w){ue(b),c=!1},d(w){w&&te(r),b&&b.d(w)}}}function _n(n,r,c){let{visible:b=!1}=r,{title:w=""}=r,{label:x=""}=r,{value:y=""}=r,{placeholder:e=""}=r,{confirmButtonText:o="确定"}=r,{cancelButtonText:h="取消"}=r;const _=tr();let l;function d(){y.trim()&&_("confirm",y.trim())}function g(){_("close")}function p(t){t.target===t.currentTarget&&g()}function f(t){t.key==="Escape"?g():t.key==="Enter"&&(t.preventDefault(),d())}function i(t){je[t?"unshift":"push"](()=>{l=t,c(7,l)})}function a(){y=this.value,c(0,y)}return n.$$set=t=>{"visible"in t&&c(1,b=t.visible),"title"in t&&c(2,w=t.title),"label"in t&&c(3,x=t.label),"value"in t&&c(0,y=t.value),"placeholder"in t&&c(4,e=t.placeholder),"confirmButtonText"in t&&c(5,o=t.confirmButtonText),"cancelButtonText"in t&&c(6,h=t.cancelButtonText)},n.$$.update=()=>{n.$$.dirty&130&&b&&l&&setTimeout(()=>l.focus(),50)},[y,b,w,x,e,o,h,l,d,g,p,f,i,a]}class Kt extends Qe{constructor(r){super(),Ze(this,r,_n,fn,Ye,{visible:1,title:2,label:3,value:0,placeholder:4,confirmButtonText:5,cancelButtonText:6})}}function Lr(n,r,c){const b=n.slice();return b[56]=r[c],b}function Dr(n,r,c){const b=n.slice();return b[59]=r[c],b}function Rr(n,r,c){const b=n.slice();return b[62]=r[c],b[64]=c,b}function pn(n){let r,c,b,w,x,y,e,o,h,_,l,d,g,p,f,i,a,t,s,u,m,S,C,v,k,T,B,A,M,W,N,G,X,K,D,O,I,H,q,V,Q,U,F,R,$,j,Y,Z,he,me,ye,fe,ne,xe,be,We,Pe=Object.keys(n[6]).length>0,we,J,oe,de;e=new Fe({props:{name:"home",size:16}});let ve=ze(n[14]),Se=[];for(let ie=0;ie<ve.length;ie+=1)Se[ie]=Ar(Rr(n,ve,ie));const He=ie=>ue(Se[ie],1,1,()=>{Se[ie]=null});d=new Fe({props:{name:"chevronLeft",size:18}}),a=new Fe({props:{name:"upload",size:16}}),S=new Fe({props:{name:"download",size:16}}),N=new Fe({props:{name:"folder-plus",size:18}}),K=new Fe({props:{name:"edit",size:16}}),H=new Fe({props:{name:"refresh",size:16}}),Q=new Fe({props:{name:"search",size:16}}),Y=new Fe({props:{name:"trash",size:16}});const re=[Sn,bn,mn,vn],_e=[];function ke(ie,Re){return ie[4]?0:ie[5]?1:ie[1].length===0?2:3}ne=ke(n),xe=_e[ne]=re[ne](n);let ae=n[7]&&Br(),Oe=Pe&&Tr(n);return{c(){r=P("div"),c=z(),b=P("div"),w=P("div"),x=P("div"),y=P("button"),Ae(e.$$.fragment),o=z();for(let ie=0;ie<Se.length;ie+=1)Se[ie].c();h=z(),_=P("div"),l=P("button"),Ae(d.$$.fragment),g=z(),p=P("div"),f=P("div"),i=P("button"),Ae(a.$$.fragment),t=z(),s=P("span"),s.textContent="上传",u=z(),m=P("button"),Ae(S.$$.fragment),C=z(),v=P("span"),v.textContent="下载",T=z(),B=P("div"),A=z(),M=P("div"),W=P("button"),Ae(N.$$.fragment),G=z(),X=P("button"),Ae(K.$$.fragment),O=z(),I=P("button"),Ae(H.$$.fragment),q=z(),V=P("button"),Ae(Q.$$.fragment),U=z(),F=P("div"),R=z(),$=P("div"),j=P("button"),Ae(Y.$$.fragment),he=z(),me=P("div"),me.innerHTML='<div class="col-icon"></div> <div class="col-name">名称</div> <div class="col-size svelte-1y3ch05">大小</div> <div class="col-date svelte-1y3ch05">修改时间</div>',ye=z(),fe=P("div"),xe.c(),be=z(),ae&&ae.c(),We=z(),Oe&&Oe.c(),E(r,"class","file-resizer svelte-1y3ch05"),ht(r,"dragging",n[13]),E(y,"class","breadcrumb-item home svelte-1y3ch05"),E(y,"title","根目录"),E(x,"class","breadcrumb svelte-1y3ch05"),E(l,"class","action-btn svelte-1y3ch05"),E(l,"title","折叠"),E(_,"class","header-actions svelte-1y3ch05"),E(w,"class","header svelte-1y3ch05"),E(i,"title","上传文件"),E(i,"class","toolbar-btn svelte-1y3ch05"),m.disabled=k=n[3].size===0,E(m,"title","下载选中文件"),E(m,"class","toolbar-btn svelte-1y3ch05"),E(f,"class","toolbar-group svelte-1y3ch05"),E(B,"class","toolbar-divider svelte-1y3ch05"),E(W,"title","新建文件夹"),E(W,"class","toolbar-btn icon-only svelte-1y3ch05"),X.disabled=D=n[3].size!==1,E(X,"title","重命名"),E(X,"class","toolbar-btn icon-only svelte-1y3ch05"),E(I,"title","刷新"),E(I,"class","toolbar-btn icon-only svelte-1y3ch05"),E(V,"title","跳转到路径"),E(V,"class","toolbar-btn icon-only svelte-1y3ch05"),E(M,"class","toolbar-group svelte-1y3ch05"),E(F,"class","toolbar-spacer svelte-1y3ch05"),j.disabled=Z=n[3].size===0,E(j,"title","删除"),E(j,"class","toolbar-btn toolbar-btn-danger icon-only svelte-1y3ch05"),E($,"class","toolbar-group svelte-1y3ch05"),E(p,"class","toolbar svelte-1y3ch05"),E(me,"class","file-list-header svelte-1y3ch05"),E(fe,"class","file-list-container svelte-1y3ch05"),ht(fe,"drag-over",n[7]),E(b,"class","file-panel expanded svelte-1y3ch05"),pe(b,"width",n[2]+"px")},m(ie,Re){se(ie,r,Re),se(ie,c,Re),se(ie,b,Re),L(b,w),L(w,x),L(x,y),Le(e,y,null),L(x,o);for(let et=0;et<Se.length;et+=1)Se[et]&&Se[et].m(x,null);L(w,h),L(w,_),L(_,l),Le(d,l,null),L(b,g),L(b,p),L(p,f),L(f,i),Le(a,i,null),L(i,t),L(i,s),L(f,u),L(f,m),Le(S,m,null),L(m,C),L(m,v),L(p,T),L(p,B),L(p,A),L(p,M),L(M,W),Le(N,W,null),L(M,G),L(M,X),Le(K,X,null),L(M,O),L(M,I),Le(H,I,null),L(M,q),L(M,V),Le(Q,V,null),L(p,U),L(p,F),L(p,R),L(p,$),L($,j),Le(Y,j,null),L(b,he),L(b,me),L(b,ye),L(b,fe),_e[ne].m(fe,null),L(fe,be),ae&&ae.m(fe,null),L(b,We),Oe&&Oe.m(b,null),J=!0,oe||(de=[ee(r,"mousedown",n[17]),ee(y,"click",n[36]),ee(l,"click",n[16]),ee(i,"click",n[20]),ee(m,"click",n[21]),ee(W,"click",n[38]),ee(X,"click",n[23]),ee(I,"click",n[27]),ee(V,"click",n[39]),ee(j,"click",n[22]),ee(fe,"drop",n[31]),ee(fe,"dragover",n[29]),ee(fe,"dragleave",n[30])],oe=!0)},p(ie,Re){if((!J||Re[0]&8192)&&ht(r,"dragging",ie[13]),Re[0]&268451840){ve=ze(ie[14]);let Ne;for(Ne=0;Ne<ve.length;Ne+=1){const ot=Rr(ie,ve,Ne);Se[Ne]?(Se[Ne].p(ot,Re),le(Se[Ne],1)):(Se[Ne]=Ar(ot),Se[Ne].c(),le(Se[Ne],1),Se[Ne].m(x,null))}for(tt(),Ne=ve.length;Ne<Se.length;Ne+=1)He(Ne);rt()}(!J||Re[0]&8&&k!==(k=ie[3].size===0))&&(m.disabled=k),(!J||Re[0]&8&&D!==(D=ie[3].size!==1))&&(X.disabled=D),(!J||Re[0]&8&&Z!==(Z=ie[3].size===0))&&(j.disabled=Z);let et=ne;ne=ke(ie),ne===et?_e[ne].p(ie,Re):(tt(),ue(_e[et],1,1,()=>{_e[et]=null}),rt(),xe=_e[ne],xe?xe.p(ie,Re):(xe=_e[ne]=re[ne](ie),xe.c()),le(xe,1),xe.m(fe,be)),ie[7]?ae?Re[0]&128&&le(ae,1):(ae=Br(),ae.c(),le(ae,1),ae.m(fe,null)):ae&&(tt(),ue(ae,1,1,()=>{ae=null}),rt()),(!J||Re[0]&128)&&ht(fe,"drag-over",ie[7]),Re[0]&64&&(Pe=Object.keys(ie[6]).length>0),Pe?Oe?(Oe.p(ie,Re),Re[0]&64&&le(Oe,1)):(Oe=Tr(ie),Oe.c(),le(Oe,1),Oe.m(b,null)):Oe&&(tt(),ue(Oe,1,1,()=>{Oe=null}),rt()),(!J||Re[0]&4)&&pe(b,"width",ie[2]+"px")},i(ie){if(!J){le(e.$$.fragment,ie);for(let Re=0;Re<ve.length;Re+=1)le(Se[Re]);le(d.$$.fragment,ie),le(a.$$.fragment,ie),le(S.$$.fragment,ie),le(N.$$.fragment,ie),le(K.$$.fragment,ie),le(H.$$.fragment,ie),le(Q.$$.fragment,ie),le(Y.$$.fragment,ie),le(xe),le(ae),le(Oe),ie&&Ue(()=>{J&&(we||(we=it(b,pt,{x:-20,duration:200},!0)),we.run(1))}),J=!0}},o(ie){ue(e.$$.fragment,ie),Se=Se.filter(Boolean);for(let Re=0;Re<Se.length;Re+=1)ue(Se[Re]);ue(d.$$.fragment,ie),ue(a.$$.fragment,ie),ue(S.$$.fragment,ie),ue(N.$$.fragment,ie),ue(K.$$.fragment,ie),ue(H.$$.fragment,ie),ue(Q.$$.fragment,ie),ue(Y.$$.fragment,ie),ue(xe),ue(ae),ue(Oe),ie&&(we||(we=it(b,pt,{x:-20,duration:200},!1)),we.run(0)),J=!1},d(ie){ie&&(te(r),te(c),te(b)),De(e),ei(Se,ie),De(d),De(a),De(S),De(N),De(K),De(H),De(Q),De(Y),_e[ne].d(),ae&&ae.d(),Oe&&Oe.d(),ie&&we&&we.end(),oe=!1,Ie(de)}}}function gn(n){let r,c,b,w,x,y,e,o,h,_,l;return w=new Fe({props:{name:"folder",size:24,color:"var(--text-secondary)"}}),e=new Fe({props:{name:"menu",size:20}}),{c(){r=P("div"),c=P("div"),b=P("div"),Ae(w.$$.fragment),x=z(),y=P("button"),Ae(e.$$.fragment),E(b,"class","sidebar-icon svelte-1y3ch05"),E(b,"title","点击展开"),E(b,"role","button"),E(b,"tabindex","0"),E(y,"class","expand-btn svelte-1y3ch05"),E(y,"title","展开"),E(c,"class","collapsed-content svelte-1y3ch05"),E(r,"class","file-panel collapsed svelte-1y3ch05")},m(d,g){se(d,r,g),L(r,c),L(c,b),Le(w,b,null),L(c,x),L(c,y),Le(e,y,null),h=!0,_||(l=[ee(b,"click",n[16]),ee(b,"keydown",n[35]),ee(y,"click",n[16])],_=!0)},p:Me,i(d){h||(le(w.$$.fragment,d),le(e.$$.fragment,d),d&&Ue(()=>{h&&(o||(o=it(r,pt,{x:-20,duration:200},!0)),o.run(1))}),h=!0)},o(d){ue(w.$$.fragment,d),ue(e.$$.fragment,d),d&&(o||(o=it(r,pt,{x:-20,duration:200},!1)),o.run(0)),h=!1},d(d){d&&te(r),De(w),De(e),d&&o&&o.end(),_=!1,Ie(l)}}}function Ar(n){let r,c,b,w=n[62]+"",x,y,e,o,h;r=new Fe({props:{name:"chevronRight",size:14,color:"var(--text-secondary)",className:"separator"}});function _(){return n[37](n[64])}return{c(){Ae(r.$$.fragment),c=z(),b=P("button"),x=ce(w),y=z(),E(b,"class","breadcrumb-item svelte-1y3ch05")},m(l,d){Le(r,l,d),se(l,c,d),se(l,b,d),L(b,x),L(b,y),e=!0,o||(h=ee(b,"click",_),o=!0)},p(l,d){n=l,(!e||d[0]&16384)&&w!==(w=n[62]+"")&&Ce(x,w)},i(l){e||(le(r.$$.fragment,l),e=!0)},o(l){ue(r.$$.fragment,l),e=!1},d(l){l&&(te(c),te(b)),De(r,l),o=!1,h()}}}function vn(n){let r,c=[],b=new Map,w,x=ze(n[15]);const y=e=>e[59].path;for(let e=0;e<x.length;e+=1){let o=Dr(n,x,e),h=y(o);b.set(h,c[e]=Mr(h,o))}return{c(){r=P("div");for(let e=0;e<c.length;e+=1)c[e].c();E(r,"class","file-list svelte-1y3ch05")},m(e,o){se(e,r,o);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(r,null);w=!0},p(e,o){o[0]&819208&&(x=ze(e[15]),tt(),c=Lt(c,o,y,1,e,x,b,r,sr,Mr,null,Dr),rt())},i(e){if(!w){for(let o=0;o<x.length;o+=1)le(c[o]);w=!0}},o(e){for(let o=0;o<c.length;o+=1)ue(c[o]);w=!1},d(e){e&&te(r);for(let o=0;o<c.length;o+=1)c[o].d()}}}function mn(n){let r,c,b,w,x,y;return c=new Fe({props:{name:"folder",size:48,color:"var(--bg-input)"}}),{c(){r=P("div"),Ae(c.$$.fragment),b=z(),w=P("p"),w.textContent="此目录为空",E(w,"class","svelte-1y3ch05"),E(r,"class","state-container empty svelte-1y3ch05")},m(e,o){se(e,r,o),Le(c,r,null),L(r,b),L(r,w),y=!0},p:Me,i(e){y||(le(c.$$.fragment,e),e&&(x||Ue(()=>{x=rr(r,gt,{}),x.start()})),y=!0)},o(e){ue(c.$$.fragment,e),y=!1},d(e){e&&te(r),De(c)}}}function bn(n){let r,c,b,w,x,y,e,o,h,_,l;return c=new Fe({props:{name:"close",size:32,color:"var(--accent-error)"}}),{c(){r=P("div"),Ae(c.$$.fragment),b=z(),w=P("p"),x=ce(n[5]),y=z(),e=P("button"),e.textContent="重试",E(w,"class","svelte-1y3ch05"),E(e,"class","retry-btn svelte-1y3ch05"),E(r,"class","state-container error svelte-1y3ch05")},m(d,g){se(d,r,g),Le(c,r,null),L(r,b),L(r,w),L(w,x),L(r,y),L(r,e),h=!0,_||(l=ee(e,"click",n[27]),_=!0)},p(d,g){(!h||g[0]&32)&&Ce(x,d[5])},i(d){h||(le(c.$$.fragment,d),d&&(o||Ue(()=>{o=rr(r,gt,{}),o.start()})),h=!0)},o(d){ue(c.$$.fragment,d),h=!1},d(d){d&&te(r),De(c),_=!1,l()}}}function Sn(n){let r,c;return{c(){r=P("div"),r.innerHTML='<div class="spinner svelte-1y3ch05"></div> <p class="svelte-1y3ch05">正在加载目录...</p>',E(r,"class","state-container loading svelte-1y3ch05")},m(b,w){se(b,r,w)},p:Me,i(b){b&&(c||Ue(()=>{c=rr(r,gt,{}),c.start()}))},o:Me,d(b){b&&te(r)}}}function Mr(n,r){let c,b,w;return b=new cn({props:{file:r[59],selected:r[3].has(r[59].path)}}),b.$on("click",r[18]),b.$on("dblclick",r[19]),b.$on("contextmenu",Cn),{key:n,first:null,c(){c=xt(),Ae(b.$$.fragment),this.first=c},m(x,y){se(x,c,y),Le(b,x,y),w=!0},p(x,y){r=x;const e={};y[0]&32768&&(e.file=r[59]),y[0]&32776&&(e.selected=r[3].has(r[59].path)),b.$set(e)},i(x){w||(le(b.$$.fragment,x),w=!0)},o(x){ue(b.$$.fragment,x),w=!1},d(x){x&&te(c),De(b,x)}}}function Br(n){let r,c,b,w,x,y,e;return b=new Fe({props:{name:"upload",size:48,color:"var(--accent-primary)"}}),{c(){r=P("div"),c=P("div"),Ae(b.$$.fragment),w=z(),x=P("div"),x.textContent="释放以上传文件",E(x,"class","drop-message svelte-1y3ch05"),E(c,"class","drop-content svelte-1y3ch05"),E(r,"class","drop-overlay svelte-1y3ch05")},m(o,h){se(o,r,h),L(r,c),Le(b,c,null),L(c,w),L(c,x),e=!0},i(o){e||(le(b.$$.fragment,o),o&&Ue(()=>{e&&(y||(y=it(r,gt,{duration:150},!0)),y.run(1))}),e=!0)},o(o){ue(b.$$.fragment,o),o&&(y||(y=it(r,gt,{duration:150},!1)),y.run(0)),e=!1},d(o){o&&te(r),De(b),o&&y&&y.end()}}}function Tr(n){let r,c,b,w,x,y=Object.keys(n[6]).length+"",e,o,h,_=[],l=new Map,d,g,p=ze(Object.values(n[6]));const f=i=>i[56].transfer_id;for(let i=0;i<p.length;i+=1){let a=Lr(n,p,i),t=f(a);l.set(t,_[i]=Or(t,a))}return{c(){r=P("div"),c=P("div"),b=P("h4"),b.textContent="传输任务",w=z(),x=P("span"),e=ce(y),o=z(),h=P("div");for(let i=0;i<_.length;i+=1)_[i].c();E(b,"class","svelte-1y3ch05"),E(x,"class","badge svelte-1y3ch05"),E(c,"class","transfers-header svelte-1y3ch05"),E(h,"class","transfer-list svelte-1y3ch05"),E(r,"class","transfers svelte-1y3ch05")},m(i,a){se(i,r,a),L(r,c),L(c,b),L(c,w),L(c,x),L(x,e),L(r,o),L(r,h);for(let t=0;t<_.length;t+=1)_[t]&&_[t].m(h,null);g=!0},p(i,a){(!g||a[0]&64)&&y!==(y=Object.keys(i[6]).length+"")&&Ce(e,y),a[0]&64|a[1]&2&&(p=ze(Object.values(i[6])),tt(),_=Lt(_,a,f,1,i,p,l,h,sr,Or,null,Lr),rt())},i(i){if(!g){for(let a=0;a<p.length;a+=1)le(_[a]);i&&Ue(()=>{g&&(d||(d=it(r,pt,{y:20,duration:200},!0)),d.run(1))}),g=!0}},o(i){for(let a=0;a<_.length;a+=1)ue(_[a]);i&&(d||(d=it(r,pt,{y:20,duration:200},!1)),d.run(0)),g=!1},d(i){i&&te(r);for(let a=0;a<_.length;a+=1)_[a].d();i&&d&&d.end()}}}function Or(n,r){let c,b,w;return b=new un({props:{transfer:r[56]}}),b.$on("cancel",r[32]),{key:n,first:null,c(){c=xt(),Ae(b.$$.fragment),this.first=c},m(x,y){se(x,c,y),Le(b,x,y),w=!0},p(x,y){r=x;const e={};y[0]&64&&(e.transfer=r[56]),b.$set(e)},i(x){w||(le(b.$$.fragment,x),w=!0)},o(x){ue(b.$$.fragment,x),w=!1},d(x){x&&te(c),De(b,x)}}}function wn(n){let r,c,b,w,x,y,e,o,h,_,l,d,g,p,f;const i=[gn,pn],a=[];function t(A,M){return A[0]?0:1}r=t(n),c=a[r]=i[r](n);function s(A){n[40](A)}function u(A){n[41](A)}let m={title:"重命名",label:"新名称：",placeholder:"输入新名称"};n[8]!==void 0&&(m.visible=n[8]),n[11]!==void 0&&(m.value=n[11]),w=new Kt({props:m}),je.push(()=>ct(w,"visible",s)),je.push(()=>ct(w,"value",u)),w.$on("confirm",n[24]);function S(A){n[42](A)}function C(A){n[43](A)}let v={title:"新建文件夹",label:"文件夹名称：",placeholder:"输入文件夹名称"};n[9]!==void 0&&(v.visible=n[9]),n[11]!==void 0&&(v.value=n[11]),o=new Kt({props:v}),je.push(()=>ct(o,"visible",S)),je.push(()=>ct(o,"value",C)),o.$on("confirm",n[25]);function k(A){n[44](A)}function T(A){n[45](A)}let B={title:"跳转到路径",label:"目标路径：",placeholder:"例如：/home/user 或 /var/log"};return n[10]!==void 0&&(B.visible=n[10]),n[12]!==void 0&&(B.value=n[12]),d=new Kt({props:B}),je.push(()=>ct(d,"visible",k)),je.push(()=>ct(d,"value",T)),d.$on("confirm",n[26]),{c(){c.c(),b=z(),Ae(w.$$.fragment),e=z(),Ae(o.$$.fragment),l=z(),Ae(d.$$.fragment)},m(A,M){a[r].m(A,M),se(A,b,M),Le(w,A,M),se(A,e,M),Le(o,A,M),se(A,l,M),Le(d,A,M),f=!0},p(A,M){let W=r;r=t(A),r===W?a[r].p(A,M):(tt(),ue(a[W],1,1,()=>{a[W]=null}),rt(),c=a[r],c?c.p(A,M):(c=a[r]=i[r](A),c.c()),le(c,1),c.m(b.parentNode,b));const N={};!x&&M[0]&256&&(x=!0,N.visible=A[8],lt(()=>x=!1)),!y&&M[0]&2048&&(y=!0,N.value=A[11],lt(()=>y=!1)),w.$set(N);const G={};!h&&M[0]&512&&(h=!0,G.visible=A[9],lt(()=>h=!1)),!_&&M[0]&2048&&(_=!0,G.value=A[11],lt(()=>_=!1)),o.$set(G);const X={};!g&&M[0]&1024&&(g=!0,X.visible=A[10],lt(()=>g=!1)),!p&&M[0]&4096&&(p=!0,X.value=A[12],lt(()=>p=!1)),d.$set(X)},i(A){f||(le(c),le(w.$$.fragment,A),le(o.$$.fragment,A),le(d.$$.fragment,A),f=!0)},o(A){ue(c),ue(w.$$.fragment,A),ue(o.$$.fragment,A),ue(d.$$.fragment,A),f=!1},d(A){A&&(te(b),te(e),te(l)),a[r].d(A),De(w,A),De(o,A),De(d,A)}}}function yn(n){return!n||n.length===0?[]:[...n].sort((r,c)=>r.is_dir&&!c.is_dir?-1:!r.is_dir&&c.is_dir?1:r.name.localeCompare(c.name))}const Cn=n=>{};function kn(n,r,c){let b,w,{activeSessionId:x=null}=r,y=!0,e=400,o="/",h=[],_=new Set,l=!1,d=null,g={},p=!1,f=!1,i=!1,a=!1,t=null,s="",u="",m=!1,S=0,C=0,v=[];const k=st.subscribe(J=>{if(c(0,y=J.collapsed),c(2,e=J.width),c(6,g=J.transfers),x&&J.sessionStates[x]){const oe=J.sessionStates[x];c(34,o=oe.currentPath||"/"),c(1,h=oe.files||[]),c(3,_=new Set(oe.selectedFiles||[]))}});async function T(J){if(x){c(4,l=!0),c(5,d=null);try{const oe=await vi(x,J);c(1,h=oe||[]),c(34,o=J),st.setSessionState(x,{currentPath:J,files:h,selectedFiles:[]}),_.clear()}catch(oe){console.error("Failed to load directory:",oe),c(5,d=oe.message||"加载目录失败")}finally{c(4,l=!1)}}}async function B(){await st.setCollapsed(!y)}function A(J){c(13,m=!0),S=J.clientX,C=e,document.addEventListener("mousemove",M),document.addEventListener("mouseup",W),document.body.style.userSelect="none",document.body.style.cursor="col-resize"}function M(J){if(!m)return;const oe=S-J.clientX,de=Math.max(350,Math.min(800,C+oe));c(2,e=de)}async function W(){c(13,m=!1),document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",W),document.body.style.userSelect="",document.body.style.cursor="",await st.setWidth(e)}function N(J){const{file:oe,event:de}=J.detail;de.ctrlKey||de.metaKey?(_.has(oe.path)?_.delete(oe.path):_.add(oe.path),c(3,_)):(_.clear(),_.add(oe.path),c(3,_)),st.setSessionState(x,{selectedFiles:Array.from(_)})}function G(J){const oe=J.detail;oe.is_dir&&T(oe.path)}async function X(){try{const J=await Si();if(!J||J.length===0)return;(await Xt(x,J,o)).forEach(de=>j(de)),setTimeout(()=>T(o),2e3)}catch(J){console.error("Upload failed:",J),await at("上传失败",J.message||"上传文件时发生错误")}}async function K(){if(_.size!==0)try{const J=await bi();if(!J)return;const oe=Array.from(_);(await gi(x,oe,J)).forEach(ve=>j(ve))}catch(J){console.error("Download failed:",J),await at("下载失败",J.message||"下载文件时发生错误")}}async function D(){if(_.size!==0)try{if(!await wi("确认删除",`确定要删除选中的 ${_.size} 个项目吗？`))return;await pi(x,Array.from(_)),_.clear(),await T(o)}catch(J){console.error("Delete failed:",J),await at("删除失败",J.message||"删除文件时发生错误")}}function O(){if(_.size!==1)return;const J=Array.from(_)[0],oe=h.find(de=>de.path===J);oe&&(t=oe,c(11,s=oe.name),c(8,f=!0))}async function I(J){const oe=J.detail;if(!(!t||!oe)){try{const ve=(o.endsWith("/")?o:o+"/")+oe;await mi(x,t.path,ve),await T(o)}catch(de){console.error("Rename failed:",de),await at("重命名失败",de.message||"重命名时发生错误")}t=null,c(11,s="")}}async function H(J){const oe=J.detail;if(oe)try{const ve=(o.endsWith("/")?o:o+"/")+oe;await _i(x,ve),await T(o)}catch(de){console.error("Create directory failed:",de),await at("创建文件夹失败",de.message||"创建文件夹时发生错误")}}async function q(J){const oe=J.detail;if(oe)try{const de=oe.startsWith("/")?oe:"/"+oe;await T(de),c(12,u="")}catch(de){console.error("Go to path failed:",de),await at("跳转失败",de.message||"无法访问该路径")}}async function V(){await T(o)}function Q(J){T(J)}function U(J){if(J===-1)Q("/");else{const oe="/"+w.slice(0,J+1).join("/");Q(oe)}}function F(J){J.preventDefault(),J.stopPropagation(),c(7,p=!0)}function R(J){J.target===J.currentTarget&&c(7,p=!1)}async function $(J){J.preventDefault(),J.stopPropagation(),c(7,p=!1);const oe=J.dataTransfer.files;if(!oe||oe.length===0){console.warn("No files in drop event"),await at("拖放失败",`请使用上传按钮选择文件。

注意：由于 Wails 框架限制，拖放文件功能可能无法使用。`);return}const de=[];for(let ve=0;ve<oe.length;ve++){const Se=oe[ve];Se.path&&de.push(Se.path)}if(de.length===0){console.warn("Cannot access file paths from drop event in Wails"),await at("拖放功能不可用",`抱歉，Wails 应用暂不支持拖放上传。

请点击工具栏的"上传"按钮选择文件。`);return}try{(await Xt(x,de,o)).forEach(Se=>j(Se)),setTimeout(()=>T(o),2e3)}catch(ve){console.error("Drop upload failed:",ve),await at("上传失败",ve.message||"上传文件时发生错误")}}function j(J){const oe=`sftp:progress:${J}`,de=di(oe,ve=>{st.updateTransfer(J,ve),(ve.status==="completed"||ve.status==="failed")&&setTimeout(()=>{st.removeTransfer(J)},3e3)});v.push(de)}async function Y(J){const oe=J.detail;try{await fi(oe)}catch(de){console.error("Cancel transfer failed:",de)}}Tt(async()=>{await st.init()}),Nt(()=>{k(),v.forEach(J=>J())});const Z=J=>J.key==="Enter"&&B(),he=()=>U(-1),me=J=>U(J),ye=()=>c(9,i=!0),fe=()=>c(10,a=!0);function ne(J){f=J,c(8,f)}function xe(J){s=J,c(11,s)}function be(J){i=J,c(9,i)}function We(J){s=J,c(11,s)}function Pe(J){a=J,c(10,a)}function we(J){u=J,c(12,u)}return n.$$set=J=>{"activeSessionId"in J&&c(33,x=J.activeSessionId)},n.$$.update=()=>{n.$$.dirty[0]&1|n.$$.dirty[1]&12&&x&&!y&&T(o),n.$$.dirty[0]&2&&c(15,b=yn(h)),n.$$.dirty[1]&8&&c(14,w=o.split("/").filter(J=>J))},[y,h,e,_,l,d,g,p,f,i,a,s,u,m,w,b,B,A,N,G,X,K,D,O,I,H,q,V,U,F,R,$,Y,x,o,Z,he,me,ye,fe,ne,xe,be,We,Pe,we]}class En extends Qe{constructor(r){super(),Ze(this,r,kn,wn,Ye,{activeSessionId:33},null,[-1,-1,-1])}}function xn(n){let r,c,b,w,x,y=n[1]?"实时数据获取中...":"请先连接到服务器",e,o,h,_,l,d,g,p,f=n[0].cpu+"",i,a,t,s,u,m,S,C,v,k,T=n[0].memory+"",B,A,M,W,N,G,X,K,D,O,I=n[0].disk+"",H,q,V,Q,U,F,R,$,j,Y,Z,he,me,ye,fe,ne,xe=n[0].network.in.toFixed(1)+"",be,We,Pe,we,J,oe,de,ve=n[0].network.out.toFixed(1)+"",Se,He,re,_e;return{c(){r=P("div"),c=P("div"),b=P("h3"),b.textContent="服务器监控",w=z(),x=P("div"),e=ce(y),o=z(),h=P("div"),_=P("div"),l=P("div"),d=P("div"),d.innerHTML='<div class="p-1.5 bg-purple-100 dark:bg-purple-900 rounded-lg"><svg class="w-3.5 h-3.5 text-purple-600 dark:text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 002-2h2a2 2 0 002-2z"></path></svg></div> <span class="text-xs font-semibold text-gray-900 dark:text-white">CPU</span>',g=z(),p=P("span"),i=ce(f),a=ce("%"),t=z(),s=P("div"),s.textContent="CPU 图表待实现",u=z(),m=P("div"),S=P("div"),C=P("div"),C.innerHTML='<div class="p-1.5 bg-emerald-100 dark:bg-emerald-900 rounded-lg"><svg class="w-3.5 h-3.5 text-emerald-600 dark:text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 002-2h2a2 2 0 002-2z"></path></svg></div> <span class="text-xs font-semibold text-gray-900 dark:text-white">内存</span>',v=z(),k=P("span"),B=ce(T),A=ce("%"),M=z(),W=P("div"),W.textContent="内存图表待实现",N=z(),G=P("div"),X=P("div"),K=P("div"),K.innerHTML='<div class="p-1.5 bg-amber-100 dark:bg-amber-900 rounded-lg"><svg class="w-3.5 h-3.5 text-amber-600 dark:text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"></path></svg></div> <span class="text-xs font-semibold text-gray-900 dark:text-white">磁盘</span>',D=z(),O=P("span"),H=ce(I),q=ce("%"),V=z(),Q=P("div"),U=P("div"),F=z(),R=P("div"),R.innerHTML="<span>已用 156 GB</span> <span>总计 200 GB</span>",$=z(),j=P("div"),Y=P("div"),Y.innerHTML='<div class="p-1.5 bg-blue-100 dark:bg-blue-900 rounded-lg"><svg class="w-3.5 h-3.5 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"></path></svg></div> <span class="text-xs font-semibold text-gray-900 dark:text-white">网络流量</span>',Z=z(),he=P("div"),me=P("div"),ye=P("div"),ye.innerHTML='<div class="w-2 h-2 rounded-full bg-emerald-500"></div> <span class="text-xs text-gray-700 dark:text-gray-300 font-medium">入站</span>',fe=z(),ne=P("span"),be=ce(xe),We=ce(" MB/s"),Pe=z(),we=P("div"),J=P("div"),J.innerHTML='<div class="w-2 h-2 rounded-full bg-rose-500"></div> <span class="text-xs text-gray-700 dark:text-gray-300 font-medium">出站</span>',oe=z(),de=P("span"),Se=ce(ve),He=ce(" MB/s"),re=z(),_e=P("div"),_e.innerHTML='<div class="text-xs font-semibold text-gray-900 dark:text-white mb-2">系统信息</div> <div class="space-y-1.5 text-[10px]"><div class="flex justify-between py-1"><span class="text-gray-600 dark:text-gray-400">操作系统</span> <span class="text-gray-900 dark:text-white font-medium">Ubuntu 22.04 LTS</span></div> <div class="flex justify-between py-1"><span class="text-gray-600 dark:text-gray-400">内核版本</span> <span class="text-gray-900 dark:text-white font-medium">5.15.0-91-generic</span></div> <div class="flex justify-between py-1"><span class="text-gray-600 dark:text-gray-400">运行时间</span> <span class="text-gray-900 dark:text-white font-medium">15天 7小时 32分</span></div> <div class="flex justify-between py-1"><span class="text-gray-600 dark:text-gray-400">进程数</span> <span class="text-gray-900 dark:text-white font-medium">187</span></div></div>',E(b,"class","text-sm font-semibold text-gray-900 dark:text-white"),E(x,"class","text-xs text-gray-500 dark:text-gray-400 mt-1"),E(c,"class","p-3 border-b border-gray-200 dark:border-gray-700"),E(d,"class","flex items-center gap-2"),E(p,"class","text-xs font-bold px-2 py-1 rounded-lg bg-white dark:bg-gray-800"),pe(p,"color",_t(n[0].cpu)),E(l,"class","flex items-center justify-between mb-2"),E(s,"class","h-[80px] bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center text-xs text-gray-400"),E(_,"class","bg-gradient-to-br from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-xl p-3 shadow-sm border border-purple-100 dark:border-purple-800"),E(C,"class","flex items-center gap-2"),E(k,"class","text-xs font-bold px-2 py-1 rounded-lg bg-white dark:bg-gray-800"),pe(k,"color",_t(n[0].memory)),E(S,"class","flex items-center justify-between mb-2"),E(W,"class","h-[80px] bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center text-xs text-gray-400"),E(m,"class","bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 rounded-xl p-3 shadow-sm border border-emerald-100 dark:border-emerald-800"),E(K,"class","flex items-center gap-2"),E(O,"class","text-xs font-bold px-2 py-1 rounded-lg bg-white dark:bg-gray-800"),pe(O,"color",_t(n[0].disk)),E(X,"class","flex items-center justify-between mb-2"),E(U,"class","h-2 rounded-full transition-all duration-300"),pe(U,"width",n[0].disk+"%"),pe(U,"background-color",_t(n[0].disk)),E(Q,"class","w-full bg-gray-100 dark:bg-gray-700 rounded-full h-2 overflow-hidden"),E(R,"class","flex justify-between mt-2 text-[10px] text-gray-600 dark:text-gray-400"),E(G,"class","bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 rounded-xl p-3 shadow-sm border border-amber-100 dark:border-amber-800"),E(Y,"class","flex items-center gap-2 mb-3"),E(ye,"class","flex items-center gap-2"),E(ne,"class","text-xs font-mono font-bold text-gray-900 dark:text-white"),E(me,"class","flex items-center justify-between bg-white dark:bg-gray-800 rounded-lg p-2"),E(J,"class","flex items-center gap-2"),E(de,"class","text-xs font-mono font-bold text-gray-900 dark:text-white"),E(we,"class","flex items-center justify-between bg-white dark:bg-gray-800 rounded-lg p-2"),E(he,"class","space-y-2"),E(j,"class","bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl p-3 shadow-sm border border-blue-100 dark:border-blue-800"),E(_e,"class","bg-gray-50 dark:bg-gray-700 rounded-xl p-3 shadow-sm border border-gray-200 dark:border-gray-600"),E(h,"class","p-3 space-y-3"),E(r,"class","h-full flex flex-col bg-white dark:bg-gray-800 overflow-y-auto scrollbar-thin")},m(ke,ae){se(ke,r,ae),L(r,c),L(c,b),L(c,w),L(c,x),L(x,e),L(r,o),L(r,h),L(h,_),L(_,l),L(l,d),L(l,g),L(l,p),L(p,i),L(p,a),L(_,t),L(_,s),L(h,u),L(h,m),L(m,S),L(S,C),L(S,v),L(S,k),L(k,B),L(k,A),L(m,M),L(m,W),L(h,N),L(h,G),L(G,X),L(X,K),L(X,D),L(X,O),L(O,H),L(O,q),L(G,V),L(G,Q),L(Q,U),L(G,F),L(G,R),L(h,$),L(h,j),L(j,Y),L(j,Z),L(j,he),L(he,me),L(me,ye),L(me,fe),L(me,ne),L(ne,be),L(ne,We),L(he,Pe),L(he,we),L(we,J),L(we,oe),L(we,de),L(de,Se),L(de,He),L(h,re),L(h,_e)},p(ke,[ae]){ae&2&&y!==(y=ke[1]?"实时数据获取中...":"请先连接到服务器")&&Ce(e,y),ae&1&&f!==(f=ke[0].cpu+"")&&Ce(i,f),ae&1&&pe(p,"color",_t(ke[0].cpu)),ae&1&&T!==(T=ke[0].memory+"")&&Ce(B,T),ae&1&&pe(k,"color",_t(ke[0].memory)),ae&1&&I!==(I=ke[0].disk+"")&&Ce(H,I),ae&1&&pe(O,"color",_t(ke[0].disk)),ae&1&&pe(U,"width",ke[0].disk+"%"),ae&1&&pe(U,"background-color",_t(ke[0].disk)),ae&1&&xe!==(xe=ke[0].network.in.toFixed(1)+"")&&Ce(be,xe),ae&1&&ve!==(ve=ke[0].network.out.toFixed(1)+"")&&Ce(Se,ve)},i:Me,o:Me,d(ke){ke&&te(r)}}}function _t(n){return n<50?"#10b981":n<80?"#f59e0b":"#ef4444"}function Ln(n,r,c){let b={cpu:45,memory:62,disk:78,network:{in:125.5,out:89.3}},w=null,x=null;async function y(){if(!w)return;const{GetMonitoringData:e}=window.wailsBindings||{};if(typeof e=="function")try{const o=await e(w);o&&c(0,b={cpu:o.cpu||45,memory:o.memory||62,disk:o.disk||78,network:o.network||{in:125.5,out:89.3}})}catch(o){console.error("Failed to fetch monitoring data:",o)}}return Tt(()=>{const e=o=>{c(1,w=o.detail),w&&y()};return window.addEventListener("active-session-changed",e),x=setInterval(y,2e3),()=>{window.removeEventListener("active-session-changed",e),clearInterval(x)}}),Nt(()=>{x&&clearInterval(x)}),[b,w]}class Dn extends Qe{constructor(r){super(),Ze(this,r,Ln,xn,Ye,{})}}function Pr(n,r,c){const b=n.slice();return b[13]=r[c],b}function Ir(n){var B;let r,c,b,w,x,y,e,o,h,_,l,d=[],g=new Map,p,f,i,a=(((B=n[4].find(n[9]))==null?void 0:B.name)||"选择工具")+"",t,s,u,m,S=ze(n[4]);const C=A=>A[13].id;for(let A=0;A<S.length;A+=1){let M=Pr(n,S,A),W=C(M);g.set(W,d[A]=Hr(W,M))}function v(A,M){return A[1]==="json"?An:Rn}let k=v(n),T=k(n);return{c(){r=P("div"),c=P("div"),b=z(),w=P("div"),x=P("div"),y=P("div"),e=P("h3"),e.textContent="开发工具",o=z(),h=P("button"),h.innerHTML='<svg class="w-4 h-4 text-gray-500 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',_=z(),l=P("div");for(let A=0;A<d.length;A+=1)d[A].c();p=z(),f=P("div"),i=P("h2"),t=ce(a),s=z(),T.c(),E(c,"class","absolute inset-0 bg-black/20 backdrop-blur-sm"),E(e,"class","text-sm font-semibold text-gray-900 dark:text-white"),E(h,"class","p-1.5 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors"),E(y,"class","flex items-center justify-between mb-4"),E(l,"class","space-y-1"),E(x,"class","w-64 bg-gray-50 dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 p-4"),E(i,"class","text-lg font-semibold text-gray-900 dark:text-white mb-6"),E(f,"class","flex-1 p-6 overflow-y-auto"),E(w,"class","relative w-full max-w-4xl bg-white dark:bg-gray-800 rounded-2xl shadow-2xl m-4 max-h-[80vh] overflow-hidden flex"),E(r,"class","fixed inset-0 z-50 flex items-start justify-center pt-16"),E(r,"role","dialog"),E(r,"aria-modal","true")},m(A,M){se(A,r,M),L(r,c),L(r,b),L(r,w),L(w,x),L(x,y),L(y,e),L(y,o),L(y,h),L(x,_),L(x,l);for(let W=0;W<d.length;W+=1)d[W]&&d[W].m(l,null);L(w,p),L(w,f),L(f,i),L(i,t),L(f,s),T.m(f,null),u||(m=[ee(h,"click",n[7]),ee(r,"click",n[6])],u=!0)},p(A,M){var W;M&18&&(S=ze(A[4]),d=Lt(d,M,C,1,A,S,g,l,ir,Hr,null,Pr)),M&2&&a!==(a=(((W=A[4].find(A[9]))==null?void 0:W.name)||"选择工具")+"")&&Ce(t,a),k===(k=v(A))&&T?T.p(A,M):(T.d(1),T=k(A),T&&(T.c(),T.m(f,null)))},d(A){A&&te(r);for(let M=0;M<d.length;M+=1)d[M].d();T.d(),u=!1,Ie(m)}}}function Hr(n,r){let c,b,w,x,y=r[13].name+"",e,o,h,_,l,d;function g(){return r[8](r[13])}return{key:n,first:null,c(){c=P("button"),b=P("span"),b.textContent=`${r[13].icon}`,w=z(),x=P("span"),e=ce(y),h=z(),E(b,"class","text-xl"),E(x,"class",o=`text-sm font-medium ${r[1]===r[13].id?"text-gray-900 dark:text-white":"text-gray-700 dark:text-gray-300"}`),E(c,"class",_="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all "+(r[1]===r[13].id?"bg-white dark:bg-gray-800 shadow-sm border border-gray-200 dark:border-gray-700":"hover:bg-gray-100 dark:hover:bg-gray-800")),this.first=c},m(p,f){se(p,c,f),L(c,b),L(c,w),L(c,x),L(x,e),L(c,h),l||(d=ee(c,"click",g),l=!0)},p(p,f){r=p,f&2&&o!==(o=`text-sm font-medium ${r[1]===r[13].id?"text-gray-900 dark:text-white":"text-gray-700 dark:text-gray-300"}`)&&E(x,"class",o),f&2&&_!==(_="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all "+(r[1]===r[13].id?"bg-white dark:bg-gray-800 shadow-sm border border-gray-200 dark:border-gray-700":"hover:bg-gray-100 dark:hover:bg-gray-800"))&&E(c,"class",_)},d(p){p&&te(c),l=!1,d()}}}function Rn(n){var w;let r,c=((w=n[4].find(n[12]))==null?void 0:w.name)+" 功能待实现",b;return{c(){r=P("div"),b=ce(c),E(r,"class","text-center py-12 text-gray-500 dark:text-gray-400")},m(x,y){se(x,r,y),L(r,b)},p(x,y){var e;y&2&&c!==(c=((e=x[4].find(x[12]))==null?void 0:e.name)+" 功能待实现")&&Ce(b,c)},d(x){x&&te(r)}}}function An(n){let r,c,b,w,x,y,e,o,h,_,l,d,g,p;return{c(){r=P("div"),c=P("div"),b=P("label"),b.textContent="输入 JSON",w=z(),x=P("textarea"),y=z(),e=P("button"),e.textContent="格式化",o=z(),h=P("div"),_=P("label"),_.textContent="输出",l=z(),d=P("textarea"),E(b,"class","block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"),E(x,"placeholder","{&quot;name&quot;: &quot;test&quot;}"),E(x,"class","w-full h-32 px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm font-mono resize-none focus:outline-none focus:ring-2 focus:ring-purple-500 dark:text-white"),E(e,"class","w-full px-4 py-2.5 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors"),E(_,"class","block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"),d.readOnly=!0,E(d,"class","w-full h-32 px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm font-mono resize-none focus:outline-none dark:text-white"),E(r,"class","space-y-4")},m(f,i){se(f,r,i),L(r,c),L(c,b),L(c,w),L(c,x),Ee(x,n[2]),L(r,y),L(r,e),L(r,o),L(r,h),L(h,_),L(h,l),L(h,d),Ee(d,n[3]),g||(p=[ee(x,"input",n[10]),ee(e,"click",n[5]),ee(d,"input",n[11])],g=!0)},p(f,i){i&4&&Ee(x,f[2]),i&8&&Ee(d,f[3])},d(f){f&&te(r),g=!1,Ie(p)}}}function Mn(n){let r,c=n[0]&&Ir(n);return{c(){c&&c.c(),r=xt()},m(b,w){c&&c.m(b,w),se(b,r,w)},p(b,[w]){b[0]?c?c.p(b,w):(c=Ir(b),c.c(),c.m(r.parentNode,r)):c&&(c.d(1),c=null)},i:Me,o:Me,d(b){b&&te(r),c&&c.d(b)}}}function Bn(n,r,c){let{isOpen:b=!1}=r,w=null,x="",y="";const e=[{id:"json",name:"JSON 格式化",icon:"📄",color:"text-purple-600"},{id:"base64",name:"Base64 编解码",icon:"🔐",color:"text-blue-600"},{id:"hash",name:"Hash 计算",icon:"#️⃣",color:"text-green-600"},{id:"timestamp",name:"时间戳转换",icon:"🕐",color:"text-amber-600"},{id:"uuid",name:"UUID 生成",icon:"🆔",color:"text-indigo-600"}];function o(){try{const i=JSON.parse(x);c(3,y=JSON.stringify(i,null,2))}catch(i){c(3,y="JSON 格式错误: "+i.message)}}function h(i){i.target===i.currentTarget&&c(0,b=!1)}const _=()=>c(0,b=!1),l=i=>c(1,w=i.id),d=i=>i.id===w;function g(){x=this.value,c(2,x)}function p(){y=this.value,c(3,y)}const f=i=>i.id===w;return n.$$set=i=>{"isOpen"in i&&c(0,b=i.isOpen)},[b,w,x,y,e,o,h,_,l,d,g,p,f]}class Tn extends Qe{constructor(r){super(),Ze(this,r,Bn,Mn,Ye,{isOpen:0})}}function Fr(n){let r,c,b,w,x,y,e,o,h,_,l,d,g,p,f;const i=n[6].default,a=Ai(i,n,n[5],null);return{c(){r=P("div"),c=P("div"),b=z(),w=P("div"),x=P("div"),y=P("h2"),e=ce(n[2]),o=z(),h=P("button"),h.innerHTML='<svg class="w-5 h-5 text-gray-500 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',_=z(),l=P("div"),a&&a.c(),E(c,"class","absolute inset-0 bg-black/20 backdrop-blur-sm transition-opacity pointer-events-auto"),E(y,"class","text-xl font-semibold text-gray-900 dark:text-white"),E(h,"class","p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"),E(x,"class","flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"),E(l,"class","flex-1 overflow-y-auto p-6"),E(w,"class",d="relative w-60 max-w-"+n[3]+" bg-white dark:bg-gray-800 rounded-2xl shadow-2xl m-4 max-h-[90vh] overflow-hidden flex flex-col transform transition-all"),E(r,"class","fixed inset-0 z-50 flex items-center justify-center"),E(r,"role","dialog"),E(r,"aria-modal","true")},m(t,s){se(t,r,s),L(r,c),L(r,b),L(r,w),L(w,x),L(x,y),L(y,e),L(x,o),L(x,h),L(w,_),L(w,l),a&&a.m(l,null),g=!0,p||(f=[ee(h,"click",function(){vt(n[1])&&n[1].apply(this,arguments)}),ee(r,"click",n[4])],p=!0)},p(t,s){n=t,(!g||s&4)&&Ce(e,n[2]),a&&a.p&&(!g||s&32)&&Bi(a,i,n,n[5],g?Mi(i,n[5],s,null):Ti(n[5]),null),(!g||s&8&&d!==(d="relative w-60 max-w-"+n[3]+" bg-white dark:bg-gray-800 rounded-2xl shadow-2xl m-4 max-h-[90vh] overflow-hidden flex flex-col transform transition-all"))&&E(w,"class",d)},i(t){g||(le(a,t),g=!0)},o(t){ue(a,t),g=!1},d(t){t&&te(r),a&&a.d(t),p=!1,Ie(f)}}}function On(n){let r,c,b=n[0]&&Fr(n);return{c(){b&&b.c(),r=xt()},m(w,x){b&&b.m(w,x),se(w,r,x),c=!0},p(w,[x]){w[0]?b?(b.p(w,x),x&1&&le(b,1)):(b=Fr(w),b.c(),le(b,1),b.m(r.parentNode,r)):b&&(tt(),ue(b,1,1,()=>{b=null}),rt())},i(w){c||(le(b),c=!0)},o(w){ue(b),c=!1},d(w){w&&te(r),b&&b.d(w)}}}function Pn(n,r,c){let{$$slots:b={},$$scope:w}=r,{isOpen:x=!1}=r,{onClose:y=()=>{}}=r,{title:e=""}=r,{size:o="md"}=r;function h(l){l.target===l.currentTarget&&y()}function _(l){l.key==="Escape"&&x&&y()}return n.$$set=l=>{"isOpen"in l&&c(0,x=l.isOpen),"onClose"in l&&c(1,y=l.onClose),"title"in l&&c(2,e=l.title),"size"in l&&c(3,o=l.size),"$$scope"in l&&c(5,w=l.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&(x?document.addEventListener("keydown",_):document.removeEventListener("keydown",_))},[x,y,e,o,h,w,b]}class In extends Qe{constructor(r){super(),Ze(this,r,Pn,On,Ye,{isOpen:0,onClose:1,title:2,size:3})}}function Wr(n){let r,c,b,w,x,y,e,o,h,_,l,d,g,p,f,i,a;return{c(){r=P("div"),c=P("label"),c.textContent="认证方式",b=z(),w=P("div"),x=P("button"),y=P("div"),e=ce("密码"),_=z(),l=P("button"),d=P("div"),g=ce("SSH 密钥"),E(c,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),E(y,"class",o=`text-xs font-medium ${n[3]==="password"?"text-purple-700 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`),E(x,"type","button"),E(x,"class",h=`flex-1 px-3 py-1.5 rounded-md border-2 transition-all ${n[3]==="password"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`),E(d,"class",p=`text-xs font-medium ${n[3]==="key"?"text-purple-700 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`),E(l,"type","button"),E(l,"class",f=`flex-1 px-3 py-1.5 rounded-md border-2 transition-all ${n[3]==="key"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`),E(w,"class","flex gap-2")},m(t,s){se(t,r,s),L(r,c),L(r,b),L(r,w),L(w,x),L(x,y),L(y,e),L(w,_),L(w,l),L(l,d),L(d,g),i||(a=[ee(x,"click",n[20]),ee(l,"click",n[21])],i=!0)},p(t,s){s[0]&8&&o!==(o=`text-xs font-medium ${t[3]==="password"?"text-purple-700 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`)&&E(y,"class",o),s[0]&8&&h!==(h=`flex-1 px-3 py-1.5 rounded-md border-2 transition-all ${t[3]==="password"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`)&&E(x,"class",h),s[0]&8&&p!==(p=`text-xs font-medium ${t[3]==="key"?"text-purple-700 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`)&&E(d,"class",p),s[0]&8&&f!==(f=`flex-1 px-3 py-1.5 rounded-md border-2 transition-all ${t[3]==="key"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`)&&E(l,"class",f)},d(t){t&&te(r),i=!1,Ie(a)}}}function Nr(n){let r,c,b,w,x,y,e,o,h,_,l,d,g,p,f,i,a,t;function s(k,T){return k[9]?Fn:Hn}let u=s(n),m=u(n);function S(k,T){return k[9]?Nn:Wn}let C=S(n),v=C(n);return{c(){r=P("div"),c=P("label"),c.textContent="SSH 私钥文件",b=z(),w=P("div"),x=P("input"),y=z(),e=P("button"),e.textContent="选择文件",o=z(),h=P("div"),_=P("label"),_.textContent="Passphrase（可选）",l=z(),d=P("div"),m.c(),g=z(),p=P("button"),v.c(),f=z(),i=P("p"),i.textContent="如果您的 SSH 密钥文件已加密，请输入 passphrase。否则留空即可。",E(c,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),E(x,"type","text"),E(x,"placeholder","点击选择密钥文件 (例如: ~/.ssh/id_rsa)"),x.readOnly=!0,E(x,"class","flex-1 px-3 py-1.5 bg-gray-100 dark:bg-gray-600 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none transition-all"),E(e,"type","button"),E(e,"class","px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white rounded-md text-xs font-medium transition-colors whitespace-nowrap"),E(w,"class","flex gap-1.5"),E(_,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),E(p,"type","button"),E(p,"class","absolute right-2 top-1/2 transform -translate-y-1/2 p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors"),E(d,"class","relative"),E(i,"class","mt-0.5 text-[10px] text-gray-500 dark:text-gray-400")},m(k,T){se(k,r,T),L(r,c),L(r,b),L(r,w),L(w,x),Ee(x,n[4].keyPath),L(w,y),L(w,e),se(k,o,T),se(k,h,T),L(h,_),L(h,l),L(h,d),m.m(d,null),L(d,g),L(d,p),v.m(p,null),L(h,f),L(h,i),a||(t=[ee(x,"input",n[22]),ee(e,"click",n[11]),ee(p,"click",n[25])],a=!0)},p(k,T){T[0]&16&&x.value!==k[4].keyPath&&Ee(x,k[4].keyPath),u===(u=s(k))&&m?m.p(k,T):(m.d(1),m=u(k),m&&(m.c(),m.m(d,g))),C!==(C=S(k))&&(v.d(1),v=C(k),v&&(v.c(),v.m(p,null)))},d(k){k&&(te(r),te(o),te(h)),m.d(),v.d(),a=!1,Ie(t)}}}function Hn(n){let r,c,b;return{c(){r=P("input"),E(r,"type","password"),E(r,"placeholder","如果密钥已加密，请输入 passphrase"),E(r,"class","w-full px-3 py-1.5 pr-10 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all")},m(w,x){se(w,r,x),Ee(r,n[4].passphrase),c||(b=ee(r,"input",n[24]),c=!0)},p(w,x){x[0]&16&&r.value!==w[4].passphrase&&Ee(r,w[4].passphrase)},d(w){w&&te(r),c=!1,b()}}}function Fn(n){let r,c,b;return{c(){r=P("input"),E(r,"type","text"),E(r,"placeholder","如果密钥已加密，请输入 passphrase"),E(r,"class","w-full px-3 py-1.5 pr-10 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all")},m(w,x){se(w,r,x),Ee(r,n[4].passphrase),c||(b=ee(r,"input",n[23]),c=!0)},p(w,x){x[0]&16&&r.value!==w[4].passphrase&&Ee(r,w[4].passphrase)},d(w){w&&te(r),c=!1,b()}}}function Wn(n){let r,c;return{c(){r=Te("svg"),c=Te("path"),E(c,"stroke-linecap","round"),E(c,"stroke-linejoin","round"),E(c,"stroke-width","2"),E(c,"d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"),E(r,"class","w-4 h-4 text-gray-500 dark:text-gray-400"),E(r,"fill","none"),E(r,"stroke","currentColor"),E(r,"viewBox","0 0 24 24")},m(b,w){se(b,r,w),L(r,c)},d(b){b&&te(r)}}}function Nn(n){let r,c,b;return{c(){r=Te("svg"),c=Te("path"),b=Te("path"),E(c,"stroke-linecap","round"),E(c,"stroke-linejoin","round"),E(c,"stroke-width","2"),E(c,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),E(b,"stroke-linecap","round"),E(b,"stroke-linejoin","round"),E(b,"stroke-width","2"),E(b,"d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"),E(r,"class","w-4 h-4 text-gray-500 dark:text-gray-400"),E(r,"fill","none"),E(r,"stroke","currentColor"),E(r,"viewBox","0 0 24 24")},m(w,x){se(w,r,x),L(r,c),L(r,b)},d(w){w&&te(r)}}}function jr(n){let r,c,b;return{c(){r=P("div"),c=ce(n[6]),E(r,"class",b=`p-2 rounded-md text-xs ${n[6].includes("成功")?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300"}`)},m(w,x){se(w,r,x),L(r,c)},p(w,x){x[0]&64&&Ce(c,w[6]),x[0]&64&&b!==(b=`p-2 rounded-md text-xs ${w[6].includes("成功")?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300"}`)&&E(r,"class",b)},d(w){w&&te(r)}}}function zr(n){let r,c,b,w,x,y,e,o,h,_;return{c(){r=P("div"),c=P("label"),c.innerHTML='数据库类型 <span class="text-red-500">*</span>',b=z(),w=P("select"),x=P("option"),x.textContent="MySQL",y=P("option"),y.textContent="PostgreSQL",e=P("option"),e.textContent="MongoDB",o=P("option"),o.textContent="Redis",E(c,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),x.__value="mysql",Ee(x,x.__value),y.__value="postgresql",Ee(y,y.__value),e.__value="mongodb",Ee(e,e.__value),o.__value="redis",Ee(o,o.__value),E(w,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"),n[4].dbType===void 0&&Ue(()=>n[26].call(w))},m(l,d){se(l,r,d),L(r,c),L(r,b),L(r,w),L(w,x),L(w,y),L(w,e),L(w,o),cr(w,n[4].dbType,!0),h||(_=ee(w,"change",n[26]),h=!0)},p(l,d){d[0]&16&&cr(w,l[4].dbType)},d(l){l&&te(r),h=!1,_()}}}function Ur(n){let r,c,b,w,x,y;return{c(){r=P("div"),c=P("label"),c.innerHTML='用户名 <span class="text-red-500">*</span>',b=z(),w=P("input"),E(c,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),E(w,"type","text"),w.required=!0,E(w,"placeholder","root"),E(w,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all")},m(e,o){se(e,r,o),L(r,c),L(r,b),L(r,w),Ee(w,n[4].username),x||(y=ee(w,"input",n[29]),x=!0)},p(e,o){o[0]&16&&w.value!==e[4].username&&Ee(w,e[4].username)},d(e){e&&te(r),x=!1,y()}}}function $r(n){let r,c,b,w,x,y,e,o,h,_,l,d,g;function p(u,m){return u[8]?zn:jn}let f=p(n),i=f(n);function a(u,m){return u[8]?$n:Un}let t=a(n),s=t(n);return{c(){r=P("div"),c=P("label"),c.innerHTML='密码 <span class="text-red-500">*</span>',b=z(),w=P("div"),i.c(),x=z(),y=P("button"),s.c(),e=z(),o=P("div"),h=P("input"),_=z(),l=P("span"),l.textContent="保存密码",E(c,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),E(y,"type","button"),E(y,"class","absolute right-2 top-1/2 transform -translate-y-1/2 p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors"),E(w,"class","relative"),E(h,"type","checkbox"),E(h,"class","w-3.5 h-3.5 rounded border-gray-300 text-purple-600 focus:ring-purple-500"),E(l,"class","text-xs text-gray-700 dark:text-gray-300"),E(o,"class","flex items-center gap-1.5 cursor-pointer")},m(u,m){se(u,r,m),L(r,c),L(r,b),L(r,w),i.m(w,null),L(w,x),L(w,y),s.m(y,null),se(u,e,m),se(u,o,m),L(o,h),h.checked=n[4].savePassword,L(o,_),L(o,l),d||(g=[ee(y,"click",n[32]),ee(h,"change",n[33])],d=!0)},p(u,m){f===(f=p(u))&&i?i.p(u,m):(i.d(1),i=f(u),i&&(i.c(),i.m(w,x))),t!==(t=a(u))&&(s.d(1),s=t(u),s&&(s.c(),s.m(y,null))),m[0]&16&&(h.checked=u[4].savePassword)},d(u){u&&(te(r),te(e),te(o)),i.d(),s.d(),d=!1,Ie(g)}}}function jn(n){let r,c,b;return{c(){r=P("input"),E(r,"type","password"),E(r,"placeholder","输入密码"),E(r,"class","w-full px-3 py-1.5 pr-10 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all")},m(w,x){se(w,r,x),Ee(r,n[4].password),c||(b=ee(r,"input",n[31]),c=!0)},p(w,x){x[0]&16&&r.value!==w[4].password&&Ee(r,w[4].password)},d(w){w&&te(r),c=!1,b()}}}function zn(n){let r,c,b;return{c(){r=P("input"),E(r,"type","text"),E(r,"placeholder","输入密码"),E(r,"class","w-full px-3 py-1.5 pr-10 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all")},m(w,x){se(w,r,x),Ee(r,n[4].password),c||(b=ee(r,"input",n[30]),c=!0)},p(w,x){x[0]&16&&r.value!==w[4].password&&Ee(r,w[4].password)},d(w){w&&te(r),c=!1,b()}}}function Un(n){let r,c;return{c(){r=Te("svg"),c=Te("path"),E(c,"stroke-linecap","round"),E(c,"stroke-linejoin","round"),E(c,"stroke-width","2"),E(c,"d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"),E(r,"class","w-4 h-4 text-gray-500 dark:text-gray-400"),E(r,"fill","none"),E(r,"stroke","currentColor"),E(r,"viewBox","0 0 24 24")},m(b,w){se(b,r,w),L(r,c)},d(b){b&&te(r)}}}function $n(n){let r,c,b;return{c(){r=Te("svg"),c=Te("path"),b=Te("path"),E(c,"stroke-linecap","round"),E(c,"stroke-linejoin","round"),E(c,"stroke-width","2"),E(c,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),E(b,"stroke-linecap","round"),E(b,"stroke-linejoin","round"),E(b,"stroke-width","2"),E(b,"d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"),E(r,"class","w-4 h-4 text-gray-500 dark:text-gray-400"),E(r,"fill","none"),E(r,"stroke","currentColor"),E(r,"viewBox","0 0 24 24")},m(w,x){se(w,r,x),L(r,c),L(r,b)},d(w){w&&te(r)}}}function Kr(n){let r,c,b,w,x,y;return{c(){r=P("div"),c=P("label"),c.textContent="数据库名",b=z(),w=P("input"),E(c,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),E(w,"type","text"),E(w,"placeholder","例如：production_db"),E(w,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all")},m(e,o){se(e,r,o),L(r,c),L(r,b),L(r,w),Ee(w,n[4].database),x||(y=ee(w,"input",n[34]),x=!0)},p(e,o){o[0]&16&&w.value!==e[4].database&&Ee(w,e[4].database)},d(e){e&&te(r),x=!1,y()}}}function Kn(n){let r,c,b,w,x,y,e,o,h,_,l,d,g,p,f,i,a,t,s,u,m,S,C,v,k,T,B,A,M,W,N,G,X,K,D,O,I,H,q,V,Q,U,F,R,$,j,Y,Z,he,me,ye,fe,ne,xe,be,We,Pe,we,J,oe,de,ve,Se,He,re,_e,ke,ae,Oe,ie,Re=n[5]?"测试中...":"测试连接",et,Ne,ot,Ot=n[7]?"保存中...":n[1]?"更新连接":"添加连接",jt,zt,nr,$e=n[2]==="ssh"&&Wr(n),Ke=n[3]==="key"&&Nr(n),qe=n[6]&&jr(n),Ve=n[2]==="database"&&zr(n),Ge=(n[3]==="password"||n[2]==="database"||n[2]==="docker")&&Ur(n),Je=n[3]==="password"&&$r(n),Xe=n[2]==="database"&&Kr(n);return{c(){r=P("div"),c=P("label"),c.textContent="连接类型",b=z(),w=P("div"),x=P("button"),y=P("div"),e=Te("svg"),o=Te("path"),_=z(),l=P("span"),d=ce("SSH"),f=z(),i=P("button"),a=P("div"),t=Te("svg"),s=Te("path"),m=z(),S=P("span"),C=ce("数据库"),T=z(),B=P("button"),A=P("div"),M=Te("svg"),W=Te("path"),G=z(),X=P("span"),K=ce("Docker"),I=z(),H=P("form"),q=P("div"),V=P("label"),V.innerHTML='连接名称 <span class="text-red-500">*</span>',Q=z(),U=P("input"),F=z(),$e&&$e.c(),R=z(),Ke&&Ke.c(),$=z(),qe&&qe.c(),j=z(),Ve&&Ve.c(),Y=z(),Z=P("div"),he=P("div"),me=P("label"),me.innerHTML='主机地址 <span class="text-red-500">*</span>',ye=z(),fe=P("input"),ne=z(),xe=P("div"),be=P("label"),be.innerHTML='端口 <span class="text-red-500">*</span>',We=z(),Pe=P("input"),we=z(),Ge&&Ge.c(),J=z(),Je&&Je.c(),oe=z(),Xe&&Xe.c(),de=z(),ve=P("div"),Se=P("label"),Se.textContent="分组",He=z(),re=P("input"),_e=z(),ke=P("div"),ae=P("button"),ae.textContent="取消",Oe=z(),ie=P("button"),et=ce(Re),Ne=z(),ot=P("button"),jt=ce(Ot),E(c,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2"),E(o,"stroke-linecap","round"),E(o,"stroke-linejoin","round"),E(o,"stroke-width","2"),E(o,"d","M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"),E(e,"class",h=`w-4 h-4 ${n[2]==="ssh"?"text-purple-600":"text-gray-600 dark:text-gray-400"}`),E(e,"fill","none"),E(e,"stroke","currentColor"),E(e,"viewBox","0 0 24 24"),E(l,"class",g=`text-xs font-medium ${n[2]==="ssh"?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`),E(y,"class","flex items-center justify-center gap-1"),E(x,"type","button"),E(x,"class",p=`p-2 rounded-lg border-2 transition-all ${n[2]==="ssh"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`),E(s,"stroke-linecap","round"),E(s,"stroke-linejoin","round"),E(s,"stroke-width","2"),E(s,"d","M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"),E(t,"class",u=`w-4 h-4 ${n[2]==="database"?"text-purple-600":"text-gray-600 dark:text-gray-400"}`),E(t,"fill","none"),E(t,"stroke","currentColor"),E(t,"viewBox","0 0 24 24"),E(S,"class",v=`text-xs font-medium ${n[2]==="database"?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`),E(a,"class","flex items-center justify-center gap-1"),E(i,"type","button"),E(i,"class",k=`p-2 rounded-lg border-2 transition-all ${n[2]==="database"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`),E(W,"d","M13.983 11.078h2.119a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186h-2.119a.185.185 0 00-.185.185v1.888c0 .102.083.185.185.185m-2.954-3.333h2.118a.186.186 0 00.186-.186V5.671a.186.186 0 00-.186-.185h-2.118a.185.185 0 00-.185.185v1.888c0 .102.082.185.185.185m-2.954 3.333h2.118a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186H8.075a.186.186 0 00-.186.186v1.888c0 .102.083.185.186.185m-2.954-3.333h2.119a.186.186 0 00.185-.186V5.671a.185.185 0 00-.185-.185H5.12a.186.186 0 00-.186.185v1.888c0 .102.084.185.186.185m-2.93 3.333h2.12a.185.185 0 00.185-.185V9.006a.185.185 0 00-.186-.186h-2.12a.185.185 0 00-.184.186v1.888c0 .102.083.185.185.185M20.69 6.662c.057.16.09.331.09.51v7.9c0 3.058-2.724 4.928-8.78 4.928-6.055 0-8.779-1.87-8.779-4.928v-7.9c0-.179.033-.35.09-.51C1.536 7.396 0 9.522 0 12.072v3.639c0 4.072 3.608 6.789 12 6.789 8.391 0 12-2.717 12-6.79v-3.638c0-2.55-1.536-4.677-4.31-6.41"),E(M,"class",N=`w-4 h-4 ${n[2]==="docker"?"text-purple-600":"text-gray-600 dark:text-gray-400"}`),E(M,"fill","currentColor"),E(M,"viewBox","0 0 24 24"),E(X,"class",D=`text-xs font-medium ${n[2]==="docker"?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`),E(A,"class","flex items-center justify-center gap-1"),E(B,"type","button"),E(B,"class",O=`p-2 rounded-lg border-2 transition-all ${n[2]==="docker"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`),E(w,"class","grid grid-cols-3 gap-2"),E(r,"class","mb-4"),E(V,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),E(U,"type","text"),U.required=!0,E(U,"placeholder","例如：生产服务器-01"),E(U,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"),E(me,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),E(fe,"type","text"),fe.required=!0,E(fe,"placeholder","192.168.1.10 或 example.com"),E(fe,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"),E(he,"class","col-span-2"),E(be,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),E(Pe,"type","text"),Pe.required=!0,E(Pe,"placeholder",n[13]()),E(Pe,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"),E(Z,"class","grid grid-cols-3 gap-2"),E(Se,"class","block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"),E(re,"type","text"),E(re,"placeholder","例如：生产环境"),E(re,"class","w-full px-3 py-1.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"),E(ae,"type","button"),E(ae,"class","px-3 py-1.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md text-xs font-medium transition-colors"),E(ie,"type","button"),ie.disabled=n[5],E(ie,"class","px-3 py-1.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md text-xs font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed"),E(ot,"type","submit"),ot.disabled=n[7],E(ot,"class","flex-1 px-3 py-1.5 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-md text-xs font-medium transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed"),E(ke,"class","flex gap-2 pt-3"),E(H,"class","space-y-3")},m(ge,Be){se(ge,r,Be),L(r,c),L(r,b),L(r,w),L(w,x),L(x,y),L(y,e),L(e,o),L(y,_),L(y,l),L(l,d),L(w,f),L(w,i),L(i,a),L(a,t),L(t,s),L(a,m),L(a,S),L(S,C),L(w,T),L(w,B),L(B,A),L(A,M),L(M,W),L(A,G),L(A,X),L(X,K),se(ge,I,Be),se(ge,H,Be),L(H,q),L(q,V),L(q,Q),L(q,U),Ee(U,n[4].name),L(H,F),$e&&$e.m(H,null),L(H,R),Ke&&Ke.m(H,null),L(H,$),qe&&qe.m(H,null),L(H,j),Ve&&Ve.m(H,null),L(H,Y),L(H,Z),L(Z,he),L(he,me),L(he,ye),L(he,fe),Ee(fe,n[4].host),L(Z,ne),L(Z,xe),L(xe,be),L(xe,We),L(xe,Pe),Ee(Pe,n[4].port),L(H,we),Ge&&Ge.m(H,null),L(H,J),Je&&Je.m(H,null),L(H,oe),Xe&&Xe.m(H,null),L(H,de),L(H,ve),L(ve,Se),L(ve,He),L(ve,re),Ee(re,n[4].group),L(H,_e),L(H,ke),L(ke,ae),L(ke,Oe),L(ke,ie),L(ie,et),L(ke,Ne),L(ke,ot),L(ot,jt),zt||(nr=[ee(x,"click",n[16]),ee(i,"click",n[17]),ee(B,"click",n[18]),ee(U,"input",n[19]),ee(fe,"input",n[27]),ee(Pe,"input",n[28]),ee(re,"input",n[35]),ee(ae,"click",n[36]),ee(ie,"click",n[10]),ee(H,"submit",Hi(n[12]))],zt=!0)},p(ge,Be){Be[0]&4&&h!==(h=`w-4 h-4 ${ge[2]==="ssh"?"text-purple-600":"text-gray-600 dark:text-gray-400"}`)&&E(e,"class",h),Be[0]&4&&g!==(g=`text-xs font-medium ${ge[2]==="ssh"?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`)&&E(l,"class",g),Be[0]&4&&p!==(p=`p-2 rounded-lg border-2 transition-all ${ge[2]==="ssh"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`)&&E(x,"class",p),Be[0]&4&&u!==(u=`w-4 h-4 ${ge[2]==="database"?"text-purple-600":"text-gray-600 dark:text-gray-400"}`)&&E(t,"class",u),Be[0]&4&&v!==(v=`text-xs font-medium ${ge[2]==="database"?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`)&&E(S,"class",v),Be[0]&4&&k!==(k=`p-2 rounded-lg border-2 transition-all ${ge[2]==="database"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`)&&E(i,"class",k),Be[0]&4&&N!==(N=`w-4 h-4 ${ge[2]==="docker"?"text-purple-600":"text-gray-600 dark:text-gray-400"}`)&&E(M,"class",N),Be[0]&4&&D!==(D=`text-xs font-medium ${ge[2]==="docker"?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`)&&E(X,"class",D),Be[0]&4&&O!==(O=`p-2 rounded-lg border-2 transition-all ${ge[2]==="docker"?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`)&&E(B,"class",O),Be[0]&16&&U.value!==ge[4].name&&Ee(U,ge[4].name),ge[2]==="ssh"?$e?$e.p(ge,Be):($e=Wr(ge),$e.c(),$e.m(H,R)):$e&&($e.d(1),$e=null),ge[3]==="key"?Ke?Ke.p(ge,Be):(Ke=Nr(ge),Ke.c(),Ke.m(H,$)):Ke&&(Ke.d(1),Ke=null),ge[6]?qe?qe.p(ge,Be):(qe=jr(ge),qe.c(),qe.m(H,j)):qe&&(qe.d(1),qe=null),ge[2]==="database"?Ve?Ve.p(ge,Be):(Ve=zr(ge),Ve.c(),Ve.m(H,Y)):Ve&&(Ve.d(1),Ve=null),Be[0]&16&&fe.value!==ge[4].host&&Ee(fe,ge[4].host),Be[0]&16&&Pe.value!==ge[4].port&&Ee(Pe,ge[4].port),ge[3]==="password"||ge[2]==="database"||ge[2]==="docker"?Ge?Ge.p(ge,Be):(Ge=Ur(ge),Ge.c(),Ge.m(H,J)):Ge&&(Ge.d(1),Ge=null),ge[3]==="password"?Je?Je.p(ge,Be):(Je=$r(ge),Je.c(),Je.m(H,oe)):Je&&(Je.d(1),Je=null),ge[2]==="database"?Xe?Xe.p(ge,Be):(Xe=Kr(ge),Xe.c(),Xe.m(H,de)):Xe&&(Xe.d(1),Xe=null),Be[0]&16&&re.value!==ge[4].group&&Ee(re,ge[4].group),Be[0]&32&&Re!==(Re=ge[5]?"测试中...":"测试连接")&&Ce(et,Re),Be[0]&32&&(ie.disabled=ge[5]),Be[0]&130&&Ot!==(Ot=ge[7]?"保存中...":ge[1]?"更新连接":"添加连接")&&Ce(jt,Ot),Be[0]&128&&(ot.disabled=ge[7])},d(ge){ge&&(te(r),te(I),te(H)),$e&&$e.d(),Ke&&Ke.d(),qe&&qe.d(),Ve&&Ve.d(),Ge&&Ge.d(),Je&&Je.d(),Xe&&Xe.d(),zt=!1,Ie(nr)}}}function qn(n){let r,c,b;function w(y){n[38](y)}let x={onClose:n[37],title:n[1]?"编辑连接":"添加连接",size:"sm",$$slots:{default:[Kn]},$$scope:{ctx:n}};return n[0]!==void 0&&(x.isOpen=n[0]),r=new In({props:x}),je.push(()=>ct(r,"isOpen",w)),{c(){Ae(r.$$.fragment)},m(y,e){Le(r,y,e),b=!0},p(y,e){const o={};e[0]&1&&(o.onClose=y[37]),e[0]&2&&(o.title=y[1]?"编辑连接":"添加连接"),e[0]&1023|e[1]&1024&&(o.$$scope={dirty:e,ctx:y}),!c&&e[0]&1&&(c=!0,o.isOpen=y[0],lt(()=>c=!1)),r.$set(o)},i(y){b||(le(r.$$.fragment,y),b=!0)},o(y){ue(r.$$.fragment,y),b=!1},d(y){De(r,y)}}}function Vn(n,r,c){let{isOpen:b=!1}=r,{onAdd:w=()=>{}}=r,{onUpdate:x=()=>{}}=r,{editingAsset:y=null}=r,e="ssh",o="password",h=!1,_="",l=!1,d=!1,g=!1,p={id:"",name:"",host:"",port:"",username:"",password:"",savePassword:!1,keyPath:"",passphrase:"",group:"",dbType:"mysql",database:""};async function f(){if(!window.wailsBindings){c(6,_="Wails 绑定未加载");return}if(!p.host){c(6,_="请填写主机地址");return}if(o==="password"&&!p.password){c(6,_="请输入密码以测试连接");return}if(o==="password"&&!p.username){c(6,_="请填写用户名");return}if(o==="key"&&!p.keyPath){c(6,_="请选择 SSH 密钥文件");return}c(5,h=!0),c(6,_="");try{const R=o==="key"?p.keyPath:p.password;await window.wailsBindings.TestConnection(p.host,parseInt(p.port),p.username,o,R,p.passphrase||""),c(6,_="✓ 连接成功")}catch(R){console.error("Connection test failed:",R),c(6,_="✗ 连接失败: "+R)}finally{c(5,h=!1)}}async function i(){if(!window.wailsBindings){alert("Wails 绑定未加载");return}try{const R=await window.wailsBindings.SelectSSHKeyFile();R&&c(4,p.keyPath=R,p)}catch(R){console.error("Failed to select key file:",R),c(6,_="选择密钥文件失败: "+R)}}async function a(){if(!window.wailsBindings){alert("Wails 绑定未加载");return}if(!p.name||!p.host){alert("请填写必填字段（连接名称、主机地址）");return}if(o==="password"&&!p.username){alert("密码认证需要填写用户名");return}if(o==="password"&&!p.password){alert("密码认证需要输入密码");return}if(o==="key"&&!p.keyPath){alert("密钥认证需要选择密钥文件");return}c(7,l=!0);try{const R=!!p.id,$={id:R?p.id:`conn_${Date.now()}`,name:p.name,host:p.host,port:parseInt(p.port),user:p.username,auth_type:o,key_path:o==="key"?p.keyPath:"",tags:[p.group||"默认分组"],type:e,metadata:{database:p.database||void 0}};R?(await window.wailsBindings.UpdateConnection($),o==="password"&&p.password&&p.savePassword?await window.wailsBindings.SavePassword($.id,p.password):o==="password"&&!p.savePassword&&await window.wailsBindings.DeletePassword($.id),x($)):(w($),o==="password"&&p.password&&p.savePassword&&await window.wailsBindings.SavePassword($.id,p.password)),c(0,b=!1)}catch(R){console.error("Failed to save connection:",R),alert("保存连接失败: "+R)}finally{c(7,l=!1)}}function t(){c(4,p={id:"",name:"",host:"",port:s(),username:"",password:"",savePassword:!1,keyPath:"",passphrase:"",group:"",dbType:"mysql",database:""}),c(6,_=""),c(8,d=!1),c(9,g=!1)}function s(){switch(e){case"ssh":return"22";case"docker":return"2375";case"database":switch(p.dbType){case"mysql":return"3306";case"postgresql":return"5432";case"mongodb":return"27017";case"redis":return"6379";default:return""}default:return""}}async function u(){var R,$,j;if(!(!y||!b))try{const Y=await window.wailsBindings.GetConnection(y.id);if(Y){c(4,p={id:Y.id,name:Y.name||"",host:Y.host||"",port:((R=Y.port)==null?void 0:R.toString())||"",username:Y.user||"",password:"",savePassword:!1,keyPath:Y.key_path||"",passphrase:"",group:(($=Y.tags)==null?void 0:$[0])||"",dbType:"mysql",database:((j=Y.metadata)==null?void 0:j.database)||""}),c(2,e=Y.type||"ssh"),c(3,o=Y.auth_type||"password");try{if(await window.wailsBindings.HasPassword(Y.id)){c(4,p.savePassword=!0,p);const he=await window.wailsBindings.GetPassword(Y.id);c(4,p.password=he||"",p)}}catch(Z){console.warn("Failed to load password:",Z)}}}catch(Y){console.error("Failed to load connection:",Y)}}const m=()=>c(2,e="ssh"),S=()=>c(2,e="database"),C=()=>c(2,e="docker");function v(){p.name=this.value,c(4,p),c(0,b),c(1,y)}const k=()=>{c(3,o="password"),c(6,_="")},T=()=>{c(3,o="key"),c(6,_="")};function B(){p.keyPath=this.value,c(4,p),c(0,b),c(1,y)}function A(){p.passphrase=this.value,c(4,p),c(0,b),c(1,y)}function M(){p.passphrase=this.value,c(4,p),c(0,b),c(1,y)}const W=()=>c(9,g=!g);function N(){p.dbType=Ni(this),c(4,p),c(0,b),c(1,y)}function G(){p.host=this.value,c(4,p),c(0,b),c(1,y)}function X(){p.port=this.value,c(4,p),c(0,b),c(1,y)}function K(){p.username=this.value,c(4,p),c(0,b),c(1,y)}function D(){p.password=this.value,c(4,p),c(0,b),c(1,y)}function O(){p.password=this.value,c(4,p),c(0,b),c(1,y)}const I=()=>c(8,d=!d);function H(){p.savePassword=this.checked,c(4,p),c(0,b),c(1,y)}function q(){p.database=this.value,c(4,p),c(0,b),c(1,y)}function V(){p.group=this.value,c(4,p),c(0,b),c(1,y)}const Q=()=>c(0,b=!1),U=()=>{c(0,b=!1)};function F(R){b=R,c(0,b)}return n.$$set=R=>{"isOpen"in R&&c(0,b=R.isOpen),"onAdd"in R&&c(14,w=R.onAdd),"onUpdate"in R&&c(15,x=R.onUpdate),"editingAsset"in R&&c(1,y=R.editingAsset)},n.$$.update=()=>{n.$$.dirty[0]&1&&(b||t()),n.$$.dirty[0]&3&&b&&!y&&(t(),c(4,p.port=s(),p)),n.$$.dirty[0]&16&&p.port===""&&c(4,p.port=s(),p),n.$$.dirty[0]&12&&(e==="ssh"?o!=="password"&&o!=="key"&&c(3,o="password"):c(3,o="password")),n.$$.dirty[0]&3&&b&&y&&u()},[b,y,e,o,p,h,_,l,d,g,f,i,a,s,w,x,m,S,C,v,k,T,B,A,M,W,N,G,X,K,D,O,I,H,q,V,Q,U,F]}class Gn extends Qe{constructor(r){super(),Ze(this,r,Vn,qn,Ye,{isOpen:0,onAdd:14,onUpdate:15,editingAsset:1},null,[-1,-1])}}function qr(n){let r,c,b,w;return{c(){r=P("div"),c=P("div"),E(c,"class","h-full w-full rounded svelte-h9djo3"),E(r,"class","resize-handle-horizontal flex-shrink-0 relative svelte-h9djo3"),pe(r,"cursor",n[2]?"default":"col-resize"),pe(r,"height","100%"),pe(r,"padding","0 2px"),pe(r,"pointer-events",n[2]?"none":"auto")},m(x,y){se(x,r,y),L(r,c),b||(w=ee(r,"mousedown",n[11]),b=!0)},p(x,y){y[0]&4&&pe(r,"cursor",x[2]?"default":"col-resize"),y[0]&4&&pe(r,"pointer-events",x[2]?"none":"auto")},d(x){x&&te(r),b=!1,w()}}}function Jn(n){let r,c,b,w,x,y,e,o,h,_,l,d,g,p,f,i,a,t,s,u,m,S,C,v,k,T,B,A,M,W,N,G,X,K,D,O,I,H,q,V,Q,U,F,R,$,j,Y,Z,he,me,ye,fe,ne,xe,be,We,Pe;T=new as({props:{onConnect:n[14],onAddClick:n[20],onDelete:n[21],onEdit:n[16]}});let we=!n[3]&&qr(n),J={};N=new Cs({props:J}),n[22](N),q=new En({}),$=new Dn({});function oe(re){n[23](re)}function de(re){n[24](re)}let ve={onAdd:n[15],onUpdate:n[17]};n[2]!==void 0&&(ve.isOpen=n[2]),n[4]!==void 0&&(ve.editingAsset=n[4]),Z=new Gn({props:ve}),je.push(()=>ct(Z,"isOpen",oe)),je.push(()=>ct(Z,"editingAsset",de));function Se(re){n[25](re)}let He={};return n[1]!==void 0&&(He.isOpen=n[1]),fe=new Tn({props:He}),je.push(()=>ct(fe,"isOpen",Se)),{c(){r=P("div"),c=P("header"),b=P("div"),w=P("div"),w.textContent="SSH",x=z(),y=P("div"),e=P("div"),o=ce("跨平台 SSH 连接工具"),_=z(),l=P("div"),d=ce("Cross-Platform SSH Manager"),p=z(),f=P("div"),i=P("button"),a=Te("svg"),t=Te("path"),s=Te("path"),u=z(),m=P("span"),m.textContent="开发工具",C=z(),v=P("div"),k=P("div"),Ae(T.$$.fragment),A=z(),we&&we.c(),M=z(),W=P("div"),Ae(N.$$.fragment),X=z(),K=P("div"),D=P("div"),O=z(),I=P("div"),H=P("div"),Ae(q.$$.fragment),V=z(),Q=P("div"),U=P("div"),F=z(),R=P("div"),Ae($.$$.fragment),Y=z(),Ae(Z.$$.fragment),ye=z(),Ae(fe.$$.fragment),E(w,"class","w-8 h-8 bg-gradient-to-br from-purple-600 to-blue-600 rounded-lg flex items-center justify-center font-bold text-sm text-white shadow-md"),E(e,"class",h="font-semibold text-sm "+(n[0]==="dark"?"text-white":"text-gray-900")),E(l,"class",g="text-xs "+(n[0]==="dark"?"text-gray-400":"text-gray-500")),E(b,"class","flex items-center gap-3"),E(t,"stroke-linecap","round"),E(t,"stroke-linejoin","round"),E(t,"stroke-width","2"),E(t,"d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31 .826 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31 -2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-1.066 2.573c-.94-1.543.826-3.31 -2.37a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31 .826-2.37a1.724 1.724 0 00-1.065-2.572-1.065c-.426 1.756-2.924 0 3.35a1.724 1.724 0 001.066-2.573c.996.608 2.296.07 2.572-1.065z"),E(s,"stroke-linecap","round"),E(s,"stroke-linejoin","round"),E(s,"stroke-width","2"),E(s,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),E(a,"class","w-4 h-4"),E(a,"fill","none"),E(a,"stroke","currentColor"),E(a,"viewBox","0 0 24 24"),E(m,"class","text-sm"),i.disabled=n[2],E(i,"class","flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-lg font-medium transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed"),E(f,"class","ml-auto"),E(c,"class",S="h-14 flex-shrink-0 "+(n[0]==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200")+" border-b flex items-center px-6 shadow-sm"),pe(c,"pointer-events",n[2]?"none":"auto"),E(k,"class",B="flex-shrink-0 transition-all duration-200 "+(n[0]==="dark"?"border-gray-700 bg-gray-800":"border-gray-200 bg-white")+" border-r overflow-hidden"),pe(k,"width",(n[3]?"0":n[8])+"px"),pe(k,"min-width",(n[3]?"0":n[8])+"px"),ht(k,"collapsed",n[3]),E(W,"class",G="flex-1 min-w-0 min-h-0 flex flex-col "+(n[0]==="dark"?"bg-gray-900":"bg-gray-50")),E(D,"class","h-full w-full rounded svelte-h9djo3"),E(K,"class","resize-handle-horizontal flex-shrink-0 relative svelte-h9djo3"),pe(K,"cursor",n[2]?"default":"col-resize"),pe(K,"height","100%"),pe(K,"padding","0 2px"),pe(K,"pointer-events",n[2]?"none":"auto"),E(H,"class","flex-1 overflow-hidden"),pe(H,"height",n[6]+"%"),E(U,"class","w-full h-full rounded svelte-h9djo3"),E(Q,"class","resize-handle-vertical flex-shrink-0 relative svelte-h9djo3"),pe(Q,"cursor",n[2]?"default":"row-resize"),pe(Q,"width","100%"),pe(Q,"padding","2px 0"),pe(Q,"pointer-events",n[2]?"none":"auto"),E(R,"class","flex-1 overflow-hidden"),pe(R,"height",100-n[6]+"%"),E(I,"data-right-panel","true"),E(I,"class",j="flex-shrink-0 flex flex-col overflow-hidden "+(n[0]==="dark"?"border-gray-700 bg-gray-800":"border-gray-200 bg-white")+" border-l shadow-sm"),pe(I,"width",n[7]+"px"),pe(I,"min-width","300px"),pe(I,"max-width","600px"),E(v,"class","flex-1 flex overflow-hidden min-h-0 svelte-h9djo3"),E(r,"class",xe="h-screen w-full flex flex-col "+n[9]+" "+(n[0]==="dark"?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900")+" svelte-h9djo3")},m(re,_e){se(re,r,_e),L(r,c),L(c,b),L(b,w),L(b,x),L(b,y),L(y,e),L(e,o),L(y,_),L(y,l),L(l,d),L(c,p),L(c,f),L(f,i),L(i,a),L(a,t),L(a,s),L(i,u),L(i,m),L(r,C),L(r,v),L(v,k),Le(T,k,null),L(v,A),we&&we.m(v,null),L(v,M),L(v,W),Le(N,W,null),L(v,X),L(v,K),L(K,D),L(v,O),L(v,I),L(I,H),Le(q,H,null),L(I,V),L(I,Q),L(Q,U),L(I,F),L(I,R),Le($,R,null),L(r,Y),Le(Z,r,null),L(r,ye),Le(fe,r,null),be=!0,We||(Pe=[ee(i,"click",n[10]),ee(K,"mousedown",n[12]),ee(Q,"mousedown",n[13])],We=!0)},p(re,_e){(!be||_e[0]&1&&h!==(h="font-semibold text-sm "+(re[0]==="dark"?"text-white":"text-gray-900")))&&E(e,"class",h),(!be||_e[0]&1&&g!==(g="text-xs "+(re[0]==="dark"?"text-gray-400":"text-gray-500")))&&E(l,"class",g),(!be||_e[0]&4)&&(i.disabled=re[2]),(!be||_e[0]&1&&S!==(S="h-14 flex-shrink-0 "+(re[0]==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200")+" border-b flex items-center px-6 shadow-sm"))&&E(c,"class",S),(!be||_e[0]&4)&&pe(c,"pointer-events",re[2]?"none":"auto");const ke={};_e[0]&20&&(ke.onAddClick=re[20]),T.$set(ke),(!be||_e[0]&1&&B!==(B="flex-shrink-0 transition-all duration-200 "+(re[0]==="dark"?"border-gray-700 bg-gray-800":"border-gray-200 bg-white")+" border-r overflow-hidden"))&&E(k,"class",B),(!be||_e[0]&264)&&pe(k,"width",(re[3]?"0":re[8])+"px"),(!be||_e[0]&264)&&pe(k,"min-width",(re[3]?"0":re[8])+"px"),(!be||_e[0]&9)&&ht(k,"collapsed",re[3]),re[3]?we&&(we.d(1),we=null):we?we.p(re,_e):(we=qr(re),we.c(),we.m(v,M));const ae={};N.$set(ae),(!be||_e[0]&1&&G!==(G="flex-1 min-w-0 min-h-0 flex flex-col "+(re[0]==="dark"?"bg-gray-900":"bg-gray-50")))&&E(W,"class",G),(!be||_e[0]&4)&&pe(K,"cursor",re[2]?"default":"col-resize"),(!be||_e[0]&4)&&pe(K,"pointer-events",re[2]?"none":"auto"),(!be||_e[0]&64)&&pe(H,"height",re[6]+"%"),(!be||_e[0]&4)&&pe(Q,"cursor",re[2]?"default":"row-resize"),(!be||_e[0]&4)&&pe(Q,"pointer-events",re[2]?"none":"auto"),(!be||_e[0]&64)&&pe(R,"height",100-re[6]+"%"),(!be||_e[0]&1&&j!==(j="flex-shrink-0 flex flex-col overflow-hidden "+(re[0]==="dark"?"border-gray-700 bg-gray-800":"border-gray-200 bg-white")+" border-l shadow-sm"))&&E(I,"class",j),(!be||_e[0]&128)&&pe(I,"width",re[7]+"px");const Oe={};!he&&_e[0]&4&&(he=!0,Oe.isOpen=re[2],lt(()=>he=!1)),!me&&_e[0]&16&&(me=!0,Oe.editingAsset=re[4],lt(()=>me=!1)),Z.$set(Oe);const ie={};!ne&&_e[0]&2&&(ne=!0,ie.isOpen=re[1],lt(()=>ne=!1)),fe.$set(ie),(!be||_e[0]&513&&xe!==(xe="h-screen w-full flex flex-col "+re[9]+" "+(re[0]==="dark"?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900")+" svelte-h9djo3"))&&E(r,"class",xe)},i(re){be||(le(T.$$.fragment,re),le(N.$$.fragment,re),le(q.$$.fragment,re),le($.$$.fragment,re),le(Z.$$.fragment,re),le(fe.$$.fragment,re),be=!0)},o(re){ue(T.$$.fragment,re),ue(N.$$.fragment,re),ue(q.$$.fragment,re),ue($.$$.fragment,re),ue(Z.$$.fragment,re),ue(fe.$$.fragment,re),be=!1},d(re){re&&te(r),De(T),we&&we.d(),n[22](null),De(N),De(q),De($),De(Z),De(fe),We=!1,Ie(Pe)}}}function Xn(n,r,c){let b,w,x,y,e,o,h;Ct(n,nt,U=>c(18,e=U)),Ct(n,Wt,U=>c(0,o=U)),Ct(n,yt,U=>c(19,h=U));let _=!1,l=!1,d=!1,g=null,p,f=!1,i=!1,a=!1;function t(){l||c(1,_=!_)}function s(U){U.preventDefault(),!l&&(f=!0,document.addEventListener("mousemove",u),document.addEventListener("mouseup",m))}function u(U){if(!f)return;const F=Math.max(200,Math.min(500,U.clientX));es(F)}function m(){f=!1,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",m)}function S(U){U.preventDefault(),!l&&(i=!0,document.addEventListener("mousemove",C),document.addEventListener("mouseup",v))}function C(U){if(!i)return;const F=window.innerWidth,R=Math.max(300,Math.min(600,F-U.clientX));ts(R)}function v(){i=!1,document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",v)}function k(U){if(U.preventDefault(),l)return;a=!0;const F=document.querySelector("[data-right-panel]");if(F){const R=F.getBoundingClientRect();T=U.clientY,B=y,A=R.height}document.addEventListener("mousemove",M),document.addEventListener("mouseup",W)}let T=0,B=50,A=0;function M(U){if(!a)return;const R=(U.clientY-T)/A*100,$=Math.max(20,Math.min(80,B+R));rs($)}function W(){a=!1,document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",W)}function N(U){p&&typeof p.handleConnect=="function"?p.handleConnect(U):(console.error("TerminalPanel not available"),alert("终端面板未初始化"))}async function G(U){var F;if(!window.wailsBindings){console.error("Wails bindings not loaded");return}try{await window.wailsBindings.AddConnection(U);const R={id:U.id,name:U.name,host:U.host,port:U.port,username:U.user,group:((F=U.tags)==null?void 0:F[0])||"默认分组",status:"online",type:U.type||"ssh",auth_type:U.auth_type,key_path:U.key_path,tags:U.tags||[]};ut.update($=>[...$,R])}catch(R){throw console.error("Failed to add asset:",R),R}}function X(U){c(4,g=U),c(2,l=!0)}async function K(U){if(!window.wailsBindings){console.error("Wails bindings not loaded");return}try{ut.update(F=>F.map(R=>{var $;return R.id===U.id?{...R,id:U.id,name:U.name,host:U.host,port:U.port,username:U.user,group:(($=U.tags)==null?void 0:$[0])||"默认分组",type:U.type||"ssh",auth_type:U.auth_type,key_path:U.key_path,tags:U.tags||[]}:R}))}catch(F){throw console.error("Failed to update asset:",F),F}}async function D(){if(!window.wailsBindings){console.warn("Wails bindings not loaded yet");return}try{const U=await window.wailsBindings.GetConnections();console.log("Loaded connections from backend:",U);const F=U.map(R=>{var $;return{id:R.id,name:R.name,host:R.host,port:R.port,username:R.user,group:(($=R.tags)==null?void 0:$[0])||"默认分组",status:"online",type:"ssh",auth_type:R.auth_type,key_path:R.key_path,tags:R.tags||[]}});ut.set(F)}catch(U){console.error("Failed to load connections:",U)}}Tt(async()=>{window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&Wt.set("dark");try{const F=await xi(()=>Promise.resolve().then(()=>sn),void 0);window.wailsBindings=F,window.dispatchEvent(new CustomEvent("wails-bindings-loaded",{detail:Object.keys(F.default||F).join(", ")})),await D()}catch(F){console.warn("Wails bindings not available yet:",F.message)}const U=()=>{const F=document.getElementById("app");F&&(F.style.height="100vh",F.style.width="100vw")};return U(),window.addEventListener("resize",U),()=>{window.removeEventListener("resize",U)}});const O=()=>{c(4,g=null),c(2,l=!0)},I=async U=>{if(!window.wailsBindings){ut.update(F=>F.filter(R=>R.id!==U.id));return}if(confirm(`确定要删除连接 "${U.name}" 吗？`))try{await window.wailsBindings.RemoveConnection(U.id),ut.update(F=>F.filter(R=>R.id!==U.id))}catch(F){console.error("Failed to delete asset:",F),alert("删除连接失败: "+F)}};function H(U){je[U?"unshift":"push"](()=>{p=U,c(5,p)})}function q(U){l=U,c(2,l)}function V(U){g=U,c(4,g)}function Q(U){_=U,c(1,_)}return n.$$.update=()=>{n.$$.dirty[0]&524288&&h&&Array.from(h.values()),n.$$.dirty[0]&1&&c(9,b=o==="dark"?"dark":""),n.$$.dirty[0]&262144&&c(8,w=e.sidebarWidth),n.$$.dirty[0]&262144&&c(7,x=e.rightPanelWidth),n.$$.dirty[0]&262144&&c(6,y=e.fileManagerHeight)},[o,_,l,d,g,p,y,x,w,b,t,s,S,k,N,G,X,K,e,h,O,I,H,q,V,Q]}class Yn extends Qe{constructor(r){super(),Ze(this,r,Xn,Jn,Ye,{},null,[-1,-1])}}new Yn({target:document.getElementById("app")});
