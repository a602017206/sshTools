# sshTools

一个功能完整的跨平台SSH桌面客户端工具，使用Go和Wails构建。

**功能齐全** · **安全可靠** · **跨平台** · **现代化UI**

集成终端、文件管理、系统监控于一体的现代化SSH工具，让远程服务器管理更加高效便捷。

## 欢迎赞助

如果您喜欢这个项目，欢迎赞助支持。您的赞助将帮助我继续开发和维护这个项目。

### 赞助方式

- **支付宝** - 扫描下方二维码
- **微信支付** - 扫描下方二维码

<img src="zfb.png" alt="支付宝" width="200"/>
<img src="wx.png" alt="微信支付" width="200"/>

## 特性

### 当前实现 ✨

**核心功能**
- ✅ **完整的终端UI** - 基于xterm.js的现代化终端界面
- ✅ **多标签页支持** - 同时连接和管理多个SSH会话
  - 浏览器风格的水平标签栏
  - 标签重命名（双击编辑）
  - 显示连接名称和user@host信息
  - 关闭确认（防止误操作）
  - 自动切换到其他标签
  - 无并发会话数量限制
- ✅ **SSH连接管理** - 保存和管理多个SSH连接配置
- ✅ **多种认证方式**
  - 密码认证（支持键盘交互式认证）
  - SSH密钥认证（支持RSA、Ed25519、ECDSA等）
  - 加密密钥Passphrase支持
- ✅ **密码管理**
  - AES-GCM加密存储密码
  - 自动保存和读取密码
  - 机器特征绑定的加密密钥
- ✅ **原生对话框** - Wails原生对话框集成，完美支持桌面端
- ✅ **SSH密钥选择器** - 图形化文件选择器，支持多种密钥格式
- ✅ **实时SSH会话** - PTY支持、完整ANSI颜色、实时双向通信
- ✅ **响应式界面** - 侧边栏连接管理 + 主终端显示区域
- ✅ **终端功能** - 自适应大小、滚动历史、链接点击
- ✅ **配置持久化** - 连接配置和加密凭证本地存储
- ✅ **事件驱动通信** - 前后端实时数据传输

**文件管理（SFTP）**
- ✅ **可折叠文件管理面板** - 右侧独立可调整大小的面板
- ✅ **目录浏览与导航**
  - 面包屑导航快速返回上级目录
  - 路径输入跳转到指定目录
  - 文件列表按类型和名称排序
- ✅ **文件操作**
  - 上传文件（支持多文件选择）
  - 下载文件到本地
  - 删除文件和文件夹（递归删除）
  - 重命名文件/文件夹
  - 创建新文件夹
- ✅ **传输管理**
  - 实时显示传输进度条
  - 传输速度和百分比显示
  - 支持取消传输任务
  - 并发传输支持
  - 64KB块流式传输（支持大文件）
- ✅ **用户体验**
  - 批量选择（Ctrl/Cmd+点击）
  - 双击打开文件夹
  - 文件大小和修改时间显示
  - 文件类型图标（文件夹、文件、符号链接）
  - 拖放上传提示（引导使用上传按钮）

**系统监控**
- ✅ **可折叠监控面板** - 右侧独立可调整大小的面板
- ✅ **实时性能监控**
  - CPU使用率（整体和各核心）
  - 内存使用情况（已用/总量）
  - 磁盘使用统计
  - 网络I/O流量
- ✅ **系统信息显示**
  - 操作系统和版本
  - 主机名和架构
  - 系统运行时间
  - 进程数量统计

### 计划中 🚀

**核心功能增强**
- 🔸 **端口转发/SSH隧道**
  - 本地端口转发（Local Forward）
  - 远程端口转发（Remote Forward）
  - 动态端口转发（SOCKS代理）
  - 隧道状态监控
- 🔸 **跳板机支持**
  - 多级SSH跳转配置
  - ProxyJump自动连接
  - 跳板链路管理
- 🔸 **会话日志记录**
  - 自动记录终端输出
  - 日志搜索和导出
  - 可配置的日志保留策略
  - 敏感信息过滤

**标签页增强**
- 🔸 **键盘快捷键**
  - Ctrl+T: 新建标签
  - Ctrl+W: 关闭当前标签
  - Ctrl+Tab / Ctrl+Shift+Tab: 切换标签
  - Ctrl+数字键: 快速跳转到指定标签
- 🔸 **标签拖拽排序** - 鼠标拖拽重新排列标签顺序
- 🔸 **标签持久化** - 保存标签状态，应用重启后自动恢复会话
- 🔸 **标签分组** - 按项目或环境对标签进行分组管理
- 🔸 **跨标签搜索** - 在所有打开的终端中搜索关键词
- 🔸 **会话重连** - 网络中断后自动尝试重新连接

**界面和体验**
- 🔸 **终端分屏**
  - 水平/垂直分割
  - 多窗格同时显示
  - 分屏布局保存
- 🔸 **主题系统**
  - 浅色/深色主题切换
  - 自定义终端配色方案
  - 字体和字号配置
- 🔸 **全局快捷键** - 全局热键快速呼出应用窗口
- 🔸 **命令历史** - 跨会话的命令历史记录和搜索
- 🔸 **智能提示** - 基于历史的命令自动补全

**安全和管理**
- 🔸 **系统密钥链集成**
  - macOS Keychain
  - Windows Credential Manager
  - Linux Secret Service
- 🔸 **会话超时** - 自动锁定或关闭长时间不活动的会话
- 🔸 **连接审计** - 记录所有连接活动和操作日志
- 🔸 **多用户配置** - 支持多个配置文件和快速切换

**高级功能**
- 🔸 **脚本执行** - 批量在多个服务器上执行命令
- 🔸 **文件比较** - 对比远程和本地文件差异
- 🔸 **性能监控** - 实时显示服务器资源使用情况
- 🔸 **连接池** - 复用SSH连接以提升性能
- 🔸 **云同步** - 可选的配置云端同步功能

详细的开发计划请查看 [DEVELOPMENT_PLAN.md](./DEVELOPMENT_PLAN.md)

## 技术栈

- **后端**: Go 1.25
  - Wails v2 - 桌面应用框架
  - golang.org/x/crypto/ssh - SSH协议实现
  - github.com/pkg/sftp - SFTP文件传输
  - github.com/shirou/gopsutil/v3 - 系统性能监控
  - AES-GCM - 密码加密存储
  - Wails Runtime - 原生对话框和文件选择器

- **前端**: Svelte + Vite
  - xterm.js - 终端模拟器
  - 现代化的响应式UI
  - 通过Wails绑定与Go后端通信
  - 自定义模态对话框组件

## 快速开始

### 环境要求

- Go 1.25+
- Node.js 18+
- Wails CLI v2.11.0+

macOS还需要:
- Xcode Command Line Tools

### 安装

```bash
# 安装Wails CLI
go install github.com/wailsapp/wails/v2/cmd/wails@latest

# 进入项目目录
cd sshTools

# 安装前端依赖
cd frontend && npm install && cd ..
```

### 开发

```bash
# 开发模式（热重载）
wails dev

# 或使用完整路径
$HOME/go/bin/wails dev

# 构建生产版本
wails build
```

**📖 详细使用说明请查看 [QUICK_START.md](./QUICK_START.md)**

## 使用指南

### 创建 SSH 连接

1. **启动应用**: `wails dev` 或运行构建后的应用
2. **点击"+ 新建连接"**
3. **填写连接信息**:
   - 连接名称
   - 主机地址
   - 端口（默认22）
   - 用户名
4. **选择认证方式**:
   - **密码认证**: 输入密码用于测试
   - **SSH密钥认证**: 点击"选择文件"选择私钥（如 `~/.ssh/id_rsa`）
5. **测试连接**: 点击"测试连接"验证配置
6. **保存**: 点击"保存"按钮

### 连接到服务器

**使用密码认证**:
- 首次连接: 输入密码，可选择"保存密码（加密存储）"
- 再次连接: 自动使用保存的密码，无需重复输入

**使用密钥认证**:
- 如果密钥已加密: 系统会提示输入 Passphrase
- 如果密钥未加密: 直接连接

### 使用多标签页

**打开新标签**:
1. 从侧边栏点击任意连接的"连接"按钮
2. 每次点击都会在新标签页中打开SSH会话
3. 无标签数量限制，可同时管理多个服务器

**标签操作**:
- **切换标签**: 点击标签即可切换到对应的终端
- **重命名标签**: 双击标签标题，输入新名称，按Enter确认或Esc取消
- **关闭标签**: 点击标签右侧的 × 按钮
  - 如果会话仍在连接中，会提示确认是否关闭
  - 关闭当前标签会自动切换到其他标签
- **查看连接信息**: 鼠标悬停在标签上，查看完整的 user@host:port 信息

**标签显示**:
- 默认显示连接名称
- 双击可自定义标签名称（例如："生产环境"、"数据库服务器"等）
- 绿色状态指示灯表示连接正常

### 使用文件管理器

**打开文件管理器**:
1. 连接到 SSH 服务器后，点击右侧工具栏的文件夹图标（📁）
2. 文件管理面板从右侧展开，显示远程服务器文件列表

**浏览文件**:
- **导航**: 双击文件夹打开，点击面包屑导航返回上级
- **跳转路径**: 点击工具栏的搜索图标（🔍），输入路径（如 `/var/log`）直接跳转
- **刷新**: 点击刷新按钮重新加载当前目录

**文件操作**:
- **上传**: 点击"上传"按钮，选择本地文件上传到当前目录
- **下载**: 选中文件后点击"下载"按钮，选择本地保存位置
- **删除**: 选中文件/文件夹后点击删除按钮（🗑️）
- **重命名**: 选中单个文件后点击编辑按钮，输入新名称
- **新建文件夹**: 点击文件夹加号按钮（📁+），输入文件夹名称

**批量操作**:
- 按住 Ctrl（Windows/Linux）或 Cmd（macOS）点击多个文件
- 可批量下载或删除选中的多个文件

**传输进度**:
- 上传/下载时底部显示进度条
- 显示传输速度和完成百分比
- 点击取消按钮可中止传输

### 使用系统监控

**打开监控面板**:
1. 连接到 SSH 服务器后，点击右侧工具栏的监控图标
2. 监控面板从右侧展开，显示实时系统性能数据

**监控信息**:
- **CPU**: 整体使用率和各核心负载
- **内存**: 已用/总量、使用百分比
- **磁盘**: 各分区使用情况
- **网络**: 实时上传/下载速度
- **系统信息**: OS版本、主机名、运行时间等

**面板操作**:
- 拖动面板边缘调整宽度
- 点击折叠按钮隐藏面板
- 数据每秒自动刷新

### 支持的 SSH 密钥格式

- RSA (`id_rsa`)
- Ed25519 (`id_ed25519`) - 推荐
- ECDSA (`id_ecdsa`)
- PEM 格式 (`*.pem`)
- 其他标准 SSH 私钥格式 (`*.key`)

## 项目结构

```
sshTools/
├── main.go              # 应用入口点
├── app.go               # 主应用逻辑和Wails绑定
├── internal/            # 内部包
│   ├── ssh/            # SSH核心功能
│   │   ├── client.go        # SSH客户端实现
│   │   ├── session.go       # 会话管理
│   │   ├── manager.go       # 会话管理器
│   │   ├── sftp.go          # SFTP文件传输
│   │   ├── transfer.go      # 传输任务管理
│   │   └── monitor.go       # 系统性能监控
│   ├── config/         # 配置管理
│   ├── store/          # 凭证存储
│   ├── terminal/       # 终端模拟器
│   └── crypto/         # 加密相关
├── frontend/           # Svelte前端
│   ├── src/
│   │   ├── components/
│   │   │   ├── Terminal.svelte             # 终端组件
│   │   │   ├── TabBar.svelte               # 标签栏
│   │   │   ├── ConnectionManager.svelte    # 连接管理
│   │   │   ├── FileManager.svelte          # 文件管理器
│   │   │   ├── FileListItem.svelte         # 文件列表项
│   │   │   ├── FileOperationModal.svelte   # 文件操作对话框
│   │   │   ├── TransferProgressBar.svelte  # 传输进度条
│   │   │   ├── MonitorPanel.svelte         # 监控面板
│   │   │   └── Icon.svelte                 # 图标组件
│   │   ├── stores/
│   │   │   ├── theme.js           # 主题状态
│   │   │   ├── fileManager.js     # 文件管理器状态
│   │   │   └── monitor.js         # 监控面板状态
│   │   └── App.svelte             # 主应用
│   └── wailsjs/       # Wails自动生成的绑定
├── build/             # 构建配置
└── assets/            # 资源文件
```

## 配置

应用配置和数据存储在 `~/.sshtools/` 目录:
- `config.json` - 应用配置文件，包含：
  - SSH连接配置列表
  - 应用设置（主题、字体、窗口大小等）
  - 文件管理器设置（面板宽度、排序方式等）
  - 监控面板设置（面板宽度、刷新间隔等）
- `credentials.enc` - AES-GCM加密的密码存储（仅当用户选择保存密码时）

**安全说明**：密码使用AES-GCM加密算法存储，加密密钥基于机器特征生成，确保数据安全。

**配置示例** (`config.json`):
```json
{
  "connections": [
    {
      "id": "unique-id",
      "name": "生产服务器",
      "host": "192.168.1.100",
      "port": 22,
      "user": "admin",
      "auth_type": "key",
      "key_path": "/Users/username/.ssh/id_ed25519"
    }
  ],
  "settings": {
    "theme": "dark",
    "sidebar_width": 300,
    "file_manager_collapsed": false,
    "file_manager_width": 400,
    "monitor_collapsed": false,
    "monitor_width": 350
  }
}

## 安全和隐私

### 密码加密存储
- **加密算法**: AES-256-GCM（Galois/Counter Mode）
- **密钥派生**: 基于机器特征（主机名 + 用户目录）
- **存储位置**: `~/.sshtools/credentials.enc`（权限 0600）
- **数据保护**: 密码在传输和存储过程中始终加密

### 隐私保护
- ✅ 所有数据本地存储，无云端同步
- ✅ SSH 密钥 Passphrase 不会保存到磁盘
- ✅ 用户可选择是否保存密码
- ✅ 连接配置不包含敏感信息

### 安全建议
- 使用 SSH 密钥认证而非密码（更安全）
- 推荐使用 Ed25519 密钥（更快更安全）
- 定期轮换 SSH 密钥和密码
- 为 SSH 私钥设置强 Passphrase

## 开发文档

- [CLAUDE.md](./CLAUDE.md) - 项目架构和开发指南
- [DEVELOPMENT_PLAN.md](./DEVELOPMENT_PLAN.md) - 详细的开发计划和功能清单

## 构建

```bash
# macOS (Apple Silicon)
wails build -platform darwin/arm64

# macOS (Intel)
wails build -platform darwin/amd64

# Windows
wails build -platform windows/amd64

# Linux
wails build -platform linux/amd64
```

构建后的应用程序位于 `build/bin/` 目录。

## 常见问题

### 连接失败：ssh: unable to authenticate

这通常是认证方式不匹配导致的。解决方案：

1. **检查认证方式**: 确认服务器支持您选择的认证方式（密码或密钥）
2. **密钥认证**: 确保选择了正确的私钥文件
3. **密码认证**: 检查用户名和密码是否正确
4. **服务器配置**: 某些服务器可能禁用了密码认证，需要使用密钥

### 无法保存密码

- 确保应用有权限创建 `~/.sshtools/` 目录
- 检查磁盘空间是否充足
- macOS/Linux: 检查文件权限（应为 0600）

### SSH 密钥认证失败

1. **检查密钥格式**: 确保使用的是私钥文件（不是 `.pub` 公钥）
2. **Passphrase**: 如果密钥已加密，需要输入正确的 Passphrase
3. **密钥权限**: 私钥文件权限应为 600 或 400
4. **公钥配置**: 确保公钥已添加到服务器的 `~/.ssh/authorized_keys`

### 构建失败

```bash
# 清理并重新安装依赖
cd frontend
rm -rf node_modules
npm install
cd ..

# 重新生成绑定
wails dev
```

### 文件上传/下载失败

1. **权限问题**: 确保对远程目录有读写权限
2. **路径不存在**: 确保目标目录存在
3. **磁盘空间不足**: 检查本地和远程磁盘空间
4. **大文件传输**: 支持大文件，使用64KB块流式传输，不会占用过多内存

### 拖放上传不工作

由于 Wails 框架限制，拖放上传功能可能不可用。请使用工具栏的"上传"按钮选择文件，功能完全正常。

### 监控数据不显示

1. **权限问题**: 某些系统信息需要特定权限
2. **系统兼容性**: 确保在支持的系统上运行（Linux、macOS、Windows）
3. **网络问题**: 检查 SSH 连接是否正常

## 贡献

欢迎提交 Issue 和 Pull Request！

## License

Apache License 2.0
